define(["@jupyter-widgets/base"],function(t){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=29)}([function(t,e,n){var i,r;!function(){var s={version:"3.5.17"},a=[].slice,o=function(t){return a.call(t)},l=this.document;function c(t){return t&&(t.ownerDocument||t.document||t).documentElement}function h(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}if(l)try{o(l.documentElement.childNodes)[0].nodeType}catch(t){o=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}if(Date.now||(Date.now=function(){return+new Date}),l)try{l.createElement("DIV").style.setProperty("opacity",0,"")}catch(t){var u=this.Element.prototype,d=u.setAttribute,_=u.setAttributeNS,f=this.CSSStyleDeclaration.prototype,g=f.setProperty;u.setAttribute=function(t,e){d.call(this,t,e+"")},u.setAttributeNS=function(t,e,n){_.call(this,t,e,n+"")},f.setProperty=function(t,e,n){g.call(this,t,e+"",n)}}function p(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function m(t){return null===t?NaN:+t}function v(t){return!isNaN(t)}function b(t){return{left:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);i<r;){var s=i+r>>>1;t(e[s],n)<0?i=s+1:r=s}return i},right:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);i<r;){var s=i+r>>>1;t(e[s],n)>0?r=s:i=s+1}return i}}}s.ascending=p,s.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},s.min=function(t,e){var n,i,r=-1,s=t.length;if(1===arguments.length){for(;++r<s;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<s;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;++r<s;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<s;)null!=(i=e.call(t,t[r],r))&&n>i&&(n=i)}return n},s.max=function(t,e){var n,i,r=-1,s=t.length;if(1===arguments.length){for(;++r<s;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<s;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;++r<s;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<s;)null!=(i=e.call(t,t[r],r))&&i>n&&(n=i)}return n},s.extent=function(t,e){var n,i,r,s=-1,a=t.length;if(1===arguments.length){for(;++s<a;)if(null!=(i=t[s])&&i>=i){n=r=i;break}for(;++s<a;)null!=(i=t[s])&&(n>i&&(n=i),r<i&&(r=i))}else{for(;++s<a;)if(null!=(i=e.call(t,t[s],s))&&i>=i){n=r=i;break}for(;++s<a;)null!=(i=e.call(t,t[s],s))&&(n>i&&(n=i),r<i&&(r=i))}return[n,r]},s.sum=function(t,e){var n,i=0,r=t.length,s=-1;if(1===arguments.length)for(;++s<r;)v(n=+t[s])&&(i+=n);else for(;++s<r;)v(n=+e.call(t,t[s],s))&&(i+=n);return i},s.mean=function(t,e){var n,i=0,r=t.length,s=-1,a=r;if(1===arguments.length)for(;++s<r;)v(n=m(t[s]))?i+=n:--a;else for(;++s<r;)v(n=m(e.call(t,t[s],s)))?i+=n:--a;if(a)return i/a},s.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),r=+t[i-1],s=n-i;return s?r+s*(t[i]-r):r},s.median=function(t,e){var n,i=[],r=t.length,a=-1;if(1===arguments.length)for(;++a<r;)v(n=m(t[a]))&&i.push(n);else for(;++a<r;)v(n=m(e.call(t,t[a],a)))&&i.push(n);if(i.length)return s.quantile(i.sort(p),.5)},s.variance=function(t,e){var n,i,r=t.length,s=0,a=0,o=-1,l=0;if(1===arguments.length)for(;++o<r;)v(n=m(t[o]))&&(a+=(i=n-s)*(n-(s+=i/++l)));else for(;++o<r;)v(n=m(e.call(t,t[o],o)))&&(a+=(i=n-s)*(n-(s+=i/++l)));if(l>1)return a/(l-1)},s.deviation=function(){var t=s.variance.apply(this,arguments);return t?Math.sqrt(t):t};var y=b(p);function x(t){return t.length}s.bisectLeft=y.left,s.bisect=s.bisectRight=y.right,s.bisector=function(t){return b(1===t.length?function(e,n){return p(t(e),n)}:t)},s.shuffle=function(t,e,n){(s=arguments.length)<3&&(n=t.length,s<2&&(e=0));for(var i,r,s=n-e;s;)r=Math.random()*s--|0,i=t[s+e],t[s+e]=t[r+e],t[r+e]=i;return t},s.permute=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},s.pairs=function(t){for(var e=0,n=t.length-1,i=t[0],r=new Array(n<0?0:n);e<n;)r[e]=[i,i=t[++e]];return r},s.transpose=function(t){if(!(r=t.length))return[];for(var e=-1,n=s.min(t,x),i=new Array(n);++e<n;)for(var r,a=-1,o=i[e]=new Array(r);++a<r;)o[a]=t[a][e];return i},s.zip=function(){return s.transpose(arguments)},s.keys=function(t){var e=[];for(var n in t)e.push(n);return e},s.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},s.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},s.merge=function(t){for(var e,n,i,r=t.length,s=-1,a=0;++s<r;)a+=t[s].length;for(n=new Array(a);--r>=0;)for(e=(i=t[r]).length;--e>=0;)n[--a]=i[e];return n};var k=Math.abs;function w(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function M(){this._=Object.create(null)}s.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n==1/0)throw new Error("infinite range");var i,r=[],s=function(t){var e=1;for(;t*e%1;)e*=10;return e}(k(n)),a=-1;if(t*=s,e*=s,(n*=s)<0)for(;(i=t+n*++a)>e;)r.push(i/s);else for(;(i=t+n*++a)<e;)r.push(i/s);return r},s.map=function(t,e){var n=new M;if(t instanceof M)t.forEach(function(t,e){n.set(t,e)});else if(Array.isArray(t)){var i,r=-1,s=t.length;if(1===arguments.length)for(;++r<s;)n.set(r,t[r]);else for(;++r<s;)n.set(e.call(t,i=t[r],r),i)}else for(var a in t)n.set(a,t[a]);return n};var A="__proto__",q="\0";function z(t){return(t+="")===A||t[0]===q?q+t:t}function E(t){return(t+="")[0]===q?t.slice(1):t}function S(t){return z(t)in this._}function T(t){return(t=z(t))in this._&&delete this._[t]}function L(){var t=[];for(var e in this._)t.push(E(e));return t}function N(){var t=0;for(var e in this._)++t;return t}function O(){for(var t in this._)return!1;return!0}function C(){this._=Object.create(null)}function j(t){return t}function B(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}function P(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,i=D.length;n<i;++n){var r=D[n]+e;if(r in t)return r}}w(M,{has:S,get:function(t){return this._[z(t)]},set:function(t,e){return this._[z(t)]=e},remove:T,keys:L,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:E(e),value:this._[e]});return t},size:N,empty:O,forEach:function(t){for(var e in this._)t.call(this,E(e),this._[e])}}),s.nest=function(){var t,e,n={},i=[],r=[];function a(r,s,o){if(o>=i.length)return e?e.call(n,s):t?s.sort(t):s;for(var l,c,h,u,d=-1,_=s.length,f=i[o++],g=new M;++d<_;)(u=g.get(l=f(c=s[d])))?u.push(c):g.set(l,[c]);return r?(c=r(),h=function(t,e){c.set(t,a(r,e,o))}):(c={},h=function(t,e){c[t]=a(r,e,o)}),g.forEach(h),c}return n.map=function(t,e){return a(e,t,0)},n.entries=function(t){return function t(e,n){if(n>=i.length)return e;var s=[],a=r[n++];return e.forEach(function(e,i){s.push({key:e,values:t(i,n)})}),a?s.sort(function(t,e){return a(t.key,e.key)}):s}(a(s.map,t,0),0)},n.key=function(t){return i.push(t),n},n.sortKeys=function(t){return r[i.length-1]=t,n},n.sortValues=function(e){return t=e,n},n.rollup=function(t){return e=t,n},n},s.set=function(t){var e=new C;if(t)for(var n=0,i=t.length;n<i;++n)e.add(t[n]);return e},w(C,{has:S,add:function(t){return this._[z(t+="")]=!0,t},remove:T,values:L,size:N,empty:O,forEach:function(t){for(var e in this._)t.call(this,E(e))}}),s.behavior={},s.rebind=function(t,e){for(var n,i=1,r=arguments.length;++i<r;)t[n=arguments[i]]=B(t,e,e[n]);return t};var D=["webkit","ms","moz","Moz","o","O"];function R(){}function F(){}function I(t){var e=[],n=new M;function i(){for(var n,i=e,r=-1,s=i.length;++r<s;)(n=i[r].on)&&n.apply(this,arguments);return t}return i.on=function(i,r){var s,a=n.get(i);return arguments.length<2?a&&a.on:(a&&(a.on=null,e=e.slice(0,s=e.indexOf(a)).concat(e.slice(s+1)),n.remove(i)),r&&e.push(n.set(i,{on:r})),t)},i}function U(){s.event.preventDefault()}function H(){for(var t,e=s.event;t=e.sourceEvent;)e=t;return e}function Y(t){for(var e=new F,n=0,i=arguments.length;++n<i;)e[arguments[n]]=I(e);return e.of=function(n,i){return function(r){try{var a=r.sourceEvent=s.event;r.target=t,s.event=r,e[r.type].apply(n,i)}finally{s.event=a}}},e}s.dispatch=function(){for(var t=new F,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=I(t);return t},F.prototype.on=function(t,e){var n=t.indexOf("."),i="";if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},s.event=null,s.requote=function(t){return t.replace(V,"\\$&")};var V=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,W={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]};function G(t){return W(t,$),t}var Z=function(t,e){return e.querySelector(t)},K=function(t,e){return e.querySelectorAll(t)},X=function(t,e){var n=t.matches||t[P(t,"matchesSelector")];return(X=function(t,e){return n.call(t,e)})(t,e)};"function"==typeof Sizzle&&(Z=function(t,e){return Sizzle(t,e)[0]||null},K=Sizzle,X=Sizzle.matchesSelector),s.selection=function(){return s.select(l.documentElement)};var $=s.selection.prototype=[];function J(t){return"function"==typeof t?t:function(){return Z(t,this)}}function Q(t){return"function"==typeof t?t:function(){return K(t,this)}}$.select=function(t){var e,n,i,r,s=[];t=J(t);for(var a=-1,o=this.length;++a<o;){s.push(e=[]),e.parentNode=(i=this[a]).parentNode;for(var l=-1,c=i.length;++l<c;)(r=i[l])?(e.push(n=t.call(r,r.__data__,l,a)),n&&"__data__"in r&&(n.__data__=r.__data__)):e.push(null)}return G(s)},$.selectAll=function(t){var e,n,i=[];t=Q(t);for(var r=-1,s=this.length;++r<s;)for(var a=this[r],l=-1,c=a.length;++l<c;)(n=a[l])&&(i.push(e=o(t.call(n,n.__data__,l,r))),e.parentNode=n);return G(i)};var tt="http://www.w3.org/1999/xhtml",et={svg:"http://www.w3.org/2000/svg",xhtml:tt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nt(t,e){return t=s.ns.qualify(t),null==e?t.local?function(){this.removeAttributeNS(t.space,t.local)}:function(){this.removeAttribute(t)}:"function"==typeof e?t.local?function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}:function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}:t.local?function(){this.setAttributeNS(t.space,t.local,e)}:function(){this.setAttribute(t,e)}}function it(t){return t.trim().replace(/\s+/g," ")}function rt(t){return new RegExp("(?:^|\\s+)"+s.requote(t)+"(?:\\s+|$)","g")}function st(t){return(t+"").trim().split(/^|\s+/)}function at(t,e){var n=(t=st(t).map(ot)).length;return"function"==typeof e?function(){for(var i=-1,r=e.apply(this,arguments);++i<n;)t[i](this,r)}:function(){for(var i=-1;++i<n;)t[i](this,e)}}function ot(t){var e=rt(t);return function(n,i){if(r=n.classList)return i?r.add(t):r.remove(t);var r=n.getAttribute("class")||"";i?(e.lastIndex=0,e.test(r)||n.setAttribute("class",it(r+" "+t))):n.setAttribute("class",it(r.replace(e," ")))}}function lt(t,e,n){return null==e?function(){this.style.removeProperty(t)}:"function"==typeof e?function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}:function(){this.style.setProperty(t,e,n)}}function ct(t,e){return null==e?function(){delete this[t]}:"function"==typeof e?function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}:function(){this[t]=e}}function ht(t){return"function"==typeof t?t:(t=s.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){var e=this.ownerDocument,n=this.namespaceURI;return n===tt&&e.documentElement.namespaceURI===tt?e.createElement(t):e.createElementNS(n,t)}}function ut(){var t=this.parentNode;t&&t.removeChild(this)}function dt(t){return{__data__:t}}function _t(t){return function(){return X(this,t)}}function ft(t,e){for(var n=0,i=t.length;n<i;n++)for(var r,s=t[n],a=0,o=s.length;a<o;a++)(r=s[a])&&e(r,a,n);return t}function gt(t){return W(t,pt),t}s.ns={prefix:et,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),et.hasOwnProperty(n)?{space:et[n],local:t}:t}},$.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return(t=s.ns.qualify(t)).local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(nt(e,t[e]));return this}return this.each(nt(t,e))},$.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),i=(t=st(t)).length,r=-1;if(e=n.classList){for(;++r<i;)if(!e.contains(t[r]))return!1}else for(e=n.getAttribute("class");++r<i;)if(!rt(t[r]).test(e))return!1;return!0}for(e in t)this.each(at(e,t[e]));return this}return this.each(at(t,e))},$.style=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=""),t)this.each(lt(n,t[n],e));return this}if(i<2){var r=this.node();return h(r).getComputedStyle(r,null).getPropertyValue(t)}n=""}return this.each(lt(t,e,n))},$.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(ct(e,t[e]));return this}return this.each(ct(t,e))},$.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},$.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},$.append=function(t){return t=ht(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},$.insert=function(t,e){return t=ht(t),e=J(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},$.remove=function(){return this.each(ut)},$.data=function(t,e){var n,i,r=-1,s=this.length;if(!arguments.length){for(t=new Array(s=(n=this[0]).length);++r<s;)(i=n[r])&&(t[r]=i.__data__);return t}function a(t,n){var i,r,s,a=t.length,h=n.length,u=Math.min(a,h),d=new Array(h),_=new Array(h),f=new Array(a);if(e){var g,p=new M,m=new Array(a);for(i=-1;++i<a;)(r=t[i])&&(p.has(g=e.call(r,r.__data__,i))?f[i]=r:p.set(g,r),m[i]=g);for(i=-1;++i<h;)(r=p.get(g=e.call(n,s=n[i],i)))?!0!==r&&(d[i]=r,r.__data__=s):_[i]=dt(s),p.set(g,!0);for(i=-1;++i<a;)i in m&&!0!==p.get(m[i])&&(f[i]=t[i])}else{for(i=-1;++i<u;)r=t[i],s=n[i],r?(r.__data__=s,d[i]=r):_[i]=dt(s);for(;i<h;++i)_[i]=dt(n[i]);for(;i<a;++i)f[i]=t[i]}_.update=d,_.parentNode=d.parentNode=f.parentNode=t.parentNode,o.push(_),l.push(d),c.push(f)}var o=gt([]),l=G([]),c=G([]);if("function"==typeof t)for(;++r<s;)a(n=this[r],t.call(n,n.parentNode.__data__,r));else for(;++r<s;)a(n=this[r],t);return l.enter=function(){return o},l.exit=function(){return c},l},$.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},$.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=_t(t));for(var s=0,a=this.length;s<a;s++){r.push(e=[]),e.parentNode=(n=this[s]).parentNode;for(var o=0,l=n.length;o<l;o++)(i=n[o])&&t.call(i,i.__data__,o,s)&&e.push(i)}return G(r)},$.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,i=this[t],r=i.length-1,s=i[r];--r>=0;)(n=i[r])&&(s&&s!==n.nextSibling&&s.parentNode.insertBefore(n,s),s=n);return this},$.sort=function(t){t=function(t){arguments.length||(t=p);return function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},$.each=function(t){return ft(this,function(e,n,i){t.call(e,e.__data__,n,i)})},$.call=function(t){var e=o(arguments);return t.apply(e[0]=this,e),this},$.empty=function(){return!this.node()},$.node=function(){for(var t=0,e=this.length;t<e;t++)for(var n=this[t],i=0,r=n.length;i<r;i++){var s=n[i];if(s)return s}return null},$.size=function(){var t=0;return ft(this,function(){++t}),t};var pt=[];function mt(t,e,n){var i="__on"+t,r=t.indexOf("."),a=bt;r>0&&(t=t.slice(0,r));var l=vt.get(t);function c(){var e=this[i];e&&(this.removeEventListener(t,e,e.$),delete this[i])}return l&&(t=l,a=yt),r?e?function(){var r=a(e,o(arguments));c.call(this),this.addEventListener(t,this[i]=r,r.$=n),r._=e}:c:e?R:function(){var e,n=new RegExp("^__on([^.]+)"+s.requote(t)+"$");for(var i in this)if(e=i.match(n)){var r=this[i];this.removeEventListener(e[1],r,r.$),delete this[i]}}}s.selection.enter=gt,s.selection.enter.prototype=pt,pt.append=$.append,pt.empty=$.empty,pt.node=$.node,pt.call=$.call,pt.size=$.size,pt.select=function(t){for(var e,n,i,r,s,a=[],o=-1,l=this.length;++o<l;){i=(r=this[o]).update,a.push(e=[]),e.parentNode=r.parentNode;for(var c=-1,h=r.length;++c<h;)(s=r[c])?(e.push(i[c]=n=t.call(r.parentNode,s.__data__,c,o)),n.__data__=s.__data__):e.push(null)}return G(a)},pt.insert=function(t,e){return arguments.length<2&&(e=function(t){var e,n;return function(i,r,s){var a,o=t[s].update,l=o.length;for(s!=n&&(n=s,e=0),r>=e&&(e=r+1);!(a=o[e])&&++e<l;);return a}}(this)),$.insert.call(this,t,e)},s.select=function(t){var e;return"string"==typeof t?(e=[Z(t,l)]).parentNode=l.documentElement:(e=[t]).parentNode=c(t),G([e])},s.selectAll=function(t){var e;return"string"==typeof t?(e=o(K(t,l))).parentNode=l.documentElement:(e=o(t)).parentNode=null,G([e])},$.on=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=!1),t)this.each(mt(n,t[n],e));return this}if(i<2)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each(mt(t,e,n))};var vt=s.map({mouseenter:"mouseover",mouseleave:"mouseout"});function bt(t,e){return function(n){var i=s.event;s.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{s.event=i}}}function yt(t,e){var n=bt(t,e);return function(t){var e=t.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||n.call(this,t)}}l&&vt.forEach(function(t){"on"+t in l&&vt.remove(t)});var xt,kt=0;function wt(t){var e=".dragsuppress-"+ ++kt,n="click"+e,i=s.select(h(t)).on("touchmove"+e,U).on("dragstart"+e,U).on("selectstart"+e,U);if(null==xt&&(xt=!("onselectstart"in t)&&P(t.style,"userSelect")),xt){var r=c(t).style,a=r[xt];r[xt]="none"}return function(t){if(i.on(e,null),xt&&(r[xt]=a),t){var s=function(){i.on(n,null)};i.on(n,function(){U(),s()},!0),setTimeout(s,0)}}}s.mouse=function(t){return At(t,H())};var Mt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function At(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();if(Mt<0){var r=h(t);if(r.scrollX||r.scrollY){var a=(n=s.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();Mt=!(a.f||a.e),n.remove()}}return Mt?(i.x=e.pageX,i.y=e.pageY):(i.x=e.clientX,i.y=e.clientY),[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}function qt(){return s.event.changedTouches[0].identifier}s.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=H().changedTouches),e)for(var i,r=0,s=e.length;r<s;++r)if((i=e[r]).identifier===n)return At(t,i)},s.behavior.drag=function(){var t=Y(r,"drag","dragstart","dragend"),e=null,n=a(R,s.mouse,h,"mousemove","mouseup"),i=a(qt,s.touch,j,"touchmove","touchend");function r(){this.on("mousedown.drag",n).on("touchstart.drag",i)}function a(n,i,r,a,o){return function(){var l,c=s.event.target.correspondingElement||s.event.target,h=this.parentNode,u=t.of(this,arguments),d=0,_=n(),f=".drag"+(null==_?"":"-"+_),g=s.select(r(c)).on(a+f,function(){var t,e,n=i(h,_);if(!n)return;t=n[0]-m[0],e=n[1]-m[1],d|=t|e,m=n,u({type:"drag",x:n[0]+l[0],y:n[1]+l[1],dx:t,dy:e})}).on(o+f,function(){if(!i(h,_))return;g.on(a+f,null).on(o+f,null),p(d),u({type:"dragend"})}),p=wt(c),m=i(h,_);l=e?[(l=e.apply(this,arguments)).x-m[0],l.y-m[1]]:[0,0],u({type:"dragstart"})}}return r.origin=function(t){return arguments.length?(e=t,r):e},s.rebind(r,t,"on")},s.touches=function(t,e){return arguments.length<2&&(e=H().touches),e?o(e).map(function(e){var n=At(t,e);return n.identifier=e.identifier,n}):[]};var zt=1e-6,Et=zt*zt,St=Math.PI,Tt=2*St,Lt=Tt-zt,Nt=St/2,Ot=St/180,Ct=180/St;function jt(t){return t>0?1:t<0?-1:0}function Bt(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function Pt(t){return t>1?0:t<-1?St:Math.acos(t)}function Dt(t){return t>1?Nt:t<-1?-Nt:Math.asin(t)}function Rt(t){return((t=Math.exp(t))+1/t)/2}function Ft(t){return(t=Math.sin(t/2))*t}var It=Math.SQRT2;s.interpolateZoom=function(t,e){var n,i,r=t[0],s=t[1],a=t[2],o=e[0],l=e[1],c=e[2],h=o-r,u=l-s,d=h*h+u*u;if(d<Et)i=Math.log(c/a)/It,n=function(t){return[r+t*h,s+t*u,a*Math.exp(It*t*i)]};else{var _=Math.sqrt(d),f=(c*c-a*a+4*d)/(2*a*2*_),g=(c*c-a*a-4*d)/(2*c*2*_),p=Math.log(Math.sqrt(f*f+1)-f),m=Math.log(Math.sqrt(g*g+1)-g);i=(m-p)/It,n=function(t){var e=t*i,n=Rt(p),o=a/(2*_)*(n*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(It*e+p)-function(t){return((t=Math.exp(t))-1/t)/2}(p));return[r+o*h,s+o*u,a*n/Rt(It*e+p)]}}return n.duration=1e3*i,n},s.behavior.zoom=function(){var t,e,n,i,r,a,o,c,u,d={x:0,y:0,k:1},_=[960,500],f=Yt,g=250,p=0,m="mousedown.zoom",v="mousemove.zoom",b="mouseup.zoom",y="touchstart.zoom",x=Y(k,"zoomstart","zoom","zoomend");function k(t){t.on(m,L).on(Ht+".zoom",O).on("dblclick.zoom",C).on(y,N)}function w(t){return[(t[0]-d.x)/d.k,(t[1]-d.y)/d.k]}function M(t){d.k=Math.max(f[0],Math.min(f[1],t))}function A(t,e){e=function(t){return[t[0]*d.k+d.x,t[1]*d.k+d.y]}(e),d.x+=t[0]-e[0],d.y+=t[1]-e[1]}function q(t,n,i,r){t.__chart__={x:d.x,y:d.y,k:d.k},M(Math.pow(2,r)),A(e=n,i),t=s.select(t),g>0&&(t=t.transition().duration(g)),t.call(k.event)}function z(){o&&o.domain(a.range().map(function(t){return(t-d.x)/d.k}).map(a.invert)),u&&u.domain(c.range().map(function(t){return(t-d.y)/d.k}).map(c.invert))}function E(t){p++||t({type:"zoomstart"})}function S(t){z(),t({type:"zoom",scale:d.k,translate:[d.x,d.y]})}function T(t){--p||(t({type:"zoomend"}),e=null)}function L(){var t=this,e=x.of(t,arguments),n=0,i=s.select(h(t)).on(v,function(){n=1,A(s.mouse(t),r),S(e)}).on(b,function(){i.on(v,null).on(b,null),a(n),T(e)}),r=w(s.mouse(t)),a=wt(t);_o.call(t),E(e)}function N(){var t,e=this,n=x.of(e,arguments),i={},a=0,o=".zoom-"+s.event.changedTouches[0].identifier,l="touchmove"+o,c="touchend"+o,h=[],u=s.select(e),_=wt(e);function f(){var n=s.touches(e);return t=d.k,n.forEach(function(t){t.identifier in i&&(i[t.identifier]=w(t))}),n}function g(){var t=s.event.target;s.select(t).on(l,p).on(c,v),h.push(t);for(var n=s.event.changedTouches,o=0,u=n.length;o<u;++o)i[n[o].identifier]=null;var _=f(),g=Date.now();if(1===_.length){if(g-r<500){var m=_[0];q(e,m,i[m.identifier],Math.floor(Math.log(d.k)/Math.LN2)+1),U()}r=g}else if(_.length>1){m=_[0];var b=_[1],y=m[0]-b[0],x=m[1]-b[1];a=y*y+x*x}}function p(){var o,l,c,h,u=s.touches(e);_o.call(e);for(var d=0,_=u.length;d<_;++d,h=null)if(c=u[d],h=i[c.identifier]){if(l)break;o=c,l=h}if(h){var f=(f=c[0]-o[0])*f+(f=c[1]-o[1])*f,g=a&&Math.sqrt(f/a);o=[(o[0]+c[0])/2,(o[1]+c[1])/2],l=[(l[0]+h[0])/2,(l[1]+h[1])/2],M(g*t)}r=null,A(o,l),S(n)}function v(){if(s.event.touches.length){for(var t=s.event.changedTouches,e=0,r=t.length;e<r;++e)delete i[t[e].identifier];for(var a in i)return void f()}s.selectAll(h).on(o,null),u.on(m,L).on(y,N),_(),T(n)}g(),E(n),u.on(m,null).on(y,g)}function O(){var r=x.of(this,arguments);i?clearTimeout(i):(_o.call(this),t=w(e=n||s.mouse(this)),E(r)),i=setTimeout(function(){i=null,T(r)},50),U(),M(Math.pow(2,.002*Ut())*d.k),A(e,t),S(r)}function C(){var t=s.mouse(this),e=Math.log(d.k)/Math.LN2;q(this,t,w(t),s.event.shiftKey?Math.ceil(e)-1:Math.floor(e)+1)}return Ht||(Ht="onwheel"in l?(Ut=function(){return-s.event.deltaY*(s.event.deltaMode?120:1)},"wheel"):"onmousewheel"in l?(Ut=function(){return s.event.wheelDelta},"mousewheel"):(Ut=function(){return-s.event.detail},"MozMousePixelScroll")),k.event=function(t){t.each(function(){var t=x.of(this,arguments),n=d;po?s.select(this).transition().each("start.zoom",function(){d=this.__chart__||{x:0,y:0,k:1},E(t)}).tween("zoom:zoom",function(){var i=_[0],r=_[1],a=e?e[0]:i/2,o=e?e[1]:r/2,l=s.interpolateZoom([(a-d.x)/d.k,(o-d.y)/d.k,i/d.k],[(a-n.x)/n.k,(o-n.y)/n.k,i/n.k]);return function(e){var n=l(e),r=i/n[2];this.__chart__=d={x:a-n[0]*r,y:o-n[1]*r,k:r},S(t)}}).each("interrupt.zoom",function(){T(t)}).each("end.zoom",function(){T(t)}):(this.__chart__=d,E(t),S(t),T(t))})},k.translate=function(t){return arguments.length?(d={x:+t[0],y:+t[1],k:d.k},z(),k):[d.x,d.y]},k.scale=function(t){return arguments.length?(d={x:d.x,y:d.y,k:null},M(+t),z(),k):d.k},k.scaleExtent=function(t){return arguments.length?(f=null==t?Yt:[+t[0],+t[1]],k):f},k.center=function(t){return arguments.length?(n=t&&[+t[0],+t[1]],k):n},k.size=function(t){return arguments.length?(_=t&&[+t[0],+t[1]],k):_},k.duration=function(t){return arguments.length?(g=+t,k):g},k.x=function(t){return arguments.length?(o=t,a=t.copy(),d={x:0,y:0,k:1},k):o},k.y=function(t){return arguments.length?(u=t,c=t.copy(),d={x:0,y:0,k:1},k):u},s.rebind(k,x,"on")};var Ut,Ht,Yt=[0,1/0];function Vt(){}function Wt(t,e,n){return this instanceof Wt?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof Wt?new Wt(t.h,t.s,t.l):fe(""+t,ge,Wt):new Wt(t,e,n)}s.color=Vt,Vt.prototype.toString=function(){return this.rgb()+""},s.hsl=Wt;var Gt=Wt.prototype=new Vt;function Zt(t,e,n){var i,r;function s(t){return Math.round(255*function(t){return t>360?t-=360:t<0&&(t+=360),t<60?i+(r-i)*t/60:t<180?r:t<240?i+(r-i)*(240-t)/60:i}(t))}return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:e<0?0:e>1?1:e,i=2*(n=n<0?0:n>1?1:n)-(r=n<=.5?n*(1+e):n+e-n*e),new ce(s(t+120),s(t),s(t-120))}function Kt(t,e,n){return this instanceof Kt?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof Kt?new Kt(t.h,t.c,t.l):se(t instanceof Jt?t.l:(t=pe((t=s.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new Kt(t,e,n)}Gt.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new Wt(this.h,this.s,this.l/t)},Gt.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new Wt(this.h,this.s,t*this.l)},Gt.rgb=function(){return Zt(this.h,this.s,this.l)},s.hcl=Kt;var Xt=Kt.prototype=new Vt;function $t(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new Jt(n,Math.cos(t*=Ot)*e,Math.sin(t)*e)}function Jt(t,e,n){return this instanceof Jt?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof Jt?new Jt(t.l,t.a,t.b):t instanceof Kt?$t(t.h,t.c,t.l):pe((t=ce(t)).r,t.g,t.b):new Jt(t,e,n)}Xt.brighter=function(t){return new Kt(this.h,this.c,Math.min(100,this.l+Qt*(arguments.length?t:1)))},Xt.darker=function(t){return new Kt(this.h,this.c,Math.max(0,this.l-Qt*(arguments.length?t:1)))},Xt.rgb=function(){return $t(this.h,this.c,this.l).rgb()},s.lab=Jt;var Qt=18,te=.95047,ee=1,ne=1.08883,ie=Jt.prototype=new Vt;function re(t,e,n){var i=(t+16)/116,r=i+e/500,s=i-n/200;return new ce(le(3.2404542*(r=ae(r)*te)-1.5371385*(i=ae(i)*ee)-.4985314*(s=ae(s)*ne)),le(-.969266*r+1.8760108*i+.041556*s),le(.0556434*r-.2040259*i+1.0572252*s))}function se(t,e,n){return t>0?new Kt(Math.atan2(n,e)*Ct,Math.sqrt(e*e+n*n),t):new Kt(NaN,NaN,t)}function ae(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function oe(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function le(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function ce(t,e,n){return this instanceof ce?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof ce?new ce(t.r,t.g,t.b):fe(""+t,ce,Zt):new ce(t,e,n)}function he(t){return new ce(t>>16,t>>8&255,255&t)}function ue(t){return he(t)+""}ie.brighter=function(t){return new Jt(Math.min(100,this.l+Qt*(arguments.length?t:1)),this.a,this.b)},ie.darker=function(t){return new Jt(Math.max(0,this.l-Qt*(arguments.length?t:1)),this.a,this.b)},ie.rgb=function(){return re(this.l,this.a,this.b)},s.rgb=ce;var de=ce.prototype=new Vt;function _e(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function fe(t,e,n){var i,r,s,a=0,o=0,l=0;if(i=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(ve(r[0]),ve(r[1]),ve(r[2]))}return(s=be.get(t))?e(s.r,s.g,s.b):(null==t||"#"!==t.charAt(0)||isNaN(s=parseInt(t.slice(1),16))||(4===t.length?(a=(3840&s)>>4,a|=a>>4,o=240&s,o|=o>>4,l=15&s,l|=l<<4):7===t.length&&(a=(16711680&s)>>16,o=(65280&s)>>8,l=255&s)),e(a,o,l))}function ge(t,e,n){var i,r,s=Math.min(t/=255,e/=255,n/=255),a=Math.max(t,e,n),o=a-s,l=(a+s)/2;return o?(r=l<.5?o/(a+s):o/(2-a-s),i=t==a?(e-n)/o+(e<n?6:0):e==a?(n-t)/o+2:(t-e)/o+4,i*=60):(i=NaN,r=l>0&&l<1?0:i),new Wt(i,r,l)}function pe(t,e,n){var i=oe((.4124564*(t=me(t))+.3575761*(e=me(e))+.1804375*(n=me(n)))/te),r=oe((.2126729*t+.7151522*e+.072175*n)/ee);return Jt(116*r-16,500*(i-r),200*(r-oe((.0193339*t+.119192*e+.9503041*n)/ne)))}function me(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ve(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}de.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,r=30;return e||n||i?(e&&e<r&&(e=r),n&&n<r&&(n=r),i&&i<r&&(i=r),new ce(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,i/t))):new ce(r,r,r)},de.darker=function(t){return new ce((t=Math.pow(.7,arguments.length?t:1))*this.r,t*this.g,t*this.b)},de.hsl=function(){return ge(this.r,this.g,this.b)},de.toString=function(){return"#"+_e(this.r)+_e(this.g)+_e(this.b)};var be=s.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function ye(t){return"function"==typeof t?t:function(){return t}}function xe(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),ke(e,n,t,i)}}function ke(t,e,n,i){var r={},a=s.dispatch("beforesend","progress","load","error"),l={},c=new XMLHttpRequest,h=null;function u(){var t,e=c.status;if(!e&&function(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}(c)||e>=200&&e<300||304===e){try{t=n.call(r,c)}catch(t){return void a.error.call(r,t)}a.load.call(r,t)}else a.error.call(r,c)}return!this.XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(t)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=u:c.onreadystatechange=function(){c.readyState>3&&u()},c.onprogress=function(t){var e=s.event;s.event=t;try{a.progress.call(r,c)}finally{s.event=e}},r.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?l[t]:(null==e?delete l[t]:l[t]=e+"",r)},r.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",r):e},r.responseType=function(t){return arguments.length?(h=t,r):h},r.response=function(t){return n=t,r},["get","post"].forEach(function(t){r[t]=function(){return r.send.apply(r,[t].concat(o(arguments)))}}),r.send=function(n,i,s){if(2===arguments.length&&"function"==typeof i&&(s=i,i=null),c.open(n,t,!0),null==e||"accept"in l||(l.accept=e+",*/*"),c.setRequestHeader)for(var o in l)c.setRequestHeader(o,l[o]);return null!=e&&c.overrideMimeType&&c.overrideMimeType(e),null!=h&&(c.responseType=h),null!=s&&r.on("error",s).on("load",function(t){s(null,t)}),a.beforesend.call(r,c),c.send(null==i?null:i),r},r.abort=function(){return c.abort(),r},s.rebind(r,a,"on"),null==i?r:r.get(function(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}(i))}be.forEach(function(t,e){be.set(t,he(e))}),s.functor=ye,s.xhr=xe(j),s.dsv=function(t,e){var n=new RegExp('["'+t+"\n]"),i=t.charCodeAt(0);function r(t,n,i){arguments.length<3&&(i=n,n=null);var r=ke(t,e,null==n?s:a(n),i);return r.row=function(t){return arguments.length?r.response(null==(n=t)?s:a(t)):n},r}function s(t){return r.parse(t.responseText)}function a(t){return function(e){return r.parse(e.responseText,t)}}function o(e){return e.map(l).join(t)}function l(t){return n.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}return r.parse=function(t,e){var n;return r.parseRows(t,function(t,i){if(n)return n(t,i-1);var r=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");n=e?function(t,n){return e(r(t),n)}:r})},r.parseRows=function(t,e){var n,r,s={},a={},o=[],l=t.length,c=0,h=0;function u(){if(c>=l)return a;if(r)return r=!1,s;var e=c;if(34===t.charCodeAt(e)){for(var n=e;n++<l;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}return c=n+2,13===(o=t.charCodeAt(n+1))?(r=!0,10===t.charCodeAt(n+2)&&++c):10===o&&(r=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;c<l;){var o,h=1;if(10===(o=t.charCodeAt(c++)))r=!0;else if(13===o)r=!0,10===t.charCodeAt(c)&&(++c,++h);else if(o!==i)continue;return t.slice(e,c-h)}return t.slice(e)}for(;(n=u())!==a;){for(var d=[];n!==s&&n!==a;)d.push(n),n=u();e&&null==(d=e(d,h++))||o.push(d)}return o},r.format=function(e){if(Array.isArray(e[0]))return r.formatRows(e);var n=new C,i=[];return e.forEach(function(t){for(var e in t)n.has(e)||i.push(n.add(e))}),[i.map(l).join(t)].concat(e.map(function(e){return i.map(function(t){return l(e[t])}).join(t)})).join("\n")},r.formatRows=function(t){return t.map(o).join("\n")},r},s.csv=s.dsv(",","text/csv"),s.tsv=s.dsv("\t","text/tab-separated-values");var we,Me,Ae,qe,ze=this[P(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};function Ee(t,e,n){var i=arguments.length;i<2&&(e=0),i<3&&(n=Date.now());var r={c:t,t:n+e,n:null};return Me?Me.n=r:we=r,Me=r,Ae||(qe=clearTimeout(qe),Ae=1,ze(Se)),r}function Se(){var t=Te(),e=Le()-t;e>24?(isFinite(e)&&(clearTimeout(qe),qe=setTimeout(Se,e)),Ae=0):(Ae=1,ze(Se))}function Te(){for(var t=Date.now(),e=we;e;)t>=e.t&&e.c(t-e.t)&&(e.c=null),e=e.n;return t}function Le(){for(var t,e=we,n=1/0;e;)e.c?(e.t<n&&(n=e.t),e=(t=e).n):e=t?t.n=e.n:we=e.n;return Me=t,n}function Ne(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}s.timer=function(){Ee.apply(this,arguments)},s.timer.flush=function(){Te(),Le()},s.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var Oe=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(function(t,e){var n=Math.pow(10,3*k(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}});s.formatPrefix=function(t,e){var n=0;return(t=+t)&&(t<0&&(t*=-1),e&&(t=s.round(t,Ne(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),Oe[8+n/3]};var Ce=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,je=s.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=s.round(t,Ne(t,e))).toFixed(Math.max(0,Math.min(20,Ne(t*(1+1e-15),e))))}});function Be(t){return t+""}var Pe=s.time={},De=Date;function Re(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}Re.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Fe.setUTCDate.apply(this._,arguments)},setDay:function(){Fe.setUTCDay.apply(this._,arguments)},setFullYear:function(){Fe.setUTCFullYear.apply(this._,arguments)},setHours:function(){Fe.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Fe.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Fe.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Fe.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Fe.setUTCSeconds.apply(this._,arguments)},setTime:function(){Fe.setTime.apply(this._,arguments)}};var Fe=Date.prototype;function Ie(t,e,n){function i(e){var n=t(e),i=s(n,1);return e-n<i-e?n:i}function r(n){return e(n=t(new De(n-1)),1),n}function s(t,n){return e(t=new De(+t),n),t}function a(t,i,s){var a=r(t),o=[];if(s>1)for(;a<i;)n(a)%s||o.push(new Date(+a)),e(a,1);else for(;a<i;)o.push(new Date(+a)),e(a,1);return o}t.floor=t,t.round=i,t.ceil=r,t.offset=s,t.range=a;var o=t.utc=Ue(t);return o.floor=o,o.round=Ue(i),o.ceil=Ue(r),o.offset=Ue(s),o.range=function(t,e,n){try{De=Re;var i=new Re;return i._=t,a(i,e,n)}finally{De=Date}},t}function Ue(t){return function(e,n){try{De=Re;var i=new Re;return i._=e,t(i,n)._}finally{De=Date}}}Pe.year=Ie(function(t){return(t=Pe.day(t)).setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),Pe.years=Pe.year.range,Pe.years.utc=Pe.year.utc.range,Pe.day=Ie(function(t){var e=new De(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),Pe.days=Pe.day.range,Pe.days.utc=Pe.day.utc.range,Pe.dayOfYear=function(t){var e=Pe.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var n=Pe[t]=Ie(function(t){return(t=Pe.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=Pe.year(t).getDay();return Math.floor((Pe.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});Pe[t+"s"]=n.range,Pe[t+"s"].utc=n.utc.range,Pe[t+"OfYear"]=function(t){var n=Pe.year(t).getDay();return Math.floor((Pe.dayOfYear(t)+(n+e)%7)/7)}}),Pe.week=Pe.sunday,Pe.weeks=Pe.sunday.range,Pe.weeks.utc=Pe.sunday.utc.range,Pe.weekOfYear=Pe.sundayOfYear;var He={"-":"",_:" ",0:"0"},Ye=/^\s*\d+/,Ve=/^%/;function We(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(e)+r:r)}function Ge(t){return new RegExp("^(?:"+t.map(s.requote).join("|")+")","i")}function Ze(t){for(var e=new M,n=-1,i=t.length;++n<i;)e.set(t[n].toLowerCase(),n);return e}function Ke(t,e,n){Ye.lastIndex=0;var i=Ye.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Xe(t,e,n){Ye.lastIndex=0;var i=Ye.exec(e.slice(n));return i?(t.U=+i[0],n+i[0].length):-1}function $e(t,e,n){Ye.lastIndex=0;var i=Ye.exec(e.slice(n));return i?(t.W=+i[0],n+i[0].length):-1}function Je(t,e,n){Ye.lastIndex=0;var i=Ye.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Qe(t,e,n){Ye.lastIndex=0;var i=Ye.exec(e.slice(n,n+2));return i?(t.y=function(t){return t+(t>68?1900:2e3)}(+i[0]),n+i[0].length):-1}function tn(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function en(t,e,n){Ye.lastIndex=0;var i=Ye.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function nn(t,e,n){Ye.lastIndex=0;var i=Ye.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function rn(t,e,n){Ye.lastIndex=0;var i=Ye.exec(e.slice(n,n+3));return i?(t.j=+i[0],n+i[0].length):-1}function sn(t,e,n){Ye.lastIndex=0;var i=Ye.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function an(t,e,n){Ye.lastIndex=0;var i=Ye.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function on(t,e,n){Ye.lastIndex=0;var i=Ye.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function ln(t,e,n){Ye.lastIndex=0;var i=Ye.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function cn(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",i=k(e)/60|0,r=k(e)%60;return n+We(i,"0",2)+We(r,"0",2)}function hn(t,e,n){Ve.lastIndex=0;var i=Ve.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function un(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,i=t[n];!i[1](e);)i=t[++n];return i[0](e)}}s.locale=function(t){return{numberFormat:function(t){var e=t.decimal,n=t.thousands,i=t.grouping,r=t.currency,a=i&&n?function(t,e){for(var r=t.length,s=[],a=0,o=i[0],l=0;r>0&&o>0&&(l+o+1>e&&(o=Math.max(1,e-l)),s.push(t.substring(r-=o,r+o)),!((l+=o+1)>e));)o=i[a=(a+1)%i.length];return s.reverse().join(n)}:j;return function(t){var n=Ce.exec(t),i=n[1]||" ",o=n[2]||">",l=n[3]||"-",c=n[4]||"",h=n[5],u=+n[6],d=n[7],_=n[8],f=n[9],g=1,p="",m="",v=!1,b=!0;switch(_&&(_=+_.substring(1)),(h||"0"===i&&"="===o)&&(h=i="0",o="="),f){case"n":d=!0,f="g";break;case"%":g=100,m="%",f="f";break;case"p":g=100,m="%",f="r";break;case"b":case"o":case"x":case"X":"#"===c&&(p="0"+f.toLowerCase());case"c":b=!1;case"d":v=!0,_=0;break;case"s":g=-1,f="r"}"$"===c&&(p=r[0],m=r[1]),"r"!=f||_||(f="g"),null!=_&&("g"==f?_=Math.max(1,Math.min(21,_)):"e"!=f&&"f"!=f||(_=Math.max(0,Math.min(20,_)))),f=je.get(f)||Be;var y=h&&d;return function(t){var n=m;if(v&&t%1)return"";var r=t<0||0===t&&1/t<0?(t=-t,"-"):"-"===l?"":l;if(g<0){var c=s.formatPrefix(t,_);t=c.scale(t),n=c.symbol+m}else t*=g;var x,k,w=(t=f(t,_)).lastIndexOf(".");if(w<0){var M=b?t.lastIndexOf("e"):-1;M<0?(x=t,k=""):(x=t.substring(0,M),k=t.substring(M))}else x=t.substring(0,w),k=e+t.substring(w+1);!h&&d&&(x=a(x,1/0));var A=p.length+x.length+k.length+(y?0:r.length),q=A<u?new Array(A=u-A+1).join(i):"";return y&&(x=a(q+x,q.length?u-k.length:1/0)),r+=p,t=x+k,("<"===o?r+t+q:">"===o?q+r+t:"^"===o?q.substring(0,A>>=1)+r+t+q.substring(A):r+(y?t:q+t))+n}}}(t),timeFormat:function(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,a=t.days,o=t.shortDays,l=t.months,c=t.shortMonths;function h(t){var e=t.length;function n(n){for(var i,r,s,a=[],o=-1,l=0;++o<e;)37===t.charCodeAt(o)&&(a.push(t.slice(l,o)),null!=(r=He[i=t.charAt(++o)])&&(i=t.charAt(++o)),(s=x[i])&&(i=s(n,null==r?"e"===i?" ":"0":r)),a.push(i),l=o+1);return a.push(t.slice(l,o)),a.join("")}return n.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(u(n,t,e,0)!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var i=null!=n.Z&&De!==Re,r=new(i?Re:De);return"j"in n?r.setFullYear(n.y,0,n.j):"W"in n||"U"in n?("w"in n||(n.w="W"in n?1:0),r.setFullYear(n.y,0,1),r.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(r.getDay()+5)%7:n.w+7*n.U-(r.getDay()+6)%7)):r.setFullYear(n.y,n.m,n.d),r.setHours(n.H+(n.Z/100|0),n.M+n.Z%100,n.S,n.L),i?r._:r},n.toString=function(){return t},n}function u(t,e,n,i){for(var r,s,a,o=0,l=e.length,c=n.length;o<l;){if(i>=c)return-1;if(37===(r=e.charCodeAt(o++))){if(a=e.charAt(o++),!(s=k[a in He?e.charAt(o++):a])||(i=s(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}h.utc=function(t){var e=h(t);function n(t){try{var n=new(De=Re);return n._=t,e(n)}finally{De=Date}}return n.parse=function(t){try{De=Re;var n=e.parse(t);return n&&n._}finally{De=Date}},n.toString=e.toString,n},h.multi=h.utc.multi=un;var d=s.map(),_=Ge(a),f=Ze(a),g=Ge(o),p=Ze(o),m=Ge(l),v=Ze(l),b=Ge(c),y=Ze(c);r.forEach(function(t,e){d.set(t.toLowerCase(),e)});var x={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return l[t.getMonth()]},c:h(e),d:function(t,e){return We(t.getDate(),e,2)},e:function(t,e){return We(t.getDate(),e,2)},H:function(t,e){return We(t.getHours(),e,2)},I:function(t,e){return We(t.getHours()%12||12,e,2)},j:function(t,e){return We(1+Pe.dayOfYear(t),e,3)},L:function(t,e){return We(t.getMilliseconds(),e,3)},m:function(t,e){return We(t.getMonth()+1,e,2)},M:function(t,e){return We(t.getMinutes(),e,2)},p:function(t){return r[+(t.getHours()>=12)]},S:function(t,e){return We(t.getSeconds(),e,2)},U:function(t,e){return We(Pe.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return We(Pe.mondayOfYear(t),e,2)},x:h(n),X:h(i),y:function(t,e){return We(t.getFullYear()%100,e,2)},Y:function(t,e){return We(t.getFullYear()%1e4,e,4)},Z:cn,"%":function(){return"%"}},k={a:function(t,e,n){g.lastIndex=0;var i=g.exec(e.slice(n));return i?(t.w=p.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(t,e,n){_.lastIndex=0;var i=_.exec(e.slice(n));return i?(t.w=f.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(t,e,n){b.lastIndex=0;var i=b.exec(e.slice(n));return i?(t.m=y.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(t,e,n){m.lastIndex=0;var i=m.exec(e.slice(n));return i?(t.m=v.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(t,e,n){return u(t,x.c.toString(),e,n)},d:nn,e:nn,H:sn,I:sn,j:rn,L:ln,m:en,M:an,p:function(t,e,n){var i=d.get(e.slice(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)},S:on,U:Xe,w:Ke,W:$e,x:function(t,e,n){return u(t,x.x.toString(),e,n)},X:function(t,e,n){return u(t,x.X.toString(),e,n)},y:Qe,Y:Je,Z:tn,"%":hn};return h}(t)}};var dn=s.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function _n(){}s.format=dn.numberFormat,s.geo={},_n.prototype={s:0,t:0,add:function(t){gn(t,this.t,fn),gn(fn.s,this.s,this),this.s?this.t+=fn.t:this.s=fn.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var fn=new _n;function gn(t,e,n){var i=n.s=t+e,r=i-t,s=i-r;n.t=t-s+(e-r)}function pn(t,e){t&&vn.hasOwnProperty(t.type)&&vn[t.type](t,e)}s.geo.stream=function(t,e){t&&mn.hasOwnProperty(t.type)?mn[t.type](t,e):pn(t,e)};var mn={Feature:function(t,e){pn(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)pn(n[i].geometry,e)}},vn={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){bn(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)bn(n[i],e,0)},Polygon:function(t,e){yn(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)yn(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)pn(n[i],e)}};function bn(t,e,n){var i,r=-1,s=t.length-n;for(e.lineStart();++r<s;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function yn(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)bn(t[n],e,1);e.polygonEnd()}s.geo.area=function(t){return xn=0,s.geo.stream(t,Cn),xn};var xn,kn,wn,Mn,An,qn,zn,En,Sn,Tn,Ln,Nn,On=new _n,Cn={sphere:function(){xn+=4*St},point:R,lineStart:R,lineEnd:R,polygonStart:function(){On.reset(),Cn.lineStart=jn},polygonEnd:function(){var t=2*On;xn+=t<0?4*St+t:t,Cn.lineStart=Cn.lineEnd=Cn.point=R}};function jn(){var t,e,n,i,r;function s(t,e){e=e*Ot/2+St/4;var s=(t*=Ot)-n,a=s>=0?1:-1,o=a*s,l=Math.cos(e),c=Math.sin(e),h=r*c,u=i*l+h*Math.cos(o),d=h*a*Math.sin(o);On.add(Math.atan2(d,u)),n=t,i=l,r=c}Cn.point=function(a,o){Cn.point=s,n=(t=a)*Ot,i=Math.cos(o=(e=o)*Ot/2+St/4),r=Math.sin(o)},Cn.lineEnd=function(){s(t,e)}}function Bn(t){var e=t[0],n=t[1],i=Math.cos(n);return[i*Math.cos(e),i*Math.sin(e),Math.sin(n)]}function Pn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Dn(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Rn(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Fn(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function In(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Un(t){return[Math.atan2(t[1],t[0]),Dt(t[2])]}function Hn(t,e){return k(t[0]-e[0])<zt&&k(t[1]-e[1])<zt}s.geo.bounds=function(){var t,e,n,i,r,a,o,l,c,h,u,d={point:_,lineStart:g,lineEnd:p,polygonStart:function(){d.point=m,d.lineStart=v,d.lineEnd=b,c=0,Cn.polygonStart()},polygonEnd:function(){Cn.polygonEnd(),d.point=_,d.lineStart=g,d.lineEnd=p,On<0?(t=-(n=180),e=-(i=90)):c>zt?i=90:c<-zt&&(e=-90),u[0]=t,u[1]=n}};function _(r,s){h.push(u=[t=r,n=r]),s<e&&(e=s),s>i&&(i=s)}function f(s,a){var o=Bn([s*Ot,a*Ot]);if(l){var c=Dn(l,o),h=Dn([c[1],-c[0],0],c);In(h),h=Un(h);var u=s-r,d=u>0?1:-1,f=h[0]*Ct*d,g=k(u)>180;if(g^(d*r<f&&f<d*s))(p=h[1]*Ct)>i&&(i=p);else if(g^(d*r<(f=(f+360)%360-180)&&f<d*s)){var p;(p=-h[1]*Ct)<e&&(e=p)}else a<e&&(e=a),a>i&&(i=a);g?s<r?y(t,s)>y(t,n)&&(n=s):y(s,n)>y(t,n)&&(t=s):n>=t?(s<t&&(t=s),s>n&&(n=s)):s>r?y(t,s)>y(t,n)&&(n=s):y(s,n)>y(t,n)&&(t=s)}else _(s,a);l=o,r=s}function g(){d.point=f}function p(){u[0]=t,u[1]=n,d.point=_,l=null}function m(t,e){if(l){var n=t-r;c+=k(n)>180?n+(n>0?360:-360):n}else a=t,o=e;Cn.point(t,e),f(t,e)}function v(){Cn.lineStart()}function b(){m(a,o),Cn.lineEnd(),k(c)>zt&&(t=-(n=180)),u[0]=t,u[1]=n,l=null}function y(t,e){return(e-=t)<0?e+360:e}function x(t,e){return t[0]-e[0]}function w(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}return function(r){if(i=n=-(t=e=1/0),h=[],s.geo.stream(r,d),c=h.length){h.sort(x);for(var a=1,o=[g=h[0]];a<c;++a)w((_=h[a])[0],g)||w(_[1],g)?(y(g[0],_[1])>y(g[0],g[1])&&(g[1]=_[1]),y(_[0],g[1])>y(g[0],g[1])&&(g[0]=_[0])):o.push(g=_);for(var l,c,_,f=-1/0,g=(a=0,o[c=o.length-1]);a<=c;g=_,++a)_=o[a],(l=y(g[1],_[0]))>f&&(f=l,t=_[0],n=g[1])}return h=u=null,t===1/0||e===1/0?[[NaN,NaN],[NaN,NaN]]:[[t,e],[n,i]]}}(),s.geo.centroid=function(t){kn=wn=Mn=An=qn=zn=En=Sn=Tn=Ln=Nn=0,s.geo.stream(t,Yn);var e=Tn,n=Ln,i=Nn,r=e*e+n*n+i*i;return r<Et&&(e=zn,n=En,i=Sn,wn<zt&&(e=Mn,n=An,i=qn),(r=e*e+n*n+i*i)<Et)?[NaN,NaN]:[Math.atan2(n,e)*Ct,Dt(i/Math.sqrt(r))*Ct]};var Yn={sphere:R,point:Vn,lineStart:Gn,lineEnd:Zn,polygonStart:function(){Yn.lineStart=Kn},polygonEnd:function(){Yn.lineStart=Gn}};function Vn(t,e){t*=Ot;var n=Math.cos(e*=Ot);Wn(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function Wn(t,e,n){Mn+=(t-Mn)/++kn,An+=(e-An)/kn,qn+=(n-qn)/kn}function Gn(){var t,e,n;function i(i,r){i*=Ot;var s=Math.cos(r*=Ot),a=s*Math.cos(i),o=s*Math.sin(i),l=Math.sin(r),c=Math.atan2(Math.sqrt((c=e*l-n*o)*c+(c=n*a-t*l)*c+(c=t*o-e*a)*c),t*a+e*o+n*l);wn+=c,zn+=c*(t+(t=a)),En+=c*(e+(e=o)),Sn+=c*(n+(n=l)),Wn(t,e,n)}Yn.point=function(r,s){r*=Ot;var a=Math.cos(s*=Ot);t=a*Math.cos(r),e=a*Math.sin(r),n=Math.sin(s),Yn.point=i,Wn(t,e,n)}}function Zn(){Yn.point=Vn}function Kn(){var t,e,n,i,r;function s(t,e){t*=Ot;var s=Math.cos(e*=Ot),a=s*Math.cos(t),o=s*Math.sin(t),l=Math.sin(e),c=i*l-r*o,h=r*a-n*l,u=n*o-i*a,d=Math.sqrt(c*c+h*h+u*u),_=n*a+i*o+r*l,f=d&&-Pt(_)/d,g=Math.atan2(d,_);Tn+=f*c,Ln+=f*h,Nn+=f*u,wn+=g,zn+=g*(n+(n=a)),En+=g*(i+(i=o)),Sn+=g*(r+(r=l)),Wn(n,i,r)}Yn.point=function(a,o){t=a,e=o,Yn.point=s,a*=Ot;var l=Math.cos(o*=Ot);n=l*Math.cos(a),i=l*Math.sin(a),r=Math.sin(o),Wn(n,i,r)},Yn.lineEnd=function(){s(t,e),Yn.lineEnd=Zn,Yn.point=Vn}}function Xn(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n}function $n(){return!0}function Jn(t,e,n,i,r){var s=[],a=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],i=t[e];if(Hn(n,i)){r.lineStart();for(var o=0;o<e;++o)r.point((n=t[o])[0],n[1]);r.lineEnd()}else{var l=new ti(n,t,null,!0),c=new ti(n,null,l,!1);l.o=c,s.push(l),a.push(c),c=new ti(i,null,l=new ti(i,t,null,!1),!0),l.o=c,s.push(l),a.push(c)}}}),a.sort(e),Qn(s),Qn(a),s.length){for(var o=0,l=n,c=a.length;o<c;++o)a[o].e=l=!l;for(var h,u,d=s[0];;){for(var _=d,f=!0;_.v;)if((_=_.n)===d)return;h=_.z,r.lineStart();do{if(_.v=_.o.v=!0,_.e){if(f)for(o=0,c=h.length;o<c;++o)r.point((u=h[o])[0],u[1]);else i(_.x,_.n.x,1,r);_=_.n}else{if(f)for(o=(h=_.p.z).length-1;o>=0;--o)r.point((u=h[o])[0],u[1]);else i(_.x,_.p.x,-1,r);_=_.p}h=(_=_.o).z,f=!f}while(!_.v);r.lineEnd()}}}function Qn(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function ti(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function ei(t,e,n,i){return function(r,a){var o,l=e(a),c=r.invert(i[0],i[1]),h={point:u,lineStart:_,lineEnd:f,polygonStart:function(){h.point=y,h.lineStart=x,h.lineEnd=k,o=[],g=[]},polygonEnd:function(){h.point=u,h.lineStart=_,h.lineEnd=f,o=s.merge(o);var t=function(t,e){var n=t[0],i=t[1],r=[Math.sin(n),-Math.cos(n),0],s=0,a=0;On.reset();for(var o=0,l=e.length;o<l;++o){var c=e[o],h=c.length;if(h)for(var u=c[0],d=u[0],_=u[1]/2+St/4,f=Math.sin(_),g=Math.cos(_),p=1;;){p===h&&(p=0);var m=(t=c[p])[0],v=t[1]/2+St/4,b=Math.sin(v),y=Math.cos(v),x=m-d,k=x>=0?1:-1,w=k*x,M=w>St,A=f*b;if(On.add(Math.atan2(A*k*Math.sin(w),g*y+A*Math.cos(w))),s+=M?x+k*Tt:x,M^d>=n^m>=n){var q=Dn(Bn(u),Bn(t));In(q);var z=Dn(r,q);In(z);var E=(M^x>=0?-1:1)*Dt(z[2]);(i>E||i===E&&(q[0]||q[1]))&&(a+=M^x>=0?1:-1)}if(!p++)break;d=m,f=b,g=y,u=t}}return(s<-zt||s<zt&&On<-zt)^1&a}(c,g);o.length?(b||(a.polygonStart(),b=!0),Jn(o,ri,t,n,a)):t&&(b||(a.polygonStart(),b=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),b&&(a.polygonEnd(),b=!1),o=g=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function u(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&a.point(e,n)}function d(t,e){var n=r(t,e);l.point(n[0],n[1])}function _(){h.point=d,l.lineStart()}function f(){h.point=u,l.lineEnd()}var g,p,m=ii(),v=e(m),b=!1;function y(t,e){p.push([t,e]);var n=r(t,e);v.point(n[0],n[1])}function x(){v.lineStart(),p=[]}function k(){y(p[0][0],p[0][1]),v.lineEnd();var t,e=v.clean(),n=m.buffer(),i=n.length;if(p.pop(),g.push(p),p=null,i)if(1&e){var r,s=-1;if((i=(t=n[0]).length-1)>0){for(b||(a.polygonStart(),b=!0),a.lineStart();++s<i;)a.point((r=t[s])[0],r[1]);a.lineEnd()}}else i>1&&2&e&&n.push(n.pop().concat(n.shift())),o.push(n.filter(ni))}return h}}function ni(t){return t.length>1}function ii(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:R,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function ri(t,e){return((t=t.x)[0]<0?t[1]-Nt-zt:Nt-t[1])-((e=e.x)[0]<0?e[1]-Nt-zt:Nt-e[1])}var si=ei($n,function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(s,a){var o=s>0?St:-St,l=k(s-n);k(l-St)<zt?(t.point(n,i=(i+a)/2>0?Nt:-Nt),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(o,i),t.point(s,i),e=0):r!==o&&l>=St&&(k(n-r)<zt&&(n-=r*zt),k(s-o)<zt&&(s-=o*zt),i=function(t,e,n,i){var r,s,a=Math.sin(t-n);return k(a)>zt?Math.atan((Math.sin(e)*(s=Math.cos(i))*Math.sin(n)-Math.sin(i)*(r=Math.cos(e))*Math.sin(t))/(r*s*a)):(e+i)/2}(n,i,s,a),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(o,i),e=0),t.point(n=s,i=a),r=o},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}},function(t,e,n,i){var r;if(null==t)r=n*Nt,i.point(-St,r),i.point(0,r),i.point(St,r),i.point(St,0),i.point(St,-r),i.point(0,-r),i.point(-St,-r),i.point(-St,0),i.point(-St,r);else if(k(t[0]-e[0])>zt){var s=t[0]<e[0]?St:-St;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(e[0],e[1])},[-St,-St/2]);function ai(t,e,n,i){return function(r){var s,a=r.a,o=r.b,l=a.x,c=a.y,h=0,u=1,d=o.x-l,_=o.y-c;if(s=t-l,d||!(s>0)){if(s/=d,d<0){if(s<h)return;s<u&&(u=s)}else if(d>0){if(s>u)return;s>h&&(h=s)}if(s=n-l,d||!(s<0)){if(s/=d,d<0){if(s>u)return;s>h&&(h=s)}else if(d>0){if(s<h)return;s<u&&(u=s)}if(s=e-c,_||!(s>0)){if(s/=_,_<0){if(s<h)return;s<u&&(u=s)}else if(_>0){if(s>u)return;s>h&&(h=s)}if(s=i-c,_||!(s<0)){if(s/=_,_<0){if(s>u)return;s>h&&(h=s)}else if(_>0){if(s<h)return;s<u&&(u=s)}return h>0&&(r.a={x:l+h*d,y:c+h*_}),u<1&&(r.b={x:l+u*d,y:c+u*_}),r}}}}}}var oi=1e9;function li(t,e,n,i){return function(l){var c,h,u,d,_,f,g,p,m,v,b,y=l,x=ii(),k=ai(t,e,n,i),w={point:q,lineStart:function(){w.point=z,h&&h.push(u=[]);v=!0,m=!1,g=p=NaN},lineEnd:function(){c&&(z(d,_),f&&m&&x.rejoin(),c.push(x.buffer()));w.point=q,m&&l.lineEnd()},polygonStart:function(){l=x,c=[],h=[],b=!0},polygonEnd:function(){l=y,c=s.merge(c);var e=function(t){for(var e=0,n=h.length,i=t[1],r=0;r<n;++r)for(var s,a=1,o=h[r],l=o.length,c=o[0];a<l;++a)s=o[a],c[1]<=i?s[1]>i&&Bt(c,s,t)>0&&++e:s[1]<=i&&Bt(c,s,t)<0&&--e,c=s;return 0!==e}([t,i]),n=b&&e,r=c.length;(n||r)&&(l.polygonStart(),n&&(l.lineStart(),M(null,null,1,l),l.lineEnd()),r&&Jn(c,a,e,M,l),l.polygonEnd()),c=h=u=null}};function M(s,a,l,c){var h=0,u=0;if(null==s||(h=r(s,l))!==(u=r(a,l))||o(s,a)<0^l>0)do{c.point(0===h||3===h?t:n,h>1?i:e)}while((h=(h+l+4)%4)!==u);else c.point(a[0],a[1])}function A(r,s){return t<=r&&r<=n&&e<=s&&s<=i}function q(t,e){A(t,e)&&l.point(t,e)}function z(t,e){var n=A(t=Math.max(-oi,Math.min(oi,t)),e=Math.max(-oi,Math.min(oi,e)));if(h&&u.push([t,e]),v)d=t,_=e,f=n,v=!1,n&&(l.lineStart(),l.point(t,e));else if(n&&m)l.point(t,e);else{var i={a:{x:g,y:p},b:{x:t,y:e}};k(i)?(m||(l.lineStart(),l.point(i.a.x,i.a.y)),l.point(i.b.x,i.b.y),n||l.lineEnd(),b=!1):n&&(l.lineStart(),l.point(t,e),b=!1)}g=t,p=e,m=n}return w};function r(i,r){return k(i[0]-t)<zt?r>0?0:3:k(i[0]-n)<zt?r>0?2:1:k(i[1]-e)<zt?r>0?1:0:r>0?3:2}function a(t,e){return o(t.x,e.x)}function o(t,e){var n=r(t,1),i=r(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}}function ci(t){var e=0,n=St/3,i=Li(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*St/180,n=t[1]*St/180):[e/St*180,n/St*180]},r}function hi(t,e){var n=Math.sin(t),i=(n+Math.sin(e))/2,r=1+n*(2*i-n),s=Math.sqrt(r)/i;function a(t,e){var n=Math.sqrt(r-2*i*Math.sin(e))/i;return[n*Math.sin(t*=i),s-n*Math.cos(t)]}return a.invert=function(t,e){var n=s-e;return[Math.atan2(t,n)/i,Dt((r-(t*t+n*n)*i*i)/(2*i))]},a}s.geo.clipExtent=function(){var t,e,n,i,r,s,a={stream:function(t){return r&&(r.valid=!1),(r=s(t)).valid=!0,r},extent:function(o){return arguments.length?(s=li(t=+o[0][0],e=+o[0][1],n=+o[1][0],i=+o[1][1]),r&&(r.valid=!1,r=null),a):[[t,e],[n,i]]}};return a.extent([[0,0],[960,500]])},(s.geo.conicEqualArea=function(){return ci(hi)}).raw=hi,s.geo.albers=function(){return s.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},s.geo.albersUsa=function(){var t,e,n,i,r=s.geo.albers(),a=s.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o=s.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(e,n){t=[e,n]}};function c(r){var s=r[0],a=r[1];return t=null,e(s,a),t||(n(s,a),t)||i(s,a),t}return c.invert=function(t){var e=r.scale(),n=r.translate(),i=(t[0]-n[0])/e,s=(t[1]-n[1])/e;return(s>=.12&&s<.234&&i>=-.425&&i<-.214?a:s>=.166&&s<.234&&i>=-.214&&i<-.115?o:r).invert(t)},c.stream=function(t){var e=r.stream(t),n=a.stream(t),i=o.stream(t);return{point:function(t,r){e.point(t,r),n.point(t,r),i.point(t,r)},sphere:function(){e.sphere(),n.sphere(),i.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),i.polygonEnd()}}},c.precision=function(t){return arguments.length?(r.precision(t),a.precision(t),o.precision(t),c):r.precision()},c.scale=function(t){return arguments.length?(r.scale(t),a.scale(.35*t),o.scale(t),c.translate(r.translate())):r.scale()},c.translate=function(t){if(!arguments.length)return r.translate();var s=r.scale(),h=+t[0],u=+t[1];return e=r.translate(t).clipExtent([[h-.455*s,u-.238*s],[h+.455*s,u+.238*s]]).stream(l).point,n=a.translate([h-.307*s,u+.201*s]).clipExtent([[h-.425*s+zt,u+.12*s+zt],[h-.214*s-zt,u+.234*s-zt]]).stream(l).point,i=o.translate([h-.205*s,u+.212*s]).clipExtent([[h-.214*s+zt,u+.166*s+zt],[h-.115*s-zt,u+.234*s-zt]]).stream(l).point,c},c.scale(1070)};var ui,di,_i,fi,gi,pi,mi={point:R,lineStart:R,lineEnd:R,polygonStart:function(){di=0,mi.lineStart=vi},polygonEnd:function(){mi.lineStart=mi.lineEnd=mi.point=R,ui+=k(di/2)}};function vi(){var t,e,n,i;function r(t,e){di+=i*t-n*e,n=t,i=e}mi.point=function(s,a){mi.point=r,t=n=s,e=i=a},mi.lineEnd=function(){r(t,e)}}var bi={point:function(t,e){t<_i&&(_i=t);t>gi&&(gi=t);e<fi&&(fi=e);e>pi&&(pi=e)},lineStart:R,lineEnd:R,polygonStart:R,polygonEnd:R};function yi(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}var xi,ki={point:wi,lineStart:Mi,lineEnd:Ai,polygonStart:function(){ki.lineStart=qi},polygonEnd:function(){ki.point=wi,ki.lineStart=Mi,ki.lineEnd=Ai}};function wi(t,e){Mn+=t,An+=e,++qn}function Mi(){var t,e;function n(n,i){var r=n-t,s=i-e,a=Math.sqrt(r*r+s*s);zn+=a*(t+n)/2,En+=a*(e+i)/2,Sn+=a,wi(t=n,e=i)}ki.point=function(i,r){ki.point=n,wi(t=i,e=r)}}function Ai(){ki.point=wi}function qi(){var t,e,n,i;function r(t,e){var r=t-n,s=e-i,a=Math.sqrt(r*r+s*s);zn+=a*(n+t)/2,En+=a*(i+e)/2,Sn+=a,Tn+=(a=i*t-n*e)*(n+t),Ln+=a*(i+e),Nn+=3*a,wi(n=t,i=e)}ki.point=function(s,a){ki.point=r,wi(t=n=s,e=i=a)},ki.lineEnd=function(){r(t,e)}}function zi(t){var e=.5,n=Math.cos(30*Ot),i=16;function r(e){return(i?function(e){var n,r,a,o,l,c,h,u,d,_,f,g,p={point:m,lineStart:v,lineEnd:y,polygonStart:function(){e.polygonStart(),p.lineStart=x},polygonEnd:function(){e.polygonEnd(),p.lineStart=v}};function m(n,i){n=t(n,i),e.point(n[0],n[1])}function v(){u=NaN,p.point=b,e.lineStart()}function b(n,r){var a=Bn([n,r]),o=t(n,r);s(u,d,h,_,f,g,u=o[0],d=o[1],h=n,_=a[0],f=a[1],g=a[2],i,e),e.point(u,d)}function y(){p.point=m,e.lineEnd()}function x(){v(),p.point=k,p.lineEnd=w}function k(t,e){b(n=t,e),r=u,a=d,o=_,l=f,c=g,p.point=b}function w(){s(u,d,h,_,f,g,r,a,n,o,l,c,i,e),p.lineEnd=y,y()}return p}:function(e){return Si(e,function(n,i){n=t(n,i),e.point(n[0],n[1])})})(e)}function s(i,r,a,o,l,c,h,u,d,_,f,g,p,m){var v=h-i,b=u-r,y=v*v+b*b;if(y>4*e&&p--){var x=o+_,w=l+f,M=c+g,A=Math.sqrt(x*x+w*w+M*M),q=Math.asin(M/=A),z=k(k(M)-1)<zt||k(a-d)<zt?(a+d)/2:Math.atan2(w,x),E=t(z,q),S=E[0],T=E[1],L=S-i,N=T-r,O=b*L-v*N;(O*O/y>e||k((v*L+b*N)/y-.5)>.3||o*_+l*f+c*g<n)&&(s(i,r,a,o,l,c,S,T,z,x/=A,w/=A,M,p,m),m.point(S,T),s(S,T,z,x,w,M,h,u,d,_,f,g,p,m))}}return r.precision=function(t){return arguments.length?(i=(e=t*t)>0&&16,r):Math.sqrt(e)},r}function Ei(t){this.stream=t}function Si(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function Ti(t){return Li(function(){return t})()}function Li(t){var e,n,i,r,a,o,l=zi(function(t,n){return[(t=e(t,n))[0]*c+r,a-t[1]*c]}),c=150,h=480,u=250,d=0,_=0,f=0,g=0,p=0,m=si,v=j,b=null,y=null;function x(t){return[(t=i(t[0]*Ot,t[1]*Ot))[0]*c+r,a-t[1]*c]}function w(t){return(t=i.invert((t[0]-r)/c,(a-t[1])/c))&&[t[0]*Ct,t[1]*Ct]}function M(){i=Xn(n=ji(f,g,p),e);var t=e(d,_);return r=h-t[0]*c,a=u+t[1]*c,A()}function A(){return o&&(o.valid=!1,o=null),x}return x.stream=function(t){return o&&(o.valid=!1),(o=Ni(m(n,l(v(t))))).valid=!0,o},x.clipAngle=function(t){return arguments.length?(m=null==t?(b=t,si):function(t){var e=Math.cos(t),n=e>0,i=k(e)>zt;return ei(r,function(t){var e,o,l,c,h;return{lineStart:function(){c=l=!1,h=1},point:function(u,d){var _,f=[u,d],g=r(u,d),p=n?g?0:a(u,d):g?a(u+(u<0?St:-St),d):0;if(!e&&(c=l=g)&&t.lineStart(),g!==l&&(_=s(e,f),(Hn(e,_)||Hn(f,_))&&(f[0]+=zt,f[1]+=zt,g=r(f[0],f[1]))),g!==l)h=0,g?(t.lineStart(),_=s(f,e),t.point(_[0],_[1])):(_=s(e,f),t.point(_[0],_[1]),t.lineEnd()),e=_;else if(i&&e&&n^g){var m;p&o||!(m=s(f,e,!0))||(h=0,n?(t.lineStart(),t.point(m[0][0],m[0][1]),t.point(m[1][0],m[1][1]),t.lineEnd()):(t.point(m[1][0],m[1][1]),t.lineEnd(),t.lineStart(),t.point(m[0][0],m[0][1])))}!g||e&&Hn(e,f)||t.point(f[0],f[1]),e=f,l=g,o=p},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return h|(c&&l)<<1}}},Ri(t,6*Ot),n?[0,-t]:[-St,t-St]);function r(t,n){return Math.cos(t)*Math.cos(n)>e}function s(t,n,i){var r=[1,0,0],s=Dn(Bn(t),Bn(n)),a=Pn(s,s),o=s[0],l=a-o*o;if(!l)return!i&&t;var c=e*a/l,h=-e*o/l,u=Dn(r,s),d=Fn(r,c);Rn(d,Fn(s,h));var _=u,f=Pn(d,_),g=Pn(_,_),p=f*f-g*(Pn(d,d)-1);if(!(p<0)){var m=Math.sqrt(p),v=Fn(_,(-f-m)/g);if(Rn(v,d),v=Un(v),!i)return v;var b,y=t[0],x=n[0],w=t[1],M=n[1];x<y&&(b=y,y=x,x=b);var A=x-y,q=k(A-St)<zt;if(!q&&M<w&&(b=w,w=M,M=b),q||A<zt?q?w+M>0^v[1]<(k(v[0]-y)<zt?w:M):w<=v[1]&&v[1]<=M:A>St^(y<=v[0]&&v[0]<=x)){var z=Fn(_,(-f+m)/g);return Rn(z,d),[v,Un(z)]}}}function a(e,i){var r=n?t:St-t,s=0;return e<-r?s|=1:e>r&&(s|=2),i<-r?s|=4:i>r&&(s|=8),s}}((b=+t)*Ot),A()):b},x.clipExtent=function(t){return arguments.length?(y=t,v=t?li(t[0][0],t[0][1],t[1][0],t[1][1]):j,A()):y},x.scale=function(t){return arguments.length?(c=+t,M()):c},x.translate=function(t){return arguments.length?(h=+t[0],u=+t[1],M()):[h,u]},x.center=function(t){return arguments.length?(d=t[0]%360*Ot,_=t[1]%360*Ot,M()):[d*Ct,_*Ct]},x.rotate=function(t){return arguments.length?(f=t[0]%360*Ot,g=t[1]%360*Ot,p=t.length>2?t[2]%360*Ot:0,M()):[f*Ct,g*Ct,p*Ct]},s.rebind(x,l,"precision"),function(){return e=t.apply(this,arguments),x.invert=e.invert&&w,M()}}function Ni(t){return Si(t,function(e,n){t.point(e*Ot,n*Ot)})}function Oi(t,e){return[t,e]}function Ci(t,e){return[t>St?t-Tt:t<-St?t+Tt:t,e]}function ji(t,e,n){return t?e||n?Xn(Pi(t),Di(e,n)):Pi(t):e||n?Di(e,n):Ci}function Bi(t){return function(e,n){return[(e+=t)>St?e-Tt:e<-St?e+Tt:e,n]}}function Pi(t){var e=Bi(t);return e.invert=Bi(-t),e}function Di(t,e){var n=Math.cos(t),i=Math.sin(t),r=Math.cos(e),s=Math.sin(e);function a(t,e){var a=Math.cos(e),o=Math.cos(t)*a,l=Math.sin(t)*a,c=Math.sin(e),h=c*n+o*i;return[Math.atan2(l*r-h*s,o*n-c*i),Dt(h*r+l*s)]}return a.invert=function(t,e){var a=Math.cos(e),o=Math.cos(t)*a,l=Math.sin(t)*a,c=Math.sin(e),h=c*r-l*s;return[Math.atan2(l*r+c*s,o*n+h*i),Dt(h*n-o*i)]},a}function Ri(t,e){var n=Math.cos(t),i=Math.sin(t);return function(r,s,a,o){var l=a*e;null!=r?(r=Fi(n,r),s=Fi(n,s),(a>0?r<s:r>s)&&(r+=a*Tt)):(r=t+a*Tt,s=t-.5*l);for(var c,h=r;a>0?h>s:h<s;h-=l)o.point((c=Un([n,-i*Math.cos(h),-i*Math.sin(h)]))[0],c[1])}}function Fi(t,e){var n=Bn(e);n[0]-=t,In(n);var i=Pt(-n[1]);return((-n[2]<0?-i:i)+2*Math.PI-zt)%(2*Math.PI)}function Ii(t,e,n){var i=s.range(t,e-zt,n).concat(e);return function(t){return i.map(function(e){return[t,e]})}}function Ui(t,e,n){var i=s.range(t,e-zt,n).concat(e);return function(t){return i.map(function(e){return[e,t]})}}function Hi(t){return t.source}function Yi(t){return t.target}s.geo.path=function(){var t,e,n,i,r,a=4.5;function o(t){return t&&("function"==typeof a&&i.pointRadius(+a.apply(this,arguments)),r&&r.valid||(r=n(i)),s.geo.stream(t,r)),i.result()}function l(){return r=null,o}return o.area=function(t){return ui=0,s.geo.stream(t,n(mi)),ui},o.centroid=function(t){return Mn=An=qn=zn=En=Sn=Tn=Ln=Nn=0,s.geo.stream(t,n(ki)),Nn?[Tn/Nn,Ln/Nn]:Sn?[zn/Sn,En/Sn]:qn?[Mn/qn,An/qn]:[NaN,NaN]},o.bounds=function(t){return gi=pi=-(_i=fi=1/0),s.geo.stream(t,n(bi)),[[_i,fi],[gi,pi]]},o.projection=function(e){return arguments.length?(n=(t=e)?e.stream||function(t){var e=zi(function(e,n){return t([e*Ct,n*Ct])});return function(t){return Ni(e(t))}}(e):j,l()):t},o.context=function(t){return arguments.length?(i=null==(e=t)?new function(){var t=yi(4.5),e=[],n={point:i,lineStart:function(){n.point=r},lineEnd:a,polygonStart:function(){n.lineEnd=o},polygonEnd:function(){n.lineEnd=a,n.point=i},pointRadius:function(e){return t=yi(e),n},result:function(){if(e.length){var t=e.join("");return e=[],t}}};function i(n,i){e.push("M",n,",",i,t)}function r(t,i){e.push("M",t,",",i),n.point=s}function s(t,n){e.push("L",t,",",n)}function a(){n.point=i}function o(){e.push("Z")}return n}:new function(t){var e=4.5,n={point:i,lineStart:function(){n.point=r},lineEnd:a,polygonStart:function(){n.lineEnd=o},polygonEnd:function(){n.lineEnd=a,n.point=i},pointRadius:function(t){return e=t,n},result:R};function i(n,i){t.moveTo(n+e,i),t.arc(n,i,e,0,Tt)}function r(e,i){t.moveTo(e,i),n.point=s}function s(e,n){t.lineTo(e,n)}function a(){n.point=i}function o(){t.closePath()}return n}(t),"function"!=typeof a&&i.pointRadius(a),l()):e},o.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(i.pointRadius(+t),+t),o):a},o.projection(s.geo.albersUsa()).context(null)},s.geo.transform=function(t){return{stream:function(e){var n=new Ei(e);for(var i in t)n[i]=t[i];return n}}},Ei.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},s.geo.projection=Ti,s.geo.projectionMutator=Li,(s.geo.equirectangular=function(){return Ti(Oi)}).raw=Oi.invert=Oi,s.geo.rotation=function(t){function e(e){return(e=t(e[0]*Ot,e[1]*Ot))[0]*=Ct,e[1]*=Ct,e}return t=ji(t[0]%360*Ot,t[1]*Ot,t.length>2?t[2]*Ot:0),e.invert=function(e){return(e=t.invert(e[0]*Ot,e[1]*Ot))[0]*=Ct,e[1]*=Ct,e},e},Ci.invert=Oi,s.geo.circle=function(){var t,e,n=[0,0],i=6;function r(){var t="function"==typeof n?n.apply(this,arguments):n,i=ji(-t[0]*Ot,-t[1]*Ot,0).invert,r=[];return e(null,null,1,{point:function(t,e){r.push(t=i(t,e)),t[0]*=Ct,t[1]*=Ct}}),{type:"Polygon",coordinates:[r]}}return r.origin=function(t){return arguments.length?(n=t,r):n},r.angle=function(n){return arguments.length?(e=Ri((t=+n)*Ot,i*Ot),r):t},r.precision=function(n){return arguments.length?(e=Ri(t*Ot,(i=+n)*Ot),r):i},r.angle(90)},s.geo.distance=function(t,e){var n,i=(e[0]-t[0])*Ot,r=t[1]*Ot,s=e[1]*Ot,a=Math.sin(i),o=Math.cos(i),l=Math.sin(r),c=Math.cos(r),h=Math.sin(s),u=Math.cos(s);return Math.atan2(Math.sqrt((n=u*a)*n+(n=c*h-l*u*o)*n),l*h+c*u*o)},s.geo.graticule=function(){var t,e,n,i,r,a,o,l,c,h,u,d,_=10,f=_,g=90,p=360,m=2.5;function v(){return{type:"MultiLineString",coordinates:b()}}function b(){return s.range(Math.ceil(i/g)*g,n,g).map(u).concat(s.range(Math.ceil(l/p)*p,o,p).map(d)).concat(s.range(Math.ceil(e/_)*_,t,_).filter(function(t){return k(t%g)>zt}).map(c)).concat(s.range(Math.ceil(a/f)*f,r,f).filter(function(t){return k(t%p)>zt}).map(h))}return v.lines=function(){return b().map(function(t){return{type:"LineString",coordinates:t}})},v.outline=function(){return{type:"Polygon",coordinates:[u(i).concat(d(o).slice(1),u(n).reverse().slice(1),d(l).reverse().slice(1))]}},v.extent=function(t){return arguments.length?v.majorExtent(t).minorExtent(t):v.minorExtent()},v.majorExtent=function(t){return arguments.length?(i=+t[0][0],n=+t[1][0],l=+t[0][1],o=+t[1][1],i>n&&(t=i,i=n,n=t),l>o&&(t=l,l=o,o=t),v.precision(m)):[[i,l],[n,o]]},v.minorExtent=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],a=+n[0][1],r=+n[1][1],e>t&&(n=e,e=t,t=n),a>r&&(n=a,a=r,r=n),v.precision(m)):[[e,a],[t,r]]},v.step=function(t){return arguments.length?v.majorStep(t).minorStep(t):v.minorStep()},v.majorStep=function(t){return arguments.length?(g=+t[0],p=+t[1],v):[g,p]},v.minorStep=function(t){return arguments.length?(_=+t[0],f=+t[1],v):[_,f]},v.precision=function(s){return arguments.length?(m=+s,c=Ii(a,r,90),h=Ui(e,t,m),u=Ii(l,o,90),d=Ui(i,n,m),v):m},v.majorExtent([[-180,-90+zt],[180,90-zt]]).minorExtent([[-180,-80-zt],[180,80+zt]])},s.geo.greatArc=function(){var t,e,n=Hi,i=Yi;function r(){return{type:"LineString",coordinates:[t||n.apply(this,arguments),e||i.apply(this,arguments)]}}return r.distance=function(){return s.geo.distance(t||n.apply(this,arguments),e||i.apply(this,arguments))},r.source=function(e){return arguments.length?(n=e,t="function"==typeof e?null:e,r):n},r.target=function(t){return arguments.length?(i=t,e="function"==typeof t?null:t,r):i},r.precision=function(){return arguments.length?r:0},r},s.geo.interpolate=function(t,e){return function(t,e,n,i){var r=Math.cos(e),s=Math.sin(e),a=Math.cos(i),o=Math.sin(i),l=r*Math.cos(t),c=r*Math.sin(t),h=a*Math.cos(n),u=a*Math.sin(n),d=2*Math.asin(Math.sqrt(Ft(i-e)+r*a*Ft(n-t))),_=1/Math.sin(d),f=d?function(t){var e=Math.sin(t*=d)*_,n=Math.sin(d-t)*_,i=n*l+e*h,r=n*c+e*u,a=n*s+e*o;return[Math.atan2(r,i)*Ct,Math.atan2(a,Math.sqrt(i*i+r*r))*Ct]}:function(){return[t*Ct,e*Ct]};return f.distance=d,f}(t[0]*Ot,t[1]*Ot,e[0]*Ot,e[1]*Ot)},s.geo.length=function(t){return xi=0,s.geo.stream(t,Vi),xi};var Vi={sphere:R,point:R,lineStart:function(){var t,e,n;function i(i,r){var s=Math.sin(r*=Ot),a=Math.cos(r),o=k((i*=Ot)-t),l=Math.cos(o);xi+=Math.atan2(Math.sqrt((o=a*Math.sin(o))*o+(o=n*s-e*a*l)*o),e*s+n*a*l),t=i,e=s,n=a}Vi.point=function(r,s){t=r*Ot,e=Math.sin(s*=Ot),n=Math.cos(s),Vi.point=i},Vi.lineEnd=function(){Vi.point=Vi.lineEnd=R}},lineEnd:R,polygonStart:R,polygonEnd:R};function Wi(t,e){function n(e,n){var i=Math.cos(e),r=Math.cos(n),s=t(i*r);return[s*r*Math.sin(e),s*Math.sin(n)]}return n.invert=function(t,n){var i=Math.sqrt(t*t+n*n),r=e(i),s=Math.sin(r),a=Math.cos(r);return[Math.atan2(t*s,i*a),Math.asin(i&&n*s/i)]},n}var Gi=Wi(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(s.geo.azimuthalEqualArea=function(){return Ti(Gi)}).raw=Gi;var Zi=Wi(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},j);function Ki(t,e){var n=Math.cos(t),i=function(t){return Math.tan(St/4+t/2)},r=t===e?Math.sin(t):Math.log(n/Math.cos(e))/Math.log(i(e)/i(t)),s=n*Math.pow(i(t),r)/r;if(!r)return Ji;function a(t,e){s>0?e<-Nt+zt&&(e=-Nt+zt):e>Nt-zt&&(e=Nt-zt);var n=s/Math.pow(i(e),r);return[n*Math.sin(r*t),s-n*Math.cos(r*t)]}return a.invert=function(t,e){var n=s-e,i=jt(r)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/r,2*Math.atan(Math.pow(s/i,1/r))-Nt]},a}function Xi(t,e){var n=Math.cos(t),i=t===e?Math.sin(t):(n-Math.cos(e))/(e-t),r=n/i+t;if(k(i)<zt)return Oi;function s(t,e){var n=r-e;return[n*Math.sin(i*t),r-n*Math.cos(i*t)]}return s.invert=function(t,e){var n=r-e;return[Math.atan2(t,n)/i,r-jt(i)*Math.sqrt(t*t+n*n)]},s}(s.geo.azimuthalEquidistant=function(){return Ti(Zi)}).raw=Zi,(s.geo.conicConformal=function(){return ci(Ki)}).raw=Ki,(s.geo.conicEquidistant=function(){return ci(Xi)}).raw=Xi;var $i=Wi(function(t){return 1/t},Math.atan);function Ji(t,e){return[t,Math.log(Math.tan(St/4+e/2))]}function Qi(t){var e,n=Ti(t),i=n.scale,r=n.translate,s=n.clipExtent;return n.scale=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var a=s.apply(n,arguments);if(a===n){if(e=null==t){var o=St*i(),l=r();s([[l[0]-o,l[1]-o],[l[0]+o,l[1]+o]])}}else e&&(a=null);return a},n.clipExtent(null)}(s.geo.gnomonic=function(){return Ti($i)}).raw=$i,Ji.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Nt]},(s.geo.mercator=function(){return Qi(Ji)}).raw=Ji;var tr=Wi(function(){return 1},Math.asin);(s.geo.orthographic=function(){return Ti(tr)}).raw=tr;var er=Wi(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});function nr(t,e){return[Math.log(Math.tan(St/4+e/2)),-t]}function ir(t){return t[0]}function rr(t){return t[1]}function sr(t){for(var e=t.length,n=[0,1],i=2,r=2;r<e;r++){for(;i>1&&Bt(t[n[i-2]],t[n[i-1]],t[r])<=0;)--i;n[i++]=r}return n.slice(0,i)}function ar(t,e){return t[0]-e[0]||t[1]-e[1]}(s.geo.stereographic=function(){return Ti(er)}).raw=er,nr.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Nt]},(s.geo.transverseMercator=function(){var t=Qi(nr),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90])}).raw=nr,s.geom={},s.geom.hull=function(t){var e=ir,n=rr;if(arguments.length)return i(t);function i(t){if(t.length<3)return[];var i,r=ye(e),s=ye(n),a=t.length,o=[],l=[];for(i=0;i<a;i++)o.push([+r.call(this,t[i],i),+s.call(this,t[i],i),i]);for(o.sort(ar),i=0;i<a;i++)l.push([o[i][0],-o[i][1]]);var c=sr(o),h=sr(l),u=h[0]===c[0],d=h[h.length-1]===c[c.length-1],_=[];for(i=c.length-1;i>=0;--i)_.push(t[o[c[i]][2]]);for(i=+u;i<h.length-d;++i)_.push(t[o[h[i]][2]]);return _}return i.x=function(t){return arguments.length?(e=t,i):e},i.y=function(t){return arguments.length?(n=t,i):n},i},s.geom.polygon=function(t){return W(t,or),t};var or=s.geom.polygon.prototype=[];function lr(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function cr(t,e,n,i){var r=t[0],s=n[0],a=e[0]-r,o=i[0]-s,l=t[1],c=n[1],h=e[1]-l,u=i[1]-c,d=(o*(l-c)-u*(r-s))/(u*a-o*h);return[r+d*a,l+d*h]}function hr(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}or.area=function(){for(var t,e=-1,n=this.length,i=this[n-1],r=0;++e<n;)t=i,i=this[e],r+=t[1]*i[0]-t[0]*i[1];return.5*r},or.centroid=function(t){var e,n,i=-1,r=this.length,s=0,a=0,o=this[r-1];for(arguments.length||(t=-1/(6*this.area()));++i<r;)e=o,o=this[i],n=e[0]*o[1]-o[0]*e[1],s+=(e[0]+o[0])*n,a+=(e[1]+o[1])*n;return[s*t,a*t]},or.clip=function(t){for(var e,n,i,r,s,a,o=hr(t),l=-1,c=this.length-hr(this),h=this[c-1];++l<c;){for(e=t.slice(),t.length=0,r=this[l],s=e[(i=e.length-o)-1],n=-1;++n<i;)lr(a=e[n],h,r)?(lr(s,h,r)||t.push(cr(s,a,h,r)),t.push(a)):lr(s,h,r)&&t.push(cr(s,a,h,r)),s=a;o&&t.push(t[0]),h=r}return t};var ur,dr,_r,fr,gr,pr=[],mr=[];function vr(t){var e=pr.pop()||new function(){jr(this),this.edge=this.site=this.circle=null};return e.site=t,e}function br(t){zr(t),_r.remove(t),pr.push(t),jr(t)}function yr(t){var e=t.circle,n=e.x,i=e.cy,r={x:n,y:i},s=t.P,a=t.N,o=[t];br(t);for(var l=s;l.circle&&k(n-l.circle.x)<zt&&k(i-l.circle.cy)<zt;)s=l.P,o.unshift(l),br(l),l=s;o.unshift(l),zr(l);for(var c=a;c.circle&&k(n-c.circle.x)<zt&&k(i-c.circle.cy)<zt;)a=c.N,o.push(c),br(c),c=a;o.push(c),zr(c);var h,u=o.length;for(h=1;h<u;++h)c=o[h],l=o[h-1],Nr(c.edge,l.site,c.site,r);l=o[0],(c=o[u-1]).edge=Tr(l.site,c.site,null,r),qr(l),qr(c)}function xr(t){for(var e,n,i,r,s=t.x,a=t.y,o=_r._;o;)if((i=kr(o,a)-s)>zt)o=o.L;else{if(!((r=s-wr(o,a))>zt)){i>-zt?(e=o.P,n=o):r>-zt?(e=o,n=o.N):e=n=o;break}if(!o.R){e=o;break}o=o.R}var l=vr(t);if(_r.insert(e,l),e||n){if(e===n)return zr(e),n=vr(e.site),_r.insert(l,n),l.edge=n.edge=Tr(e.site,l.site),qr(e),void qr(n);if(n){zr(e),zr(n);var c=e.site,h=c.x,u=c.y,d=t.x-h,_=t.y-u,f=n.site,g=f.x-h,p=f.y-u,m=2*(d*p-_*g),v=d*d+_*_,b=g*g+p*p,y={x:(p*v-_*b)/m+h,y:(d*b-g*v)/m+u};Nr(n.edge,c,f,y),l.edge=Tr(c,t,null,y),n.edge=Tr(t,f,null,y),qr(e),qr(n)}else l.edge=Tr(e.site,l.site)}}function kr(t,e){var n=t.site,i=n.x,r=n.y,s=r-e;if(!s)return i;var a=t.P;if(!a)return-1/0;var o=(n=a.site).x,l=n.y,c=l-e;if(!c)return o;var h=o-i,u=1/s-1/c,d=h/c;return u?(-d+Math.sqrt(d*d-2*u*(h*h/(-2*c)-l+c/2+r-s/2)))/u+i:(i+o)/2}function wr(t,e){var n=t.N;if(n)return kr(n,e);var i=t.site;return i.y===e?i.x:1/0}function Mr(t){this.site=t,this.edges=[]}function Ar(t,e){return e.angle-t.angle}function qr(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,s=n.site;if(i!==s){var a=r.x,o=r.y,l=i.x-a,c=i.y-o,h=s.x-a,u=2*(l*(p=s.y-o)-c*h);if(!(u>=-Et)){var d=l*l+c*c,_=h*h+p*p,f=(p*d-c*_)/u,g=(l*_-h*d)/u,p=g+o,m=mr.pop()||new function(){jr(this),this.x=this.y=this.arc=this.site=this.cy=null};m.arc=t,m.site=r,m.x=f+a,m.y=p+Math.sqrt(f*f+g*g),m.cy=p,t.circle=m;for(var v=null,b=gr._;b;)if(m.y<b.y||m.y===b.y&&m.x<=b.x){if(!b.L){v=b.P;break}b=b.L}else{if(!b.R){v=b;break}b=b.R}gr.insert(v,m),v||(fr=m)}}}}function zr(t){var e=t.circle;e&&(e.P||(fr=e.N),gr.remove(e),mr.push(e),jr(e),t.circle=null)}function Er(t,e){var n=t.b;if(n)return!0;var i,r,s=t.a,a=e[0][0],o=e[1][0],l=e[0][1],c=e[1][1],h=t.l,u=t.r,d=h.x,_=h.y,f=u.x,g=u.y,p=(d+f)/2,m=(_+g)/2;if(g===_){if(p<a||p>=o)return;if(d>f){if(s){if(s.y>=c)return}else s={x:p,y:l};n={x:p,y:c}}else{if(s){if(s.y<l)return}else s={x:p,y:c};n={x:p,y:l}}}else if(r=m-(i=(d-f)/(g-_))*p,i<-1||i>1)if(d>f){if(s){if(s.y>=c)return}else s={x:(l-r)/i,y:l};n={x:(c-r)/i,y:c}}else{if(s){if(s.y<l)return}else s={x:(c-r)/i,y:c};n={x:(l-r)/i,y:l}}else if(_<g){if(s){if(s.x>=o)return}else s={x:a,y:i*a+r};n={x:o,y:i*o+r}}else{if(s){if(s.x<a)return}else s={x:o,y:i*o+r};n={x:a,y:i*a+r}}return t.a=s,t.b=n,!0}function Sr(t,e){this.l=t,this.r=e,this.a=this.b=null}function Tr(t,e,n,i){var r=new Sr(t,e);return ur.push(r),n&&Nr(r,t,e,n),i&&Nr(r,e,t,i),dr[t.i].edges.push(new Or(r,t,e)),dr[e.i].edges.push(new Or(r,e,t)),r}function Lr(t,e,n){var i=new Sr(t,null);return i.a=e,i.b=n,ur.push(i),i}function Nr(t,e,n,i){t.a||t.b?t.l===n?t.b=i:t.a=i:(t.a=i,t.l=e,t.r=n)}function Or(t,e,n){var i=t.a,r=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(r.x-i.x,i.y-r.y):Math.atan2(i.x-r.x,r.y-i.y)}function Cr(){this._=null}function jr(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Br(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function Pr(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function Dr(t){for(;t.L;)t=t.L;return t}function Rr(t,e){var n,i,r,s=t.sort(Fr).pop();for(ur=[],dr=new Array(t.length),_r=new Cr,gr=new Cr;;)if(r=fr,s&&(!r||s.y<r.y||s.y===r.y&&s.x<r.x))s.x===n&&s.y===i||(dr[s.i]=new Mr(s),xr(s),n=s.x,i=s.y),s=t.pop();else{if(!r)break;yr(r.arc)}e&&(function(t){for(var e,n=ur,i=ai(t[0][0],t[0][1],t[1][0],t[1][1]),r=n.length;r--;)(!Er(e=n[r],t)||!i(e)||k(e.a.x-e.b.x)<zt&&k(e.a.y-e.b.y)<zt)&&(e.a=e.b=null,n.splice(r,1))}(e),function(t){for(var e,n,i,r,s,a,o,l,c,h,u=t[0][0],d=t[1][0],_=t[0][1],f=t[1][1],g=dr,p=g.length;p--;)if((s=g[p])&&s.prepare())for(l=(o=s.edges).length,a=0;a<l;)i=(h=o[a].end()).x,r=h.y,e=(c=o[++a%l].start()).x,n=c.y,(k(i-e)>zt||k(r-n)>zt)&&(o.splice(a,0,new Or(Lr(s.site,h,k(i-u)<zt&&f-r>zt?{x:u,y:k(e-u)<zt?n:f}:k(r-f)<zt&&d-i>zt?{x:k(n-f)<zt?e:d,y:f}:k(i-d)<zt&&r-_>zt?{x:d,y:k(e-d)<zt?n:_}:k(r-_)<zt&&i-u>zt?{x:k(n-_)<zt?e:u,y:_}:null),s.site,null)),++l)}(e));var a={cells:dr,edges:ur};return _r=gr=ur=dr=null,a}function Fr(t,e){return e.y-t.y||e.x-t.x}Mr.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)(t=e[n].edge).b&&t.a||e.splice(n,1);return e.sort(Ar),e.length},Or.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Cr.prototype={insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Dr(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(Br(this,n),n=(t=n).U),n.C=!1,i.C=!0,Pr(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(Pr(this,n),n=(t=n).U),n.C=!1,i.C=!0,Br(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,s=t.L,a=t.R;if(n=s?a?Dr(a):s:a,r?r.L===t?r.L=n:r.R=n:this._=n,s&&a?(i=n.C,n.C=t.C,n.L=s,s.U=n,n!==a?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=a,a.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,Br(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Pr(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,Br(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,Pr(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Br(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,Pr(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}},s.geom.voronoi=function(t){var e=ir,n=rr,i=e,r=n,s=Ir;if(t)return a(t);function a(t){var e=new Array(t.length),n=s[0][0],i=s[0][1],r=s[1][0],a=s[1][1];return Rr(o(t),s).cells.forEach(function(s,o){var l=s.edges,c=s.site;(e[o]=l.length?l.map(function(t){var e=t.start();return[e.x,e.y]}):c.x>=n&&c.x<=r&&c.y>=i&&c.y<=a?[[n,a],[r,a],[r,i],[n,i]]:[]).point=t[o]}),e}function o(t){return t.map(function(t,e){return{x:Math.round(i(t,e)/zt)*zt,y:Math.round(r(t,e)/zt)*zt,i:e}})}return a.links=function(t){return Rr(o(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},a.triangles=function(t){var e=[];return Rr(o(t)).cells.forEach(function(n,i){for(var r,s=n.site,a=n.edges.sort(Ar),o=-1,l=a.length,c=a[l-1].edge,h=c.l===s?c.r:c.l;++o<l;)c,r=h,h=(c=a[o].edge).l===s?c.r:c.l,i<r.i&&i<h.i&&Ur(s,r,h)<0&&e.push([t[i],t[r.i],t[h.i]])}),e},a.x=function(t){return arguments.length?(i=ye(e=t),a):e},a.y=function(t){return arguments.length?(r=ye(n=t),a):n},a.clipExtent=function(t){return arguments.length?(s=null==t?Ir:t,a):s===Ir?null:s},a.size=function(t){return arguments.length?a.clipExtent(t&&[[0,0],t]):s===Ir?null:s&&s[1]},a};var Ir=[[-1e6,-1e6],[1e6,1e6]];function Ur(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function Hr(t){return t.x}function Yr(t){return t.y}function Vr(t,e){t=s.rgb(t),e=s.rgb(e);var n=t.r,i=t.g,r=t.b,a=e.r-n,o=e.g-i,l=e.b-r;return function(t){return"#"+_e(Math.round(n+a*t))+_e(Math.round(i+o*t))+_e(Math.round(r+l*t))}}function Wr(t,e){var n,i={},r={};for(n in t)n in e?i[n]=$r(t[n],e[n]):r[n]=t[n];for(n in e)n in t||(r[n]=e[n]);return function(t){for(n in i)r[n]=i[n](t);return r}}function Gr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Zr(t,e){var n,i,r,s=Kr.lastIndex=Xr.lastIndex=0,a=-1,o=[],l=[];for(t+="",e+="";(n=Kr.exec(t))&&(i=Xr.exec(e));)(r=i.index)>s&&(r=e.slice(s,r),o[a]?o[a]+=r:o[++a]=r),(n=n[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:Gr(n,i)})),s=Xr.lastIndex;return s<e.length&&(r=e.slice(s),o[a]?o[a]+=r:o[++a]=r),o.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var n,i=0;i<e;++i)o[(n=l[i]).i]=n.x(t);return o.join("")})}s.geom.delaunay=function(t){return s.geom.voronoi().triangles(t)},s.geom.quadtree=function(t,e,n,i,r){var s,a=ir,o=rr;if(s=arguments.length)return a=Hr,o=Yr,3===s&&(r=n,i=e,n=e=0),l(t);function l(t){var l,c,h,u,d,_,f,g,p,m=ye(a),v=ye(o);if(null!=e)_=e,f=n,g=i,p=r;else if(g=p=-(_=f=1/0),c=[],h=[],d=t.length,s)for(u=0;u<d;++u)(l=t[u]).x<_&&(_=l.x),l.y<f&&(f=l.y),l.x>g&&(g=l.x),l.y>p&&(p=l.y),c.push(l.x),h.push(l.y);else for(u=0;u<d;++u){var b=+m(l=t[u],u),y=+v(l,u);b<_&&(_=b),y<f&&(f=y),b>g&&(g=b),y>p&&(p=y),c.push(b),h.push(y)}var x=g-_,w=p-f;function M(t,e,n,i,r,s,a,o){if(!isNaN(n)&&!isNaN(i))if(t.leaf){var l=t.x,c=t.y;if(null!=l)if(k(l-n)+k(c-i)<.01)A(t,e,n,i,r,s,a,o);else{var h=t.point;t.x=t.y=t.point=null,A(t,h,l,c,r,s,a,o),A(t,e,n,i,r,s,a,o)}else t.x=n,t.y=i,t.point=e}else A(t,e,n,i,r,s,a,o)}function A(t,e,n,i,r,s,a,o){var l=.5*(r+a),c=.5*(s+o),h=n>=l,u=i>=c,d=u<<1|h;t.leaf=!1,t=t.nodes[d]||(t.nodes[d]={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(t){M(q,t,+m(t,++u),+v(t,u),_,f,g,p)}}),h?r=l:a=l,u?s=c:o=c,M(t,e,n,i,r,s,a,o)}x>w?p=f+x:g=_+w;var q={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(t){M(q,t,+m(t,++u),+v(t,u),_,f,g,p)}};if(q.visit=function(t){!function t(e,n,i,r,s,a){if(!e(n,i,r,s,a)){var o=.5*(i+s),l=.5*(r+a),c=n.nodes;c[0]&&t(e,c[0],i,r,o,l),c[1]&&t(e,c[1],o,r,s,l),c[2]&&t(e,c[2],i,l,o,a),c[3]&&t(e,c[3],o,l,s,a)}}(t,q,_,f,g,p)},q.find=function(t){return function(t,e,n,i,r,s,a){var o,l=1/0;return function t(c,h,u,d,_){if(!(h>s||u>a||d<i||_<r)){if(f=c.point){var f,g=e-c.x,p=n-c.y,m=g*g+p*p;if(m<l){var v=Math.sqrt(l=m);i=e-v,r=n-v,s=e+v,a=n+v,o=f}}for(var b=c.nodes,y=.5*(h+d),x=.5*(u+_),k=(n>=x)<<1|e>=y,w=k+4;k<w;++k)if(c=b[3&k])switch(3&k){case 0:t(c,h,u,y,x);break;case 1:t(c,y,u,d,x);break;case 2:t(c,h,x,y,_);break;case 3:t(c,y,x,d,_)}}}(t,i,r,s,a),o}(q,t[0],t[1],_,f,g,p)},u=-1,null==e){for(;++u<d;)M(q,t[u],c[u],h[u],_,f,g,p);--u}else t.forEach(q.add);return c=h=t=l=null,q}return l.x=function(t){return arguments.length?(a=t,l):a},l.y=function(t){return arguments.length?(o=t,l):o},l.extent=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),l):null==e?null:[[e,n],[i,r]]},l.size=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=n=0,i=+t[0],r=+t[1]),l):null==e?null:[i-e,r-n]},l},s.interpolateRgb=Vr,s.interpolateObject=Wr,s.interpolateNumber=Gr,s.interpolateString=Zr;var Kr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Xr=new RegExp(Kr.source,"g");function $r(t,e){for(var n,i=s.interpolators.length;--i>=0&&!(n=s.interpolators[i](t,e)););return n}function Jr(t,e){var n,i=[],r=[],s=t.length,a=e.length,o=Math.min(t.length,e.length);for(n=0;n<o;++n)i.push($r(t[n],e[n]));for(;n<s;++n)r[n]=t[n];for(;n<a;++n)r[n]=e[n];return function(t){for(n=0;n<o;++n)r[n]=i[n](t);return r}}s.interpolate=$r,s.interpolators=[function(t,e){var n=typeof e;return("string"===n?be.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?Vr:Zr:e instanceof Vt?Vr:Array.isArray(e)?Jr:"object"===n&&isNaN(e)?Wr:Gr)(t,e)}],s.interpolateArray=Jr;var Qr=function(){return j},ts=s.map({linear:Qr,poly:function(t){return function(e){return Math.pow(e,t)}},quad:function(){return rs},cubic:function(){return ss},sin:function(){return os},exp:function(){return ls},circle:function(){return cs},elastic:function(t,e){var n;arguments.length<2&&(e=.45);arguments.length?n=e/Tt*Math.asin(1/t):(t=1,n=e/4);return function(i){return 1+t*Math.pow(2,-10*i)*Math.sin((i-n)*Tt/e)}},back:function(t){t||(t=1.70158);return function(e){return e*e*((t+1)*e-t)}},bounce:function(){return hs}}),es=s.map({in:j,out:ns,"in-out":is,"out-in":function(t){return is(ns(t))}});function ns(t){return function(e){return 1-t(1-e)}}function is(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}}function rs(t){return t*t}function ss(t){return t*t*t}function as(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function os(t){return 1-Math.cos(t*Nt)}function ls(t){return Math.pow(2,10*(t-1))}function cs(t){return 1-Math.sqrt(1-t*t)}function hs(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function us(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function ds(t){var e=[t.a,t.b],n=[t.c,t.d],i=fs(e),r=_s(e,n),s=fs(function(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}(n,e,-r))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,i*=-1,r*=-1),this.rotate=(i?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*Ct,this.translate=[t.e,t.f],this.scale=[i,s],this.skew=s?Math.atan2(r,s)*Ct:0}function _s(t,e){return t[0]*e[0]+t[1]*e[1]}function fs(t){var e=Math.sqrt(_s(t,t));return e&&(t[0]/=e,t[1]/=e),e}s.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.slice(0,e):t,i=e>=0?t.slice(e+1):"in";return n=ts.get(n)||Qr,function(t){return function(e){return e<=0?0:e>=1?1:t(e)}}((i=es.get(i)||j)(n.apply(null,a.call(arguments,1))))},s.interpolateHcl=function(t,e){t=s.hcl(t),e=s.hcl(e);var n=t.h,i=t.c,r=t.l,a=e.h-n,o=e.c-i,l=e.l-r;isNaN(o)&&(o=0,i=isNaN(i)?e.c:i);isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:a<-180&&(a+=360);return function(t){return $t(n+a*t,i+o*t,r+l*t)+""}},s.interpolateHsl=function(t,e){t=s.hsl(t),e=s.hsl(e);var n=t.h,i=t.s,r=t.l,a=e.h-n,o=e.s-i,l=e.l-r;isNaN(o)&&(o=0,i=isNaN(i)?e.s:i);isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:a<-180&&(a+=360);return function(t){return Zt(n+a*t,i+o*t,r+l*t)+""}},s.interpolateLab=function(t,e){t=s.lab(t),e=s.lab(e);var n=t.l,i=t.a,r=t.b,a=e.l-n,o=e.a-i,l=e.b-r;return function(t){return re(n+a*t,i+o*t,r+l*t)+""}},s.interpolateRound=us,s.transform=function(t){var e=l.createElementNS(s.ns.prefix.svg,"g");return(s.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new ds(n?n.matrix:gs)})(t)},ds.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var gs={a:1,b:0,c:0,d:1,e:0,f:0};function ps(t){return t.length?t.pop()+",":""}function ms(t,e){var n=[],i=[];return t=s.transform(t),e=s.transform(e),function(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var r=n.push("translate(",null,",",null,")");i.push({i:r-4,x:Gr(t[0],e[0])},{i:r-2,x:Gr(t[1],e[1])})}else(e[0]||e[1])&&n.push("translate("+e+")")}(t.translate,e.translate,n,i),function(t,e,n,i){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),i.push({i:n.push(ps(n)+"rotate(",null,")")-2,x:Gr(t,e)})):e&&n.push(ps(n)+"rotate("+e+")")}(t.rotate,e.rotate,n,i),function(t,e,n,i){t!==e?i.push({i:n.push(ps(n)+"skewX(",null,")")-2,x:Gr(t,e)}):e&&n.push(ps(n)+"skewX("+e+")")}(t.skew,e.skew,n,i),function(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var r=n.push(ps(n)+"scale(",null,",",null,")");i.push({i:r-4,x:Gr(t[0],e[0])},{i:r-2,x:Gr(t[1],e[1])})}else 1===e[0]&&1===e[1]||n.push(ps(n)+"scale("+e+")")}(t.scale,e.scale,n,i),t=e=null,function(t){for(var e,r=-1,s=i.length;++r<s;)n[(e=i[r]).i]=e.x(t);return n.join("")}}function vs(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function bs(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function ys(t){for(var e=t.source,n=t.target,i=function(t,e){if(t===e)return t;var n=xs(t),i=xs(e),r=n.pop(),s=i.pop(),a=null;for(;r===s;)a=r,r=n.pop(),s=i.pop();return a}(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var s=r.length;n!==i;)r.splice(s,0,n),n=n.parent;return r}function xs(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function ks(t){t.fixed|=2}function ws(t){t.fixed&=-7}function Ms(t){t.fixed|=4,t.px=t.x,t.py=t.y}function As(t){t.fixed&=-5}s.interpolateTransform=ms,s.layout={},s.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;++n<i;)e.push(ys(t[n]));return e}},s.layout.chord=function(){var t,e,n,i,r,a,o,l={},c=0;function h(){var l,h,d,_,f,g={},p=[],m=s.range(i),v=[];for(t=[],e=[],l=0,_=-1;++_<i;){for(h=0,f=-1;++f<i;)h+=n[_][f];p.push(h),v.push(s.range(i)),l+=h}for(r&&m.sort(function(t,e){return r(p[t],p[e])}),a&&v.forEach(function(t,e){t.sort(function(t,i){return a(n[e][t],n[e][i])})}),l=(Tt-c*i)/l,h=0,_=-1;++_<i;){for(d=h,f=-1;++f<i;){var b=m[_],y=v[b][f],x=n[b][y],k=h,w=h+=x*l;g[b+"-"+y]={index:b,subindex:y,startAngle:k,endAngle:w,value:x}}e[b]={index:b,startAngle:d,endAngle:h,value:p[b]},h+=c}for(_=-1;++_<i;)for(f=_-1;++f<i;){var M=g[_+"-"+f],A=g[f+"-"+_];(M.value||A.value)&&t.push(M.value<A.value?{source:A,target:M}:{source:M,target:A})}o&&u()}function u(){t.sort(function(t,e){return o((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}return l.matrix=function(r){return arguments.length?(i=(n=r)&&n.length,t=e=null,l):n},l.padding=function(n){return arguments.length?(c=n,t=e=null,l):c},l.sortGroups=function(n){return arguments.length?(r=n,t=e=null,l):r},l.sortSubgroups=function(e){return arguments.length?(a=e,t=null,l):a},l.sortChords=function(e){return arguments.length?(o=e,t&&u(),l):o},l.chords=function(){return t||h(),t},l.groups=function(){return e||h(),e},l},s.layout.force=function(){var t,e,n,i,r,a,o={},l=s.dispatch("start","tick","end"),c=[1,1],h=.9,u=qs,d=zs,_=-30,f=Es,g=.1,p=.64,m=[],v=[];function b(t){return function(e,n,i,r){if(e.point!==t){var s=e.cx-t.x,a=e.cy-t.y,o=r-n,l=s*s+a*a;if(o*o/p<l){if(l<f){var c=e.charge/l;t.px-=s*c,t.py-=a*c}return!0}if(e.point&&l&&l<f){c=e.pointCharge/l;t.px-=s*c,t.py-=a*c}}return!e.charge}}function y(t){t.px=s.event.x,t.py=s.event.y,o.resume()}return o.tick=function(){if((n*=.99)<.005)return t=null,l.end({type:"end",alpha:n=0}),!0;var e,o,u,d,f,p,y,x,k,w=m.length,M=v.length;for(o=0;o<M;++o)d=(u=v[o]).source,(p=(x=(f=u.target).x-d.x)*x+(k=f.y-d.y)*k)&&(x*=p=n*r[o]*((p=Math.sqrt(p))-i[o])/p,k*=p,f.x-=x*(y=d.weight+f.weight?d.weight/(d.weight+f.weight):.5),f.y-=k*y,d.x+=x*(y=1-y),d.y+=k*y);if((y=n*g)&&(x=c[0]/2,k=c[1]/2,o=-1,y))for(;++o<w;)(u=m[o]).x+=(x-u.x)*y,u.y+=(k-u.y)*y;if(_)for(!function t(e,n,i){var r=0,s=0;e.charge=0;if(!e.leaf)for(var a,o=e.nodes,l=o.length,c=-1;++c<l;)null!=(a=o[c])&&(t(a,n,i),e.charge+=a.charge,r+=a.charge*a.cx,s+=a.charge*a.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var h=n*i[e.point.index];e.charge+=e.pointCharge=h,r+=h*e.point.x,s+=h*e.point.y}e.cx=r/e.charge;e.cy=s/e.charge}(e=s.geom.quadtree(m),n,a),o=-1;++o<w;)(u=m[o]).fixed||e.visit(b(u));for(o=-1;++o<w;)(u=m[o]).fixed?(u.x=u.px,u.y=u.py):(u.x-=(u.px-(u.px=u.x))*h,u.y-=(u.py-(u.py=u.y))*h);l.tick({type:"tick",alpha:n})},o.nodes=function(t){return arguments.length?(m=t,o):m},o.links=function(t){return arguments.length?(v=t,o):v},o.size=function(t){return arguments.length?(c=t,o):c},o.linkDistance=function(t){return arguments.length?(u="function"==typeof t?t:+t,o):u},o.distance=o.linkDistance,o.linkStrength=function(t){return arguments.length?(d="function"==typeof t?t:+t,o):d},o.friction=function(t){return arguments.length?(h=+t,o):h},o.charge=function(t){return arguments.length?(_="function"==typeof t?t:+t,o):_},o.chargeDistance=function(t){return arguments.length?(f=t*t,o):Math.sqrt(f)},o.gravity=function(t){return arguments.length?(g=+t,o):g},o.theta=function(t){return arguments.length?(p=t*t,o):Math.sqrt(p)},o.alpha=function(e){return arguments.length?(e=+e,n?e>0?n=e:(t.c=null,t.t=NaN,t=null,l.end({type:"end",alpha:n=0})):e>0&&(l.start({type:"start",alpha:n=e}),t=Ee(o.tick)),o):n},o.start=function(){var t,e,n,s=m.length,l=v.length,h=c[0],f=c[1];for(t=0;t<s;++t)(n=m[t]).index=t,n.weight=0;for(t=0;t<l;++t)"number"==typeof(n=v[t]).source&&(n.source=m[n.source]),"number"==typeof n.target&&(n.target=m[n.target]),++n.source.weight,++n.target.weight;for(t=0;t<s;++t)n=m[t],isNaN(n.x)&&(n.x=g("x",h)),isNaN(n.y)&&(n.y=g("y",f)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);if(i=[],"function"==typeof u)for(t=0;t<l;++t)i[t]=+u.call(this,v[t],t);else for(t=0;t<l;++t)i[t]=u;if(r=[],"function"==typeof d)for(t=0;t<l;++t)r[t]=+d.call(this,v[t],t);else for(t=0;t<l;++t)r[t]=d;if(a=[],"function"==typeof _)for(t=0;t<s;++t)a[t]=+_.call(this,m[t],t);else for(t=0;t<s;++t)a[t]=_;function g(n,i){if(!e){for(e=new Array(s),c=0;c<s;++c)e[c]=[];for(c=0;c<l;++c){var r=v[c];e[r.source.index].push(r.target),e[r.target.index].push(r.source)}}for(var a,o=e[t],c=-1,h=o.length;++c<h;)if(!isNaN(a=o[c][n]))return a;return Math.random()*i}return o.resume()},o.resume=function(){return o.alpha(.1)},o.stop=function(){return o.alpha(0)},o.drag=function(){if(e||(e=s.behavior.drag().origin(j).on("dragstart.force",ks).on("drag.force",y).on("dragend.force",ws)),!arguments.length)return e;this.on("mouseover.force",Ms).on("mouseout.force",As).call(e)},s.rebind(o,l,"on")};var qs=20,zs=1,Es=1/0;function Ss(t,e){return s.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=js,t}function Ts(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(r=t.children)&&(i=r.length))for(var i,r;--i>=0;)n.push(r[i])}function Ls(t,e){for(var n=[t],i=[];null!=(t=n.pop());)if(i.push(t),(s=t.children)&&(r=s.length))for(var r,s,a=-1;++a<r;)n.push(s[a]);for(;null!=(t=i.pop());)e(t)}function Ns(t){return t.children}function Os(t){return t.value}function Cs(t,e){return e.value-t.value}function js(t){return s.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}s.layout.hierarchy=function(){var t=Cs,e=Ns,n=Os;function i(r){var s,a=[r],o=[];for(r.depth=0;null!=(s=a.pop());)if(o.push(s),(c=e.call(i,s,s.depth))&&(l=c.length)){for(var l,c,h;--l>=0;)a.push(h=c[l]),h.parent=s,h.depth=s.depth+1;n&&(s.value=0),s.children=c}else n&&(s.value=+n.call(i,s,s.depth)||0),delete s.children;return Ls(r,function(e){var i,r;t&&(i=e.children)&&i.sort(t),n&&(r=e.parent)&&(r.value+=e.value)}),o}return i.sort=function(e){return arguments.length?(t=e,i):t},i.children=function(t){return arguments.length?(e=t,i):e},i.value=function(t){return arguments.length?(n=t,i):n},i.revalue=function(t){return n&&(Ts(t,function(t){t.children&&(t.value=0)}),Ls(t,function(t){var e;t.children||(t.value=+n.call(i,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},i},s.layout.partition=function(){var t=s.layout.hierarchy(),e=[1,1];function n(n,i){var r=t.call(this,n,i);return function t(e,n,i,r){var s=e.children;if(e.x=n,e.y=e.depth*r,e.dx=i,e.dy=r,s&&(a=s.length)){var a,o,l,c=-1;for(i=e.value?i/e.value:0;++c<a;)t(o=s[c],n,l=o.value*i,r),n+=l}}(r[0],0,e[0],e[1]/function t(e){var n=e.children,i=0;if(n&&(r=n.length))for(var r,s=-1;++s<r;)i=Math.max(i,t(n[s]));return 1+i}(r[0])),r}return n.size=function(t){return arguments.length?(e=t,n):e},Ss(n,t)},s.layout.pie=function(){var t=Number,e=Bs,n=0,i=Tt,r=0;function a(o){var l,c=o.length,h=o.map(function(e,n){return+t.call(a,e,n)}),u=+("function"==typeof n?n.apply(this,arguments):n),d=("function"==typeof i?i.apply(this,arguments):i)-u,_=Math.min(Math.abs(d)/c,+("function"==typeof r?r.apply(this,arguments):r)),f=_*(d<0?-1:1),g=s.sum(h),p=g?(d-c*f)/g:0,m=s.range(c),v=[];return null!=e&&m.sort(e===Bs?function(t,e){return h[e]-h[t]}:function(t,n){return e(o[t],o[n])}),m.forEach(function(t){v[t]={data:o[t],value:l=h[t],startAngle:u,endAngle:u+=l*p+f,padAngle:_}}),v}return a.value=function(e){return arguments.length?(t=e,a):t},a.sort=function(t){return arguments.length?(e=t,a):e},a.startAngle=function(t){return arguments.length?(n=t,a):n},a.endAngle=function(t){return arguments.length?(i=t,a):i},a.padAngle=function(t){return arguments.length?(r=t,a):r},a};var Bs={};function Ps(t){return t.x}function Ds(t){return t.y}function Rs(t,e,n){t.y0=e,t.y=n}s.layout.stack=function(){var t=j,e=Us,n=Hs,i=Rs,r=Ps,a=Ds;function o(l,c){if(!(_=l.length))return l;var h=l.map(function(e,n){return t.call(o,e,n)}),u=h.map(function(t){return t.map(function(t,e){return[r.call(o,t,e),a.call(o,t,e)]})}),d=e.call(o,u,c);h=s.permute(h,d),u=s.permute(u,d);var _,f,g,p,m=n.call(o,u,c),v=h[0].length;for(g=0;g<v;++g)for(i.call(o,h[0][g],p=m[g],u[0][g][1]),f=1;f<_;++f)i.call(o,h[f][g],p+=u[f-1][g][1],u[f][g][1]);return l}return o.values=function(e){return arguments.length?(t=e,o):t},o.order=function(t){return arguments.length?(e="function"==typeof t?t:Fs.get(t)||Us,o):e},o.offset=function(t){return arguments.length?(n="function"==typeof t?t:Is.get(t)||Hs,o):n},o.x=function(t){return arguments.length?(r=t,o):r},o.y=function(t){return arguments.length?(a=t,o):a},o.out=function(t){return arguments.length?(i=t,o):i},o};var Fs=s.map({"inside-out":function(t){var e,n,i=t.length,r=t.map(Ys),a=t.map(Vs),o=s.range(i).sort(function(t,e){return r[t]-r[e]}),l=0,c=0,h=[],u=[];for(e=0;e<i;++e)n=o[e],l<c?(l+=a[n],h.push(n)):(c+=a[n],u.push(n));return u.reverse().concat(h)},reverse:function(t){return s.range(t.length).reverse()},default:Us}),Is=s.map({silhouette:function(t){var e,n,i,r=t.length,s=t[0].length,a=[],o=0,l=[];for(n=0;n<s;++n){for(e=0,i=0;e<r;e++)i+=t[e][n][1];i>o&&(o=i),a.push(i)}for(n=0;n<s;++n)l[n]=(o-a[n])/2;return l},wiggle:function(t){var e,n,i,r,s,a,o,l,c,h=t.length,u=t[0],d=u.length,_=[];for(_[0]=l=c=0,n=1;n<d;++n){for(e=0,r=0;e<h;++e)r+=t[e][n][1];for(e=0,s=0,o=u[n][0]-u[n-1][0];e<h;++e){for(i=0,a=(t[e][n][1]-t[e][n-1][1])/(2*o);i<e;++i)a+=(t[i][n][1]-t[i][n-1][1])/o;s+=a*t[e][n][1]}_[n]=l-=r?s/r*o:0,l<c&&(c=l)}for(n=0;n<d;++n)_[n]-=c;return _},expand:function(t){var e,n,i,r=t.length,s=t[0].length,a=1/r,o=[];for(n=0;n<s;++n){for(e=0,i=0;e<r;e++)i+=t[e][n][1];if(i)for(e=0;e<r;e++)t[e][n][1]/=i;else for(e=0;e<r;e++)t[e][n][1]=a}for(n=0;n<s;++n)o[n]=0;return o},zero:Hs});function Us(t){return s.range(t.length)}function Hs(t){for(var e=-1,n=t[0].length,i=[];++e<n;)i[e]=0;return i}function Ys(t){for(var e,n=1,i=0,r=t[0][1],s=t.length;n<s;++n)(e=t[n][1])>r&&(i=n,r=e);return i}function Vs(t){return t.reduce(Ws,0)}function Ws(t,e){return t+e[1]}function Gs(t,e){return Zs(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function Zs(t,e){for(var n=-1,i=+t[0],r=(t[1]-i)/e,s=[];++n<=e;)s[n]=r*n+i;return s}function Ks(t){return[s.min(t),s.max(t)]}function Xs(t,e){return t.value-e.value}function $s(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function Js(t,e){t._pack_next=e,e._pack_prev=t}function Qs(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return.999*r*r>n*n+i*i}function ta(t){if((e=t.children)&&(l=e.length)){var e,n,i,r,s,a,o,l,c=1/0,h=-1/0,u=1/0,d=-1/0;if(e.forEach(ea),(n=e[0]).x=-n.r,n.y=0,b(n),l>1&&((i=e[1]).x=i.r,i.y=0,b(i),l>2))for(ia(n,i,r=e[2]),b(r),$s(n,r),n._pack_prev=r,$s(r,i),i=n._pack_next,s=3;s<l;s++){ia(n,i,r=e[s]);var _=0,f=1,g=1;for(a=i._pack_next;a!==i;a=a._pack_next,f++)if(Qs(a,r)){_=1;break}if(1==_)for(o=n._pack_prev;o!==a._pack_prev&&!Qs(o,r);o=o._pack_prev,g++);_?(f<g||f==g&&i.r<n.r?Js(n,i=a):Js(n=o,i),s--):($s(n,r),i=r,b(r))}var p=(c+h)/2,m=(u+d)/2,v=0;for(s=0;s<l;s++)(r=e[s]).x-=p,r.y-=m,v=Math.max(v,r.r+Math.sqrt(r.x*r.x+r.y*r.y));t.r=v,e.forEach(na)}function b(t){c=Math.min(t.x-t.r,c),h=Math.max(t.x+t.r,h),u=Math.min(t.y-t.r,u),d=Math.max(t.y+t.r,d)}}function ea(t){t._pack_next=t._pack_prev=t}function na(t){delete t._pack_next,delete t._pack_prev}function ia(t,e,n){var i=t.r+n.r,r=e.x-t.x,s=e.y-t.y;if(i&&(r||s)){var a=e.r+n.r,o=r*r+s*s,l=.5+((i*=i)-(a*=a))/(2*o),c=Math.sqrt(Math.max(0,2*a*(i+o)-(i-=o)*i-a*a))/(2*o);n.x=t.x+l*r+c*s,n.y=t.y+l*s-c*r}else n.x=t.x+i,n.y=t.y}function ra(t,e){return t.parent==e.parent?1:2}function sa(t){var e=t.children;return e.length?e[0]:t.t}function aa(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function oa(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function la(t,e,n){return t.a.parent===e.parent?t.a:n}function ca(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function ha(t,e){var n=t.x+e[3],i=t.y+e[0],r=t.dx-e[1]-e[3],s=t.dy-e[0]-e[2];return r<0&&(n+=r/2,r=0),s<0&&(i+=s/2,s=0),{x:n,y:i,dx:r,dy:s}}function ua(t){var e=t[0],n=t[t.length-1];return e<n?[e,n]:[n,e]}function da(t){return t.rangeExtent?t.rangeExtent():ua(t.range())}function _a(t,e,n,i){var r=n(t[0],t[1]),s=i(e[0],e[1]);return function(t){return s(r(t))}}function fa(t,e){var n,i=0,r=t.length-1,s=t[i],a=t[r];return a<s&&(n=i,i=r,r=n,n=s,s=a,a=n),t[i]=e.floor(s),t[r]=e.ceil(a),t}function ga(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:pa}s.layout.histogram=function(){var t=!0,e=Number,n=Ks,i=Gs;function r(r,a){for(var o,l,c=[],h=r.map(e,this),u=n.call(this,h,a),d=i.call(this,u,h,a),_=(a=-1,h.length),f=d.length-1,g=t?1:1/_;++a<f;)(o=c[a]=[]).dx=d[a+1]-(o.x=d[a]),o.y=0;if(f>0)for(a=-1;++a<_;)(l=h[a])>=u[0]&&l<=u[1]&&((o=c[s.bisect(d,l,1,f)-1]).y+=g,o.push(r[a]));return c}return r.value=function(t){return arguments.length?(e=t,r):e},r.range=function(t){return arguments.length?(n=ye(t),r):n},r.bins=function(t){return arguments.length?(i="number"==typeof t?function(e){return Zs(e,t)}:ye(t),r):i},r.frequency=function(e){return arguments.length?(t=!!e,r):t},r},s.layout.pack=function(){var t,e=s.layout.hierarchy().sort(Xs),n=0,i=[1,1];function r(r,s){var a=e.call(this,r,s),o=a[0],l=i[0],c=i[1],h=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(o.x=o.y=0,Ls(o,function(t){t.r=+h(t.value)}),Ls(o,ta),n){var u=n*(t?1:Math.max(2*o.r/l,2*o.r/c))/2;Ls(o,function(t){t.r+=u}),Ls(o,ta),Ls(o,function(t){t.r-=u})}return function t(e,n,i,r){var s=e.children;e.x=n+=r*e.x;e.y=i+=r*e.y;e.r*=r;if(s)for(var a=-1,o=s.length;++a<o;)t(s[a],n,i,r)}(o,l/2,c/2,t?1:1/Math.max(2*o.r/l,2*o.r/c)),a}return r.size=function(t){return arguments.length?(i=t,r):i},r.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,r):t},r.padding=function(t){return arguments.length?(n=+t,r):n},Ss(r,e)},s.layout.tree=function(){var t=s.layout.hierarchy().sort(null).value(null),e=ra,n=[1,1],i=null;function r(r,s){var c=t.call(this,r,s),h=c[0],u=function(t){var e,n={A:null,children:[t]},i=[n];for(;null!=(e=i.pop());)for(var r,s=e.children,a=0,o=s.length;a<o;++a)i.push((s[a]=r={_:s[a],parent:e,children:(r=s[a].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=r);return n.children[0]}(h);if(Ls(u,a),u.parent.m=-u.z,Ts(u,o),i)Ts(h,l);else{var d=h,_=h,f=h;Ts(h,function(t){t.x<d.x&&(d=t),t.x>_.x&&(_=t),t.depth>f.depth&&(f=t)});var g=e(d,_)/2-d.x,p=n[0]/(_.x+e(_,d)/2+g),m=n[1]/(f.depth||1);Ts(h,function(t){t.x=(t.x+g)*p,t.y=t.depth*m})}return c}function a(t){var n=t.children,i=t.parent.children,r=t.i?i[t.i-1]:null;if(n.length){!function(t){var e,n=0,i=0,r=t.children,s=r.length;for(;--s>=0;)(e=r[s]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}(t);var s=(n[0].z+n[n.length-1].z)/2;r?(t.z=r.z+e(t._,r._),t.m=t.z-s):t.z=s}else r&&(t.z=r.z+e(t._,r._));t.parent.A=function(t,n,i){if(n){for(var r,s=t,a=t,o=n,l=s.parent.children[0],c=s.m,h=a.m,u=o.m,d=l.m;o=aa(o),s=sa(s),o&&s;)l=sa(l),(a=aa(a)).a=t,(r=o.z+u-s.z-c+e(o._,s._))>0&&(oa(la(o,t,i),t,r),c+=r,h+=r),u+=o.m,c+=s.m,d+=l.m,h+=a.m;o&&!aa(a)&&(a.t=o,a.m+=u-h),s&&!sa(l)&&(l.t=s,l.m+=c-d,i=t)}return i}(t,r,t.parent.A||i[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function l(t){t.x*=n[0],t.y=t.depth*n[1]}return r.separation=function(t){return arguments.length?(e=t,r):e},r.size=function(t){return arguments.length?(i=null==(n=t)?l:null,r):i?null:n},r.nodeSize=function(t){return arguments.length?(i=null==(n=t)?null:l,r):i?n:null},Ss(r,t)},s.layout.cluster=function(){var t=s.layout.hierarchy().sort(null).value(null),e=ra,n=[1,1],i=!1;function r(r,a){var o,l=t.call(this,r,a),c=l[0],h=0;Ls(c,function(t){var n=t.children;n&&n.length?(t.x=function(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}(n),t.y=function(t){return 1+s.max(t,function(t){return t.y})}(n)):(t.x=o?h+=e(t,o):0,t.y=0,o=t)});var u=function t(e){var n=e.children;return n&&n.length?t(n[0]):e}(c),d=function t(e){var n,i=e.children;return i&&(n=i.length)?t(i[n-1]):e}(c),_=u.x-e(u,d)/2,f=d.x+e(d,u)/2;return Ls(c,i?function(t){t.x=(t.x-c.x)*n[0],t.y=(c.y-t.y)*n[1]}:function(t){t.x=(t.x-_)/(f-_)*n[0],t.y=(1-(c.y?t.y/c.y:1))*n[1]}),l}return r.separation=function(t){return arguments.length?(e=t,r):e},r.size=function(t){return arguments.length?(i=null==(n=t),r):i?null:n},r.nodeSize=function(t){return arguments.length?(i=null!=(n=t),r):i?n:null},Ss(r,t)},s.layout.treemap=function(){var t,e=s.layout.hierarchy(),n=Math.round,i=[1,1],r=null,a=ca,o=!1,l="squarify",c=.5*(1+Math.sqrt(5));function h(t,e){for(var n,i,r=-1,s=t.length;++r<s;)i=(n=t[r]).value*(e<0?0:e),n.area=isNaN(i)||i<=0?0:i}function u(t){var e=t.children;if(e&&e.length){var n,i,r,s=a(t),o=[],c=e.slice(),d=1/0,g="slice"===l?s.dx:"dice"===l?s.dy:"slice-dice"===l?1&t.depth?s.dy:s.dx:Math.min(s.dx,s.dy);for(h(c,s.dx*s.dy/t.value),o.area=0;(r=c.length)>0;)o.push(n=c[r-1]),o.area+=n.area,"squarify"!==l||(i=_(o,g))<=d?(c.pop(),d=i):(o.area-=o.pop().area,f(o,g,s,!1),g=Math.min(s.dx,s.dy),o.length=o.area=0,d=1/0);o.length&&(f(o,g,s,!0),o.length=o.area=0),e.forEach(u)}}function d(t){var e=t.children;if(e&&e.length){var n,i=a(t),r=e.slice(),s=[];for(h(r,i.dx*i.dy/t.value),s.area=0;n=r.pop();)s.push(n),s.area+=n.area,null!=n.z&&(f(s,n.z?i.dx:i.dy,i,!r.length),s.length=s.area=0);e.forEach(d)}}function _(t,e){for(var n,i=t.area,r=0,s=1/0,a=-1,o=t.length;++a<o;)(n=t[a].area)&&(n<s&&(s=n),n>r&&(r=n));return e*=e,(i*=i)?Math.max(e*r*c/i,i/(e*s*c)):1/0}function f(t,e,i,r){var s,a=-1,o=t.length,l=i.x,c=i.y,h=e?n(t.area/e):0;if(e==i.dx){for((r||h>i.dy)&&(h=i.dy);++a<o;)(s=t[a]).x=l,s.y=c,s.dy=h,l+=s.dx=Math.min(i.x+i.dx-l,h?n(s.area/h):0);s.z=!0,s.dx+=i.x+i.dx-l,i.y+=h,i.dy-=h}else{for((r||h>i.dx)&&(h=i.dx);++a<o;)(s=t[a]).x=l,s.y=c,s.dx=h,c+=s.dy=Math.min(i.y+i.dy-c,h?n(s.area/h):0);s.z=!1,s.dy+=i.y+i.dy-c,i.x+=h,i.dx-=h}}function g(n){var r=t||e(n),s=r[0];return s.x=s.y=0,s.value?(s.dx=i[0],s.dy=i[1]):s.dx=s.dy=0,t&&e.revalue(s),h([s],s.dx*s.dy/s.value),(t?d:u)(s),o&&(t=r),r}return g.size=function(t){return arguments.length?(i=t,g):i},g.padding=function(t){if(!arguments.length)return r;function e(e){return ha(e,t)}var n;return a=null==(r=t)?ca:"function"==(n=typeof t)?function(e){var n=t.call(g,e,e.depth);return null==n?ca(e):ha(e,"number"==typeof n?[n,n,n,n]:n)}:"number"===n?(t=[t,t,t,t],e):e,g},g.round=function(t){return arguments.length?(n=t?Math.round:Number,g):n!=Number},g.sticky=function(e){return arguments.length?(o=e,t=null,g):o},g.ratio=function(t){return arguments.length?(c=t,g):c},g.mode=function(t){return arguments.length?(l=t+"",g):l},Ss(g,e)},s.random={normal:function(t,e){var n=arguments.length;return n<2&&(e=1),n<1&&(t=0),function(){var n,i,r;do{r=(n=2*Math.random()-1)*n+(i=2*Math.random()-1)*i}while(!r||r>1);return t+e*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var t=s.random.normal.apply(s,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=s.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;n<t;n++)e+=Math.random();return e}}},s.scale={};var pa={floor:j,ceil:j};function ma(t,e,n,i){var r=[],a=[],o=0,l=Math.min(t.length,e.length)-1;for(t[l]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<=l;)r.push(n(t[o-1],t[o])),a.push(i(e[o-1],e[o]));return function(e){var n=s.bisect(t,e,1,l)-1;return a[n](r[n](e))}}function va(t,e){return s.rebind(t,e,"range","rangeRound","interpolate","clamp")}function ba(t,e){return fa(t,ga(ya(t,e)[2])),fa(t,ga(ya(t,e)[2])),t}function ya(t,e){null==e&&(e=10);var n=ua(t),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),s=e/i*r;return s<=.15?r*=10:s<=.35?r*=5:s<=.75&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function xa(t,e){return s.range.apply(s,ya(t,e))}function ka(t,e,n){var i=ya(t,e);if(n){var r=Ce.exec(n);if(r.shift(),"s"===r[8]){var a=s.formatPrefix(Math.max(k(i[0]),k(i[1])));return r[7]||(r[7]="."+Ma(a.scale(i[2]))),r[8]="f",n=s.format(r.join("")),function(t){return n(a.scale(t))+a.symbol}}r[7]||(r[7]="."+function(t,e){var n=Ma(e[2]);return t in wa?Math.abs(n-Ma(Math.max(k(e[0]),k(e[1]))))+ +("e"!==t):n-2*("%"===t)}(r[8],i)),n=r.join("")}else n=",."+Ma(i[2])+"f";return s.format(n)}s.scale.linear=function(){return function t(e,n,i,r){var s,a;function o(){var t=Math.min(e.length,n.length)>2?ma:_a,o=r?bs:vs;return s=t(e,n,o,i),a=t(n,e,o,$r),l}function l(t){return s(t)}l.invert=function(t){return a(t)};l.domain=function(t){return arguments.length?(e=t.map(Number),o()):e};l.range=function(t){return arguments.length?(n=t,o()):n};l.rangeRound=function(t){return l.range(t).interpolate(us)};l.clamp=function(t){return arguments.length?(r=t,o()):r};l.interpolate=function(t){return arguments.length?(i=t,o()):i};l.ticks=function(t){return xa(e,t)};l.tickFormat=function(t,n){return ka(e,t,n)};l.nice=function(t){return ba(e,t),o()};l.copy=function(){return t(e,n,i,r)};return o()}([0,1],[0,1],$r,!1)};var wa={s:1,g:1,p:1,r:1,e:1};function Ma(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}s.scale.log=function(){return function t(e,n,i,r){function a(t){return(i?Math.log(t<0?0:t):-Math.log(t>0?0:-t))/Math.log(n)}function o(t){return i?Math.pow(n,t):-Math.pow(n,-t)}function l(t){return e(a(t))}l.invert=function(t){return o(e.invert(t))};l.domain=function(t){return arguments.length?(i=t[0]>=0,e.domain((r=t.map(Number)).map(a)),l):r};l.base=function(t){return arguments.length?(n=+t,e.domain(r.map(a)),l):n};l.nice=function(){var t=fa(r.map(a),i?Math:qa);return e.domain(t),r=t.map(o),l};l.ticks=function(){var t=ua(r),e=[],s=t[0],l=t[1],c=Math.floor(a(s)),h=Math.ceil(a(l)),u=n%1?2:n;if(isFinite(h-c)){if(i){for(;c<h;c++)for(var d=1;d<u;d++)e.push(o(c)*d);e.push(o(c))}else for(e.push(o(c));c++<h;)for(var d=u-1;d>0;d--)e.push(o(c)*d);for(c=0;e[c]<s;c++);for(h=e.length;e[h-1]>l;h--);e=e.slice(c,h)}return e};l.tickFormat=function(t,e){if(!arguments.length)return Aa;arguments.length<2?e=Aa:"function"!=typeof e&&(e=s.format(e));var i=Math.max(1,n*t/l.ticks().length);return function(t){var r=t/o(Math.round(a(t)));return r*n<n-.5&&(r*=n),r<=i?e(t):""}};l.copy=function(){return t(e.copy(),n,i,r)};return va(l,e)}(s.scale.linear().domain([0,1]),10,!0,[1,10])};var Aa=s.format(".0e"),qa={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};function za(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}s.scale.pow=function(){return function t(e,n,i){var r=za(n),s=za(1/n);function a(t){return e(r(t))}a.invert=function(t){return s(e.invert(t))};a.domain=function(t){return arguments.length?(e.domain((i=t.map(Number)).map(r)),a):i};a.ticks=function(t){return xa(i,t)};a.tickFormat=function(t,e){return ka(i,t,e)};a.nice=function(t){return a.domain(ba(i,t))};a.exponent=function(t){return arguments.length?(r=za(n=t),s=za(1/n),e.domain(i.map(r)),a):n};a.copy=function(){return t(e.copy(),n,i)};return va(a,e)}(s.scale.linear(),1,[0,1])},s.scale.sqrt=function(){return s.scale.pow().exponent(.5)},s.scale.ordinal=function(){return function t(e,n){var i,r,a;function o(t){return r[((i.get(t)||("range"===n.t?i.set(t,e.push(t)):NaN))-1)%r.length]}function l(t,n){return s.range(e.length).map(function(e){return t+n*e})}o.domain=function(t){if(!arguments.length)return e;e=[],i=new M;for(var r,s=-1,a=t.length;++s<a;)i.has(r=t[s])||i.set(r,e.push(r));return o[n.t].apply(o,n.a)};o.range=function(t){return arguments.length?(r=t,a=0,n={t:"range",a:arguments},o):r};o.rangePoints=function(t,i){arguments.length<2&&(i=0);var s=t[0],c=t[1],h=e.length<2?(s=(s+c)/2,0):(c-s)/(e.length-1+i);return r=l(s+h*i/2,h),a=0,n={t:"rangePoints",a:arguments},o};o.rangeRoundPoints=function(t,i){arguments.length<2&&(i=0);var s=t[0],c=t[1],h=e.length<2?(s=c=Math.round((s+c)/2),0):(c-s)/(e.length-1+i)|0;return r=l(s+Math.round(h*i/2+(c-s-(e.length-1+i)*h)/2),h),a=0,n={t:"rangeRoundPoints",a:arguments},o};o.rangeBands=function(t,i,s){arguments.length<2&&(i=0),arguments.length<3&&(s=i);var c=t[1]<t[0],h=t[c-0],u=t[1-c],d=(u-h)/(e.length-i+2*s);return r=l(h+d*s,d),c&&r.reverse(),a=d*(1-i),n={t:"rangeBands",a:arguments},o};o.rangeRoundBands=function(t,i,s){arguments.length<2&&(i=0),arguments.length<3&&(s=i);var c=t[1]<t[0],h=t[c-0],u=t[1-c],d=Math.floor((u-h)/(e.length-i+2*s));return r=l(h+Math.round((u-h-(e.length-i)*d)/2),d),c&&r.reverse(),a=Math.round(d*(1-i)),n={t:"rangeRoundBands",a:arguments},o};o.rangeBand=function(){return a};o.rangeExtent=function(){return ua(n.a[0])};o.copy=function(){return t(e,n)};return o.domain(e)}([],{t:"range",a:[[]]})},s.scale.category10=function(){return s.scale.ordinal().range(Ea)},s.scale.category20=function(){return s.scale.ordinal().range(Sa)},s.scale.category20b=function(){return s.scale.ordinal().range(Ta)},s.scale.category20c=function(){return s.scale.ordinal().range(La)};var Ea=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ue),Sa=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ue),Ta=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ue),La=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ue);function Na(){return 0}s.scale.quantile=function(){return function t(e,n){var i;function r(){var t=0,r=n.length;for(i=[];++t<r;)i[t-1]=s.quantile(e,t/r);return a}function a(t){if(!isNaN(t=+t))return n[s.bisect(i,t)]}a.domain=function(t){return arguments.length?(e=t.map(m).filter(v).sort(p),r()):e};a.range=function(t){return arguments.length?(n=t,r()):n};a.quantiles=function(){return i};a.invertExtent=function(t){return(t=n.indexOf(t))<0?[NaN,NaN]:[t>0?i[t-1]:e[0],t<i.length?i[t]:e[e.length-1]]};a.copy=function(){return t(e,n)};return r()}([],[])},s.scale.quantize=function(){return function t(e,n,i){var r,s;function a(t){return i[Math.max(0,Math.min(s,Math.floor(r*(t-e))))]}function o(){return r=i.length/(n-e),s=i.length-1,a}a.domain=function(t){return arguments.length?(e=+t[0],n=+t[t.length-1],o()):[e,n]};a.range=function(t){return arguments.length?(i=t,o()):i};a.invertExtent=function(t){return[t=(t=i.indexOf(t))<0?NaN:t/r+e,t+1/r]};a.copy=function(){return t(e,n,i)};return o()}(0,1,[0,1])},s.scale.threshold=function(){return function t(e,n){function i(t){if(t<=t)return n[s.bisect(e,t)]}i.domain=function(t){return arguments.length?(e=t,i):e};i.range=function(t){return arguments.length?(n=t,i):n};i.invertExtent=function(t){return t=n.indexOf(t),[e[t-1],e[t]]};i.copy=function(){return t(e,n)};return i}([.5],[0,1])},s.scale.identity=function(){return function t(e){function n(t){return+t}n.invert=n;n.domain=n.range=function(t){return arguments.length?(e=t.map(n),n):e};n.ticks=function(t){return xa(e,t)};n.tickFormat=function(t,n){return ka(e,t,n)};n.copy=function(){return t(e)};return n}([0,1])},s.svg={},s.svg.arc=function(){var t=Ca,e=ja,n=Na,i=Oa,r=Ba,s=Pa,a=Da;function o(){var o=Math.max(0,+t.apply(this,arguments)),c=Math.max(0,+e.apply(this,arguments)),h=r.apply(this,arguments)-Nt,u=s.apply(this,arguments)-Nt,d=Math.abs(u-h),_=h>u?0:1;if(c<o&&(f=c,c=o,o=f),d>=Lt)return l(c,_)+(o?l(o,1-_):"")+"Z";var f,g,p,m,v,b,y,x,k,w,M,A,q=0,z=0,E=[];if((m=(+a.apply(this,arguments)||0)/2)&&(p=i===Oa?Math.sqrt(o*o+c*c):+i.apply(this,arguments),_||(z*=-1),c&&(z=Dt(p/c*Math.sin(m))),o&&(q=Dt(p/o*Math.sin(m)))),c){v=c*Math.cos(h+z),b=c*Math.sin(h+z),y=c*Math.cos(u-z),x=c*Math.sin(u-z);var S=Math.abs(u-h-2*z)<=St?0:1;if(z&&Ra(v,b,y,x)===_^S){var T=(h+u)/2;v=c*Math.cos(T),b=c*Math.sin(T),y=x=null}}else v=b=0;if(o){k=o*Math.cos(u-q),w=o*Math.sin(u-q),M=o*Math.cos(h+q),A=o*Math.sin(h+q);var L=Math.abs(h-u+2*q)<=St?0:1;if(q&&Ra(k,w,M,A)===1-_^L){var N=(h+u)/2;k=o*Math.cos(N),w=o*Math.sin(N),M=A=null}}else k=w=0;if(d>zt&&(f=Math.min(Math.abs(c-o)/2,+n.apply(this,arguments)))>.001){g=o<c^_?0:1;var O=f,C=f;if(d<St){var j=null==M?[k,w]:null==y?[v,b]:cr([v,b],[M,A],[y,x],[k,w]),B=v-j[0],P=b-j[1],D=y-j[0],R=x-j[1],F=1/Math.sin(Math.acos((B*D+P*R)/(Math.sqrt(B*B+P*P)*Math.sqrt(D*D+R*R)))/2),I=Math.sqrt(j[0]*j[0]+j[1]*j[1]);C=Math.min(f,(o-I)/(F-1)),O=Math.min(f,(c-I)/(F+1))}if(null!=y){var U=Fa(null==M?[k,w]:[M,A],[v,b],c,O,_),H=Fa([y,x],[k,w],c,O,_);f===O?E.push("M",U[0],"A",O,",",O," 0 0,",g," ",U[1],"A",c,",",c," 0 ",1-_^Ra(U[1][0],U[1][1],H[1][0],H[1][1]),",",_," ",H[1],"A",O,",",O," 0 0,",g," ",H[0]):E.push("M",U[0],"A",O,",",O," 0 1,",g," ",H[0])}else E.push("M",v,",",b);if(null!=M){var Y=Fa([v,b],[M,A],o,-C,_),V=Fa([k,w],null==y?[v,b]:[y,x],o,-C,_);f===C?E.push("L",V[0],"A",C,",",C," 0 0,",g," ",V[1],"A",o,",",o," 0 ",_^Ra(V[1][0],V[1][1],Y[1][0],Y[1][1]),",",1-_," ",Y[1],"A",C,",",C," 0 0,",g," ",Y[0]):E.push("L",V[0],"A",C,",",C," 0 0,",g," ",Y[0])}else E.push("L",k,",",w)}else E.push("M",v,",",b),null!=y&&E.push("A",c,",",c," 0 ",S,",",_," ",y,",",x),E.push("L",k,",",w),null!=M&&E.push("A",o,",",o," 0 ",L,",",1-_," ",M,",",A);return E.push("Z"),E.join("")}function l(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}return o.innerRadius=function(e){return arguments.length?(t=ye(e),o):t},o.outerRadius=function(t){return arguments.length?(e=ye(t),o):e},o.cornerRadius=function(t){return arguments.length?(n=ye(t),o):n},o.padRadius=function(t){return arguments.length?(i=t==Oa?Oa:ye(t),o):i},o.startAngle=function(t){return arguments.length?(r=ye(t),o):r},o.endAngle=function(t){return arguments.length?(s=ye(t),o):s},o.padAngle=function(t){return arguments.length?(a=ye(t),o):a},o.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-Nt;return[Math.cos(i)*n,Math.sin(i)*n]},o};var Oa="auto";function Ca(t){return t.innerRadius}function ja(t){return t.outerRadius}function Ba(t){return t.startAngle}function Pa(t){return t.endAngle}function Da(t){return t&&t.padAngle}function Ra(t,e,n,i){return(t-n)*e-(e-i)*t>0?0:1}function Fa(t,e,n,i,r){var s=t[0]-e[0],a=t[1]-e[1],o=(r?i:-i)/Math.sqrt(s*s+a*a),l=o*a,c=-o*s,h=t[0]+l,u=t[1]+c,d=e[0]+l,_=e[1]+c,f=(h+d)/2,g=(u+_)/2,p=d-h,m=_-u,v=p*p+m*m,b=n-i,y=h*_-d*u,x=(m<0?-1:1)*Math.sqrt(Math.max(0,b*b*v-y*y)),k=(y*m-p*x)/v,w=(-y*p-m*x)/v,M=(y*m+p*x)/v,A=(-y*p+m*x)/v,q=k-f,z=w-g,E=M-f,S=A-g;return q*q+z*z>E*E+S*S&&(k=M,w=A),[[k-l,w-c],[k*n/b,w*n/b]]}function Ia(t){var e=ir,n=rr,i=$n,r=Ha,s=r.key,a=.7;function o(s){var o,l=[],c=[],h=-1,u=s.length,d=ye(e),_=ye(n);function f(){l.push("M",r(t(c),a))}for(;++h<u;)i.call(this,o=s[h],h)?c.push([+d.call(this,o,h),+_.call(this,o,h)]):c.length&&(f(),c=[]);return c.length&&f(),l.length?l.join(""):null}return o.x=function(t){return arguments.length?(e=t,o):e},o.y=function(t){return arguments.length?(n=t,o):n},o.defined=function(t){return arguments.length?(i=t,o):i},o.interpolate=function(t){return arguments.length?(s="function"==typeof t?r=t:(r=Ua.get(t)||Ha).key,o):s},o.tension=function(t){return arguments.length?(a=t,o):a},o}s.svg.line=function(){return Ia(j)};var Ua=s.map({linear:Ha,"linear-closed":Ya,step:function(t){var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];for(;++e<n;)r.push("H",(i[0]+(i=t[e])[0])/2,"V",i[1]);n>1&&r.push("H",i[0]);return r.join("")},"step-before":Va,"step-after":Wa,basis:Ka,"basis-open":function(t){if(t.length<4)return Ha(t);var e,n=[],i=-1,r=t.length,s=[0],a=[0];for(;++i<3;)e=t[i],s.push(e[0]),a.push(e[1]);n.push(Xa(Qa,s)+","+Xa(Qa,a)),--i;for(;++i<r;)e=t[i],s.shift(),s.push(e[0]),a.shift(),a.push(e[1]),to(n,s,a);return n.join("")},"basis-closed":function(t){var e,n,i=-1,r=t.length,s=r+4,a=[],o=[];for(;++i<4;)n=t[i%r],a.push(n[0]),o.push(n[1]);e=[Xa(Qa,a),",",Xa(Qa,o)],--i;for(;++i<s;)n=t[i%r],a.shift(),a.push(n[0]),o.shift(),o.push(n[1]),to(e,a,o);return e.join("")},bundle:function(t,e){var n=t.length-1;if(n)for(var i,r,s=t[0][0],a=t[0][1],o=t[n][0]-s,l=t[n][1]-a,c=-1;++c<=n;)i=t[c],r=c/n,i[0]=e*i[0]+(1-e)*(s+r*o),i[1]=e*i[1]+(1-e)*(a+r*l);return Ka(t)},cardinal:function(t,e){return t.length<3?Ha(t):t[0]+Ga(t,Za(t,e))},"cardinal-open":function(t,e){return t.length<4?Ha(t):t[1]+Ga(t.slice(1,-1),Za(t,e))},"cardinal-closed":function(t,e){return t.length<3?Ya(t):t[0]+Ga((t.push(t[0]),t),Za([t[t.length-2]].concat(t,[t[1]]),e))},monotone:function(t){return t.length<3?Ha(t):t[0]+Ga(t,function(t){var e,n,i,r,s=[],a=function(t){var e=0,n=t.length-1,i=[],r=t[0],s=t[1],a=i[0]=eo(r,s);for(;++e<n;)i[e]=(a+(a=eo(r=s,s=t[e+1])))/2;return i[e]=a,i}(t),o=-1,l=t.length-1;for(;++o<l;)e=eo(t[o],t[o+1]),k(e)<zt?a[o]=a[o+1]=0:(n=a[o]/e,i=a[o+1]/e,(r=n*n+i*i)>9&&(r=3*e/Math.sqrt(r),a[o]=r*n,a[o+1]=r*i));o=-1;for(;++o<=l;)r=(t[Math.min(l,o+1)][0]-t[Math.max(0,o-1)][0])/(6*(1+a[o]*a[o])),s.push([r||0,a[o]*r||0]);return s}(t))}});function Ha(t){return t.length>1?t.join("L"):t+"Z"}function Ya(t){return t.join("L")+"Z"}function Va(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("V",(i=t[e])[1],"H",i[0]);return r.join("")}function Wa(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i=t[e])[0],"V",i[1]);return r.join("")}function Ga(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return Ha(t);var n=t.length!=e.length,i="",r=t[0],s=t[1],a=e[0],o=a,l=1;if(n&&(i+="Q"+(s[0]-2*a[0]/3)+","+(s[1]-2*a[1]/3)+","+s[0]+","+s[1],r=t[1],l=2),e.length>1){o=e[1],s=t[l],l++,i+="C"+(r[0]+a[0])+","+(r[1]+a[1])+","+(s[0]-o[0])+","+(s[1]-o[1])+","+s[0]+","+s[1];for(var c=2;c<e.length;c++,l++)s=t[l],o=e[c],i+="S"+(s[0]-o[0])+","+(s[1]-o[1])+","+s[0]+","+s[1]}if(n){var h=t[l];i+="Q"+(s[0]+2*o[0]/3)+","+(s[1]+2*o[1]/3)+","+h[0]+","+h[1]}return i}function Za(t,e){for(var n,i=[],r=(1-e)/2,s=t[0],a=t[1],o=1,l=t.length;++o<l;)n=s,s=a,a=t[o],i.push([r*(a[0]-n[0]),r*(a[1]-n[1])]);return i}function Ka(t){if(t.length<3)return Ha(t);var e=1,n=t.length,i=t[0],r=i[0],s=i[1],a=[r,r,r,(i=t[1])[0]],o=[s,s,s,i[1]],l=[r,",",s,"L",Xa(Qa,a),",",Xa(Qa,o)];for(t.push(t[n-1]);++e<=n;)i=t[e],a.shift(),a.push(i[0]),o.shift(),o.push(i[1]),to(l,a,o);return t.pop(),l.push("L",i),l.join("")}function Xa(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}Ua.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var $a=[0,2/3,1/3,0],Ja=[0,1/3,2/3,0],Qa=[0,1/6,2/3,1/6];function to(t,e,n){t.push("C",Xa($a,e),",",Xa($a,n),",",Xa(Ja,e),",",Xa(Ja,n),",",Xa(Qa,e),",",Xa(Qa,n))}function eo(t,e){return(e[1]-t[1])/(e[0]-t[0])}function no(t){for(var e,n,i,r=-1,s=t.length;++r<s;)n=(e=t[r])[0],i=e[1]-Nt,e[0]=n*Math.cos(i),e[1]=n*Math.sin(i);return t}function io(t){var e=ir,n=ir,i=0,r=rr,s=$n,a=Ha,o=a.key,l=a,c="L",h=.7;function u(o){var u,d,_,f=[],g=[],p=[],m=-1,v=o.length,b=ye(e),y=ye(i),x=e===n?function(){return d}:ye(n),k=i===r?function(){return _}:ye(r);function w(){f.push("M",a(t(p),h),c,l(t(g.reverse()),h),"Z")}for(;++m<v;)s.call(this,u=o[m],m)?(g.push([d=+b.call(this,u,m),_=+y.call(this,u,m)]),p.push([+x.call(this,u,m),+k.call(this,u,m)])):g.length&&(w(),g=[],p=[]);return g.length&&w(),f.length?f.join(""):null}return u.x=function(t){return arguments.length?(e=n=t,u):n},u.x0=function(t){return arguments.length?(e=t,u):e},u.x1=function(t){return arguments.length?(n=t,u):n},u.y=function(t){return arguments.length?(i=r=t,u):r},u.y0=function(t){return arguments.length?(i=t,u):i},u.y1=function(t){return arguments.length?(r=t,u):r},u.defined=function(t){return arguments.length?(s=t,u):s},u.interpolate=function(t){return arguments.length?(o="function"==typeof t?a=t:(a=Ua.get(t)||Ha).key,l=a.reverse||a,c=a.closed?"M":"L",u):o},u.tension=function(t){return arguments.length?(h=t,u):h},u}function ro(t){return t.radius}function so(t){return[t.x,t.y]}function ao(){return 64}function oo(){return"circle"}function lo(t){var e=Math.sqrt(t/St);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}s.svg.line.radial=function(){var t=Ia(no);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},Va.reverse=Wa,Wa.reverse=Va,s.svg.area=function(){return io(j)},s.svg.area.radial=function(){var t=io(no);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},s.svg.chord=function(){var t=Hi,e=Yi,n=ro,i=Ba,r=Pa;function s(n,i){var r=a(this,t,n,i),s=a(this,e,n,i);return"M"+r.p0+o(r.r,r.p1,r.a1-r.a0)+(function(t,e){return t.a0==e.a0&&t.a1==e.a1}(r,s)?l(r.r,r.p1,r.r,r.p0):l(r.r,r.p1,s.r,s.p0)+o(s.r,s.p1,s.a1-s.a0)+l(s.r,s.p1,r.r,r.p0))+"Z"}function a(t,e,s,a){var o=e.call(t,s,a),l=n.call(t,o,a),c=i.call(t,o,a)-Nt,h=r.call(t,o,a)-Nt;return{r:l,a0:c,a1:h,p0:[l*Math.cos(c),l*Math.sin(c)],p1:[l*Math.cos(h),l*Math.sin(h)]}}function o(t,e,n){return"A"+t+","+t+" 0 "+ +(n>St)+",1 "+e}function l(t,e,n,i){return"Q 0,0 "+i}return s.radius=function(t){return arguments.length?(n=ye(t),s):n},s.source=function(e){return arguments.length?(t=ye(e),s):t},s.target=function(t){return arguments.length?(e=ye(t),s):e},s.startAngle=function(t){return arguments.length?(i=ye(t),s):i},s.endAngle=function(t){return arguments.length?(r=ye(t),s):r},s},s.svg.diagonal=function(){var t=Hi,e=Yi,n=so;function i(i,r){var s=t.call(this,i,r),a=e.call(this,i,r),o=(s.y+a.y)/2,l=[s,{x:s.x,y:o},{x:a.x,y:o},a];return"M"+(l=l.map(n))[0]+"C"+l[1]+" "+l[2]+" "+l[3]}return i.source=function(e){return arguments.length?(t=ye(e),i):t},i.target=function(t){return arguments.length?(e=ye(t),i):e},i.projection=function(t){return arguments.length?(n=t,i):n},i},s.svg.diagonal.radial=function(){var t=s.svg.diagonal(),e=so,n=t.projection;return t.projection=function(t){return arguments.length?n(function(t){return function(){var e=t.apply(this,arguments),n=e[0],i=e[1]-Nt;return[n*Math.cos(i),n*Math.sin(i)]}}(e=t)):e},t},s.svg.symbol=function(){var t=oo,e=ao;function n(n,i){return(co.get(t.call(this,n,i))||lo)(e.call(this,n,i))}return n.type=function(e){return arguments.length?(t=ye(e),n):t},n.size=function(t){return arguments.length?(e=ye(t),n):e},n};var co=s.map({circle:lo,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*uo)),n=e*uo;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/ho),n=e*ho/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/ho),n=e*ho/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});s.svg.symbolTypes=co.keys();var ho=Math.sqrt(3),uo=Math.tan(30*Ot);$.transition=function(t){for(var e,n,i=po||++bo,r=ko(t),s=[],a=mo||{time:Date.now(),ease:as,delay:0,duration:250},o=-1,l=this.length;++o<l;){s.push(e=[]);for(var c=this[o],h=-1,u=c.length;++h<u;)(n=c[h])&&wo(n,h,r,i,a),e.push(n)}return go(s,r,i)},$.interrupt=function(t){return this.each(null==t?_o:fo(ko(t)))};var _o=fo(ko());function fo(t){return function(){var e,n,i;(e=this[t])&&(i=e[n=e.active])&&(i.timer.c=null,i.timer.t=NaN,--e.count?delete e[n]:delete this[t],e.active+=.5,i.event&&i.event.interrupt.call(this,this.__data__,i.index))}}function go(t,e,n){return W(t,vo),t.namespace=e,t.id=n,t}var po,mo,vo=[],bo=0;function yo(t,e,n,i){var r=t.id,s=t.namespace;return ft(t,"function"==typeof n?function(t,a,o){t[s][r].tween.set(e,i(n.call(t,t.__data__,a,o)))}:(n=i(n),function(t){t[s][r].tween.set(e,n)}))}function xo(t){return null==t&&(t=""),function(){this.textContent=t}}function ko(t){return null==t?"__transition__":"__transition_"+t+"__"}function wo(t,e,n,i,r){var s,a,o,l,c,h=t[n]||(t[n]={active:0,count:0}),u=h[i];function d(n){var r=h.active,d=h[r];for(var f in d&&(d.timer.c=null,d.timer.t=NaN,--h.count,delete h[r],d.event&&d.event.interrupt.call(t,t.__data__,d.index)),h)if(+f<i){var g=h[f];g.timer.c=null,g.timer.t=NaN,--h.count,delete h[f]}a.c=_,Ee(function(){return a.c&&_(n||1)&&(a.c=null,a.t=NaN),1},0,s),h.active=i,u.event&&u.event.start.call(t,t.__data__,e),c=[],u.tween.forEach(function(n,i){(i=i.call(t,t.__data__,e))&&c.push(i)}),l=u.ease,o=u.duration}function _(r){for(var s=r/o,a=l(s),d=c.length;d>0;)c[--d].call(t,a);if(s>=1)return u.event&&u.event.end.call(t,t.__data__,e),--h.count?delete h[i]:delete t[n],1}u||(s=r.time,a=Ee(function(t){var e=u.delay;if(a.t=e+s,e<=t)return d(t-e);a.c=d},0,s),u=h[i]={tween:new M,time:s,timer:a,delay:r.delay,duration:r.duration,ease:r.ease,index:e},r=null,++h.count)}vo.call=$.call,vo.empty=$.empty,vo.node=$.node,vo.size=$.size,s.transition=function(t,e){return t&&t.transition?po?t.transition(e):t:s.selection().transition(t)},s.transition.prototype=vo,vo.select=function(t){var e,n,i,r=this.id,s=this.namespace,a=[];t=J(t);for(var o=-1,l=this.length;++o<l;){a.push(e=[]);for(var c=this[o],h=-1,u=c.length;++h<u;)(i=c[h])&&(n=t.call(i,i.__data__,h,o))?("__data__"in i&&(n.__data__=i.__data__),wo(n,h,s,r,i[s][r]),e.push(n)):e.push(null)}return go(a,s,r)},vo.selectAll=function(t){var e,n,i,r,s,a=this.id,o=this.namespace,l=[];t=Q(t);for(var c=-1,h=this.length;++c<h;)for(var u=this[c],d=-1,_=u.length;++d<_;)if(i=u[d]){s=i[o][a],n=t.call(i,i.__data__,d,c),l.push(e=[]);for(var f=-1,g=n.length;++f<g;)(r=n[f])&&wo(r,f,o,a,s),e.push(r)}return go(l,o,a)},vo.filter=function(t){var e,n,i=[];"function"!=typeof t&&(t=_t(t));for(var r=0,s=this.length;r<s;r++){i.push(e=[]);for(var a,o=0,l=(a=this[r]).length;o<l;o++)(n=a[o])&&t.call(n,n.__data__,o,r)&&e.push(n)}return go(i,this.namespace,this.id)},vo.tween=function(t,e){var n=this.id,i=this.namespace;return arguments.length<2?this.node()[i][n].tween.get(t):ft(this,null==e?function(e){e[i][n].tween.remove(t)}:function(r){r[i][n].tween.set(t,e)})},vo.attr=function(t,e){if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var n="transform"==t?ms:$r,i=s.ns.qualify(t);function r(){this.removeAttribute(i)}function a(){this.removeAttributeNS(i.space,i.local)}return yo(this,"attr."+t,e,i.local?function(t){return null==t?a:(t+="",function(){var e,r=this.getAttributeNS(i.space,i.local);return r!==t&&(e=n(r,t),function(t){this.setAttributeNS(i.space,i.local,e(t))})})}:function(t){return null==t?r:(t+="",function(){var e,r=this.getAttribute(i);return r!==t&&(e=n(r,t),function(t){this.setAttribute(i,e(t))})})})},vo.attrTween=function(t,e){var n=s.ns.qualify(t);return this.tween("attr."+t,n.local?function(t,i){var r=e.call(this,t,i,this.getAttributeNS(n.space,n.local));return r&&function(t){this.setAttributeNS(n.space,n.local,r(t))}}:function(t,i){var r=e.call(this,t,i,this.getAttribute(n));return r&&function(t){this.setAttribute(n,r(t))}})},vo.style=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=""),t)this.style(n,t[n],e);return this}n=""}function r(){this.style.removeProperty(t)}return yo(this,"style."+t,e,function(e){return null==e?r:(e+="",function(){var i,r=h(this).getComputedStyle(this,null).getPropertyValue(t);return r!==e&&(i=$r(r,e),function(e){this.style.setProperty(t,i(e),n)})})})},vo.styleTween=function(t,e,n){return arguments.length<3&&(n=""),this.tween("style."+t,function(i,r){var s=e.call(this,i,r,h(this).getComputedStyle(this,null).getPropertyValue(t));return s&&function(e){this.style.setProperty(t,s(e),n)}})},vo.text=function(t){return yo(this,"text",t,xo)},vo.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)})},vo.ease=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].ease:("function"!=typeof t&&(t=s.ease.apply(s,arguments)),ft(this,function(i){i[n][e].ease=t}))},vo.delay=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].delay:ft(this,"function"==typeof t?function(i,r,s){i[n][e].delay=+t.call(i,i.__data__,r,s)}:(t=+t,function(i){i[n][e].delay=t}))},vo.duration=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].duration:ft(this,"function"==typeof t?function(i,r,s){i[n][e].duration=Math.max(1,t.call(i,i.__data__,r,s))}:(t=Math.max(1,t),function(i){i[n][e].duration=t}))},vo.each=function(t,e){var n=this.id,i=this.namespace;if(arguments.length<2){var r=mo,a=po;try{po=n,ft(this,function(e,r,s){mo=e[i][n],t.call(e,e.__data__,r,s)})}finally{mo=r,po=a}}else ft(this,function(r){var a=r[i][n];(a.event||(a.event=s.dispatch("start","end","interrupt"))).on(t,e)});return this},vo.transition=function(){for(var t,e,n,i=this.id,r=++bo,s=this.namespace,a=[],o=0,l=this.length;o<l;o++){a.push(t=[]);for(var c,h=0,u=(c=this[o]).length;h<u;h++)(e=c[h])&&wo(e,h,s,r,{time:(n=e[s][i]).time,ease:n.ease,delay:n.delay+n.duration,duration:n.duration}),t.push(e)}return go(a,s,r)},s.svg.axis=function(){var t,e=s.scale.linear(),n=Mo,i=6,r=6,a=3,l=[10],c=null;function h(o){o.each(function(){var o,h=s.select(this),u=this.__chart__||e,d=this.__chart__=e.copy(),_=null==c?d.ticks?d.ticks.apply(d,l):d.domain():c,f=null==t?d.tickFormat?d.tickFormat.apply(d,l):j:t,g=h.selectAll(".tick").data(_,d),p=g.enter().insert("g",".domain").attr("class","tick").style("opacity",zt),m=s.transition(g.exit()).style("opacity",zt).remove(),v=s.transition(g.order()).style("opacity",1),b=Math.max(i,0)+a,y=da(d),x=h.selectAll(".domain").data([0]),k=(x.enter().append("path").attr("class","domain"),s.transition(x));p.append("line"),p.append("text");var w,M,A,q,z=p.select("line"),E=v.select("line"),S=g.select("text").text(f),T=p.select("text"),L=v.select("text"),N="top"===n||"left"===n?-1:1;if("bottom"===n||"top"===n?(o=qo,w="x",A="y",M="x2",q="y2",S.attr("dy",N<0?"0em":".71em").style("text-anchor","middle"),k.attr("d","M"+y[0]+","+N*r+"V0H"+y[1]+"V"+N*r)):(o=zo,w="y",A="x",M="y2",q="x2",S.attr("dy",".32em").style("text-anchor",N<0?"end":"start"),k.attr("d","M"+N*r+","+y[0]+"H0V"+y[1]+"H"+N*r)),z.attr(q,N*i),T.attr(A,N*b),E.attr(M,0).attr(q,N*i),L.attr(w,0).attr(A,N*b),d.rangeBand){var O=d,C=O.rangeBand()/2;u=d=function(t){return O(t)+C}}else u.rangeBand?u=d:m.call(o,d,u);p.call(o,u,d),v.call(o,d,d)})}return h.scale=function(t){return arguments.length?(e=t,h):e},h.orient=function(t){return arguments.length?(n=t in Ao?t+"":Mo,h):n},h.ticks=function(){return arguments.length?(l=o(arguments),h):l},h.tickValues=function(t){return arguments.length?(c=t,h):c},h.tickFormat=function(e){return arguments.length?(t=e,h):t},h.tickSize=function(t){var e=arguments.length;return e?(i=+t,r=+arguments[e-1],h):i},h.innerTickSize=function(t){return arguments.length?(i=+t,h):i},h.outerTickSize=function(t){return arguments.length?(r=+t,h):r},h.tickPadding=function(t){return arguments.length?(a=+t,h):a},h.tickSubdivide=function(){return arguments.length&&h},h};var Mo="bottom",Ao={top:1,right:1,bottom:1,left:1};function qo(t,e,n){t.attr("transform",function(t){var i=e(t);return"translate("+(isFinite(i)?i:n(t))+",0)"})}function zo(t,e,n){t.attr("transform",function(t){var i=e(t);return"translate(0,"+(isFinite(i)?i:n(t))+")"})}s.svg.brush=function(){var t,e,n=Y(d,"brushstart","brush","brushend"),i=null,r=null,a=[0,0],o=[0,0],l=!0,c=!0,u=So[0];function d(t){t.each(function(){var t=s.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",p).on("touchstart.brush",p),e=t.selectAll(".background").data([0]);e.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var n=t.selectAll(".resize").data(u,j);n.exit().remove(),n.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Eo[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),n.style("display",d.empty()?"none":null);var a,o=s.transition(t),l=s.transition(e);i&&(a=da(i),l.attr("x",a[0]).attr("width",a[1]-a[0]),f(o)),r&&(a=da(r),l.attr("y",a[0]).attr("height",a[1]-a[0]),g(o)),_(o)})}function _(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+a[+/e$/.test(t)]+","+o[+/^s/.test(t)]+")"})}function f(t){t.select(".extent").attr("x",a[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",a[1]-a[0])}function g(t){t.select(".extent").attr("y",o[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",o[1]-o[0])}function p(){var u,p,m=this,v=s.select(s.event.target),b=n.of(m,arguments),y=s.select(m),x=v.datum(),k=!/^(n|s)$/.test(x)&&i,w=!/^(e|w)$/.test(x)&&r,M=v.classed("extent"),A=wt(m),q=s.mouse(m),z=s.select(h(m)).on("keydown.brush",function(){32==s.event.keyCode&&(M||(u=null,q[0]-=a[1],q[1]-=o[1],M=2),U())}).on("keyup.brush",function(){32==s.event.keyCode&&2==M&&(q[0]+=a[1],q[1]+=o[1],M=0,U())});if(s.event.changedTouches?z.on("touchmove.brush",T).on("touchend.brush",N):z.on("mousemove.brush",T).on("mouseup.brush",N),y.interrupt().selectAll("*").interrupt(),M)q[0]=a[0]-q[0],q[1]=o[0]-q[1];else if(x){var E=+/w$/.test(x),S=+/^n/.test(x);p=[a[1-E]-q[0],o[1-S]-q[1]],q[0]=a[E],q[1]=o[S]}else s.event.altKey&&(u=q.slice());function T(){var t=s.mouse(m),e=!1;p&&(t[0]+=p[0],t[1]+=p[1]),M||(s.event.altKey?(u||(u=[(a[0]+a[1])/2,(o[0]+o[1])/2]),q[0]=a[+(t[0]<u[0])],q[1]=o[+(t[1]<u[1])]):u=null),k&&L(t,i,0)&&(f(y),e=!0),w&&L(t,r,1)&&(g(y),e=!0),e&&(_(y),b({type:"brush",mode:M?"move":"resize"}))}function L(n,i,r){var s,h,d=da(i),_=d[0],f=d[1],g=q[r],p=r?o:a,m=p[1]-p[0];if(M&&(_-=g,f-=m+g),s=(r?c:l)?Math.max(_,Math.min(f,n[r])):n[r],M?h=(s+=g)+m:(u&&(g=Math.max(_,Math.min(f,2*u[r]-s))),g<s?(h=s,s=g):h=g),p[0]!=s||p[1]!=h)return r?e=null:t=null,p[0]=s,p[1]=h,!0}function N(){T(),y.style("pointer-events","all").selectAll(".resize").style("display",d.empty()?"none":null),s.select("body").style("cursor",null),z.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),A(),b({type:"brushend"})}y.style("pointer-events","none").selectAll(".resize").style("display",null),s.select("body").style("cursor",v.style("cursor")),b({type:"brushstart"}),T()}return d.event=function(i){i.each(function(){var i=n.of(this,arguments),r={x:a,y:o,i:t,j:e},l=this.__chart__||r;this.__chart__=r,po?s.select(this).transition().each("start.brush",function(){t=l.i,e=l.j,a=l.x,o=l.y,i({type:"brushstart"})}).tween("brush:brush",function(){var n=Jr(a,r.x),s=Jr(o,r.y);return t=e=null,function(t){a=r.x=n(t),o=r.y=s(t),i({type:"brush",mode:"resize"})}}).each("end.brush",function(){t=r.i,e=r.j,i({type:"brush",mode:"resize"}),i({type:"brushend"})}):(i({type:"brushstart"}),i({type:"brush",mode:"resize"}),i({type:"brushend"}))})},d.x=function(t){return arguments.length?(u=So[!(i=t)<<1|!r],d):i},d.y=function(t){return arguments.length?(u=So[!i<<1|!(r=t)],d):r},d.clamp=function(t){return arguments.length?(i&&r?(l=!!t[0],c=!!t[1]):i?l=!!t:r&&(c=!!t),d):i&&r?[l,c]:i?l:r?c:null},d.extent=function(n){var s,l,c,h,u;return arguments.length?(i&&(s=n[0],l=n[1],r&&(s=s[0],l=l[0]),t=[s,l],i.invert&&(s=i(s),l=i(l)),l<s&&(u=s,s=l,l=u),s==a[0]&&l==a[1]||(a=[s,l])),r&&(c=n[0],h=n[1],i&&(c=c[1],h=h[1]),e=[c,h],r.invert&&(c=r(c),h=r(h)),h<c&&(u=c,c=h,h=u),c==o[0]&&h==o[1]||(o=[c,h])),d):(i&&(t?(s=t[0],l=t[1]):(s=a[0],l=a[1],i.invert&&(s=i.invert(s),l=i.invert(l)),l<s&&(u=s,s=l,l=u))),r&&(e?(c=e[0],h=e[1]):(c=o[0],h=o[1],r.invert&&(c=r.invert(c),h=r.invert(h)),h<c&&(u=c,c=h,h=u))),i&&r?[[s,c],[l,h]]:i?[s,l]:r&&[c,h])},d.clear=function(){return d.empty()||(a=[0,0],o=[0,0],t=e=null),d},d.empty=function(){return!!i&&a[0]==a[1]||!!r&&o[0]==o[1]},s.rebind(d,n,"on")};var Eo={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},So=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],To=Pe.format=dn.timeFormat,Lo=To.utc,No=Lo("%Y-%m-%dT%H:%M:%S.%LZ");function Oo(t){return t.toISOString()}function Co(t,e,n){function i(e){return t(e)}function r(t,n){var i=(t[1]-t[0])/n,r=s.bisect(Bo,i);return r==Bo.length?[e.year,ya(t.map(function(t){return t/31536e6}),n)[2]]:r?e[i/Bo[r-1]<Bo[r]/i?r-1:r]:[Ro,ya(t,n)[2]]}return i.invert=function(e){return jo(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(jo)},i.nice=function(t,e){var n=i.domain(),s=ua(n),a=null==t?r(s,10):"number"==typeof t&&r(s,t);function o(n){return!isNaN(n)&&!t.range(n,jo(+n+1),e).length}return a&&(t=a[0],e=a[1]),i.domain(fa(n,e>1?{floor:function(e){for(;o(e=t.floor(e));)e=jo(e-1);return e},ceil:function(e){for(;o(e=t.ceil(e));)e=jo(+e+1);return e}}:t))},i.ticks=function(t,e){var n=ua(i.domain()),s=null==t?r(n,10):"number"==typeof t?r(n,t):!t.range&&[{range:t},e];return s&&(t=s[0],e=s[1]),t.range(n[0],jo(+n[1]+1),e<1?1:e)},i.tickFormat=function(){return n},i.copy=function(){return Co(t.copy(),e,n)},va(i,t)}function jo(t){return new Date(t)}To.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Oo:No,Oo.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Oo.toString=No.toString,Pe.second=Ie(function(t){return new De(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),Pe.seconds=Pe.second.range,Pe.seconds.utc=Pe.second.utc.range,Pe.minute=Ie(function(t){return new De(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),Pe.minutes=Pe.minute.range,Pe.minutes.utc=Pe.minute.utc.range,Pe.hour=Ie(function(t){var e=t.getTimezoneOffset()/60;return new De(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),Pe.hours=Pe.hour.range,Pe.hours.utc=Pe.hour.utc.range,Pe.month=Ie(function(t){return(t=Pe.day(t)).setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),Pe.months=Pe.month.range,Pe.months.utc=Pe.month.utc.range;var Bo=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Po=[[Pe.second,1],[Pe.second,5],[Pe.second,15],[Pe.second,30],[Pe.minute,1],[Pe.minute,5],[Pe.minute,15],[Pe.minute,30],[Pe.hour,1],[Pe.hour,3],[Pe.hour,6],[Pe.hour,12],[Pe.day,1],[Pe.day,2],[Pe.week,1],[Pe.month,1],[Pe.month,3],[Pe.year,1]],Do=To.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",$n]]),Ro={range:function(t,e,n){return s.range(Math.ceil(t/n)*n,+e,n).map(jo)},floor:j,ceil:j};Po.year=Pe.year,Pe.scale=function(){return Co(s.scale.linear(),Po,Do)};var Fo=Po.map(function(t){return[t[0].utc,t[1]]}),Io=Lo.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",$n]]);function Uo(t){return JSON.parse(t.responseText)}function Ho(t){var e=l.createRange();return e.selectNode(l.body),e.createContextualFragment(t.responseText)}Fo.year=Pe.year.utc,Pe.scale.utc=function(){return Co(s.scale.linear(),Fo,Io)},s.text=xe(function(t){return t.responseText}),s.json=function(t,e){return ke(t,"application/json",Uo,e)},s.html=function(t,e){return ke(t,"text/html",Ho,e)},s.xml=xe(function(t){return t.responseXML}),this.d3=s,void 0===(r="function"==typeof(i=s)?i.call(e,n,e,t):i)||(t.exports=r)}()},function(t,e,n){var i;(function(){var n=this,r=n._,s=Array.prototype,a=Object.prototype,o=Function.prototype,l=s.push,c=s.slice,h=a.toString,u=a.hasOwnProperty,d=Array.isArray,_=Object.keys,f=o.bind,g=Object.create,p=function(){},m=function(t){return t instanceof m?t:this instanceof m?void(this._wrapped=t):new m(t)};void 0!==t&&t.exports&&(e=t.exports=m),e._=m,m.VERSION="1.8.3";var v=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,s){return t.call(e,n,i,r,s)}}return function(){return t.apply(e,arguments)}},b=function(t,e,n){return null==t?m.identity:m.isFunction(t)?v(t,e,n):m.isObject(t)?m.matcher(t):m.property(t)};m.iteratee=function(t,e){return b(t,e,1/0)};var y=function(t,e){return function(n){var i=arguments.length;if(i<2||null==n)return n;for(var r=1;r<i;r++)for(var s=arguments[r],a=t(s),o=a.length,l=0;l<o;l++){var c=a[l];e&&void 0!==n[c]||(n[c]=s[c])}return n}},x=function(t){if(!m.isObject(t))return{};if(g)return g(t);p.prototype=t;var e=new p;return p.prototype=null,e},k=function(t){return function(e){return null==e?void 0:e[t]}},w=Math.pow(2,53)-1,M=k("length"),A=function(t){var e=M(t);return"number"==typeof e&&e>=0&&e<=w};function q(t){return function(e,n,i,r){n=v(n,r,4);var s=!A(e)&&m.keys(e),a=(s||e).length,o=t>0?0:a-1;return arguments.length<3&&(i=e[s?s[o]:o],o+=t),function(e,n,i,r,s,a){for(;s>=0&&s<a;s+=t){var o=r?r[s]:s;i=n(i,e[o],o,e)}return i}(e,n,i,s,o,a)}}m.each=m.forEach=function(t,e,n){var i,r;if(e=v(e,n),A(t))for(i=0,r=t.length;i<r;i++)e(t[i],i,t);else{var s=m.keys(t);for(i=0,r=s.length;i<r;i++)e(t[s[i]],s[i],t)}return t},m.map=m.collect=function(t,e,n){e=b(e,n);for(var i=!A(t)&&m.keys(t),r=(i||t).length,s=Array(r),a=0;a<r;a++){var o=i?i[a]:a;s[a]=e(t[o],o,t)}return s},m.reduce=m.foldl=m.inject=q(1),m.reduceRight=m.foldr=q(-1),m.find=m.detect=function(t,e,n){var i;if(void 0!==(i=A(t)?m.findIndex(t,e,n):m.findKey(t,e,n))&&-1!==i)return t[i]},m.filter=m.select=function(t,e,n){var i=[];return e=b(e,n),m.each(t,function(t,n,r){e(t,n,r)&&i.push(t)}),i},m.reject=function(t,e,n){return m.filter(t,m.negate(b(e)),n)},m.every=m.all=function(t,e,n){e=b(e,n);for(var i=!A(t)&&m.keys(t),r=(i||t).length,s=0;s<r;s++){var a=i?i[s]:s;if(!e(t[a],a,t))return!1}return!0},m.some=m.any=function(t,e,n){e=b(e,n);for(var i=!A(t)&&m.keys(t),r=(i||t).length,s=0;s<r;s++){var a=i?i[s]:s;if(e(t[a],a,t))return!0}return!1},m.contains=m.includes=m.include=function(t,e,n,i){return A(t)||(t=m.values(t)),("number"!=typeof n||i)&&(n=0),m.indexOf(t,e,n)>=0},m.invoke=function(t,e){var n=c.call(arguments,2),i=m.isFunction(e);return m.map(t,function(t){var r=i?e:t[e];return null==r?r:r.apply(t,n)})},m.pluck=function(t,e){return m.map(t,m.property(e))},m.where=function(t,e){return m.filter(t,m.matcher(e))},m.findWhere=function(t,e){return m.find(t,m.matcher(e))},m.max=function(t,e,n){var i,r,s=-1/0,a=-1/0;if(null==e&&null!=t)for(var o=0,l=(t=A(t)?t:m.values(t)).length;o<l;o++)(i=t[o])>s&&(s=i);else e=b(e,n),m.each(t,function(t,n,i){((r=e(t,n,i))>a||r===-1/0&&s===-1/0)&&(s=t,a=r)});return s},m.min=function(t,e,n){var i,r,s=1/0,a=1/0;if(null==e&&null!=t)for(var o=0,l=(t=A(t)?t:m.values(t)).length;o<l;o++)(i=t[o])<s&&(s=i);else e=b(e,n),m.each(t,function(t,n,i){((r=e(t,n,i))<a||r===1/0&&s===1/0)&&(s=t,a=r)});return s},m.shuffle=function(t){for(var e,n=A(t)?t:m.values(t),i=n.length,r=Array(i),s=0;s<i;s++)(e=m.random(0,s))!==s&&(r[s]=r[e]),r[e]=n[s];return r},m.sample=function(t,e,n){return null==e||n?(A(t)||(t=m.values(t)),t[m.random(t.length-1)]):m.shuffle(t).slice(0,Math.max(0,e))},m.sortBy=function(t,e,n){return e=b(e,n),m.pluck(m.map(t,function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index}),"value")};var z=function(t){return function(e,n,i){var r={};return n=b(n,i),m.each(e,function(i,s){var a=n(i,s,e);t(r,i,a)}),r}};m.groupBy=z(function(t,e,n){m.has(t,n)?t[n].push(e):t[n]=[e]}),m.indexBy=z(function(t,e,n){t[n]=e}),m.countBy=z(function(t,e,n){m.has(t,n)?t[n]++:t[n]=1}),m.toArray=function(t){return t?m.isArray(t)?c.call(t):A(t)?m.map(t,m.identity):m.values(t):[]},m.size=function(t){return null==t?0:A(t)?t.length:m.keys(t).length},m.partition=function(t,e,n){e=b(e,n);var i=[],r=[];return m.each(t,function(t,n,s){(e(t,n,s)?i:r).push(t)}),[i,r]},m.first=m.head=m.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:m.initial(t,t.length-e)},m.initial=function(t,e,n){return c.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},m.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:m.rest(t,Math.max(0,t.length-e))},m.rest=m.tail=m.drop=function(t,e,n){return c.call(t,null==e||n?1:e)},m.compact=function(t){return m.filter(t,m.identity)};var E=function(t,e,n,i){for(var r=[],s=0,a=i||0,o=M(t);a<o;a++){var l=t[a];if(A(l)&&(m.isArray(l)||m.isArguments(l))){e||(l=E(l,e,n));var c=0,h=l.length;for(r.length+=h;c<h;)r[s++]=l[c++]}else n||(r[s++]=l)}return r};function S(t){return function(e,n,i){n=b(n,i);for(var r=M(e),s=t>0?0:r-1;s>=0&&s<r;s+=t)if(n(e[s],s,e))return s;return-1}}function T(t,e,n){return function(i,r,s){var a=0,o=M(i);if("number"==typeof s)t>0?a=s>=0?s:Math.max(s+o,a):o=s>=0?Math.min(s+1,o):s+o+1;else if(n&&s&&o)return i[s=n(i,r)]===r?s:-1;if(r!=r)return(s=e(c.call(i,a,o),m.isNaN))>=0?s+a:-1;for(s=t>0?a:o-1;s>=0&&s<o;s+=t)if(i[s]===r)return s;return-1}}m.flatten=function(t,e){return E(t,e,!1)},m.without=function(t){return m.difference(t,c.call(arguments,1))},m.uniq=m.unique=function(t,e,n,i){m.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=b(n,i));for(var r=[],s=[],a=0,o=M(t);a<o;a++){var l=t[a],c=n?n(l,a,t):l;e?(a&&s===c||r.push(l),s=c):n?m.contains(s,c)||(s.push(c),r.push(l)):m.contains(r,l)||r.push(l)}return r},m.union=function(){return m.uniq(E(arguments,!0,!0))},m.intersection=function(t){for(var e=[],n=arguments.length,i=0,r=M(t);i<r;i++){var s=t[i];if(!m.contains(e,s)){for(var a=1;a<n&&m.contains(arguments[a],s);a++);a===n&&e.push(s)}}return e},m.difference=function(t){var e=E(arguments,!0,!0,1);return m.filter(t,function(t){return!m.contains(e,t)})},m.zip=function(){return m.unzip(arguments)},m.unzip=function(t){for(var e=t&&m.max(t,M).length||0,n=Array(e),i=0;i<e;i++)n[i]=m.pluck(t,i);return n},m.object=function(t,e){for(var n={},i=0,r=M(t);i<r;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},m.findIndex=S(1),m.findLastIndex=S(-1),m.sortedIndex=function(t,e,n,i){for(var r=(n=b(n,i,1))(e),s=0,a=M(t);s<a;){var o=Math.floor((s+a)/2);n(t[o])<r?s=o+1:a=o}return s},m.indexOf=T(1,m.findIndex,m.sortedIndex),m.lastIndexOf=T(-1,m.findLastIndex),m.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),s=0;s<i;s++,t+=n)r[s]=t;return r};var L=function(t,e,n,i,r){if(!(i instanceof e))return t.apply(n,r);var s=x(t.prototype),a=t.apply(s,r);return m.isObject(a)?a:s};m.bind=function(t,e){if(f&&t.bind===f)return f.apply(t,c.call(arguments,1));if(!m.isFunction(t))throw new TypeError("Bind must be called on a function");var n=c.call(arguments,2),i=function(){return L(t,i,e,this,n.concat(c.call(arguments)))};return i},m.partial=function(t){var e=c.call(arguments,1),n=function(){for(var i=0,r=e.length,s=Array(r),a=0;a<r;a++)s[a]=e[a]===m?arguments[i++]:e[a];for(;i<arguments.length;)s.push(arguments[i++]);return L(t,n,this,this,s)};return n},m.bindAll=function(t){var e,n,i=arguments.length;if(i<=1)throw new Error("bindAll must be passed function names");for(e=1;e<i;e++)t[n=arguments[e]]=m.bind(t[n],t);return t},m.memoize=function(t,e){var n=function(i){var r=n.cache,s=""+(e?e.apply(this,arguments):i);return m.has(r,s)||(r[s]=t.apply(this,arguments)),r[s]};return n.cache={},n},m.delay=function(t,e){var n=c.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},m.defer=m.partial(m.delay,m,1),m.throttle=function(t,e,n){var i,r,s,a=null,o=0;n||(n={});var l=function(){o=!1===n.leading?0:m.now(),a=null,s=t.apply(i,r),a||(i=r=null)};return function(){var c=m.now();o||!1!==n.leading||(o=c);var h=e-(c-o);return i=this,r=arguments,h<=0||h>e?(a&&(clearTimeout(a),a=null),o=c,s=t.apply(i,r),a||(i=r=null)):a||!1===n.trailing||(a=setTimeout(l,h)),s}},m.debounce=function(t,e,n){var i,r,s,a,o,l=function(){var c=m.now()-a;c<e&&c>=0?i=setTimeout(l,e-c):(i=null,n||(o=t.apply(s,r),i||(s=r=null)))};return function(){s=this,r=arguments,a=m.now();var c=n&&!i;return i||(i=setTimeout(l,e)),c&&(o=t.apply(s,r),s=r=null),o}},m.wrap=function(t,e){return m.partial(e,t)},m.negate=function(t){return function(){return!t.apply(this,arguments)}},m.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},m.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},m.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},m.once=m.partial(m.before,2);var N=!{toString:null}.propertyIsEnumerable("toString"),O=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function C(t,e){var n=O.length,i=t.constructor,r=m.isFunction(i)&&i.prototype||a,s="constructor";for(m.has(t,s)&&!m.contains(e,s)&&e.push(s);n--;)(s=O[n])in t&&t[s]!==r[s]&&!m.contains(e,s)&&e.push(s)}m.keys=function(t){if(!m.isObject(t))return[];if(_)return _(t);var e=[];for(var n in t)m.has(t,n)&&e.push(n);return N&&C(t,e),e},m.allKeys=function(t){if(!m.isObject(t))return[];var e=[];for(var n in t)e.push(n);return N&&C(t,e),e},m.values=function(t){for(var e=m.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i},m.mapObject=function(t,e,n){e=b(e,n);for(var i,r=m.keys(t),s=r.length,a={},o=0;o<s;o++)a[i=r[o]]=e(t[i],i,t);return a},m.pairs=function(t){for(var e=m.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=[e[r],t[e[r]]];return i},m.invert=function(t){for(var e={},n=m.keys(t),i=0,r=n.length;i<r;i++)e[t[n[i]]]=n[i];return e},m.functions=m.methods=function(t){var e=[];for(var n in t)m.isFunction(t[n])&&e.push(n);return e.sort()},m.extend=y(m.allKeys),m.extendOwn=m.assign=y(m.keys),m.findKey=function(t,e,n){e=b(e,n);for(var i,r=m.keys(t),s=0,a=r.length;s<a;s++)if(e(t[i=r[s]],i,t))return i},m.pick=function(t,e,n){var i,r,s={},a=t;if(null==a)return s;m.isFunction(e)?(r=m.allKeys(a),i=v(e,n)):(r=E(arguments,!1,!1,1),i=function(t,e,n){return e in n},a=Object(a));for(var o=0,l=r.length;o<l;o++){var c=r[o],h=a[c];i(h,c,a)&&(s[c]=h)}return s},m.omit=function(t,e,n){if(m.isFunction(e))e=m.negate(e);else{var i=m.map(E(arguments,!1,!1,1),String);e=function(t,e){return!m.contains(i,e)}}return m.pick(t,e,n)},m.defaults=y(m.allKeys,!0),m.create=function(t,e){var n=x(t);return e&&m.extendOwn(n,e),n},m.clone=function(t){return m.isObject(t)?m.isArray(t)?t.slice():m.extend({},t):t},m.tap=function(t,e){return e(t),t},m.isMatch=function(t,e){var n=m.keys(e),i=n.length;if(null==t)return!i;for(var r=Object(t),s=0;s<i;s++){var a=n[s];if(e[a]!==r[a]||!(a in r))return!1}return!0};var j=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof m&&(t=t._wrapped),e instanceof m&&(e=e._wrapped);var r=h.call(t);if(r!==h.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var s="[object Array]"===r;if(!s){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,o=e.constructor;if(a!==o&&!(m.isFunction(a)&&a instanceof a&&m.isFunction(o)&&o instanceof o)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],i=i||[];for(var l=n.length;l--;)if(n[l]===t)return i[l]===e;if(n.push(t),i.push(e),s){if((l=t.length)!==e.length)return!1;for(;l--;)if(!j(t[l],e[l],n,i))return!1}else{var c,u=m.keys(t);if(l=u.length,m.keys(e).length!==l)return!1;for(;l--;)if(c=u[l],!m.has(e,c)||!j(t[c],e[c],n,i))return!1}return n.pop(),i.pop(),!0};m.isEqual=function(t,e){return j(t,e)},m.isEmpty=function(t){return null==t||(A(t)&&(m.isArray(t)||m.isString(t)||m.isArguments(t))?0===t.length:0===m.keys(t).length)},m.isElement=function(t){return!(!t||1!==t.nodeType)},m.isArray=d||function(t){return"[object Array]"===h.call(t)},m.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},m.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){m["is"+t]=function(e){return h.call(e)==="[object "+t+"]"}}),m.isArguments(arguments)||(m.isArguments=function(t){return m.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(m.isFunction=function(t){return"function"==typeof t||!1}),m.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},m.isNaN=function(t){return m.isNumber(t)&&t!==+t},m.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===h.call(t)},m.isNull=function(t){return null===t},m.isUndefined=function(t){return void 0===t},m.has=function(t,e){return null!=t&&u.call(t,e)},m.noConflict=function(){return n._=r,this},m.identity=function(t){return t},m.constant=function(t){return function(){return t}},m.noop=function(){},m.property=k,m.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},m.matcher=m.matches=function(t){return t=m.extendOwn({},t),function(e){return m.isMatch(e,t)}},m.times=function(t,e,n){var i=Array(Math.max(0,t));e=v(e,n,1);for(var r=0;r<t;r++)i[r]=e(r);return i},m.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},m.now=Date.now||function(){return(new Date).getTime()};var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},P=m.invert(B),D=function(t){var e=function(e){return t[e]},n="(?:"+m.keys(t).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,e):t}};m.escape=D(B),m.unescape=D(P),m.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(i=n),m.isFunction(i)?i.call(t):i};var R=0;m.uniqueId=function(t){var e=++R+"";return t?t+e:e},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/(.)^/,I={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\u2028|\u2029/g,H=function(t){return"\\"+I[t]};m.template=function(t,e,n){!e&&n&&(e=n),e=m.defaults({},e,m.templateSettings);var i=RegExp([(e.escape||F).source,(e.interpolate||F).source,(e.evaluate||F).source].join("|")+"|$","g"),r=0,s="__p+='";t.replace(i,function(e,n,i,a,o){return s+=t.slice(r,o).replace(U,H),r=o+e.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?s+="'+\n((__t=("+i+"))==null?'':__t)+\n'":a&&(s+="';\n"+a+"\n__p+='"),e}),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var a=new Function(e.variable||"obj","_",s)}catch(t){throw t.source=s,t}var o=function(t){return a.call(this,t,m)},l=e.variable||"obj";return o.source="function("+l+"){\n"+s+"}",o},m.chain=function(t){var e=m(t);return e._chain=!0,e};var Y=function(t,e){return t._chain?m(e).chain():e};m.mixin=function(t){m.each(m.functions(t),function(e){var n=m[e]=t[e];m.prototype[e]=function(){var t=[this._wrapped];return l.apply(t,arguments),Y(this,n.apply(m,t))}})},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=s[t];m.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],Y(this,n)}}),m.each(["concat","join","slice"],function(t){var e=s[t];m.prototype[t]=function(){return Y(this,e.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return""+this._wrapped},void 0===(i=function(){return m}.apply(e,[]))||(t.exports=i)}).call(this)},function(e,n){e.exports=t},function(t,e,n){var i=n(0),r=new RegExp("^(((((\\*)|(/*)|(-*))(\\s*)%([aAbBdeHIjmMLpSUwWyYZ]{1}))+)|((\\s*)%([cxX]{1})))$");t.exports={getCustomRange:function(t){var e,n=t[0],r=t[t.length-1];return e=t[0]>t[1]?i.min(t):i.max(t),[i.scale.linear().range([n,e]),i.scale.linear().range([e,r])]},deepCopy:function(t){return JSON.parse(JSON.stringify(t))},is_valid_time_format:function(t){return r.test(t)}}},function(t,e,n){var i=n(2),r=n(0),s=n(1),a=i.WidgetView.extend({initialize:function(){this.setElement(document.createElementNS(r.ns.prefix.svg,"g")),this.d3el=r.select(this.el),a.__super__.initialize.apply(this,arguments)},render:function(){this.x_padding=0,this.y_padding=0,this.parent=this.options.parent,this.uuid=i.uuid();var t=this.set_scale_views();return this.listenTo(this.model,"scales_updated",function(){this.set_scale_views().then(s.bind(this.draw,this))},this),this.colors=this.model.get("colors"),this.options.clip_id&&this.model.get("apply_clip")&&this.d3el.attr("clip-path","url(#"+this.options.clip_id+")"),this.tooltip_div=r.select(document.createElement("div")).attr("class","mark_tooltip").attr("id","tooltip_"+this.uuid).style("display","none").style("opacity",0),this.bisect=r.bisector(function(t){return t}).left,this.d3el.style("display",this.model.get("visible")?"inline":"none"),this.display_el_classes=[],this.event_metadata={mouse_over:{msg_name:"hover",lookup_data:!0,hit_test:!0},legend_clicked:{msg_name:"legend_click",hit_test:!0},element_clicked:{msg_name:"element_click",lookup_data:!0,hit_test:!0},parent_clicked:{msg_name:"background_click",hit_test:!1},legend_mouse_over:{msg_name:"legend_hover",hit_test:!0}},t},set_scale_views:function(){for(var t in this.scales)this.stopListening(this.scales[t]);var e=this.model.get("scales"),n=this,r={};return s.each(e,function(t,e){r[e]=n.create_child_view(t)}),i.resolvePromisesDict(r).then(function(t){n.scales=t,n.set_positional_scales(),n.initialize_additional_scales(),n.set_ranges(),n.trigger("mark_scales_updated")})},set_positional_scales:function(){},initialize_additional_scales:function(){},set_internal_scales:function(){},create_listeners:function(){this.listenTo(this.model,"change:visible",this.update_visibility,this),this.listenTo(this.model,"change:selected_style",this.selected_style_updated,this),this.listenTo(this.model,"change:unselected_style",this.unselected_style_updated,this),this.parent.on("margin_updated",this.relayout,this),this.model.on_some_change(["labels","display_legend"],function(){this.model.trigger("redraw_legend")},this)},remove:function(){this.model.off(null,null,this),this.d3el.transition("remove").duration(0).remove(),this.tooltip_div.remove(),a.__super__.remove.apply(this)},draw_legend:function(t,e,n,i,r){return t.selectAll(".legend"+this.uuid).remove(),t.append("g").attr("transform","translate("+e+", "+n+")").attr("class","legend"+this.uuid).on("mouseover",s.bind(this.highlight_axes,this)).on("mouseout",s.bind(this.unhighlight_axes,this)).append("text").text(this.model.get("labels")[0]),[1,1]},highlight_axes:function(){s.each(this.model.get("scales"),function(t){t.trigger("highlight_axis")})},unhighlight_axes:function(){s.each(this.model.get("scales"),function(t){t.trigger("unhighlight_axis")})},relayout:function(){},invert_range:function(t,e){return[t,e]},invert_point:function(t){return[t]},invert_multi_range:function(t){return t},update_visibility:function(t,e){this.d3el.style("display",e?"inline":"none")},get_colors:function(t){this.colors=this.model.get("colors");var e=this.colors.length;return this.colors[t%e]},selected_style_updated:function(t,e){this.selected_style=e,this.clear_style(t.previous("selected_style"),this.selected_indices),this.style_updated(e,this.selected_indices)},unselected_style_updated:function(t,e){this.unselected_style=e;var n=this.selected_indices,i=n?s.range(this.model.mark_data.length).filter(function(t){return-1===n.indexOf(t)}):[];this.clear_style(t.previous("unselected_style"),i),this.style_updated(e,i)},style_updated:function(t,e){this.set_default_style(e),this.set_style_on_elements(t,e)},apply_styles:function(t){void 0!==t&&null!=t||(t=[this.selected_style,this.unselected_style]);for(var e=s.range(this.model.mark_data.length),n=0;n<t.length;n++)this.clear_style(t[n]);this.set_default_style(e),this.set_style_on_elements(this.selected_style,this.selected_indices);var i=this.selected_indices?s.difference(e,this.selected_indices):[];this.set_style_on_elements(this.unselected_style,i)},clear_style:function(t,e){},set_default_style:function(t){},set_style_on_elements:function(t,e){},compute_view_padding:function(){},show_tooltip:function(t){if(this.tooltip_view){r.mouse(this.parent.el);void 0!==t&&null!==t&&t?this.tooltip_div.style("pointer-events","all"):this.tooltip_div.style("pointer-events","none");this.tooltip_div.style(this.model.get("tooltip_style")).style("display",null);this.parent.popper.enableEventListeners(),this.move_tooltip()}},move_tooltip:function(t){this.tooltip_view&&(this.parent.popper_reference.x=r.event.clientX,this.parent.popper_reference.y=r.event.clientY,this.parent.popper.scheduleUpdate())},hide_tooltip:function(){this.parent.popper.disableEventListeners(),this.tooltip_div.style("pointer-events","none"),this.tooltip_div.style("opacity",0).style("display","none")},refresh_tooltip:function(t){var e=r.select(r.event.target);if(this.is_hover_element(e)){var n=e.data()[0],i=this.model.get_data_dict(n,n.index);this.trigger("update_tooltip",i),this.show_tooltip(t)}},create_tooltip:function(){var t=this.model.get("tooltip"),e=this;t?this.create_child_view(t).then(function(t){e.tooltip_view&&e.tooltip_view.remove(),e.tooltip_view=t,e.tooltip_div.node().appendChild(t.el),t.trigger("displayed",{add_to_dom_only:!0})}):e.tooltip_view&&e.tooltip_view.remove()},event_dispatcher:function(t,e){this.custom_msg_sender(t),void 0!==this.event_listeners[t]&&s.bind(this.event_listeners[t],this,e)()},custom_msg_sender:function(t){var e=this.event_metadata[t];if(void 0!==e){var n=null;if(e.hit_test){var i=r.select(r.event.target);if(!this.is_hover_element(i))return;n=i.data()[0],e.lookup_data&&(n=this.model.get_data_dict(n,n.index))}this.send({event:e.msg_name,data:n})}},reset_interactions:function(){this.reset_click(),this.reset_hover(),this.reset_legend_hover(),this.event_listeners.legend_clicked=function(){}},reset_click:function(){this.event_listeners.element_clicked=function(){},this.event_listeners.parent_clicked=function(){}},reset_hover:function(){this.event_listeners.mouse_over=function(){},this.event_listeners.mouse_move=function(){},this.event_listeners.mouse_out=function(){}},reset_legend_hover:function(){this.event_listeners.legend_mouse_over=function(){},this.event_listeners.legend_mouse_out=function(){}},mouse_over:function(){if(this.model.get("enable_hover")){var t=r.select(r.event.target);if(this.is_hover_element(t)){var e=t.data()[0],n=this.model.get_data_dict(e,e.index);this.trigger("update_tooltip",n),this.show_tooltip(),this.send({event:"hover",point:n})}}},mouse_out:function(){if(this.model.get("enable_hover")){var t=r.select(r.event.target);if(this.is_hover_element(t)){var e=t.data()[0],n=this.model.get_data_dict(e,e.index);this.hide_tooltip(),this.send({event:"hover",point:n})}}},mouse_move:function(){this.model.get("enable_hover")&&this.is_hover_element(r.select(r.event.target))&&this.move_tooltip()},is_hover_element:function(t){var e=this.display_el_classes.map(function(e){return t.classed(e)});return s.compact(e).length>0}});t.exports={Mark:a}},function(t,e,n){var i=n(2),r=(n(0),n(1)),s=n(7),a="^"+n(6).version,o=s.BaseModel.extend({defaults:function(){return r.extend(s.BaseModel.prototype.defaults(),{_model_name:"MarkModel",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:a,_view_module_version:a,scales:{},scales_metadata:{},preserve_domain:{},display_legend:!0,labels:[],apply_clip:!0,visible:!0,selected_style:{},unselected_style:{},selected:null,enable_hover:!0,tooltip:null,tooltip_style:{opacity:.9},interactions:{hover:"tooltip"},tooltip_location:"mouse"})},initialize:function(){o.__super__.initialize.apply(this,arguments),this.on("change:scales",this.update_scales,this),this.once("destroy",this.handle_destroy,this),this.dirty=!1,this.display_el_classes=["mark"],this.update_scales()},update_data:function(){this.update_domains(),this.trigger("data_updated")},update_domains:function(){},update_scales:function(){this.unregister_all_scales(this.previous("scales")),this.trigger("scales_updated"),this.update_domains()},unregister_all_scales:function(t){for(var e in this.dirty=!0,t)t[e].del_domain([],this.model_id+"_"+e);this.dirty=!1},handle_destroy:function(){this.unregister_all_scales(this.get("scales"))},get_key_for_dimension:function(t){var e=this.get("scales_metadata");for(var n in e)if(e[n].dimension===t)return n;return null},get_key_for_orientation:function(t){var e=this.get("scales_metadata");for(var n in e)if(e[n].orientation===t)return n;return null}},{serializers:r.extend({scales:{deserialize:i.unpack_models},tooltip:{deserialize:i.unpack_models}},s.BaseModel.serializers)});t.exports={MarkModel:o}},function(t){t.exports={name:"bqplot",version:"0.4.6",description:"bqplot",author:{name:"BQPlot Development team",email:"bqplot@bloomberg.net"},license:"Apache-2.0",main:"src/index.js",repository:{type:"git",url:"https://github.com/bloomberg/bqplot.git"},scripts:{build:"webpack && lessc src/bqplot.less css/bqplot.css",prepublish:"npm run build",test:'echo "Error: no test specified" && exit 1'},devDependencies:{"@jupyter-widgets/controls":"^1.3.0","@types/chai":"^4.1.4","@types/expect.js":"^0.3.29","@types/mocha":"^5.2.4","@types/sinon":"^5.0.1",chai:"^4.1.2","css-loader":"^0.23.1","file-loader":"^0.8.5","imports-loader":"^0.6.5","json-loader":"^0.5.4",karma:"^2.0.4","karma-chai":"^0.1.0","karma-chrome-launcher":"^2.2.0","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.5","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.7","karma-webpack":"^3.0.0",less:"^2.6.1","less-loader":"^4.1.0",mocha:"^5.2.0",rimraf:"^2.4.1",sinon:"^6.1.3","sinon-chai":"^3.2.0","style-loader":"^0.13.1","ts-loader":"^4.4.2",typescript:"^2.9.2",webpack:"^4.16.1","webpack-cli":"^3.0.8"},dependencies:{"@jupyter-widgets/base":"^1.0.0 || ^2.0.0",d3:"^3.5.16","popper.js":"^1.0.0",topojson:"^1.6.24",underscore:"^1.8.3"},files:["dist/","css/","src/"],jupyterlab:{extension:"src/jupyterlab-plugin"}}},function(t,e,n){var i=n(2),r=n(1),s="^"+n(6).version,a=i.WidgetModel.extend({defaults:function(){return r.extend(i.WidgetModel.prototype.defaults(),{_model_name:"BaseModel",_model_module:"bqplot",_model_module_version:s})},get_typed_field:function(t){var e=this.get(t),n=[],i=this;return e.hasOwnProperty("type")&&e.hasOwnProperty("values")&&null!==e.values&&(n="date"===e.type?(n=this.get(t).values)[0]instanceof Array?n.map(function(t){return t.map(function(t){return i.convert_to_date(t)})}):n.map(function(t){return i.convert_to_date(t)}):this.get(t).values),n},set_typed_field:function(t,e,n){var i=e,r={},s=this,a=this.get(t).type;(i[0]instanceof Array&&i[0][0]instanceof Date||i[0]instanceof Date)&&(a="date"),i[0]instanceof Array?"date"===a&&(i=i.map(function(t){return t.map(function(t){return s.convert_to_json(t)})})):"date"===a&&(i=i.map(function(t){return s.convert_to_json(t)})),r.type=a,r.values=i,this.set(t,r,n)},get_date_elem:function(t){return this.convert_to_date(this.get(t))},set_date_elem:function(t,e){this.set(t,this.convert_to_json(e))},convert_to_date:function(t){return void 0===t||null===t?null:new Date(t)},convert_to_json:function(t){return void 0===t||null===t?null:void 0===t.toJSON?t:t.toJSON().slice(0,-1)+"000"}});t.exports={BaseModel:a}},function(t,e,n){var i=n(0),r=(n(1),n(9)),s=r.Interaction.extend({initialize:function(){this.setElement(document.createElementNS(i.ns.prefix.svg,"g")),this.d3el=i.select(this.el),r.Interaction.__super__.initialize.apply(this,arguments)},render:function(){this.parent=this.options.parent,this.width=this.parent.width-this.parent.margin.left-this.parent.margin.right,this.height=this.parent.height-this.parent.margin.top-this.parent.margin.bottom,this.mark_views_promise=this.populate_mark_views()},create_listeners:function(){this.parent.on("margin_updated",this.relayout,this),this.listenTo(this.model,"change:selected",this.selected_changed),this.listenTo(this.model,"change:marks",this.marks_changed),this.listenTo(this.model,"msg:custom",this.handle_custom_messages)},relayout:function(){this.height=this.parent.height-this.parent.margin.top-this.parent.margin.bottom,this.width=this.parent.width-this.parent.margin.left-this.parent.margin.right},populate_mark_views:function(){var t=this.parent,e=this,n=this.model.get("marks").map(function(t){return t.model_id});return Promise.all(t.mark_views.views).then(function(i){var r=t.mark_views._models.map(function(t){return t.model_id}),s=n.map(function(t){return r.indexOf(t)});e.mark_views=s.map(function(t){return i[t]})})},marks_changed:function(){var t=this;this.populate_mark_views().then(function(){t.selected_changed()})},handle_custom_messages:function(t){"reset"===t.type&&this.reset()},reset:function(){},selected_changed:function(){}}),a=s.extend({create_scales:function(){if(this.scale&&this.scale.remove(),this.model.get("scale")){var t=this;return this.create_child_view(this.model.get("scale")).then(function(e){return t.scale=e,t.update_scale_domain(!0),t.set_range([t.scale]),t.scale.on("domain_changed",t.update_scale_domain,t),e})}},update_scale_domain:function(){var t="vertical"==this.model.get("orientation")?"y":"x",e=this.parent.padded_range(t,this.scale.model),n=this.parent.range(t);this.scale.expand_domain(e,n)},set_range:function(t){for(var e="vertical"==this.model.get("orientation")?"y":"x",n=0;n<t.length;n++)t[n].set_range(this.parent.range(e))}}),o=s.extend({create_scales:function(){var t=this;this.x_scale&&this.x_scale.remove(),this.y_scale&&this.y_scale.remove();var e=[];return this.model.get("x_scale")&&e.push(this.create_child_view(this.model.get("x_scale")).then(function(e){return t.x_scale=e,t.update_xscale_domain(),t.set_x_range([t.x_scale]),t.x_scale.on("domain_changed",t.update_xscale_domain,t),e})),this.model.get("y_scale")&&e.push(this.create_child_view(this.model.get("y_scale")).then(function(e){return t.y_scale=e,t.update_yscale_domain(),t.set_y_range([t.y_scale]),t.y_scale.on("domain_changed",t.update_yscale_domain,t),e})),Promise.all(e)},set_x_range:function(t){for(var e=0;e<t.length;e++)t[e].set_range(this.parent.range("x"))},set_y_range:function(t){for(var e=0;e<t.length;e++)t[e].set_range(this.parent.range("y"))},update_xscale_domain:function(){var t=this.parent.padded_range("x",this.x_scale.model),e=this.parent.range("x");this.x_scale.expand_domain(t,e)},update_yscale_domain:function(){var t=this.parent.padded_range("y",this.y_scale.model),e=this.parent.range("y");this.y_scale.expand_domain(t,e)}});t.exports={BaseSelector:s,BaseXSelector:a,BaseXYSelector:o}},function(t,e,n){var i=n(2),r=n(0),s=n(1),a=i.WidgetView.extend({initialize:function(){this.setElement(document.createElementNS(r.ns.prefix.svg,"rect")),this.d3el=r.select(this.el),a.__super__.initialize.apply(this,arguments)},render:function(){this.parent=this.options.parent,this.d3el.attr("x",0).attr("y",0).attr("width",this.parent.width-this.parent.margin.left-this.parent.margin.right).attr("height",this.parent.height-this.parent.margin.top-this.parent.margin.bottom).attr("pointer-events","all").attr("visibility","hidden"),this.parent.on("margin_updated",this.relayout,this)},relayout:function(){this.d3el.attr("width",this.parent.width-this.parent.margin.left-this.parent.margin.right).attr("height",this.parent.height-this.parent.margin.top-this.parent.margin.bottom)},remove:function(){s.each(this.mark_views,function(t){t.invert_range()}),this.d3el.remove(),a.__super__.remove.apply(this)}});t.exports={Interaction:a}},function(t,e,n){var i=n(2),r=(n(0),i.WidgetView.extend({render:function(){this.offset=0},create_event_listeners:function(){this.listenTo(this.model,"domain_changed",this.model_domain_changed,this),this.listenTo(this.model,"highlight_axis",this.highlight_axis,this),this.listenTo(this.model,"unhighlight_axis",this.unhighlight_axis,this)},set_range:function(t,e){this.scale.range(t)},compute_and_set_domain:function(t,e){this.model.compute_and_set_domain(t,e)},set_domain:function(t,e){this.model.set_domain(t,e)},model_domain_changed:function(){this.scale.domain(this.model.domain),this.trigger("domain_changed")},highlight_axis:function(){this.trigger("highlight_axis")},unhighlight_axis:function(){this.trigger("unhighlight_axis")},expand_domain:function(t,e){}}));t.exports={Scale:r}},function(t,e,n){n(0);var i=n(1),r=n(7),s="^"+n(6).version,a=r.BaseModel.extend({defaults:function(){return i.extend(r.BaseModel.prototype.defaults(),{_model_name:"ScaleModel",_view_name:"Scale",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:s,_view_module_version:s,reverse:!1,allow_padding:!0})},initialize:function(){a.__super__.initialize.apply(this,arguments),this.domains={},this.domain=[],this.set_init_state(),this.set_listeners()},set_init_state:function(){this.type="base"},set_listeners:function(){},set_domain:function(t,e){this.domains[e]=t,this.update_domain()},del_domain:function(t,e){void 0!==this.domains[e]&&(delete this.domains[e],this.update_domain())}});t.exports={ScaleModel:a}},function(t,e,n){var i=n(0),r=n(1),s=n(11),a=s.ScaleModel.extend({defaults:function(){return r.extend(s.ScaleModel.prototype.defaults(),{_model_name:"LinearScaleModel",_view_name:"LinearScale",min:null,max:null,min_range:.6,mid_range:.8})},initialize:function(){a.__super__.initialize.apply(this,arguments)},set_init_state:function(){this.type="linear",this.global_min=Number.NEGATIVE_INFINITY,this.global_max=Number.POSITIVE_INFINITY},set_listeners:function(){this.on("change:reverse",this.reverse_changed,this),this.reverse_changed(),this.on_some_change(["min","max"],this.min_max_changed,this),this.min_max_changed(),this.on_some_change(["min_range","mid_range","stabilized"],this.update_domain,this)},min_max_changed:function(){this.min=this.get("min"),this.max=this.get("max"),this.min_from_data=null===this.min,this.max_from_data=null===this.max,this.update_domain()},reverse_changed:function(t,e,n){var i=void 0!==t&&t.previous("reverse");this.reverse=this.get("reverse");var r=(i+this.reverse)%2;this.domain.length>0&&1===r&&(this.domain.reverse(),this.trigger("domain_changed",this.domain))},update_domain:function(){var t=this,e=this.min_from_data?i.min(r.map(this.domains,function(e){return e.length>0?e[0]:t.global_max})):this.min,n=this.max_from_data?i.max(r.map(this.domains,function(e){return e.length>1?e[1]:t.global_min})):this.max,s=.5*(e+n),a=.5*(n-e)/this.get("mid_range");prev_domain=this.domain,min_index=this.reverse?1:0,prev_min=prev_domain[min_index],prev_max=prev_domain[1-min_index],prev_mid=.5*(prev_max+prev_min),min_width=.5*(prev_max-prev_min)*this.get("min_range");var o=this.get("stabilized");if(o?!(e>=prev_min&&e<=prev_mid-min_width&&n<=prev_max&&n>=prev_mid+min_width):e!==prev_min||n!==prev_max){var l=o?s-a:e,c=o?s+a:n;this.domain=this.reverse?[c,l]:[l,c],this.trigger("domain_changed",this.domain)}},compute_and_set_domain:function(t,e){if(0!==t.length){var n=t[0]instanceof Array?t:[t],r=i.min(n.map(function(t){return i.min(t)})),s=i.max(n.map(function(t){return i.max(t)}));this.set_domain([r,s],e)}else this.set_domain([],e)}});t.exports={LinearScaleModel:a}},function(t,e,n){var i=n(0),r=(n(1),n(19)),s=(n(3),function(t){return i.max(Object.keys(t).map(Number))});t.exports={cycle_colors:function(t,e){var n=t.length;if(n>e)return t.slice(0,e);for(var i=[],r=Math.floor(e/n);r>0;r--)i=i.concat(t);return i.concat(t.slice(0,e%n))},cycle_colors_from_scheme:function(t,e){var n=r[t=t in r?t:"RdYlGn"],i=e.toString();if(2===e)return[n[3][0],n[3][2]];if(i in n)return n[i];i=s(n).toString();return this.cycle_colors(n[i],e)},get_linear_scale:function(t){t=t in r&&"qual"!==r[t].type?t:"RdYlGn";var e=r[t],n=e[s(e).toString()];return i.scale.linear().range(n)},get_ordinal_scale:function(t,e){var n=i.scale.ordinal();return n.range(this.cycle_colors_from_scheme(t,e)),n},get_linear_scale_range:function(t){return this.get_linear_scale(t).range()},get_ordinal_scale_range:function(t,e){return this.get_ordinal_scale(t,e).range()}}},function(t,e,n){var i=n(22);function r(t,e,n){if(0==e.length&&0==n.length)return!1;var i=!0;return e.sort(function(t,e){return t-e}),n.sort(function(t,e){return t-e}),0!=e.length&&(i=i&&e[0]<=t[0]&&t[0]<=e[1]),0!=n.length&&(i=i&&n[0]<=t[1]&&t[1]<=n[1]),i}function s(t,e){return 0==t.length||0==e.length?0!=t.length||0!=e.length:(t.sort(function(t,e){return t-e}),e.sort(function(t,e){return t-e}),t[0]<e[0]!=t[0]<e[1]||t[1]<e[0]!=t[1]<e[1]||e[0]<t[0]!=e[0]<t[1]||e[1]<t[0]!=e[1]<t[1])}t.exports={point_in_lasso:i.point_in_lasso,point_in_rectangle:r,rect_inter_rect:function(t,e,n,i){return s(t,n)&&s(e,i)},lasso_inter_rect:function(t,e,n){for(var i=0;i<n.length;i++)if(r(n[i],t,e))return!0;return!1}}},function(t,e,n){var i=n(0),r=n(10).Scale.extend({render:function(){this.scale=i.scale.linear(),this.model.domain.length>0&&this.scale.domain(this.model.domain),this.offset=0,this.create_event_listeners()},expand_domain:function(t,e){var n=this.scale.copy();n.clamp(!1),n.domain(this.model.domain),n.range(t),this.scale.domain(e.map(function(t){return n.invert(t)}))},invert:function(t){return this.scale.invert(t)},invert_range:function(t){var e=this;return t.map(function(t){return e.invert(t)})}});t.exports={LinearScale:r}},function(t,e,n){var i=n(0),r=Math.PI,s=r/180,a=Math.sqrt(3),o=Math.tan(r/6),l=function(t){var e=Math.sqrt(t/r);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"},c=i.map({circle:l,cross:function(t,e){var n=Math.sqrt(t/5)/2;return"M"+-3*n+","+-n+"H"+-n+"V"+-3*n+"H"+n+"V"+-n+"H"+3*n+"V"+n+"H"+n+"V"+3*n+"H"+-n+"V"+n+"H"+-3*n+"Z"},diamond:function(t,e){var n=Math.sqrt(t/(2*o)),i=n*o;return"M0,"+-n+"L"+i+",0 0,"+n+" "+-i+",0Z"},square:function(t,e){var n=Math.sqrt(t)/2;return"M"+-n+","+-n+"L"+n+","+-n+" "+n+","+n+" "+-n+","+n+"Z"},"triangle-down":function(t,e){var n=Math.sqrt(t/a),i=n*a/2;return"M0,"+i+"L"+n+","+-i+" "+-n+","+-i+"Z"},"triangle-up":function(t,e){var n=Math.sqrt(t/a),i=n*a/2;return"M0,"+-i+"L"+n+","+i+" "+-n+","+i+"Z"},arrow:function(t,e){var n=60+-55*e,i=Math.tan(n*s),r=Math.sqrt(t/i),a=r*i/2;return"M0,"+-r+"L"+a+","+r+" "+-a+","+r+"Z"},ellipse:function(t,e){var n=Math.pow(10,e),i=Math.sqrt(t/(r*n)),s=i*n;return"M0,"+s+"A"+i+","+s+" 0 1,1 0,"+-s+"A"+i+","+s+" 0 1,1 0,"+s+"Z"},rectangle:function(t,e){var n=Math.pow(10,e),i=Math.sqrt(t/n)/2,r=i*n;return"M"+-i+","+-r+"L"+i+","+-r+" "+i+","+r+" "+-i+","+r+"Z"}});function h(){return 64}function u(){return"circle"}function d(){return.5}t.exports={symbol:function(){var t=u,e=h;function n(n,i){return(c.get(t.call(this,n,i))||l)(e.call(this,n,i),skew.call(this,n,i))}return skew=d,n.type=function(e){return arguments.length?(t=i.functor(e),n):t},n.size=function(t){return arguments.length?(e=i.functor(t),n):e},n.skew=function(t){return arguments.length?(skew=i.functor(t),n):skew},n},types:c.keys()}},function(t,e,n){var i=n(2),r=n(0),s=n(1),a=n(3);Math.log10=Math.log10||function(t){return Math.log(t)/Math.LN10};var o=["em","ex","px"],l=i.WidgetView.extend({initialize:function(){this.setElement(document.createElementNS(r.ns.prefix.svg,"g")),this.d3el=r.select(this.el),l.__super__.initialize.apply(this,arguments)},render:function(){this.d3el.style("display",this.model.get("visible")?"inline":"none"),this.parent=this.options.parent,this.margin=this.parent.margin,this.height=this.parent.height-(this.margin.top+this.margin.bottom),this.width=this.parent.width-(this.margin.left+this.margin.right);var t=this.set_scale_promise(this.model.get("scale")),e=this.get_offset_promise(),n=this;Promise.all([t,e]).then(function(){n.create_listeners(),n.tick_format=n.generate_tick_formatter(),n.set_scales_range(),n.append_axis()})},create_listeners:function(){this.listenTo(this.model,"change:scale",function(t,e){this.update_scale(t.previous("scale"),e),this.axis.scale(this.axis_scale.scale),this.rescale_axis()},this),this.listenTo(this.model,"change:tick_values",this.set_tick_values,this),this.listenTo(this.model,"change:tick_format",this.tickformat_changed,this),this.listenTo(this.model,"change:num_ticks",this.set_tick_values,this),this.listenTo(this.model,"change:tick_rotate",this.apply_tick_styling,this),this.listenTo(this.model,"change:tick_style",this.apply_tick_styling,this),this.model.on_some_change(["label","label_color"],this.update_label,this),this.listenTo(this.model,"change:color",this.update_color,this),this.model.on_some_change(["grid_color","grid_lines"],this.update_grid_lines,this),this.listenTo(this.model,"change:label_location",this.update_label_location,this),this.listenTo(this.model,"change:label_offset",this.update_label_offset,this),this.listenTo(this.model,"change:visible",this.update_visibility,this),this.model.on_some_change(["side","orientation"],this.update_display,this),this.listenTo(this.model,"change:offset",this.update_offset,this),this.parent.on("margin_updated",this.parent_margin_updated,this)},update_offset:function(){var t=this;this.get_offset_promise().then(function(){t.set_scales_range(),t.update_offset_scale_domain(),t.g_axisline.attr("transform",t.get_axis_transform()),t.update_grid_lines()})},update_display:function(){var t=this.model.get("side");"vertical"===this.model.get("orientation")?this.axis.orient("right"===t?"right":"left"):this.axis.orient("top"===t?"top":"bottom"),this.rescale_axis()},set_tick_values:function(t){var e=this.model.get_typed_field("tick_values"),n=[],i=this.model.get("num_ticks");if(void 0!==e&&null!==e&&e.length>0)this.axis.tickValues(this.get_ticks_from_array_or_length(e));else if(void 0!==i&&null!==i)this.axis.tickValues(this.get_ticks_from_array_or_length());else if("ordinal"===this.axis_scale.model.type)this.axis.tickValues(this.axis_scale.scale.domain());else if("date"===this.axis_scale.model.type){var r=this.width<500?5:void 0;this.axis.tickValues(this.axis_scale.scale.ticks(r))}else if("log"===this.axis_scale.model.type){var s,a,o=this.axis_scale.scale.ticks(),l=Math.abs(Math.log10(this.axis_scale.scale.domain()[1]/this.axis_scale.scale.domain()[0]));if(l<2)this.axis.tickValues(o);else if(l<7){for(n=[],s=0;s<o.length;s++)a=Math.abs(Math.log10(o[s])%1),(Math.abs(a)<.001||Math.abs(a-1)<.001||Math.abs(a-.30103)<.001||Math.abs(a-.69897)<.001)&&n.push(o[s]);this.axis.tickValues(n)}else{n=[];var c=Math.round(l/10);for(s=0;s<o.length;s++)a=Math.abs(Math.log10(o[s])%c),(Math.abs(a)<.001||Math.abs(a-c)<.001)&&n.push(o[s]);this.axis.tickValues(n)}}else this.axis.tickValues(this.axis_scale.scale.ticks());null!==this.model.get("tick_format")&&void 0!==this.model.get("tick_format")||"ordinal"!==this.axis_scale.type&&(this.tick_format=this.guess_tick_format(this.axis.tickValues())),this.axis.tickFormat(this.tick_format),this.g_axisline&&(this.g_axisline.transition("set_tick_values").duration(!0===t?this.parent.model.get("animation_duration"):0).call(this.axis),this.apply_tick_styling())},tickformat_changed:function(){this.tick_format=this.generate_tick_formatter(),this.axis.tickFormat(this.tick_format),this.g_axisline&&this.g_axisline.call(this.axis),this.apply_tick_styling()},apply_tick_styling:function(){this.g_axisline.selectAll(".tick text").style(this.model.get("tick_style")).attr("transform",this.get_tick_transforms())},get_tick_transforms:function(){return`rotate(${this.model.get("tick_rotate")})`},update_scales:function(){this.update_scale_domain(),this.update_offset_scale_domain()},update_scale_domain:function(){var t="vertical"===this.model.get("orientation"),e=t?this.parent.padded_range("y",this.axis_scale.model):this.parent.padded_range("x",this.axis_scale.model),n=t?this.parent.range("y"):this.parent.range("x");this.axis_scale.expand_domain(e,n),this.axis.scale(this.axis_scale.scale)},update_offset_scale_domain:function(){var t="vertical"===this.model.get("orientation");if(this.offset_scale){var e=t?this.parent.padded_range("x",this.offset_scale.model):this.parent.padded_range("y",this.offset_scale.model),n=t?this.parent.range("x"):this.parent.range("y");this.offset_scale.expand_domain(e,n)}},generate_tick_formatter:function(){if("date"===this.axis_scale.model.type||"date_color_linear"===this.axis_scale.model.type)return this.model.get("tick_format")?r.time.format(this.model.get("tick_format")):this.guess_tick_format();if("ordinal"===this.axis_scale.model.type){var t=this.model.get("tick_format");return t?a.is_valid_time_format(t)?r.time.format(t):r.format(t):function(t){return t}}return this.model.get("tick_format")?r.format(this.model.get("tick_format")):this.guess_tick_format()},set_scales_range:function(){var t="vertical"===this.model.get("orientation");this.axis_scale.set_range(t?[this.height,0]:[0,this.width]),this.offset_scale&&this.offset_scale.set_range(t?[0,this.width]:[this.height,0])},create_axis:function(){var t="vertical"===this.model.get("orientation"),e=this.model.get("side");this.axis=t?r.svg.axis().scale(this.axis_scale.scale).orient("right"===e?"right":"left"):r.svg.axis().scale(this.axis_scale.scale).orient("top"===e?"top":"bottom")},append_axis:function(){this.create_axis(),this.update_scales(),this.g_axisline=this.d3el.append("g").attr("class","axis").attr("transform",this.get_axis_transform()).call(this.axis),this.g_axisline.append("text").attr("class","axislabel").attr(this.get_label_attributes()).style(this.get_text_styling()).text(this.model.get("label")),this.set_tick_values(),this.update_grid_lines(),this.update_color(),this.apply_tick_styling(),this.update_label()},get_offset_promise:function(){var t=this,e=Promise.resolve(),n=this.model.get("offset"),i="vertical"===this.model.get("orientation");return void 0!==n.value&&null!==n.value?(void 0===n.scale?this.offset_scale=i?this.parent.scale_x:this.parent.scale_y:e=this.create_child_view(n.scale).then(function(e){t.offset_scale=e,"ordinal"!==t.offset_scale.model.type&&t.offset_scale.scale.clamp(!0),t.offset_scale.on("domain_changed",function(){this.update_offset_scale_domain(),this.g_axisline.attr("transform",this.get_axis_transform()),this.update_grid_lines()},t)}),this.offset_value=n.value):this.offset_scale=this.offset_value=void 0,e},highlight:function(){this.g_axisline.classed("axisbold",!0)},unhighlight:function(){this.g_axisline.classed("axisbold",!1)},get_basic_transform:function(){var t="vertical"===this.model.get("orientation"),e=this.model.get("side");return t?"right"===e?this.width:0:"top"===e?0:this.height},get_axis_transform:function(){return"vertical"===this.model.get("orientation")?"translate("+this.process_offset()+", 0)":"translate(0, "+this.process_offset()+")"},process_offset:function(){if(void 0===this.offset_scale||null===this.offset_scale)return this.get_basic_transform();var t=this.offset_scale.scale(this.offset_value);return t=void 0===t?this.get_basic_transform():t,this.offset_scale.offset+t},get_label_attributes:function(){var t=0,e=this.model.get("label_location"),n=this.calculate_label_offset(),i="vertical"===this.model.get("orientation"),r=this.model.get("side");return i?("start"===e?t=-this.height:"middle"===e&&(t=-this.height/2),"right"===r?{transform:"rotate(-90)",x:t,y:n,dy:"1ex",dx:"0em"}:{transform:"rotate(-90)",x:t,y:n,dy:"0em",dx:"0em"}):("middle"===e?t=this.width/2:"end"===e&&(t=this.width),"top"===r?{x:t,y:n,dy:"0.75ex",dx:"0em",transform:""}:{x:t,y:n,dy:"0.25ex",dx:"0em",transform:""})},get_text_styling:function(){var t=this.model.get("label_location");return"start"===t?{"text-anchor":"start"}:"end"===t?{"text-anchor":"end"}:{"text-anchor":"middle"}},update_label:function(){this.g_axisline.select("text.axislabel").text(this.model.get("label")),this.d3el.selectAll(".axislabel").selectAll("text"),""!==this.model.get("label_color")&&null!==this.model.get("label_color")&&(this.g_axisline.select("text.axislabel").style("fill",this.model.get("label_color")),this.d3el.selectAll(".axislabel").selectAll("text").style("fill",this.model.get("label_color")))},update_label_location:function(){this.g_axisline.select("text.axislabel").attr(this.get_label_attributes()).style(this.get_text_styling())},update_label_offset:function(t,e){this.label_offset=this.calculate_label_offset(),this.g_axisline.select("text.axislabel").attr("y",this.label_offset)},calculate_label_offset:function(){var t=this.model.get("label_offset"),e="vertical"===this.model.get("orientation"),n=this.model.get("side");t||(t=e?"4ex":"2em");for(var i=-1,r=0;r<o.length&&-1===i;r++)i=t.indexOf(o[r]);if(-1===i)return t;"top"!==n&&"left"!==n||(t=-1*parseInt(t.substring(0,i))+t.substring(i));return t},update_grid_lines:function(t){var e=this.model.get("grid_lines"),n=this.model.get("side"),i=this.model.get("orientation"),r="vertical"!==i,s=!0===t?this.parent.model.get("animation_duration"):0,a="vertical"===i?-this.width:-this.height,o=0;if(this.offset_scale){var l=this.offset_scale.scale(this.offset_value);"bottom"===n||"right"==n?(a=-l,o=r?this.height-l:this.width-l):(a+=l,o=-l)}"none"!==e?this.axis.innerTickSize(a).outerTickSize(6):this.axis.tickSize(6),this.g_axisline.selectAll(".tick").classed("short","none"===e),this.g_axisline.transition("update_grid_lines").duration(s).call(this.axis).selectAll(".tick line").attr(r?"y1":"x1",this.offset_scale&&"none"!==e?o:null).style("stroke-dasharray","dashed"===e?"5, 5":null),this.apply_tick_styling(),this.model.get("grid_color")&&this.g_axisline.selectAll(".tick line").style("stroke",this.model.get("grid_color"))},update_color:function(){this.model.get("color")&&(this.d3el.selectAll(".tick").selectAll("text").style("fill",this.model.get("color")),this.d3el.selectAll(".domain").style("stroke",this.model.get("color")))},redraw_axisline:function(){this.update_scales();this.set_tick_values(!0),this.update_grid_lines(!0)},rescale_axis:function(){this.set_scales_range(),this.update_axis_domain(),this.update_scales(),this.g_axisline.attr("transform",this.get_axis_transform()),this.g_axisline.call(this.axis),this.g_axisline.select("text.axislabel").attr(this.get_label_attributes()).style(this.get_text_styling()),this.set_tick_values(),this.update_grid_lines(),this.apply_tick_styling()},update_axis_domain:function(){var t=this.vertical?this.parent.padded_range("y",this.axis_scale.model):this.parent.padded_range("x",this.axis_scale.model),e=this.vertical?this.parent.range("y"):this.parent.range("x");this.axis_scale.expand_domain(t,e),this.axis.scale(this.axis_scale.scale)},parent_margin_updated:function(){this.margin=this.parent.margin,this.width=this.parent.width-this.margin.left-this.margin.right,this.height=this.parent.height-this.margin.top-this.margin.bottom,this.rescale_axis()},update_visibility:function(t,e){this.d3el.style("display",e?"inline":"none")},get_ticks_from_array_or_length:function(t){var e,n,i=this.model.get("num_ticks");if("ordinal"===this.axis_scale.model.type&&(t=this.axis_scale.scale.domain()),void 0!==i&&null!==i&&i<2)return[];if(t)return void 0==i||null==i||t.length<=i?t:(e=Math.floor(t.length/(i-1)),s.range(0,t.length,e).map(function(e){return t[e]}));var r=this.axis_scale.scale.domain(),a=this.axis_scale.scale.domain().length-1;return e=(r[a]-r[0])/(i-1),"date"===this.axis_scale.model.type||"date_color_linear"===this.axis_scale.model.type?(r[0]=r[0].getTime(),r[a]=r[a].getTime(),n=r[a]+.5*e,s.range(r[0],n,e).map(function(t){return new Date(t)})):(n=r[a]+.5*e,s.range(r[0],n,e))},set_scale_promise:function(t){var e=this;return this.axis_scale&&this.axis_scale.remove(),this.create_child_view(t).then(function(t){e.displayed.then(function(){t.trigger("displayed")}),e.axis_scale=t,e.axis_scale.on("domain_changed",e.redraw_axisline,e),e.axis_scale.on("highlight_axis",e.highlight,e),e.axis_scale.on("unhighlight_axis",e.unhighlight,e)})},update_scale:function(t,e){this.axis_scale.off(),this.set_scale_promise(e)},_get_digits:function(t){return 0===t?1:Math.floor(Math.log10(Math.abs(t)))+1},_replace_trailing_zeros:function(t){var e=t.search("e");return-1!=e?t.substring(0,e).replace(/(\.[0-9]*?)0+$/gi,"$1").replace(/\.$/,"")+t.substring(e):t.replace(/(\.[0-9]*?)0+$/gi,"$1").replace(/\.$/,"")},get_format_func:function(t){if(0===t)return function(t){return r.format("d")(Math.round(t))};var e=-1==t?"":"."+t,n=this;return function(t){var i=r.format(e+"g")(t);if(i.replace(/-|\.|e/gi,"").length<6)return n._replace_trailing_zeros(i);if(""===e){var s=r.format(e+"e")(t);return s.length>=7&&(s=r.format(".6e")(t)),n._replace_trailing_zeros(s)}return n._replace_trailing_zeros(r.format(e+"e")(t))}},_linear_scale_precision:function(t){t=void 0===t||null===t?this.axis_scale.scale.ticks():t;var e=Math.abs(t[1]-t[0]),n=Math.max(Math.abs(t[0]),Math.abs(t[t.length-1])),i=this._get_digits(n),r=this._get_digits(e),s=Math.abs(i-r);return i>=0&&r>0?i<=6?0:Math.min(s,6)+1:r<=0?Math.min(Math.abs(r)+i,6)+1:void 0},linear_sc_format:function(t){return this.get_format_func(this._linear_scale_precision(t))},date_sc_format:function(t){t=void 0===t||null===t?this.axis_scale.scale.ticks():t;var e=Math.abs(t[1]-t[0]),n=1e3;return 0===Math.floor(e/n)?[[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return!0}]]:0===Math.floor(e/(n*=60))?[[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return!0}]]:0===Math.floor(e/(n*=60))?[["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return!0}]]:0===Math.floor(e/(n*=24))?[["%I %p",function(t){return t.getHours()}],["%b %d",function(t){return!0}]]:0===Math.floor(e/(n*=27))?[["%b %d",function(t){return 1!==t.getDate()}],["%b %Y",function(t){return!0}]]:0===Math.floor(e/(n*=12))?[["%b %d",function(t){return 1!==t.getDate()}],["%b %Y",function(){return!0}]]:[["%b %d",function(t){return 1!==t.getDate()}],["%b %Y",function(t){return t.getMonth()}],["%Y",function(){return!0}]]},log_sc_format:function(t){return this.get_format_func(this._log_sc_precision(t))},_log_sc_precision:function(t){return t=void 0===t||null===t?this.axis_scale.scale.ticks():t,Math.abs(Math.log10(t[1]/t[0]))>=.301?-1:3},guess_tick_format:function(t){return"linear"==this.axis_scale.model.type||"color_linear"==this.axis_scale.model.type?this.linear_sc_format(t):"date"==this.axis_scale.model.type||"date_color_linear"==this.axis_scale.model.type?r.time.format.multi(this.date_sc_format(t)):"log"==this.axis_scale.model.type?this.log_sc_format(t):void 0}});t.exports={Axis:l}},function(t,e,n){var i=n(0),r=n(1),s=n(10).Scale.extend({render:function(){this.scale=i.scale.ordinal(),this.scale.domain(this.model.domain),this.offset=0,this.create_event_listeners()},set_range:function(t,e){e=void 0===e?0:e,this.scale.rangeBands(t,e,e/2),this.offset=0===this.scale.domain().length?0:this.scale.rangeBand()/2},expand_domain:function(t,e){var n=this.scale.copy();n.rangeBands(t);var i=n.range().length>0?Math.abs((e[1]-t[1])/n.rangeBand()):0;this.scale.rangeBands(e,0,i)},invert:function(t){var e=this,n=this.scale.domain(),r=n.map(function(t){return e.scale(t)+e.scale.rangeBand()/2}).map(function(e){return Math.abs(t-e)});return n[r.indexOf(i.min(r))]},invert_range:function(t){var e=this,n=this.scale.domain(),i=n.map(function(t){return e.scale(t)+e.scale.rangeBand()/2});return r.range(i.length).filter(function(e){return i[e]>=t[0]&&i[e]<=t[1]}).map(function(t){return n[t]})}});t.exports={OrdinalScale:s}},function(t,e){t.exports={Spectral:{3:["rgb(252,141,89)","rgb(255,255,191)","rgb(153,213,148)"],4:["rgb(215,25,28)","rgb(253,174,97)","rgb(171,221,164)","rgb(43,131,186)"],5:["rgb(215,25,28)","rgb(253,174,97)","rgb(255,255,191)","rgb(171,221,164)","rgb(43,131,186)"],6:["rgb(213,62,79)","rgb(252,141,89)","rgb(254,224,139)","rgb(230,245,152)","rgb(153,213,148)","rgb(50,136,189)"],7:["rgb(213,62,79)","rgb(252,141,89)","rgb(254,224,139)","rgb(255,255,191)","rgb(230,245,152)","rgb(153,213,148)","rgb(50,136,189)"],8:["rgb(213,62,79)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(230,245,152)","rgb(171,221,164)","rgb(102,194,165)","rgb(50,136,189)"],9:["rgb(213,62,79)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(255,255,191)","rgb(230,245,152)","rgb(171,221,164)","rgb(102,194,165)","rgb(50,136,189)"],10:["rgb(158,1,66)","rgb(213,62,79)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(230,245,152)","rgb(171,221,164)","rgb(102,194,165)","rgb(50,136,189)","rgb(94,79,162)"],11:["rgb(158,1,66)","rgb(213,62,79)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(255,255,191)","rgb(230,245,152)","rgb(171,221,164)","rgb(102,194,165)","rgb(50,136,189)","rgb(94,79,162)"],type:"div"},RdYlGn:{3:["rgb(252,141,89)","rgb(255,255,191)","rgb(145,207,96)"],4:["rgb(215,25,28)","rgb(253,174,97)","rgb(166,217,106)","rgb(26,150,65)"],5:["rgb(215,25,28)","rgb(253,174,97)","rgb(255,255,191)","rgb(166,217,106)","rgb(26,150,65)"],6:["rgb(215,48,39)","rgb(252,141,89)","rgb(254,224,139)","rgb(217,239,139)","rgb(145,207,96)","rgb(26,152,80)"],7:["rgb(215,48,39)","rgb(252,141,89)","rgb(254,224,139)","rgb(255,255,191)","rgb(217,239,139)","rgb(145,207,96)","rgb(26,152,80)"],8:["rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(217,239,139)","rgb(166,217,106)","rgb(102,189,99)","rgb(26,152,80)"],9:["rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(255,255,191)","rgb(217,239,139)","rgb(166,217,106)","rgb(102,189,99)","rgb(26,152,80)"],10:["rgb(165,0,38)","rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(217,239,139)","rgb(166,217,106)","rgb(102,189,99)","rgb(26,152,80)","rgb(0,104,55)"],11:["rgb(165,0,38)","rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(255,255,191)","rgb(217,239,139)","rgb(166,217,106)","rgb(102,189,99)","rgb(26,152,80)","rgb(0,104,55)"],type:"div"},RdBu:{3:["rgb(239,138,98)","rgb(247,247,247)","rgb(103,169,207)"],4:["rgb(202,0,32)","rgb(244,165,130)","rgb(146,197,222)","rgb(5,113,176)"],5:["rgb(202,0,32)","rgb(244,165,130)","rgb(247,247,247)","rgb(146,197,222)","rgb(5,113,176)"],6:["rgb(178,24,43)","rgb(239,138,98)","rgb(253,219,199)","rgb(209,229,240)","rgb(103,169,207)","rgb(33,102,172)"],7:["rgb(178,24,43)","rgb(239,138,98)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(103,169,207)","rgb(33,102,172)"],8:["rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)"],9:["rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)"],10:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],11:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],type:"div"},PiYG:{3:["rgb(233,163,201)","rgb(247,247,247)","rgb(161,215,106)"],4:["rgb(208,28,139)","rgb(241,182,218)","rgb(184,225,134)","rgb(77,172,38)"],5:["rgb(208,28,139)","rgb(241,182,218)","rgb(247,247,247)","rgb(184,225,134)","rgb(77,172,38)"],6:["rgb(197,27,125)","rgb(233,163,201)","rgb(253,224,239)","rgb(230,245,208)","rgb(161,215,106)","rgb(77,146,33)"],7:["rgb(197,27,125)","rgb(233,163,201)","rgb(253,224,239)","rgb(247,247,247)","rgb(230,245,208)","rgb(161,215,106)","rgb(77,146,33)"],8:["rgb(197,27,125)","rgb(222,119,174)","rgb(241,182,218)","rgb(253,224,239)","rgb(230,245,208)","rgb(184,225,134)","rgb(127,188,65)","rgb(77,146,33)"],9:["rgb(197,27,125)","rgb(222,119,174)","rgb(241,182,218)","rgb(253,224,239)","rgb(247,247,247)","rgb(230,245,208)","rgb(184,225,134)","rgb(127,188,65)","rgb(77,146,33)"],10:["rgb(142,1,82)","rgb(197,27,125)","rgb(222,119,174)","rgb(241,182,218)","rgb(253,224,239)","rgb(230,245,208)","rgb(184,225,134)","rgb(127,188,65)","rgb(77,146,33)","rgb(39,100,25)"],11:["rgb(142,1,82)","rgb(197,27,125)","rgb(222,119,174)","rgb(241,182,218)","rgb(253,224,239)","rgb(247,247,247)","rgb(230,245,208)","rgb(184,225,134)","rgb(127,188,65)","rgb(77,146,33)","rgb(39,100,25)"],type:"div"},PRGn:{3:["rgb(175,141,195)","rgb(247,247,247)","rgb(127,191,123)"],4:["rgb(123,50,148)","rgb(194,165,207)","rgb(166,219,160)","rgb(0,136,55)"],5:["rgb(123,50,148)","rgb(194,165,207)","rgb(247,247,247)","rgb(166,219,160)","rgb(0,136,55)"],6:["rgb(118,42,131)","rgb(175,141,195)","rgb(231,212,232)","rgb(217,240,211)","rgb(127,191,123)","rgb(27,120,55)"],7:["rgb(118,42,131)","rgb(175,141,195)","rgb(231,212,232)","rgb(247,247,247)","rgb(217,240,211)","rgb(127,191,123)","rgb(27,120,55)"],8:["rgb(118,42,131)","rgb(153,112,171)","rgb(194,165,207)","rgb(231,212,232)","rgb(217,240,211)","rgb(166,219,160)","rgb(90,174,97)","rgb(27,120,55)"],9:["rgb(118,42,131)","rgb(153,112,171)","rgb(194,165,207)","rgb(231,212,232)","rgb(247,247,247)","rgb(217,240,211)","rgb(166,219,160)","rgb(90,174,97)","rgb(27,120,55)"],10:["rgb(64,0,75)","rgb(118,42,131)","rgb(153,112,171)","rgb(194,165,207)","rgb(231,212,232)","rgb(217,240,211)","rgb(166,219,160)","rgb(90,174,97)","rgb(27,120,55)","rgb(0,68,27)"],11:["rgb(64,0,75)","rgb(118,42,131)","rgb(153,112,171)","rgb(194,165,207)","rgb(231,212,232)","rgb(247,247,247)","rgb(217,240,211)","rgb(166,219,160)","rgb(90,174,97)","rgb(27,120,55)","rgb(0,68,27)"],type:"div"},RdYlBu:{3:["rgb(252,141,89)","rgb(255,255,191)","rgb(145,191,219)"],4:["rgb(215,25,28)","rgb(253,174,97)","rgb(171,217,233)","rgb(44,123,182)"],5:["rgb(215,25,28)","rgb(253,174,97)","rgb(255,255,191)","rgb(171,217,233)","rgb(44,123,182)"],6:["rgb(215,48,39)","rgb(252,141,89)","rgb(254,224,144)","rgb(224,243,248)","rgb(145,191,219)","rgb(69,117,180)"],7:["rgb(215,48,39)","rgb(252,141,89)","rgb(254,224,144)","rgb(255,255,191)","rgb(224,243,248)","rgb(145,191,219)","rgb(69,117,180)"],8:["rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,144)","rgb(224,243,248)","rgb(171,217,233)","rgb(116,173,209)","rgb(69,117,180)"],9:["rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,144)","rgb(255,255,191)","rgb(224,243,248)","rgb(171,217,233)","rgb(116,173,209)","rgb(69,117,180)"],10:["rgb(165,0,38)","rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,144)","rgb(224,243,248)","rgb(171,217,233)","rgb(116,173,209)","rgb(69,117,180)","rgb(49,54,149)"],11:["rgb(165,0,38)","rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,144)","rgb(255,255,191)","rgb(224,243,248)","rgb(171,217,233)","rgb(116,173,209)","rgb(69,117,180)","rgb(49,54,149)"],type:"div"},BrBG:{3:["rgb(216,179,101)","rgb(245,245,245)","rgb(90,180,172)"],4:["rgb(166,97,26)","rgb(223,194,125)","rgb(128,205,193)","rgb(1,133,113)"],5:["rgb(166,97,26)","rgb(223,194,125)","rgb(245,245,245)","rgb(128,205,193)","rgb(1,133,113)"],6:["rgb(140,81,10)","rgb(216,179,101)","rgb(246,232,195)","rgb(199,234,229)","rgb(90,180,172)","rgb(1,102,94)"],7:["rgb(140,81,10)","rgb(216,179,101)","rgb(246,232,195)","rgb(245,245,245)","rgb(199,234,229)","rgb(90,180,172)","rgb(1,102,94)"],8:["rgb(140,81,10)","rgb(191,129,45)","rgb(223,194,125)","rgb(246,232,195)","rgb(199,234,229)","rgb(128,205,193)","rgb(53,151,143)","rgb(1,102,94)"],9:["rgb(140,81,10)","rgb(191,129,45)","rgb(223,194,125)","rgb(246,232,195)","rgb(245,245,245)","rgb(199,234,229)","rgb(128,205,193)","rgb(53,151,143)","rgb(1,102,94)"],10:["rgb(84,48,5)","rgb(140,81,10)","rgb(191,129,45)","rgb(223,194,125)","rgb(246,232,195)","rgb(199,234,229)","rgb(128,205,193)","rgb(53,151,143)","rgb(1,102,94)","rgb(0,60,48)"],11:["rgb(84,48,5)","rgb(140,81,10)","rgb(191,129,45)","rgb(223,194,125)","rgb(246,232,195)","rgb(245,245,245)","rgb(199,234,229)","rgb(128,205,193)","rgb(53,151,143)","rgb(1,102,94)","rgb(0,60,48)"],type:"div"},RdGy:{3:["rgb(239,138,98)","rgb(255,255,255)","rgb(153,153,153)"],4:["rgb(202,0,32)","rgb(244,165,130)","rgb(186,186,186)","rgb(64,64,64)"],5:["rgb(202,0,32)","rgb(244,165,130)","rgb(255,255,255)","rgb(186,186,186)","rgb(64,64,64)"],6:["rgb(178,24,43)","rgb(239,138,98)","rgb(253,219,199)","rgb(224,224,224)","rgb(153,153,153)","rgb(77,77,77)"],7:["rgb(178,24,43)","rgb(239,138,98)","rgb(253,219,199)","rgb(255,255,255)","rgb(224,224,224)","rgb(153,153,153)","rgb(77,77,77)"],8:["rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(224,224,224)","rgb(186,186,186)","rgb(135,135,135)","rgb(77,77,77)"],9:["rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(255,255,255)","rgb(224,224,224)","rgb(186,186,186)","rgb(135,135,135)","rgb(77,77,77)"],10:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(224,224,224)","rgb(186,186,186)","rgb(135,135,135)","rgb(77,77,77)","rgb(26,26,26)"],11:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(255,255,255)","rgb(224,224,224)","rgb(186,186,186)","rgb(135,135,135)","rgb(77,77,77)","rgb(26,26,26)"],type:"div"},PuOr:{3:["rgb(241,163,64)","rgb(247,247,247)","rgb(153,142,195)"],4:["rgb(230,97,1)","rgb(253,184,99)","rgb(178,171,210)","rgb(94,60,153)"],5:["rgb(230,97,1)","rgb(253,184,99)","rgb(247,247,247)","rgb(178,171,210)","rgb(94,60,153)"],6:["rgb(179,88,6)","rgb(241,163,64)","rgb(254,224,182)","rgb(216,218,235)","rgb(153,142,195)","rgb(84,39,136)"],7:["rgb(179,88,6)","rgb(241,163,64)","rgb(254,224,182)","rgb(247,247,247)","rgb(216,218,235)","rgb(153,142,195)","rgb(84,39,136)"],8:["rgb(179,88,6)","rgb(224,130,20)","rgb(253,184,99)","rgb(254,224,182)","rgb(216,218,235)","rgb(178,171,210)","rgb(128,115,172)","rgb(84,39,136)"],9:["rgb(179,88,6)","rgb(224,130,20)","rgb(253,184,99)","rgb(254,224,182)","rgb(247,247,247)","rgb(216,218,235)","rgb(178,171,210)","rgb(128,115,172)","rgb(84,39,136)"],10:["rgb(127,59,8)","rgb(179,88,6)","rgb(224,130,20)","rgb(253,184,99)","rgb(254,224,182)","rgb(216,218,235)","rgb(178,171,210)","rgb(128,115,172)","rgb(84,39,136)","rgb(45,0,75)"],11:["rgb(127,59,8)","rgb(179,88,6)","rgb(224,130,20)","rgb(253,184,99)","rgb(254,224,182)","rgb(247,247,247)","rgb(216,218,235)","rgb(178,171,210)","rgb(128,115,172)","rgb(84,39,136)","rgb(45,0,75)"],type:"div"},Set2:{3:["rgb(102,194,165)","rgb(252,141,98)","rgb(141,160,203)"],4:["rgb(102,194,165)","rgb(252,141,98)","rgb(141,160,203)","rgb(231,138,195)"],5:["rgb(102,194,165)","rgb(252,141,98)","rgb(141,160,203)","rgb(231,138,195)","rgb(166,216,84)"],6:["rgb(102,194,165)","rgb(252,141,98)","rgb(141,160,203)","rgb(231,138,195)","rgb(166,216,84)","rgb(255,217,47)"],7:["rgb(102,194,165)","rgb(252,141,98)","rgb(141,160,203)","rgb(231,138,195)","rgb(166,216,84)","rgb(255,217,47)","rgb(229,196,148)"],8:["rgb(102,194,165)","rgb(252,141,98)","rgb(141,160,203)","rgb(231,138,195)","rgb(166,216,84)","rgb(255,217,47)","rgb(229,196,148)","rgb(179,179,179)"],type:"qual"},Accent:{3:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)"],4:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)","rgb(255,255,153)"],5:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)","rgb(255,255,153)","rgb(56,108,176)"],6:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)","rgb(255,255,153)","rgb(56,108,176)","rgb(240,2,127)"],7:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)","rgb(255,255,153)","rgb(56,108,176)","rgb(240,2,127)","rgb(191,91,23)"],8:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)","rgb(255,255,153)","rgb(56,108,176)","rgb(240,2,127)","rgb(191,91,23)","rgb(102,102,102)"],type:"qual"},Set1:{3:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)"],4:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(152,78,163)"],5:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(152,78,163)","rgb(255,127,0)"],6:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(152,78,163)","rgb(255,127,0)","rgb(255,255,51)"],7:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(152,78,163)","rgb(255,127,0)","rgb(255,255,51)","rgb(166,86,40)"],8:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(152,78,163)","rgb(255,127,0)","rgb(255,255,51)","rgb(166,86,40)","rgb(247,129,191)"],9:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(152,78,163)","rgb(255,127,0)","rgb(255,255,51)","rgb(166,86,40)","rgb(247,129,191)","rgb(153,153,153)"],type:"qual"},Set3:{3:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)"],4:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)"],5:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)"],6:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)"],7:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)"],8:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)","rgb(252,205,229)"],9:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)","rgb(252,205,229)","rgb(217,217,217)"],10:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)","rgb(252,205,229)","rgb(217,217,217)","rgb(188,128,189)"],11:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)","rgb(252,205,229)","rgb(217,217,217)","rgb(188,128,189)","rgb(204,235,197)"],12:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)","rgb(252,205,229)","rgb(217,217,217)","rgb(188,128,189)","rgb(204,235,197)","rgb(255,237,111)"],type:"qual"},Dark2:{3:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)"],4:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)","rgb(231,41,138)"],5:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)","rgb(231,41,138)","rgb(102,166,30)"],6:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)","rgb(231,41,138)","rgb(102,166,30)","rgb(230,171,2)"],7:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)","rgb(231,41,138)","rgb(102,166,30)","rgb(230,171,2)","rgb(166,118,29)"],8:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)","rgb(231,41,138)","rgb(102,166,30)","rgb(230,171,2)","rgb(166,118,29)","rgb(102,102,102)"],type:"qual"},Paired:{3:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)"],4:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)"],5:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)"],6:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)"],7:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)","rgb(253,191,111)"],8:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)","rgb(253,191,111)","rgb(255,127,0)"],9:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)","rgb(253,191,111)","rgb(255,127,0)","rgb(202,178,214)"],10:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)","rgb(253,191,111)","rgb(255,127,0)","rgb(202,178,214)","rgb(106,61,154)"],11:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)","rgb(253,191,111)","rgb(255,127,0)","rgb(202,178,214)","rgb(106,61,154)","rgb(255,255,153)"],12:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)","rgb(253,191,111)","rgb(255,127,0)","rgb(202,178,214)","rgb(106,61,154)","rgb(255,255,153)","rgb(177,89,40)"],type:"qual"},Pastel2:{3:["rgb(179,226,205)","rgb(253,205,172)","rgb(203,213,232)"],4:["rgb(179,226,205)","rgb(253,205,172)","rgb(203,213,232)","rgb(244,202,228)"],5:["rgb(179,226,205)","rgb(253,205,172)","rgb(203,213,232)","rgb(244,202,228)","rgb(230,245,201)"],6:["rgb(179,226,205)","rgb(253,205,172)","rgb(203,213,232)","rgb(244,202,228)","rgb(230,245,201)","rgb(255,242,174)"],7:["rgb(179,226,205)","rgb(253,205,172)","rgb(203,213,232)","rgb(244,202,228)","rgb(230,245,201)","rgb(255,242,174)","rgb(241,226,204)"],8:["rgb(179,226,205)","rgb(253,205,172)","rgb(203,213,232)","rgb(244,202,228)","rgb(230,245,201)","rgb(255,242,174)","rgb(241,226,204)","rgb(204,204,204)"],type:"qual"},Pastel1:{3:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)"],4:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)"],5:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)","rgb(254,217,166)"],6:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)","rgb(254,217,166)","rgb(255,255,204)"],7:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)","rgb(254,217,166)","rgb(255,255,204)","rgb(229,216,189)"],8:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)","rgb(254,217,166)","rgb(255,255,204)","rgb(229,216,189)","rgb(253,218,236)"],9:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)","rgb(254,217,166)","rgb(255,255,204)","rgb(229,216,189)","rgb(253,218,236)","rgb(242,242,242)"],type:"qual"},OrRd:{3:["rgb(254,232,200)","rgb(253,187,132)","rgb(227,74,51)"],4:["rgb(254,240,217)","rgb(253,204,138)","rgb(252,141,89)","rgb(215,48,31)"],5:["rgb(254,240,217)","rgb(253,204,138)","rgb(252,141,89)","rgb(227,74,51)","rgb(179,0,0)"],6:["rgb(254,240,217)","rgb(253,212,158)","rgb(253,187,132)","rgb(252,141,89)","rgb(227,74,51)","rgb(179,0,0)"],7:["rgb(254,240,217)","rgb(253,212,158)","rgb(253,187,132)","rgb(252,141,89)","rgb(239,101,72)","rgb(215,48,31)","rgb(153,0,0)"],8:["rgb(255,247,236)","rgb(254,232,200)","rgb(253,212,158)","rgb(253,187,132)","rgb(252,141,89)","rgb(239,101,72)","rgb(215,48,31)","rgb(153,0,0)"],9:["rgb(255,247,236)","rgb(254,232,200)","rgb(253,212,158)","rgb(253,187,132)","rgb(252,141,89)","rgb(239,101,72)","rgb(215,48,31)","rgb(179,0,0)","rgb(127,0,0)"],type:"seq"},PuBu:{3:["rgb(236,231,242)","rgb(166,189,219)","rgb(43,140,190)"],4:["rgb(241,238,246)","rgb(189,201,225)","rgb(116,169,207)","rgb(5,112,176)"],5:["rgb(241,238,246)","rgb(189,201,225)","rgb(116,169,207)","rgb(43,140,190)","rgb(4,90,141)"],6:["rgb(241,238,246)","rgb(208,209,230)","rgb(166,189,219)","rgb(116,169,207)","rgb(43,140,190)","rgb(4,90,141)"],7:["rgb(241,238,246)","rgb(208,209,230)","rgb(166,189,219)","rgb(116,169,207)","rgb(54,144,192)","rgb(5,112,176)","rgb(3,78,123)"],8:["rgb(255,247,251)","rgb(236,231,242)","rgb(208,209,230)","rgb(166,189,219)","rgb(116,169,207)","rgb(54,144,192)","rgb(5,112,176)","rgb(3,78,123)"],9:["rgb(255,247,251)","rgb(236,231,242)","rgb(208,209,230)","rgb(166,189,219)","rgb(116,169,207)","rgb(54,144,192)","rgb(5,112,176)","rgb(4,90,141)","rgb(2,56,88)"],type:"seq"},BuPu:{3:["rgb(224,236,244)","rgb(158,188,218)","rgb(136,86,167)"],4:["rgb(237,248,251)","rgb(179,205,227)","rgb(140,150,198)","rgb(136,65,157)"],5:["rgb(237,248,251)","rgb(179,205,227)","rgb(140,150,198)","rgb(136,86,167)","rgb(129,15,124)"],6:["rgb(237,248,251)","rgb(191,211,230)","rgb(158,188,218)","rgb(140,150,198)","rgb(136,86,167)","rgb(129,15,124)"],7:["rgb(237,248,251)","rgb(191,211,230)","rgb(158,188,218)","rgb(140,150,198)","rgb(140,107,177)","rgb(136,65,157)","rgb(110,1,107)"],8:["rgb(247,252,253)","rgb(224,236,244)","rgb(191,211,230)","rgb(158,188,218)","rgb(140,150,198)","rgb(140,107,177)","rgb(136,65,157)","rgb(110,1,107)"],9:["rgb(247,252,253)","rgb(224,236,244)","rgb(191,211,230)","rgb(158,188,218)","rgb(140,150,198)","rgb(140,107,177)","rgb(136,65,157)","rgb(129,15,124)","rgb(77,0,75)"],type:"seq"},Oranges:{3:["rgb(254,230,206)","rgb(253,174,107)","rgb(230,85,13)"],4:["rgb(254,237,222)","rgb(253,190,133)","rgb(253,141,60)","rgb(217,71,1)"],5:["rgb(254,237,222)","rgb(253,190,133)","rgb(253,141,60)","rgb(230,85,13)","rgb(166,54,3)"],6:["rgb(254,237,222)","rgb(253,208,162)","rgb(253,174,107)","rgb(253,141,60)","rgb(230,85,13)","rgb(166,54,3)"],7:["rgb(254,237,222)","rgb(253,208,162)","rgb(253,174,107)","rgb(253,141,60)","rgb(241,105,19)","rgb(217,72,1)","rgb(140,45,4)"],8:["rgb(255,245,235)","rgb(254,230,206)","rgb(253,208,162)","rgb(253,174,107)","rgb(253,141,60)","rgb(241,105,19)","rgb(217,72,1)","rgb(140,45,4)"],9:["rgb(255,245,235)","rgb(254,230,206)","rgb(253,208,162)","rgb(253,174,107)","rgb(253,141,60)","rgb(241,105,19)","rgb(217,72,1)","rgb(166,54,3)","rgb(127,39,4)"],type:"seq"},BuGn:{3:["rgb(229,245,249)","rgb(153,216,201)","rgb(44,162,95)"],4:["rgb(237,248,251)","rgb(178,226,226)","rgb(102,194,164)","rgb(35,139,69)"],5:["rgb(237,248,251)","rgb(178,226,226)","rgb(102,194,164)","rgb(44,162,95)","rgb(0,109,44)"],6:["rgb(237,248,251)","rgb(204,236,230)","rgb(153,216,201)","rgb(102,194,164)","rgb(44,162,95)","rgb(0,109,44)"],7:["rgb(237,248,251)","rgb(204,236,230)","rgb(153,216,201)","rgb(102,194,164)","rgb(65,174,118)","rgb(35,139,69)","rgb(0,88,36)"],8:["rgb(247,252,253)","rgb(229,245,249)","rgb(204,236,230)","rgb(153,216,201)","rgb(102,194,164)","rgb(65,174,118)","rgb(35,139,69)","rgb(0,88,36)"],9:["rgb(247,252,253)","rgb(229,245,249)","rgb(204,236,230)","rgb(153,216,201)","rgb(102,194,164)","rgb(65,174,118)","rgb(35,139,69)","rgb(0,109,44)","rgb(0,68,27)"],type:"seq"},YlOrBr:{3:["rgb(255,247,188)","rgb(254,196,79)","rgb(217,95,14)"],4:["rgb(255,255,212)","rgb(254,217,142)","rgb(254,153,41)","rgb(204,76,2)"],5:["rgb(255,255,212)","rgb(254,217,142)","rgb(254,153,41)","rgb(217,95,14)","rgb(153,52,4)"],6:["rgb(255,255,212)","rgb(254,227,145)","rgb(254,196,79)","rgb(254,153,41)","rgb(217,95,14)","rgb(153,52,4)"],7:["rgb(255,255,212)","rgb(254,227,145)","rgb(254,196,79)","rgb(254,153,41)","rgb(236,112,20)","rgb(204,76,2)","rgb(140,45,4)"],8:["rgb(255,255,229)","rgb(255,247,188)","rgb(254,227,145)","rgb(254,196,79)","rgb(254,153,41)","rgb(236,112,20)","rgb(204,76,2)","rgb(140,45,4)"],9:["rgb(255,255,229)","rgb(255,247,188)","rgb(254,227,145)","rgb(254,196,79)","rgb(254,153,41)","rgb(236,112,20)","rgb(204,76,2)","rgb(153,52,4)","rgb(102,37,6)"],type:"seq"},YlGn:{3:["rgb(247,252,185)","rgb(173,221,142)","rgb(49,163,84)"],4:["rgb(255,255,204)","rgb(194,230,153)","rgb(120,198,121)","rgb(35,132,67)"],5:["rgb(255,255,204)","rgb(194,230,153)","rgb(120,198,121)","rgb(49,163,84)","rgb(0,104,55)"],6:["rgb(255,255,204)","rgb(217,240,163)","rgb(173,221,142)","rgb(120,198,121)","rgb(49,163,84)","rgb(0,104,55)"],7:["rgb(255,255,204)","rgb(217,240,163)","rgb(173,221,142)","rgb(120,198,121)","rgb(65,171,93)","rgb(35,132,67)","rgb(0,90,50)"],8:["rgb(255,255,229)","rgb(247,252,185)","rgb(217,240,163)","rgb(173,221,142)","rgb(120,198,121)","rgb(65,171,93)","rgb(35,132,67)","rgb(0,90,50)"],9:["rgb(255,255,229)","rgb(247,252,185)","rgb(217,240,163)","rgb(173,221,142)","rgb(120,198,121)","rgb(65,171,93)","rgb(35,132,67)","rgb(0,104,55)","rgb(0,69,41)"],type:"seq"},Reds:{3:["rgb(254,224,210)","rgb(252,146,114)","rgb(222,45,38)"],4:["rgb(254,229,217)","rgb(252,174,145)","rgb(251,106,74)","rgb(203,24,29)"],5:["rgb(254,229,217)","rgb(252,174,145)","rgb(251,106,74)","rgb(222,45,38)","rgb(165,15,21)"],6:["rgb(254,229,217)","rgb(252,187,161)","rgb(252,146,114)","rgb(251,106,74)","rgb(222,45,38)","rgb(165,15,21)"],7:["rgb(254,229,217)","rgb(252,187,161)","rgb(252,146,114)","rgb(251,106,74)","rgb(239,59,44)","rgb(203,24,29)","rgb(153,0,13)"],8:["rgb(255,245,240)","rgb(254,224,210)","rgb(252,187,161)","rgb(252,146,114)","rgb(251,106,74)","rgb(239,59,44)","rgb(203,24,29)","rgb(153,0,13)"],9:["rgb(255,245,240)","rgb(254,224,210)","rgb(252,187,161)","rgb(252,146,114)","rgb(251,106,74)","rgb(239,59,44)","rgb(203,24,29)","rgb(165,15,21)","rgb(103,0,13)"],type:"seq"},RdPu:{3:["rgb(253,224,221)","rgb(250,159,181)","rgb(197,27,138)"],4:["rgb(254,235,226)","rgb(251,180,185)","rgb(247,104,161)","rgb(174,1,126)"],5:["rgb(254,235,226)","rgb(251,180,185)","rgb(247,104,161)","rgb(197,27,138)","rgb(122,1,119)"],6:["rgb(254,235,226)","rgb(252,197,192)","rgb(250,159,181)","rgb(247,104,161)","rgb(197,27,138)","rgb(122,1,119)"],7:["rgb(254,235,226)","rgb(252,197,192)","rgb(250,159,181)","rgb(247,104,161)","rgb(221,52,151)","rgb(174,1,126)","rgb(122,1,119)"],8:["rgb(255,247,243)","rgb(253,224,221)","rgb(252,197,192)","rgb(250,159,181)","rgb(247,104,161)","rgb(221,52,151)","rgb(174,1,126)","rgb(122,1,119)"],9:["rgb(255,247,243)","rgb(253,224,221)","rgb(252,197,192)","rgb(250,159,181)","rgb(247,104,161)","rgb(221,52,151)","rgb(174,1,126)","rgb(122,1,119)","rgb(73,0,106)"],type:"seq"},Greens:{3:["rgb(229,245,224)","rgb(161,217,155)","rgb(49,163,84)"],4:["rgb(237,248,233)","rgb(186,228,179)","rgb(116,196,118)","rgb(35,139,69)"],5:["rgb(237,248,233)","rgb(186,228,179)","rgb(116,196,118)","rgb(49,163,84)","rgb(0,109,44)"],6:["rgb(237,248,233)","rgb(199,233,192)","rgb(161,217,155)","rgb(116,196,118)","rgb(49,163,84)","rgb(0,109,44)"],7:["rgb(237,248,233)","rgb(199,233,192)","rgb(161,217,155)","rgb(116,196,118)","rgb(65,171,93)","rgb(35,139,69)","rgb(0,90,50)"],8:["rgb(247,252,245)","rgb(229,245,224)","rgb(199,233,192)","rgb(161,217,155)","rgb(116,196,118)","rgb(65,171,93)","rgb(35,139,69)","rgb(0,90,50)"],9:["rgb(247,252,245)","rgb(229,245,224)","rgb(199,233,192)","rgb(161,217,155)","rgb(116,196,118)","rgb(65,171,93)","rgb(35,139,69)","rgb(0,109,44)","rgb(0,68,27)"],type:"seq"},YlGnBu:{3:["rgb(237,248,177)","rgb(127,205,187)","rgb(44,127,184)"],4:["rgb(255,255,204)","rgb(161,218,180)","rgb(65,182,196)","rgb(34,94,168)"],5:["rgb(255,255,204)","rgb(161,218,180)","rgb(65,182,196)","rgb(44,127,184)","rgb(37,52,148)"],6:["rgb(255,255,204)","rgb(199,233,180)","rgb(127,205,187)","rgb(65,182,196)","rgb(44,127,184)","rgb(37,52,148)"],7:["rgb(255,255,204)","rgb(199,233,180)","rgb(127,205,187)","rgb(65,182,196)","rgb(29,145,192)","rgb(34,94,168)","rgb(12,44,132)"],8:["rgb(255,255,217)","rgb(237,248,177)","rgb(199,233,180)","rgb(127,205,187)","rgb(65,182,196)","rgb(29,145,192)","rgb(34,94,168)","rgb(12,44,132)"],9:["rgb(255,255,217)","rgb(237,248,177)","rgb(199,233,180)","rgb(127,205,187)","rgb(65,182,196)","rgb(29,145,192)","rgb(34,94,168)","rgb(37,52,148)","rgb(8,29,88)"],type:"seq"},Purples:{3:["rgb(239,237,245)","rgb(188,189,220)","rgb(117,107,177)"],4:["rgb(242,240,247)","rgb(203,201,226)","rgb(158,154,200)","rgb(106,81,163)"],5:["rgb(242,240,247)","rgb(203,201,226)","rgb(158,154,200)","rgb(117,107,177)","rgb(84,39,143)"],6:["rgb(242,240,247)","rgb(218,218,235)","rgb(188,189,220)","rgb(158,154,200)","rgb(117,107,177)","rgb(84,39,143)"],7:["rgb(242,240,247)","rgb(218,218,235)","rgb(188,189,220)","rgb(158,154,200)","rgb(128,125,186)","rgb(106,81,163)","rgb(74,20,134)"],8:["rgb(252,251,253)","rgb(239,237,245)","rgb(218,218,235)","rgb(188,189,220)","rgb(158,154,200)","rgb(128,125,186)","rgb(106,81,163)","rgb(74,20,134)"],9:["rgb(252,251,253)","rgb(239,237,245)","rgb(218,218,235)","rgb(188,189,220)","rgb(158,154,200)","rgb(128,125,186)","rgb(106,81,163)","rgb(84,39,143)","rgb(63,0,125)"],type:"seq"},GnBu:{3:["rgb(224,243,219)","rgb(168,221,181)","rgb(67,162,202)"],4:["rgb(240,249,232)","rgb(186,228,188)","rgb(123,204,196)","rgb(43,140,190)"],5:["rgb(240,249,232)","rgb(186,228,188)","rgb(123,204,196)","rgb(67,162,202)","rgb(8,104,172)"],6:["rgb(240,249,232)","rgb(204,235,197)","rgb(168,221,181)","rgb(123,204,196)","rgb(67,162,202)","rgb(8,104,172)"],7:["rgb(240,249,232)","rgb(204,235,197)","rgb(168,221,181)","rgb(123,204,196)","rgb(78,179,211)","rgb(43,140,190)","rgb(8,88,158)"],8:["rgb(247,252,240)","rgb(224,243,219)","rgb(204,235,197)","rgb(168,221,181)","rgb(123,204,196)","rgb(78,179,211)","rgb(43,140,190)","rgb(8,88,158)"],9:["rgb(247,252,240)","rgb(224,243,219)","rgb(204,235,197)","rgb(168,221,181)","rgb(123,204,196)","rgb(78,179,211)","rgb(43,140,190)","rgb(8,104,172)","rgb(8,64,129)"],type:"seq"},Greys:{3:["rgb(240,240,240)","rgb(189,189,189)","rgb(99,99,99)"],4:["rgb(247,247,247)","rgb(204,204,204)","rgb(150,150,150)","rgb(82,82,82)"],5:["rgb(247,247,247)","rgb(204,204,204)","rgb(150,150,150)","rgb(99,99,99)","rgb(37,37,37)"],6:["rgb(247,247,247)","rgb(217,217,217)","rgb(189,189,189)","rgb(150,150,150)","rgb(99,99,99)","rgb(37,37,37)"],7:["rgb(247,247,247)","rgb(217,217,217)","rgb(189,189,189)","rgb(150,150,150)","rgb(115,115,115)","rgb(82,82,82)","rgb(37,37,37)"],8:["rgb(255,255,255)","rgb(240,240,240)","rgb(217,217,217)","rgb(189,189,189)","rgb(150,150,150)","rgb(115,115,115)","rgb(82,82,82)","rgb(37,37,37)"],9:["rgb(255,255,255)","rgb(240,240,240)","rgb(217,217,217)","rgb(189,189,189)","rgb(150,150,150)","rgb(115,115,115)","rgb(82,82,82)","rgb(37,37,37)","rgb(0,0,0)"],type:"seq"},YlOrRd:{3:["rgb(255,237,160)","rgb(254,178,76)","rgb(240,59,32)"],4:["rgb(255,255,178)","rgb(254,204,92)","rgb(253,141,60)","rgb(227,26,28)"],5:["rgb(255,255,178)","rgb(254,204,92)","rgb(253,141,60)","rgb(240,59,32)","rgb(189,0,38)"],6:["rgb(255,255,178)","rgb(254,217,118)","rgb(254,178,76)","rgb(253,141,60)","rgb(240,59,32)","rgb(189,0,38)"],7:["rgb(255,255,178)","rgb(254,217,118)","rgb(254,178,76)","rgb(253,141,60)","rgb(252,78,42)","rgb(227,26,28)","rgb(177,0,38)"],8:["rgb(255,255,204)","rgb(255,237,160)","rgb(254,217,118)","rgb(254,178,76)","rgb(253,141,60)","rgb(252,78,42)","rgb(227,26,28)","rgb(177,0,38)"],type:"seq"},PuRd:{3:["rgb(231,225,239)","rgb(201,148,199)","rgb(221,28,119)"],4:["rgb(241,238,246)","rgb(215,181,216)","rgb(223,101,176)","rgb(206,18,86)"],5:["rgb(241,238,246)","rgb(215,181,216)","rgb(223,101,176)","rgb(221,28,119)","rgb(152,0,67)"],6:["rgb(241,238,246)","rgb(212,185,218)","rgb(201,148,199)","rgb(223,101,176)","rgb(221,28,119)","rgb(152,0,67)"],7:["rgb(241,238,246)","rgb(212,185,218)","rgb(201,148,199)","rgb(223,101,176)","rgb(231,41,138)","rgb(206,18,86)","rgb(145,0,63)"],8:["rgb(247,244,249)","rgb(231,225,239)","rgb(212,185,218)","rgb(201,148,199)","rgb(223,101,176)","rgb(231,41,138)","rgb(206,18,86)","rgb(145,0,63)"],9:["rgb(247,244,249)","rgb(231,225,239)","rgb(212,185,218)","rgb(201,148,199)","rgb(223,101,176)","rgb(231,41,138)","rgb(206,18,86)","rgb(152,0,67)","rgb(103,0,31)"],type:"seq"},Blues:{3:["rgb(222,235,247)","rgb(158,202,225)","rgb(49,130,189)"],4:["rgb(239,243,255)","rgb(189,215,231)","rgb(107,174,214)","rgb(33,113,181)"],5:["rgb(239,243,255)","rgb(189,215,231)","rgb(107,174,214)","rgb(49,130,189)","rgb(8,81,156)"],6:["rgb(239,243,255)","rgb(198,219,239)","rgb(158,202,225)","rgb(107,174,214)","rgb(49,130,189)","rgb(8,81,156)"],7:["rgb(239,243,255)","rgb(198,219,239)","rgb(158,202,225)","rgb(107,174,214)","rgb(66,146,198)","rgb(33,113,181)","rgb(8,69,148)"],8:["rgb(247,251,255)","rgb(222,235,247)","rgb(198,219,239)","rgb(158,202,225)","rgb(107,174,214)","rgb(66,146,198)","rgb(33,113,181)","rgb(8,69,148)"],9:["rgb(247,251,255)","rgb(222,235,247)","rgb(198,219,239)","rgb(158,202,225)","rgb(107,174,214)","rgb(66,146,198)","rgb(33,113,181)","rgb(8,81,156)","rgb(8,48,107)"],type:"seq"},PuBuGn:{3:["rgb(236,226,240)","rgb(166,189,219)","rgb(28,144,153)"],4:["rgb(246,239,247)","rgb(189,201,225)","rgb(103,169,207)","rgb(2,129,138)"],5:["rgb(246,239,247)","rgb(189,201,225)","rgb(103,169,207)","rgb(28,144,153)","rgb(1,108,89)"],6:["rgb(246,239,247)","rgb(208,209,230)","rgb(166,189,219)","rgb(103,169,207)","rgb(28,144,153)","rgb(1,108,89)"],7:["rgb(246,239,247)","rgb(208,209,230)","rgb(166,189,219)","rgb(103,169,207)","rgb(54,144,192)","rgb(2,129,138)","rgb(1,100,80)"],8:["rgb(255,247,251)","rgb(236,226,240)","rgb(208,209,230)","rgb(166,189,219)","rgb(103,169,207)","rgb(54,144,192)","rgb(2,129,138)","rgb(1,100,80)"],9:["rgb(255,247,251)","rgb(236,226,240)","rgb(208,209,230)","rgb(166,189,219)","rgb(103,169,207)","rgb(54,144,192)","rgb(2,129,138)","rgb(1,108,89)","rgb(1,70,54)"],type:"seq"},viridis:{256:["#440154","#440256","#450457","#450559","#46075a","#46085c","#460a5d","#460b5e","#470d60","#470e61","#471063","#471164","#471365","#481467","#481668","#481769","#48186a","#481a6c","#481b6d","#481c6e","#481d6f","#481f70","#482071","#482173","#482374","#482475","#482576","#482677","#482878","#482979","#472a7a","#472c7a","#472d7b","#472e7c","#472f7d","#46307e","#46327e","#46337f","#463480","#453581","#453781","#453882","#443983","#443a83","#443b84","#433d84","#433e85","#423f85","#424086","#424186","#414287","#414487","#404588","#404688","#3f4788","#3f4889","#3e4989","#3e4a89","#3e4c8a","#3d4d8a","#3d4e8a","#3c4f8a","#3c508b","#3b518b","#3b528b","#3a538b","#3a548c","#39558c","#39568c","#38588c","#38598c","#375a8c","#375b8d","#365c8d","#365d8d","#355e8d","#355f8d","#34608d","#34618d","#33628d","#33638d","#32648e","#32658e","#31668e","#31678e","#31688e","#30698e","#306a8e","#2f6b8e","#2f6c8e","#2e6d8e","#2e6e8e","#2e6f8e","#2d708e","#2d718e","#2c718e","#2c728e","#2c738e","#2b748e","#2b758e","#2a768e","#2a778e","#2a788e","#29798e","#297a8e","#297b8e","#287c8e","#287d8e","#277e8e","#277f8e","#27808e","#26818e","#26828e","#26828e","#25838e","#25848e","#25858e","#24868e","#24878e","#23888e","#23898e","#238a8d","#228b8d","#228c8d","#228d8d","#218e8d","#218f8d","#21908d","#21918c","#20928c","#20928c","#20938c","#1f948c","#1f958b","#1f968b","#1f978b","#1f988b","#1f998a","#1f9a8a","#1e9b8a","#1e9c89","#1e9d89","#1f9e89","#1f9f88","#1fa088","#1fa188","#1fa187","#1fa287","#20a386","#20a486","#21a585","#21a685","#22a785","#22a884","#23a983","#24aa83","#25ab82","#25ac82","#26ad81","#27ad81","#28ae80","#29af7f","#2ab07f","#2cb17e","#2db27d","#2eb37c","#2fb47c","#31b57b","#32b67a","#34b679","#35b779","#37b878","#38b977","#3aba76","#3bbb75","#3dbc74","#3fbc73","#40bd72","#42be71","#44bf70","#46c06f","#48c16e","#4ac16d","#4cc26c","#4ec36b","#50c46a","#52c569","#54c568","#56c667","#58c765","#5ac864","#5cc863","#5ec962","#60ca60","#63cb5f","#65cb5e","#67cc5c","#69cd5b","#6ccd5a","#6ece58","#70cf57","#73d056","#75d054","#77d153","#7ad151","#7cd250","#7fd34e","#81d34d","#84d44b","#86d549","#89d548","#8bd646","#8ed645","#90d743","#93d741","#95d840","#98d83e","#9bd93c","#9dd93b","#a0da39","#a2da37","#a5db36","#a8db34","#aadc32","#addc30","#b0dd2f","#b2dd2d","#b5de2b","#b8de29","#bade28","#bddf26","#c0df25","#c2df23","#c5e021","#c8e020","#cae11f","#cde11d","#d0e11c","#d2e21b","#d5e21a","#d8e219","#dae319","#dde318","#dfe318","#e2e418","#e5e419","#e7e419","#eae51a","#ece51b","#efe51c","#f1e51d","#f4e61e","#f6e620","#f8e621","#fbe723","#fde725"],type:"seq"},plasma:{256:["#0d0887","#100788","#130789","#16078a","#19068c","#1b068d","#1d068e","#20068f","#220690","#240691","#260591","#280592","#2a0593","#2c0594","#2e0595","#2f0596","#310597","#330597","#350498","#370499","#38049a","#3a049a","#3c049b","#3e049c","#3f049c","#41049d","#43039e","#44039e","#46039f","#48039f","#4903a0","#4b03a1","#4c02a1","#4e02a2","#5002a2","#5102a3","#5302a3","#5502a4","#5601a4","#5801a4","#5901a5","#5b01a5","#5c01a6","#5e01a6","#6001a6","#6100a7","#6300a7","#6400a7","#6600a7","#6700a8","#6900a8","#6a00a8","#6c00a8","#6e00a8","#6f00a8","#7100a8","#7201a8","#7401a8","#7501a8","#7701a8","#7801a8","#7a02a8","#7b02a8","#7d03a8","#7e03a8","#8004a8","#8104a7","#8305a7","#8405a7","#8606a6","#8707a6","#8808a6","#8a09a5","#8b0aa5","#8d0ba5","#8e0ca4","#8f0da4","#910ea3","#920fa3","#9410a2","#9511a1","#9613a1","#9814a0","#99159f","#9a169f","#9c179e","#9d189d","#9e199d","#a01a9c","#a11b9b","#a21d9a","#a31e9a","#a51f99","#a62098","#a72197","#a82296","#aa2395","#ab2494","#ac2694","#ad2793","#ae2892","#b02991","#b12a90","#b22b8f","#b32c8e","#b42e8d","#b52f8c","#b6308b","#b7318a","#b83289","#ba3388","#bb3488","#bc3587","#bd3786","#be3885","#bf3984","#c03a83","#c13b82","#c23c81","#c33d80","#c43e7f","#c5407e","#c6417d","#c7427c","#c8437b","#c9447a","#ca457a","#cb4679","#cc4778","#cc4977","#cd4a76","#ce4b75","#cf4c74","#d04d73","#d14e72","#d24f71","#d35171","#d45270","#d5536f","#d5546e","#d6556d","#d7566c","#d8576b","#d9586a","#da5a6a","#da5b69","#db5c68","#dc5d67","#dd5e66","#de5f65","#de6164","#df6263","#e06363","#e16462","#e26561","#e26660","#e3685f","#e4695e","#e56a5d","#e56b5d","#e66c5c","#e76e5b","#e76f5a","#e87059","#e97158","#e97257","#ea7457","#eb7556","#eb7655","#ec7754","#ed7953","#ed7a52","#ee7b51","#ef7c51","#ef7e50","#f07f4f","#f0804e","#f1814d","#f1834c","#f2844b","#f3854b","#f3874a","#f48849","#f48948","#f58b47","#f58c46","#f68d45","#f68f44","#f79044","#f79143","#f79342","#f89441","#f89540","#f9973f","#f9983e","#f99a3e","#fa9b3d","#fa9c3c","#fa9e3b","#fb9f3a","#fba139","#fba238","#fca338","#fca537","#fca636","#fca835","#fca934","#fdab33","#fdac33","#fdae32","#fdaf31","#fdb130","#fdb22f","#fdb42f","#fdb52e","#feb72d","#feb82c","#feba2c","#febb2b","#febd2a","#febe2a","#fec029","#fdc229","#fdc328","#fdc527","#fdc627","#fdc827","#fdca26","#fdcb26","#fccd25","#fcce25","#fcd025","#fcd225","#fbd324","#fbd524","#fbd724","#fad824","#fada24","#f9dc24","#f9dd25","#f8df25","#f8e125","#f7e225","#f7e425","#f6e626","#f6e826","#f5e926","#f5eb27","#f4ed27","#f3ee27","#f3f027","#f2f227","#f1f426","#f1f525","#f0f724","#f0f921"],type:"seq"},inferno:{256:["#000004","#010005","#010106","#010108","#02010a","#02020c","#02020e","#030210","#040312","#040314","#050417","#060419","#07051b","#08051d","#09061f","#0a0722","#0b0724","#0c0826","#0d0829","#0e092b","#10092d","#110a30","#120a32","#140b34","#150b37","#160b39","#180c3c","#190c3e","#1b0c41","#1c0c43","#1e0c45","#1f0c48","#210c4a","#230c4c","#240c4f","#260c51","#280b53","#290b55","#2b0b57","#2d0b59","#2f0a5b","#310a5c","#320a5e","#340a5f","#360961","#380962","#390963","#3b0964","#3d0965","#3e0966","#400a67","#420a68","#440a68","#450a69","#470b6a","#490b6a","#4a0c6b","#4c0c6b","#4d0d6c","#4f0d6c","#510e6c","#520e6d","#540f6d","#550f6d","#57106e","#59106e","#5a116e","#5c126e","#5d126e","#5f136e","#61136e","#62146e","#64156e","#65156e","#67166e","#69166e","#6a176e","#6c186e","#6d186e","#6f196e","#71196e","#721a6e","#741a6e","#751b6e","#771c6d","#781c6d","#7a1d6d","#7c1d6d","#7d1e6d","#7f1e6c","#801f6c","#82206c","#84206b","#85216b","#87216b","#88226a","#8a226a","#8c2369","#8d2369","#8f2469","#902568","#922568","#932667","#952667","#972766","#982766","#9a2865","#9b2964","#9d2964","#9f2a63","#a02a63","#a22b62","#a32c61","#a52c60","#a62d60","#a82e5f","#a92e5e","#ab2f5e","#ad305d","#ae305c","#b0315b","#b1325a","#b3325a","#b43359","#b63458","#b73557","#b93556","#ba3655","#bc3754","#bd3853","#bf3952","#c03a51","#c13a50","#c33b4f","#c43c4e","#c63d4d","#c73e4c","#c83f4b","#ca404a","#cb4149","#cc4248","#ce4347","#cf4446","#d04545","#d24644","#d34743","#d44842","#d54a41","#d74b3f","#d84c3e","#d94d3d","#da4e3c","#db503b","#dd513a","#de5238","#df5337","#e05536","#e15635","#e25734","#e35933","#e45a31","#e55c30","#e65d2f","#e75e2e","#e8602d","#e9612b","#ea632a","#eb6429","#eb6628","#ec6726","#ed6925","#ee6a24","#ef6c23","#ef6e21","#f06f20","#f1711f","#f1731d","#f2741c","#f3761b","#f37819","#f47918","#f57b17","#f57d15","#f67e14","#f68013","#f78212","#f78410","#f8850f","#f8870e","#f8890c","#f98b0b","#f98c0a","#f98e09","#fa9008","#fa9207","#fa9407","#fb9606","#fb9706","#fb9906","#fb9b06","#fb9d07","#fc9f07","#fca108","#fca309","#fca50a","#fca60c","#fca80d","#fcaa0f","#fcac11","#fcae12","#fcb014","#fcb216","#fcb418","#fbb61a","#fbb81d","#fbba1f","#fbbc21","#fbbe23","#fac026","#fac228","#fac42a","#fac62d","#f9c72f","#f9c932","#f9cb35","#f8cd37","#f8cf3a","#f7d13d","#f7d340","#f6d543","#f6d746","#f5d949","#f5db4c","#f4dd4f","#f4df53","#f4e156","#f3e35a","#f3e55d","#f2e661","#f2e865","#f2ea69","#f1ec6d","#f1ed71","#f1ef75","#f1f179","#f2f27d","#f2f482","#f3f586","#f3f68a","#f4f88e","#f5f992","#f6fa96","#f8fb9a","#f9fc9d","#fafda1","#fcffa4"],type:"seq"},magma:{256:["#000004","#010005","#010106","#010108","#020109","#02020b","#02020d","#03030f","#030312","#040414","#050416","#060518","#06051a","#07061c","#08071e","#090720","#0a0822","#0b0924","#0c0926","#0d0a29","#0e0b2b","#100b2d","#110c2f","#120d31","#130d34","#140e36","#150e38","#160f3b","#180f3d","#19103f","#1a1042","#1c1044","#1d1147","#1e1149","#20114b","#21114e","#221150","#241253","#251255","#271258","#29115a","#2a115c","#2c115f","#2d1161","#2f1163","#311165","#331067","#341069","#36106b","#38106c","#390f6e","#3b0f70","#3d0f71","#3f0f72","#400f74","#420f75","#440f76","#451077","#471078","#491078","#4a1079","#4c117a","#4e117b","#4f127b","#51127c","#52137c","#54137d","#56147d","#57157e","#59157e","#5a167e","#5c167f","#5d177f","#5f187f","#601880","#621980","#641a80","#651a80","#671b80","#681c81","#6a1c81","#6b1d81","#6d1d81","#6e1e81","#701f81","#721f81","#732081","#752181","#762181","#782281","#792282","#7b2382","#7c2382","#7e2482","#802582","#812581","#832681","#842681","#862781","#882781","#892881","#8b2981","#8c2981","#8e2a81","#902a81","#912b81","#932b80","#942c80","#962c80","#982d80","#992d80","#9b2e7f","#9c2e7f","#9e2f7f","#a02f7f","#a1307e","#a3307e","#a5317e","#a6317d","#a8327d","#aa337d","#ab337c","#ad347c","#ae347b","#b0357b","#b2357b","#b3367a","#b5367a","#b73779","#b83779","#ba3878","#bc3978","#bd3977","#bf3a77","#c03a76","#c23b75","#c43c75","#c53c74","#c73d73","#c83e73","#ca3e72","#cc3f71","#cd4071","#cf4070","#d0416f","#d2426f","#d3436e","#d5446d","#d6456c","#d8456c","#d9466b","#db476a","#dc4869","#de4968","#df4a68","#e04c67","#e24d66","#e34e65","#e44f64","#e55064","#e75263","#e85362","#e95462","#ea5661","#eb5760","#ec5860","#ed5a5f","#ee5b5e","#ef5d5e","#f05f5e","#f1605d","#f2625d","#f2645c","#f3655c","#f4675c","#f4695c","#f56b5c","#f66c5c","#f66e5c","#f7705c","#f7725c","#f8745c","#f8765c","#f9785d","#f9795d","#f97b5d","#fa7d5e","#fa7f5e","#fa815f","#fb835f","#fb8560","#fb8761","#fc8961","#fc8a62","#fc8c63","#fc8e64","#fc9065","#fd9266","#fd9467","#fd9668","#fd9869","#fd9a6a","#fd9b6b","#fe9d6c","#fe9f6d","#fea16e","#fea36f","#fea571","#fea772","#fea973","#feaa74","#feac76","#feae77","#feb078","#feb27a","#feb47b","#feb67c","#feb77e","#feb97f","#febb81","#febd82","#febf84","#fec185","#fec287","#fec488","#fec68a","#fec88c","#feca8d","#fecc8f","#fecd90","#fecf92","#fed194","#fed395","#fed597","#fed799","#fed89a","#fdda9c","#fddc9e","#fddea0","#fde0a1","#fde2a3","#fde3a5","#fde5a7","#fde7a9","#fde9aa","#fdebac","#fcecae","#fceeb0","#fcf0b2","#fcf2b4","#fcf4b6","#fcf6b8","#fcf7b9","#fcf9bb","#fcfbbd","#fcfdbf"],type:"seq"}}},function(t,e,n){var i=n(0),r=n(1),s=n(3),a=n(4).Mark.extend({render:function(){var t=a.__super__.render.apply(this),e=this;return this.drag_listener=i.behavior.drag().on("dragstart",function(t,n){return e.drag_start(t,n,this)}).on("drag",function(t,n){return e.on_drag(t,n,this)}).on("dragend",function(t,n){return e.drag_ended(t,n,this)}),this.selected_style=this.model.get("selected_style"),this.unselected_style=this.model.get("unselected_style"),this.selected_indices=this.model.get("selected"),this.hovered_style=this.model.get("hovered_style"),this.unhovered_style=this.model.get("unhovered_style"),this.hovered_index=this.model.get("hovered_point")?[this.model.get("hovered_point")]:null,this.display_el_classes=["dot","legendtext"],this.event_metadata={mouse_over:{msg_name:"hover",lookup_data:!1,hit_test:!0},legend_clicked:{msg_name:"legend_click",hit_test:!0},element_clicked:{msg_name:"element_click",lookup_data:!1,hit_test:!0},parent_clicked:{msg_name:"background_click",hit_test:!1}},this.displayed.then(function(){e.parent.tooltip_div.node().appendChild(e.tooltip_div.node()),e.create_tooltip()}),t.then(function(){e.event_listeners={},e.process_interactions(),e.create_listeners(),e.compute_view_padding(),e.draw()})},set_ranges:function(){var t=this.scales.x,e=this.scales.y,n=this.scales.size,i=this.scales.opacity,r=this.scales.skew,s=this.scales.rotation;t&&t.set_range(this.parent.padded_range("x",t.model)),e&&e.set_range(this.parent.padded_range("y",e.model)),n&&n.set_range([0,this.model.get("default_size")]),i&&i.set_range([.2,1]),r&&r.set_range([0,1]),s&&s.set_range([0,180])},set_positional_scales:function(){this.x_scale=this.scales.x,this.y_scale=this.scales.y,this.x_scale||(this.x_scale=this.parent.scale_x),this.y_scale||(this.y_scale=this.parent.scale_y),this.listenTo(this.x_scale,"domain_changed",function(){if(!this.model.dirty){this.update_position(!0)}}),this.listenTo(this.y_scale,"domain_changed",function(){if(!this.model.dirty){this.update_position(!0)}})},initialize_additional_scales:function(){var t=this.scales.color,e=this.scales.size,n=this.scales.opacity,i=this.scales.skew,r=this.scales.rotation;t&&(this.listenTo(t,"domain_changed",function(){this.color_scale_updated(!0)}),t.on("color_scale_range_changed",this.color_scale_updated,this)),e&&this.listenTo(e,"domain_changed",function(){this.update_default_size(!0)}),n&&this.listenTo(n,"domain_changed",function(){this.update_default_opacities(!0)}),i&&this.listenTo(i,"domain_changed",function(){this.update_default_skew(!0)}),r&&this.listenTo(r,"domain_changed",function(){this.update_position(!0)})},create_listeners:function(){a.__super__.create_listeners.apply(this),this.d3el.on("mouseover",r.bind(function(){this.event_dispatcher("mouse_over")},this)).on("mousemove",r.bind(function(){this.event_dispatcher("mouse_move")},this)).on("mouseout",r.bind(function(){this.event_dispatcher("mouse_out")},this)),this.listenTo(this.model,"data_updated",function(){this.draw(!0)},this),this.listenTo(this.model,"change:tooltip",this.create_tooltip,this),this.listenTo(this.model,"change:enable_hover",function(){this.hide_tooltip()},this),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.model,"change:enable_move",this.set_drag_behavior),this.listenTo(this.model,"change:selected",this.update_selected),this.listenTo(this.model,"change:hovered_point",this.update_hovered),this.listenTo(this.model,"change:hovered_style",this.hovered_style_updated,this),this.listenTo(this.model,"change:unhovered_style",this.unhovered_style_updated,this),this.listenTo(this.parent,"bg_clicked",function(){this.event_dispatcher("parent_clicked")})},get_element_color:function(t,e){var n=this.scales.color,i=this.model.get("colors"),r=i.length;return n&&void 0!==t.color&&null!==t.color?n.scale(t.color):i[e%r]},get_element_size:function(t){var e=this.scales.size;return e&&void 0!==t.size?e.scale(t.size):this.model.get("default_size")},get_element_opacity:function(t,e){var n=this.scales.opacity,i=this.model.get("default_opacities"),r=i.length;return n&&void 0!==t.opacity?n.scale(t.opacity):i[e%r]},get_element_skew:function(t){var e=this.scales.skew;return e&&void 0!==t.skew?e.scale(t.skew):this.model.get("default_skew")},get_element_rotation:function(t){var e=this.scales.rotation;return e&&t.rotation?"rotate("+e.scale(t.rotation)+")":""},relayout:function(){this.set_ranges(),this.update_position()},update_position:function(t){var e=this.scales.x,n=this.scales.y,i=this,r=!0===t?this.parent.model.get("animation_duration"):0;this.d3el.selectAll(".object_grp").transition("update_position").duration(r).attr("transform",function(t){return"translate("+(e.scale(t.x)+e.offset)+","+(n.scale(t.y)+n.offset)+")"+i.get_element_rotation(t)}),this.x_pixels=this.model.mark_data.map(function(t){return e.scale(t.x)+e.offset}),this.y_pixels=this.model.mark_data.map(function(t){return n.scale(t.y)+n.offset}),this.pixel_coords=this.model.mark_data.map(function(t){return[e.scale(t.x)+e.offset,n.scale(t.y)+n.offset]})},draw:function(t){this.set_ranges();this.scales.x,this.scales.y,this.model.get("fill"),!0===t&&this.parent.model.get("animation_duration");var e=this.d3el.selectAll(".object_grp").data(this.model.mark_data,function(t){return t.unique_id}),n=e.enter().append("g").attr("class","object_grp");this.update_position(t),this.set_drag_behavior(),e.on("click",r.bind(function(t,e){this.event_dispatcher("element_clicked",{data:t,index:e})},this)),e.on("mouseover",r.bind(function(t,e){this.scatter_hover_handler({data:t,index:e})},this)),e.on("mouseout",r.bind(function(){this.reset_hover()},this)),this.draw_elements(t,n),e.exit().remove()},draw_elements:function(t,e){},process_interactions:function(){var t=this.model.get("interactions");r.isEmpty(t)?this.reset_interactions():(void 0!==t.click&&null!==t.click?"tooltip"===t.click?(this.event_listeners.element_clicked=function(){return this.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip):"add"===t.click?(this.event_listeners.parent_clicked=this.add_element,this.event_listeners.element_clicked=function(){}):"delete"===t.click?(this.event_listeners.parent_clicked=function(){},this.event_listeners.element_clicked=this.delete_element):"select"==t.click&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.scatter_click_handler):this.reset_click(),void 0!==t.hover&&null!==t.hover?"tooltip"===t.hover&&(this.event_listeners.mouse_over=this.refresh_tooltip,this.event_listeners.mouse_move=this.move_tooltip,this.event_listeners.mouse_out=this.hide_tooltip):this.reset_hover(),void 0!==t.legend_click&&null!==t.legend_click?"tooltip"===t.legend_click&&(this.event_listeners.legend_clicked=function(){return this.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip):this.event_listeners.legend_clicked=function(){},void 0!==t.legend_hover&&null!==t.legend_hover?"highlight_axes"===t.legend_hover&&(this.event_listeners.legend_mouse_over=r.bind(this.highlight_axes,this),this.event_listeners.legend_mouse_out=r.bind(this.unhighlight_axes,this)):this.reset_legend_hover())},reset_hover:function(){this.model.set("hovered_point",null),this.hovered_index=null,this.touch()},scatter_hover_handler:function(t){t.data;var e=t.index;this.model.set("hovered_point",e,{updated_view:this}),this.touch()},reset_selection:function(){this.model.set("selected",null),this.selected_indices=null,this.touch()},scatter_click_handler:function(t){t.data;var e=t.index,n=this.model.get("selected"),r=n?s.deepCopy(n):[],a=r.indexOf(e),o=i.event.ctrlKey||i.event.metaKey;a>-1&&o?r.splice(a,1):o?r.push(e):(r=[]).push(e),this.model.set("selected",0===r.length?null:r,{updated_view:this}),this.touch(),i.event||(i.event=window.event);var l=i.event;void 0!==l.cancelBubble&&(l.cancelBubble=!0),l.stopPropagation&&l.stopPropagation(),l.preventDefault()},hovered_style_updated:function(t,e){this.hovered_style=e,this.clear_style(t.previous("hovered_style"),this.hovered_index),this.style_updated(e,this.hovered_index)},unhovered_style_updated:function(t,e){this.unhovered_style=e;var n=this.hovered_index,i=n?r.range(this.model.mark_data.length).filter(function(t){return-1===n.indexOf(t)}):[];this.clear_style(t.previous("unhovered_style"),i),this.style_updated(e,i)},draw_legend:function(t,e,n,s,a){this.legend_el=t.selectAll(".legend"+this.uuid).data([this.model.mark_data[0]]);var o=this.model.get("colors"),l=o.length,c=this,h=.8*a,u=this.legend_el.enter().append("g").attr("class","legend"+this.uuid).attr("transform",function(t,e){return"translate(0, "+(e*a+n)+")"}).on("mouseover",r.bind(function(){this.event_dispatcher("legend_mouse_over")},this)).on("mouseout",r.bind(function(){this.event_dispatcher("legend_mouse_out")},this)).on("click",r.bind(function(){this.event_dispatcher("legend_clicked")},this));this.draw_legend_elements(u,h),this.legend_el.append("text").attr("class","legendtext").attr("x",1.2*h).attr("y",h/2).attr("dy","0.35em").text(function(t,e){return c.model.get("labels")[e]}).style("fill",function(t,e){return o[e%l]});var d=i.max(this.model.get("labels"),function(t){return t.length});return this.legend_el.exit().remove(),[1,d]},draw_legend_elements:function(t,e){},invert_point:function(t){if(void 0===t)return this.model.set("selected",null),void this.touch();this.scales.x;var e=this.x_pixels.map(function(e){return Math.abs(e-t)}),n=e.indexOf(i.min(e));this.model.set("selected",[n]),this.touch()},selector_changed:function(t,e){if(void 0===t)return this.model.set("selected",null),this.touch(),[];var n=this.pixel_coords,i=r.range(n.length),s=r.filter(i,function(e){return t(n[e])});this.model.set("selected",s),this.touch()},update_selected:function(t,e){this.selected_indices=e,this.apply_styles()},update_hovered:function(t,e){this.hovered_index=null===e?e:[e],this.apply_styles()},apply_styles:function(t){void 0!==t&&null!=t||(t=[this.selected_style,this.unselected_style,this.hovered_style,this.unhovered_style]),a.__super__.apply_styles.apply(this,[t]);var e=r.range(this.model.mark_data.length);this.set_style_on_elements(this.hovered_style,this.hovered_index);var n=this.hovered_index?r.difference(e,this.hovered_index):[];this.set_style_on_elements(this.unhovered_style,n)},clear_style:function(t,e){var n=this.d3el.selectAll(".element");e&&(n=n.filter(function(t,n){return-1!==e.indexOf(n)}));var i={};for(var r in t)i[r]=null;n.style(i)},set_style_on_elements:function(t,e){if(e&&0!==e.length&&0!==Object.keys(t).length){var n=this.d3el.selectAll(".element");(n=n.filter(function(t,n){return-1!==e.indexOf(n)})).style(t)}},compute_view_padding:function(){var t=Math.sqrt(this.model.get("default_size"))/2+1;t===this.x_padding&&t===this.y_padding||(this.x_padding=t,this.y_padding=t,this.trigger("mark_padding_updated"))},update_array:function(t,e){var n=this.scales.x,i=this.scales.y;if(!this.model.get("restrict_y")){var r=[];this.model.get_typed_field("x").forEach(function(t){r.push(t)}),r[e]=n.scale.invert(t[0]),this.model.set_typed_field("x",r)}if(!this.model.get("restrict_x")){var s=[];this.model.get_typed_field("y").forEach(function(t){s.push(t)}),s[e]=i.scale.invert(t[1]),this.model.set_typed_field("y",s)}this.touch()},set_drag_behavior:function(){var t=this.d3el.selectAll(".object_grp");this.model.get("enable_move")?t.call(this.drag_listener):t.on(".drag",null)},set_drag_style:function(t,e,n){},reset_drag_style:function(t,e,n){},drag_start:function(t,e,n){var i=this.scales.x,r=this.scales.y;t[0]=i.scale(t.x)+i.offset,t[1]=r.scale(t.y)+r.offset,this.set_drag_style(t,e,n),this.send({event:"drag_start",point:{x:t.x,y:t.y},index:e})},on_drag:function(t,e,n){var r=this.scales.x,s=this.scales.y,a=this.model.get("restrict_x"),o=this.model.get("restrict_y");a&&o||(o||(t[0]=i.event.x),a||(t[1]=i.event.y),i.select(n).attr("transform",function(){return"translate("+t[0]+","+t[1]+")"}),this.send({event:"drag",origin:{x:t.x,y:t.y},point:{x:r.invert(t[0]),y:s.invert(t[1])},index:e}),this.model.get("update_on_move")&&this.update_array(t,e))},drag_ended:function(t,e,n){var i=this.scales.x,r=this.scales.y;this.reset_drag_style(t,e,n),this.update_array(t,e),this.send({event:"drag_end",point:{x:i.invert(t[0]),y:r.invert(t[1])},index:e})},selected_deleter:function(){i.event.stopPropagation()},add_element:function(){var t=i.mouse(this.el),e=[t[0],t[1]],n=this.scales.x,r=this.scales.y,s=[];this.model.get_typed_field("x").forEach(function(t){s.push(t)});var a=[];this.model.get_typed_field("y").forEach(function(t){a.push(t)}),s.push(n.scale.invert(e[0])),a.push(r.scale.invert(e[1])),this.model.set_typed_field("x",s),this.model.set_typed_field("y",a),this.touch()},delete_element:function(t){t.data;var e=t.index,n=[];this.model.get_typed_field("x").forEach(function(t,i){i!=e&&n.push(t)});var i=[];this.model.get_typed_field("y").forEach(function(t,n){n!=e&&i.push(t)}),this.model.set_typed_field("x",n),this.model.set_typed_field("y",i),this.touch()}});t.exports={ScatterBase:a}},function(t,e,n){n(0);var i=n(1),r=n(5),s=r.MarkModel.extend({defaults:function(){return i.extend({},r.MarkModel.prototype.defaults(),{_model_name:"ScatterBaseModel",_view_name:"ScatterBase",x:[],y:[],color:null,opacity:null,size:null,rotation:null,hovered_point:null,scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"},color:{dimension:"color"},size:{dimension:"size"},opacity:{dimension:"opacity"},rotation:{dimension:"rotation"}},hovered_style:{},unhovered_style:{},colors:[],default_opacities:[],enable_move:!1,enable_delete:!1,restrict_x:!1,restrict_y:!1,update_on_move:!1})},initialize:function(){s.__super__.initialize.apply(this,arguments),this.on_some_change(["x","y","color","opacity","size","rotation"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data()},update_mark_data:function(){var t=this.get_typed_field("x"),e=this.get_typed_field("y"),n=this.get("scales"),i=(n.x,n.y,n.color);if(0===t.length||0===e.length)this.mark_data=[];else{var r=Math.min(t.length,e.length);t=t.slice(0,r);var s=this.get_typed_field("color"),a=this.get_typed_field("size"),o=this.get_typed_field("opacity"),l=this.get_typed_field("rotation");i&&(this.get("preserve_domain").color?i.del_domain([],this.model_id+"_color"):i.compute_and_set_domain(s,this.model_id+"_color")),this.mark_data=t.map(function(t,n){return{x:t,y:e[n],color:s[n],size:a[n],opacity:o[n],rotation:l[n],index:n}})}},update_data:function(){this.dirty=!0,this.update_mark_data(),this.update_unique_ids(),this.update_domains(),this.dirty=!1,this.trigger("data_updated")},update_unique_ids:function(){},get_data_dict:function(t,e){return t},update_domains:function(){if(this.mark_data){var t=this.get("scales");for(var e in t)if(t.hasOwnProperty(e)&&"color"!=e){var n=t[e];this.get("preserve_domain")[e]?n.del_domain([],this.model_id+e):n.compute_and_set_domain(this.mark_data.map(function(t){return t[e]}),this.model_id+e)}}}});t.exports={ScatterBaseModel:s}},function(t,e){t.exports={point_in_lasso:function(t,e){for(var n,i,r,s,a=t[0],o=t[1],l=!1,c=0,h=e.length-1;c<e.length;h=c++)n=e[c][0],r=e[c][1],i=e[h][0],r>o!=(s=e[h][1])>o&&a<(i-n)*(o-r)/(s-r)+n&&(l=!l);return l}}},function(t,e,n){n(1);var i=n(10).Scale.extend({render:function(){this.create_d3_scale(),this.update_extrapolation(),this.model.domain.length>0&&this.scale.domain(this.model.domain),this.offset=0,this.create_event_listeners(),this.set_range()},create_d3_scale:function(){this.scale=d3.scale.linear()},create_event_listeners:function(){i.__super__.create_event_listeners.apply(this),this.listenTo(this.model,"colors_changed",this.set_range,this),this.model.on("change:extrapolation",function(){this.update_extrapolation(),this.trigger("color_scale_range_changed")},this)},update_extrapolation:function(){this.scale.clamp("constant"===this.model.get("extrapolation"))},set_range:function(){this.scale.range(this.model.color_range),this.trigger("color_scale_range_changed")}});t.exports={ColorScale:i}},function(t,e,n){var r=n(0),s=n(1),a=n(12),o=n(13),l=a.LinearScaleModel.extend({set_init_state:function(){this.type="color_linear",this.color_range=[],this.mid=null},set_listeners:function(){l.__super__.set_listeners.apply(this,arguments),this.on_some_change(["colors","scheme"],this.colors_changed,this),this.on("change:mid",this.update_domain,this),this.colors_changed()},update_domain:function(){var t=this,e=this.min_from_data?r.min(s.map(this.domains,function(e){return e.length>0?e[0]:t.global_max})):this.min,n=this.max_from_data?r.max(s.map(this.domains,function(e){return e.length>0?e[e.length-1]:t.global_min})):this.max,i=this.mid;this.mid=this.get("mid");var a=this.domain,o=a.length,l=this.color_range.length;e==a[0]&&n==a[o-1]&&l==o&&this.mid==i||(this.domain=this.create_domain(e,this.mid,n,l),this.trigger("domain_changed",this.domain))},create_domain:function(t,e,n,s){var a=r.scale.linear();if(void 0===e||null===e)a.domain([0,s-1]).range([t,n]);else{var o=s/2;a.domain([0,o,s-1]).range([t,e,n])}var l=[];for(i=0;i<s;i++){var c=this.reverse?s-1-i:i;l.push(a(c))}return l},colors_changed:function(){var t=this.get("colors");this.color_range=t.length>0?t:o.get_linear_scale_range(this.get("scheme")),this.update_domain(),this.trigger("colors_changed")}});t.exports={ColorScaleModel:l}},function(t,e,n){var i=n(1),r=n(0),s=n(4),a=n(16),o=(n(3),a.symbol),l=s.Mark.extend({render:function(){var t=l.__super__.render.apply(this),e=this;return this.dot=o().size(this.model.get("marker_size")),this.model.get("marker")&&this.dot.type(this.model.get("marker")),this.displayed.then(function(){e.parent.tooltip_div.node().appendChild(e.tooltip_div.node()),e.create_tooltip()}),this.display_el_classes=["line","legendtext","dot"],t.then(function(){e.event_listeners={},e.process_interactions(),e.create_listeners(),e.compute_view_padding(),e.draw()})},set_ranges:function(){var t=this.scales.x;t&&t.set_range(this.parent.padded_range("x",t.model));var e=this.scales.y;e&&e.set_range(this.parent.padded_range("y",e.model))},set_positional_scales:function(){var t=this.scales.x,e=this.scales.y;this.listenTo(t,"domain_changed",function(){this.model.dirty||this.update_line_xy()}),this.listenTo(e,"domain_changed",function(){this.model.dirty||this.update_line_xy()})},initialize_additional_scales:function(){var t=this.scales.color;t&&(this.listenTo(t,"domain_changed",function(){this.update_style()}),t.on("color_scale_range_changed",this.update_style,this))},create_listeners:function(){l.__super__.create_listeners.apply(this),this.d3el.on("mouseover",i.bind(function(){this.event_dispatcher("mouse_over")},this)).on("mousemove",i.bind(function(){this.event_dispatcher("mouse_move")},this)).on("mouseout",i.bind(function(){this.event_dispatcher("mouse_out")},this)),this.listenTo(this.model,"change:tooltip",this.create_tooltip,this),this.listenTo(this.model,"change:interpolation",this.update_path_style,this),this.listenTo(this.model,"change:close_path",this.update_path_style,this),this.listenTo(this.model,"change:colors",this.update_style,this),this.listenTo(this.model,"change:opacities",this.update_style,this),this.listenTo(this.model,"change:fill_opacities",this.update_style,this),this.listenTo(this.model,"change:fill_colors",this.update_style,this),this.listenTo(this.model,"change:fill",this.update_fill,this),this.listenTo(this.model,"data_updated",function(){this.draw(!0)},this),this.listenTo(this.model,"labels_updated",this.update_labels,this),this.listenTo(this.model,"change:stroke_width",this.update_stroke_width,this),this.listenTo(this.model,"change:labels_visibility",this.update_legend_labels,this),this.listenTo(this.model,"change:curves_subset",this.update_curves_subset,this),this.listenTo(this.model,"change:line_style",this.update_line_style,this),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.parent,"bg_clicked",function(){this.event_dispatcher("parent_clicked")}),this.listenTo(this.model,"change:marker",this.update_marker,this),this.listenTo(this.model,"change:marker_size",this.update_marker_size,this)},update_legend_labels:function(){"none"===this.model.get("labels_visibility")?(this.d3el.selectAll(".legend").attr("display","none"),this.d3el.selectAll(".curve_label").attr("display","none")):"label"===this.model.get("labels_visibility")?(this.d3el.selectAll(".legend").attr("display","none"),this.d3el.selectAll(".curve_label").attr("display","inline")):(this.d3el.selectAll(".legend").attr("display","inline"),this.d3el.selectAll(".curve_label").attr("display","none"))},update_labels:function(){this.d3el.selectAll(".curve").data(this.model.mark_data).select(".curve_label").text(function(t){return t.name})},get_line_style:function(){switch(this.model.get("line_style")){case"solid":return"none";case"dashed":return"10,10";case"dotted":return"2,10";case"dash_dotted":return"10,5,2,5"}},update_line_style:function(){this.d3el.selectAll(".curve").select(".line").style("stroke-dasharray",i.bind(this.get_line_style,this)),this.legend_el&&this.legend_el.select("path").style("stroke-dasharray",i.bind(this.get_line_style,this))},update_stroke_width:function(t,e){this.compute_view_padding(),this.d3el.selectAll(".curve").select(".line").style("stroke-width",e),this.legend_el&&this.legend_el.select("path").style("stroke-width",e)},update_style:function(){var t=this,e=this.model.get("fill"),n=this.model.get("fill_colors"),i=this.model.get("opacities"),r=this.model.get("fill_opacities"),s=this.d3el.selectAll(".curve");s.select(".line").style("opacity",function(t,e){return i[e]}).style("stroke",function(e,i){return t.get_element_color(e,i)||n[i]}).style("fill",function(n,i){return"inside"===e?t.get_fill_color(n,i):""}).style("fill-opacity",function(t,n){return"inside"===e?r[n]:""}),s.select(".area").style("fill",function(e,n){return t.get_fill_color(e,n)}).style("opacity",function(t,e){return r[e]}),this.update_marker_style(),this.legend_el&&(this.legend_el.select(".line").style("stroke",function(e,i){return t.get_element_color(e,i)||n[i]}).style("opacity",function(t,e){return i[e]}).style("fill",function(e,n){return"none"===t.model.get("fill")?"":t.get_fill_color(e,n)}),this.legend_el.select(".dot").style("stroke",function(e,i){return t.get_element_color(e,i)||n[i]}).style("opacity",function(t,e){return i[e]}).style("fill",function(e,i){return t.get_element_color(e,i)||n[i]}),this.legend_el.select("text").style("fill",function(e,i){return t.get_element_color(e,i)||n[i]}).style("opacity",function(t,e){return i[e]})),this.update_stroke_width(this.model,this.model.get("stroke_width")),this.update_line_style()},path_closure:function(){return this.model.get("close_path")?"Z":""},update_path_style:function(){var t=this.model.get("interpolation");this.line.interpolate(t),this.area.interpolate(t);var e=this;this.d3el.selectAll(".curve").select(".line").attr("d",function(t){return e.line(t.values)+e.path_closure()}),this.d3el.selectAll(".curve").select(".area").transition("update_path_style").duration(0).attr("d",function(t){return e.area(t.values)}),this.legend_el&&(this.legend_line.interpolate(t),this.legend_el.selectAll("path").attr("d",this.legend_line(this.legend_path_data)+this.path_closure()))},relayout:function(){this.set_ranges(),this.update_line_xy()},selector_changed:function(t,e){if(void 0===t)return this.model.set("selected",null),this.touch(),[];var n=this.pixel_coords,r=i.range(n.length),s=i.filter(r,function(e){return t(n[e])});this.model.set("selected",s),this.touch()},invert_point:function(t){if(void 0===t)return this.model.set("selected",null),void this.touch();this.scales.x;var e=Math.min(this.bisect(this.x_pixels,t),Math.max(this.x_pixels.length-1,0));this.model.set("selected",[e]),this.touch()},update_multi_range:function(t){this.scales.x,this.scales.y;var e=t[0],n=t[1],i=this.model.x_data[0]instanceof Array?this.model.x_data[0]:this.model.x_data,r=this.bisect(i,e),s=Math.min(this.bisect(i,n),Math.max(i.length-1,0));this.selector_model.set("selected",[r,s]),this.selector.touch()},draw_legend:function(t,e,n,s,a){var o=this.model.get_labels(),l=this.model.mark_data.map(function(t){return{index:t.index,name:t.name,color:t.color}});this.legend_el=t.selectAll(".legend"+this.uuid).data(l);var c=this,h=.8*a,u=this.model.get("fill_colors"),d=this.model.get("opacities");this.legend_line=r.svg.line().interpolate(this.model.get("interpolation")).x(function(t){return t[0]}).y(function(t){return t[1]}),this.legend_path_data=[[0,h],[h/2,0],[h,h/2]];var _=this.legend_el.enter().append("g").attr("class","legend"+this.uuid).attr("transform",function(t,e){return"translate(0, "+(e*a+n)+")"}).on("mouseover",i.bind(function(){this.event_dispatcher("legend_mouse_over")},this)).on("mouseout",i.bind(function(){this.event_dispatcher("legend_mouse_out")},this)).on("click",i.bind(function(){this.event_dispatcher("legend_clicked")},this));_.append("path").attr("class","line").attr("fill","none").attr("d",this.legend_line(this.legend_path_data)+this.path_closure()).style("stroke",function(t,e){return c.get_element_color(t,e)||u[e]}).style("fill",function(t,e){return"none"===c.model.get("fill")?"":c.get_fill_color(t,e)}).style("opacity",function(t,e){return d[e]}).style("stroke-width",this.model.get("stroke_width")).style("stroke-dasharray",i.bind(this.get_line_style,this)),this.model.get("marker")&&_.append("path").attr("class","dot").attr("transform","translate("+h/2+",0)").attr("d",c.dot.size(25)).style("fill",function(t,e){return c.get_element_color(t,e)}),this.legend_el.append("text").attr("class","legendtext").attr("x",1.2*h).attr("y",h/2).attr("dy","0.35em").text(function(t,e){return o[e]}).style("fill",function(t,e){return c.get_element_color(t,e)||u[e]}).style("opacity",function(t,e){return d[e]});var f=r.max(o,function(t){return t.length});return this.legend_el.exit().remove(),[this.model.mark_data.length,f]},update_curves_subset:function(){var t="label"===this.model.get("labels_visibility"),e=this.model.get("curves_subset");e.length>0?(this.d3el.selectAll(".curve").attr("display",function(t,n){return-1!==e.indexOf(n)?"inline":"none"}).select(".curve_label").attr("display",function(n,i){return-1!==e.indexOf(i)&&t?"inline":"none"}),this.legend_el&&this.legend_el.attr("display",function(t,n){return-1!==e.indexOf(n)?"inline":"none"}),this.d3el.selectAll(".curve")):(this.d3el.selectAll(".curve").attr("display","inline").select(".curve_label").attr("display",function(e){return t?"inline":"none"}),this.legend_el&&this.legend_el.attr("display","inline"))},update_fill:function(){var t=this.model.get("fill"),e="top"===t||"bottom"===t||"between"===t,n=this.scales.y;this.area.defined(function(t){return e&&null!==t.y&&isFinite(n.scale(t.y))}),"bottom"==t?this.area.y0(this.parent.plotarea_height):"top"==t?this.area.y0(0):"between"==t&&this.area.y0(function(t){return n.scale(t.y0)+n.offset});var i=this;this.d3el.selectAll(".curve").select(".area").attr("d",function(t){return i.area(t.values)}),this.d3el.selectAll(".curve").select(".line").style("fill",function(e,n){return"inside"===t?i.get_fill_color(e,n):""}),this.legend_el&&this.legend_el.select("path").style("fill",function(e,n){return"none"===t?"":i.get_fill_color(e,n)})},get_element_color:function(t,e){var n=this.scales.color;return n&&void 0!==t.color&&null!==t.color?n.scale(t.color):this.get_colors(e)},get_fill_color:function(t,e){var n=this.model.get("fill_colors");return 0===n.length?this.get_element_color(t,e):n[e]},update_line_xy:function(t){var e=this.scales.x,n=this.scales.y,i=!0===t?this.parent.model.get("animation_duration"):0;this.line.x(function(t){return e.scale(t.x)+e.offset}).y(function(t){return n.scale(t.y)+n.offset});var r=this.model.get("fill");this.area.x(function(t){return e.scale(t.x)+e.offset}).y1(function(t){return n.scale(t.y)+n.offset}),"bottom"==r?this.area.y0(this.parent.plotarea_height):"top"==r?this.area.y0(0):"between"==r&&this.area.y0(function(t){return n.scale(t.y0)+n.offset});var s=this,a=this.d3el.selectAll(".curve");a.select(".line").transition("update_line_xy").duration(i).attr("d",function(t){return s.line(t.values)+s.path_closure()}),a.select(".area").transition("update_line_xy").duration(i).attr("d",function(t,e){return s.area(t.values)}),a.select(".curve_label").transition("update_line_xy").duration(i).attr("transform",function(t){var i=t.values[t.values.length-1];return"translate("+e.scale(i.x)+","+n.scale(i.y)+")"}),this.update_dots_xy(t),this.x_pixels=this.model.mark_data.length>0?this.model.mark_data[0].values.map(function(t){return e.scale(t.x)+e.offset}):[],this.y_pixels=this.model.mark_data.length>0?this.model.mark_data[0].values.map(function(t){return n.scale(t.y)+n.offset}):[],this.pixel_coords=this.model.mark_data.length>0?this.model.mark_data[0].values.map(function(t){return[e.scale(t.x)+e.offset,n.scale(t.y)+n.offset]}):[]},draw:function(t){this.set_ranges();var e=this.d3el.selectAll(".curve").data(this.model.mark_data),n=this.scales.y,s=e.enter().append("g").attr("class","curve");s.append("path").attr("class","line").attr("fill","none"),s.append("path").attr("class","area"),s.append("text").attr("class","curve_label").attr("x",3).attr("dy",".35em").attr("display","label"!==this.model.get("labels_visibility")?"none":"inline").text(function(t){return t.name});var a=this.model.get("fill"),o="top"===a||"bottom"===a||"between"===a;e.select(".line").attr("id",function(t,e){return"curve"+(e+1)}).on("click",i.bind(function(){this.event_dispatcher("element_clicked")},this)),this.draw_dots(),this.line=r.svg.line().interpolate(this.model.get("interpolation")).defined(function(t){return null!==t.y&&isFinite(n.scale(t.y))}),this.area=r.svg.area().interpolate(this.model.get("interpolation")).defined(function(t){return o&&null!==t.y&&isFinite(n.scale(t.y))}),e.exit().remove(),this.update_line_xy(t),this.update_style(),this.update_curves_subset()},draw_dots:function(){if(this.model.get("marker")){var t=this.d3el.selectAll(".curve").selectAll(".dot").data(function(t,e){return t.values.map(function(t){return{x:t.x,y:t.y,sub_index:t.sub_index}})});t.enter().append("path").attr("class","dot"),t.exit().remove()}},update_dots_xy:function(t){if(this.model.get("marker")){var e=this.scales.x,n=this.scales.y,i=!0===t?this.parent.model.get("animation_duration"):0;this.d3el.selectAll(".curve").selectAll(".dot").transition("update_dots_xy").duration(i).attr("transform",function(t){return"translate("+(e.scale(t.x)+e.offset)+","+(n.scale(t.y)+n.offset)+")"}).attr("d",this.dot.size(this.model.get("marker_size")).type(this.model.get("marker")))}},compute_view_padding:function(){var t;if(this.model.get("marker")){var e=Math.sqrt(this.model.get("marker_size"))/2+1,n=this.model.get("stroke_width")/2;t=Math.max(e,n)}else t=this.model.get("stroke_width")/2;var i=t;t===this.x_padding&&i===this.y_padding||(this.x_padding=t,this.y_padding=i,this.trigger("mark_padding_updated"))},update_marker_style:function(){var t=this,e=this.model.get("fill_colors"),n=this.model.get("opacities");this.d3el.selectAll(".curve").each(function(i,s){r.select(this).selectAll(".dot").style("opacity",n[s]).style("fill",t.get_element_color(i,s)||e[s])})},update_marker:function(t,e){e?(this.draw_dots(),this.update_dots_xy(),this.update_marker_style(),this.legend_el&&this.legend_el.select(".dot").attr("d",this.dot.type(e).size(25))):(this.d3el.selectAll(".dot").remove(),this.legend_el&&this.legend_el.select(".dot").attr("d",this.dot.size(0)))},update_marker_size:function(t,e){this.compute_view_padding(),this.d3el.selectAll(".dot").attr("d",this.dot.size(e))},process_interactions:function(){var t=this.model.get("interactions");i.isEmpty(t)?this.reset_interactions():(void 0!==t.click&&null!==t.click?"tooltip"===t.click&&(this.event_listeners.element_clicked=function(){return this.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip):this.reset_click(),void 0!==t.hover&&null!==t.hover?"tooltip"===t.hover&&(this.event_listeners.mouse_over=this.refresh_tooltip,this.event_listeners.mouse_move=this.move_tooltip,this.event_listeners.mouse_out=this.hide_tooltip):this.reset_hover(),void 0!==t.legend_hover&&null!==t.legend_hover?"highlight_axes"===t.legend_hover&&(this.event_listeners.legend_mouse_over=i.bind(this.highlight_axes,this),this.event_listeners.legend_mouse_out=i.bind(this.unhighlight_axes,this)):this.reset_legend_hover())}});t.exports={Lines:l}},function(t,e,n){var i=n(2),r=n(0),s=n(1),a=n(27),o=n(28);o.__esModule&&(o=o.default);var l=i.DOMWidgetView.extend({initialize:function(){this.el.classList.add("bqplot"),this.el.classList.add("figure"),this.el.classList.add("jupyter-widgets");var t=document.createElementNS(r.ns.prefix.svg,"svg");this.el.appendChild(t),this.svg=r.select(t),l.__super__.initialize.apply(this,arguments)},_get_height_width:function(t,e){var n=this.model.get("max_aspect_ratio"),i=this.model.get("min_aspect_ratio"),r={},s=void 0===e||isNaN(e)||e<=0,a=void 0===t||isNaN(t)||e<=0;s&&a?(t=480,e=640):a?t=e/i:s&&(e=t*i);var o=e/t;return o<=n&&o>=i?(r.width=e,r.height=t):o>n?(r.height=t,r.width=t*n):(r.width=e,r.height=e/i),r},render:function(){var t=String(this.model.get("layout").get("min_width")),e=String(this.model.get("layout").get("min_height")),n=this._get_height_width(e.slice(0,-2),t.slice(0,-2));this.width=n.width,this.height=n.height,this.id=i.uuid(),this.x_pad_dict={},this.y_pad_dict={},this.x_padding_arr={},this.y_padding_arr={},this.figure_padding_x=this.model.get("padding_x"),this.figure_padding_y=this.model.get("padding_y"),this.clip_id="clip_path_"+this.id,this.margin=this.model.get("fig_margin"),this.update_plotarea_dimensions(),this.fig=this.svg.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.tooltip_div=r.select(document.createElement("div")).attr("class","tooltip_div"),this.popper_reference=new a.PositionReference({x:0,y:0,width:20,height:20}),this.popper=new o(this.popper_reference,this.tooltip_div.node(),{placement:"auto"}),this.bg=this.fig.append("rect").attr("class","plotarea_background").attr("x",0).attr("y",0).attr("width",this.plotarea_width).attr("height",this.plotarea_height).on("click",function(){s.trigger("bg_clicked")}).style("pointer-events","inherit").style(this.model.get("background_style")),this.fig_axes=this.fig.append("g"),this.fig_marks=this.fig.append("g"),this.interaction=this.fig.append("g"),this.clip_path=this.svg.append("svg:defs").append("svg:clipPath").attr("id",this.clip_id).append("rect").attr("x",0).attr("y",0).attr("width",this.plotarea_width).attr("height",this.plotarea_height),this.title=this.fig.append("text").attr("class","mainheading").attr({x:.5*this.plotarea_width,y:-this.margin.top/2,dy:"1em"}).text(this.model.get("title")).style(this.model.get("title_style")),this.model.on("save_png",this.save_png,this),this.model.on("save_svg",this.save_svg,this);var s=this;this.create_figure_scales().then(function(){s.mark_views=new i.ViewList(s.add_mark,s.remove_mark,s),s.mark_views.update(s.model.get("marks")),Promise.all(s.mark_views.views).then(function(t){s.replace_dummy_nodes(t),s.update_marks(t),s.update_legend(),s.set_interaction(s.model.get("interaction"))}),s.axis_views=new i.ViewList(s.add_axis,null,s),s.axis_views.update(s.model.get("axes")),s.model.on_some_change(["fig_margin","min_aspect_ration","max_aspect_ratio","preserve_aspect"],s.relayout,s),s.model.on_some_change(["padding_x","padding_y"],function(){this.figure_padding_x=this.model.get("padding_x"),this.figure_padding_y=this.model.get("padding_y"),this.trigger("margin_updated")},s),s.model.on("change:axes",function(t,e,n){this.axis_views.update(e)},s),s.model.on("change:marks",function(t,e,n){this.mark_views.update(e),Promise.all(this.mark_views.views).then(function(t){s.replace_dummy_nodes(t),s.update_marks(t),s.update_legend()})},s),s.model.on("change:legend_location",s.update_legend,s),s.model.on("change:title",s.update_title,s),s.model.on("change:interaction",function(t,e){this.set_interaction(e)},s),s.displayed.then(function(t){document.body.appendChild(s.tooltip_div.node()),s.create_listeners(),void 0!==t&&!0===t.add_to_dom_only||s.relayout(),window.addEventListener("resize",function(){s.relayout()})})})},replace_dummy_nodes:function(t){s.each(t,function(t){null!==t.dummy_node&&(t.dummy_node.parentNode.replaceChild(t.el,t.dummy_node),t.dummy_node=null,this.displayed.then(function(){t.trigger("displayed")}))},this)},create_listeners:function(){this.listenTo(this.model,"change:title_style",this.title_style_updated,this),this.listenTo(this.model,"change:background_style",this.background_style_updated,this),this.listenTo(this.model,"change:layout",this.change_layout,this),this.listenTo(this.model,"change:legend_style",this.legend_style_updated,this),this.listenTo(this.model,"change:legend_text",this.legend_text_updated,this)},title_style_updated:function(){this.title.style(this.model.get("title_style"))},background_style_updated:function(){this.bg.style(this.model.get("background_style"))},legend_style_updated:function(){this.fig_marks.selectAll(".g_legend").selectAll(".axis").selectAll("rect").style(this.model.get("legend_style"))},legend_text_updated:function(){this.fig_marks.selectAll(".g_legend").selectAll("text.legendtext").style(this.model.get("legend_text"))},create_figure_scales:function(){var t=this,e=this.create_child_view(this.model.get("scale_x")).then(function(e){t.scale_x=e,t.scale_x.scale.clamp(!0),t.scale_x.set_range([0,t.plotarea_width])}),n=this.create_child_view(this.model.get("scale_y")).then(function(e){t.scale_y=e,t.scale_y.scale.clamp(!0),t.scale_y.set_range([t.plotarea_height,0])});return Promise.all([e,n])},padded_range:function(t,e){var n,i;if(!e.get("allow_padding"))return this.range(t);var r=e.model_id;return"x"===t?(n=void 0!==this.x_padding_arr[r]?this.x_padding_arr[r]:0,[(i=this.plotarea_width*this.figure_padding_x)+n,this.plotarea_width-i-n]):"y"===t?(n=void 0!==this.y_padding_arr[r]?this.y_padding_arr[r]:0,i=this.plotarea_height*this.figure_padding_y,[this.plotarea_height-n-i,n+i]):void 0},range:function(t){return"x"===t?[0,this.plotarea_width]:"y"===t?[this.plotarea_height,0]:void 0},get_mark_plotarea_height:function(t){if(!t.get("allow_padding"))return this.plotarea_height;var e=t.model_id,n=void 0!==this.y_padding_arr[e]?this.y_padding_arr[e]:0;return this.plotarea_height*(1-this.figure_padding_y)-n-n},get_mark_plotarea_width:function(t){if(!t.get("allow_padding"))return this.plotarea_width;var e=t.model_id,n=void 0!==this.x_padding_arr[e]?this.x_padding_arr[e]:0;return this.plotarea_width*(1-this.figure_padding_x)-n-n},add_axis:function(t){var e=this;return this.create_child_view(t).then(function(t){return e.fig_axes.node().appendChild(t.el),e.displayed.then(function(){t.trigger("displayed")}),t})},remove_from_padding_dict:function(t,e,n){if(void 0!==n&&null!==n){var i=n.model_id;void 0!==t[i]&&(delete t[i][e.model.model_id+"_"+e.cid],0===Object.keys(t[i]).length&&delete t[i])}},update_padding_dict:function(t,e,n,i){var r=n.model_id;t[r]||(t[r]={}),t[r][e.model.model_id+"_"+e.cid]=i},mark_scales_updated:function(t){var e=t.model,n=e.previous("scales");this.remove_from_padding_dict(this.x_pad_dict,t,n[e.get_key_for_orientation("horizontal")]),this.remove_from_padding_dict(this.y_pad_dict,t,n[e.get_key_for_orientation("vertical")]);var i=e.get("scales");this.update_padding_dict(this.x_pad_dict,t,i[e.get_key_for_orientation("horizontal")],t.x_padding),this.update_padding_dict(this.y_pad_dict,t,i[e.get_key_for_orientation("vertical")],t.y_padding),this.update_paddings()},mark_padding_updated:function(t){var e=t.model,n=e.get("scales");this.update_padding_dict(this.x_pad_dict,t,n[e.get_key_for_orientation("horizontal")],t.x_padding),this.update_padding_dict(this.y_pad_dict,t,n[e.get_key_for_orientation("vertical")],t.y_padding),this.update_paddings()},update_marks:function(t){this.update_paddings()},remove_mark:function(t){var e=t.model;e.off("redraw_legend",null,this),e.off("data_updated",null,this),e.off("scales_updated",null,this),e.off("mark_padding_updated",null,this);var n=e.get("scales");this.remove_from_padding_dict(this.x_pad_dict,t,n[e.get_key_for_orientation("horizontal")]),this.remove_from_padding_dict(this.y_pad_dict,t,n[e.get_key_for_orientation("vertical")]),t.remove()},add_mark:function(t){var e=this;t.state_change.then(function(){t.on("data_updated redraw_legend",e.update_legend,e)});var n=e.fig_marks.node().appendChild(document.createElementNS(r.ns.prefix.svg,"g"));return e.create_child_view(t,{clip_id:e.clip_id}).then(function(t){t.dummy_node=n,t.on("mark_padding_updated",function(){e.mark_padding_updated(t)},e),t.on("mark_scales_updated",function(){e.mark_scales_updated(t)},e);var i=t.model.get("scales")[t.model.get_key_for_dimension("x")],r=t.model.get("scales")[t.model.get_key_for_dimension("y")];return void 0===i&&(i=e.scale_x.model),void 0===r&&(r=e.scale_y.model),e.update_padding_dict(e.x_pad_dict,t,i,t.x_padding),e.update_padding_dict(e.y_pad_dict,t,r,t.y_padding),t})},update_paddings:function(){var t=0;this.x_padding_arr={},this.y_padding_arr={};var e=this;s.forEach(this.x_pad_dict,function(n,i){t=0,s.forEach(n,function(e,n){t=Math.max(t,e)}),e.x_padding_arr[i]=t}),s.forEach(this.y_pad_dict,function(n,i){t=0,s.forEach(n,function(e,n){t=Math.max(t,e)}),e.y_padding_arr[i]=t}),this.trigger("margin_updated")},update_plotarea_dimensions:function(){this.plotarea_width=this.width-this.margin.left-this.margin.right,this.plotarea_height=this.height-this.margin.top-this.margin.bottom},processPhosphorMessage:function(t){switch(l.__super__.processPhosphorMessage.apply(this,arguments),t.type){case"resize":case"after-show":this.relayout()}},relayout:function(){var t=this,e=this._get_height_width(this.el.clientHeight,this.el.clientWidth);t.width=e.width,t.height=e.height,window.requestAnimationFrame(function(){t.margin=t.model.get("fig_margin"),t.update_plotarea_dimensions(),void 0!==t.scale_x&&null!==t.scale_x&&t.scale_x.set_range([0,t.plotarea_width]),void 0!==t.scale_y&&null!==t.scale_y&&t.scale_y.set_range([t.plotarea_height,0]),t.fig.attr("transform","translate("+t.margin.left+","+t.margin.top+")"),t.title.attr({x:.5*t.plotarea_width,y:-t.margin.top/2,dy:"1em"}),t.bg.attr("width",t.plotarea_width).attr("height",t.plotarea_height),t.clip_path.attr("width",t.plotarea_width).attr("height",t.plotarea_height),t.trigger("margin_updated"),t.update_legend()})},update_legend:function(){this.fig_marks.selectAll(".g_legend").remove();this.model.get("marks").length;var t=this.model.get("legend_location"),e=this.fig_marks.append("g").attr("class","g_legend"),n=this,i=1,r=1;void 0!==this.mark_views&&null!==this.mark_views&&Promise.all(this.mark_views.views).then(function(s){s.forEach(function(t){if(t.model.get("display_legend")){var n=t.draw_legend(e,0,16*i,0,16);i+=n[0],r=n[1]?Math.max(r,n[1]):r}});var a=n.get_legend_coords(t,24,16*(i+1),0);1!==i&&e.insert("g",":first-child").attr("class","axis").append("rect").attr({y:8,x:-8}).attr("width",r+2+"em").attr("height",16*i),r="top-right"===t||"right"===t||"bottom-right"===t?-(r+2):1;e.attr("transform","translate("+String(a[0]+16*r)+" "+String(a[1])+") "),e.selectAll("text.legendtext").style(n.model.get("legend_text")),e.selectAll(".axis").selectAll("rect").style(n.model.get("legend_style"))})},get_legend_coords:function(t,e,n,i){var r=0,s=0,a=this.plotarea_width,o=this.plotarea_height;switch(t){case"top":r=.5*a-e,s=0;break;case"top-right":r=a-i,s=0;break;case"right":r=a-i,s=.5*o-n;break;case"bottom-right":r=a-i,s=o-n;break;case"bottom":r=.5*a-e,s=o-n;break;case"bottom-left":r=0,s=o-n;break;case"left":r=0,s=.5*o-n;break;default:r=0,s=0}return[r,s]},set_interaction:function(t){if(t){var e=this;t.state_change.then(function(){e.create_child_view(t).then(function(t){e.interaction_view&&e.interaction_view.remove(),e.interaction_view=t,e.interaction.node().appendChild(t.el),e.displayed.then(function(){t.trigger("displayed")})})})}else this.interaction_view&&this.interaction_view.remove()},update_title:function(t,e){this.title.text(this.model.get("title"))},remove:function(){return void 0!==this.mark_views&&null!==this.mark_views&&this.mark_views.remove(),void 0!==this.axis_views&&null!==this.axis_views&&this.axis_views.remove(),void 0!==this.tooltip_div&&this.tooltip_div.remove(),l.__super__.remove.apply(this,arguments)},get_svg:function(){var t=function(t,e,n){return n.replace(new RegExp(t,"g"),e)};return function(e){var n=e.cloneNode(!0);n.setAttribute("version","1.1"),n.setAttribute("xmlns","http://www.w3.org/2000/svg"),n.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),n.style.background=window.getComputedStyle(document.body).background;var i=document.createElement("style");i.setAttribute("type","text/css"),i.innerHTML="<![CDATA[\n"+function(e,n){for(var i,r="",s=document.styleSheets,a=0;a<s.length;a++){var o=s[a].cssRules;if(o)for(var l=0;l<o.length;l++){var c=o[l];if(void 0!==c.style){var h=null;try{h=e.querySelectorAll(c.selectorText)}catch(t){console.warn("Invalid CSS selector '"+c.selectorText+"'",t)}if(h){if(e.querySelectorAll(c.selectorText).length>0){i=c.selectorText;for(var u=0;u<n.length;u++)i=t(n[u],"",i);r+=i+" { "+c.style.cssText+" }\n"}}else c.cssText.match(/^@font-face/)&&(r+=c.cssText+"\n")}}}return r+="svg { font-size: 10px; }\n"}(e,[".theme-dark",".theme-light",".bqplot > "])+"\n]]>";var r=document.createElement("defs");return r.appendChild(i),n.insertBefore(r,n.firstChild),n.outerHTML}(this.svg.node())},save_png:function(t,e){e=e||window.devicePixelRatio;var n=this.get_svg(),i=new Image,r=this;i.onload=function(){var n=document.createElement("canvas");n.classList.add("bqplot"),n.width=r.width*e,n.height=r.height*e,n.style.width=this.width,n.style.height=this.height;var s=n.getContext("2d");s.scale(e,e),s.drawImage(i,0,0);var a=document.createElement("a");a.download=t||"bqplot.png",a.href=n.toDataURL("bqplot/png"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},i.src="data:image/svg+xml;base64,"+btoa(n)},save_svg:function(t){var e=this.get_svg(),n=document.createElement("a");n.download=t||"bqplot.svg",n.href="data:text/plain;charset=utf-8,"+encodeURIComponent(e),document.body.appendChild(n),n.click(),document.body.removeChild(n)}});t.exports={Figure:l}},function(t,e){var n=function(){function t(t){this.elt=t}return t.prototype.getBoundingClientRect=function(){return this.elt.getBoundingClientRect()},Object.defineProperty(t.prototype,"clientWidth",{get:function(){return this.elt.clientWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientHeight",{get:function(){return this.elt.clientHeight},enumerable:!0,configurable:!0}),t}(),i=function(){function t(t){var e=t.x,n=t.y,i=t.width,r=t.height;this.x=e,this.y=n,this.width=i,this.height=r}return t.prototype.getBoundingClientRect=function(){var t=this.width/2,e=this.height/2;return{left:this.x-t,right:this.x+t,top:this.y-e,bottom:this.y+e,width:this.width,height:this.height}},Object.defineProperty(t.prototype,"clientWidth",{get:function(){return this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientHeight",{get:function(){return this.height},enumerable:!0,configurable:!0}),t}();t.exports={ElementReference:n,PositionReference:i}},function(t,e,n){"use strict";n.r(e),function(t){for(
/**!
 * @fileOverview Kickass library to create and place poppers near their reference elements.
 * @version 1.12.9
 * @license
 * Copyright (c) 2016 Federico Zivolo and contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
var n="undefined"!=typeof window&&"undefined"!=typeof document,i=["Edge","Trident","Firefox"],r=0,s=0;s<i.length;s+=1)if(n&&navigator.userAgent.indexOf(i[s])>=0){r=1;break}var a=n&&window.Promise?function(t){var e=!1;return function(){e||(e=!0,window.Promise.resolve().then(function(){e=!1,t()}))}}:function(t){var e=!1;return function(){e||(e=!0,setTimeout(function(){e=!1,t()},r))}};function o(t){return t&&"[object Function]"==={}.toString.call(t)}function l(t,e){if(1!==t.nodeType)return[];var n=getComputedStyle(t,null);return e?n[e]:n}function c(t){return"HTML"===t.nodeName?t:t.parentNode||t.host}function h(t){if(!t)return document.body;switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}var e=l(t),n=e.overflow,i=e.overflowX,r=e.overflowY;return/(auto|scroll)/.test(n+r+i)?t:h(c(t))}function u(t){var e=t&&t.offsetParent,n=e&&e.nodeName;return n&&"BODY"!==n&&"HTML"!==n?-1!==["TD","TABLE"].indexOf(e.nodeName)&&"static"===l(e,"position")?u(e):e:t?t.ownerDocument.documentElement:document.documentElement}function d(t){return null!==t.parentNode?d(t.parentNode):t}function _(t,e){if(!(t&&t.nodeType&&e&&e.nodeType))return document.documentElement;var n=t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING,i=n?t:e,r=n?e:t,s=document.createRange();s.setStart(i,0),s.setEnd(r,0);var a=s.commonAncestorContainer;if(t!==a&&e!==a||i.contains(r))return function(t){var e=t.nodeName;return"BODY"!==e&&("HTML"===e||u(t.firstElementChild)===t)}(a)?a:u(a);var o=d(t);return o.host?_(o.host,e):_(t,d(e).host)}function f(t){var e="top"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top")?"scrollTop":"scrollLeft",n=t.nodeName;if("BODY"===n||"HTML"===n){var i=t.ownerDocument.documentElement;return(t.ownerDocument.scrollingElement||i)[e]}return t[e]}function g(t,e){var n="x"===e?"Left":"Top",i="Left"===n?"Right":"Bottom";return parseFloat(t["border"+n+"Width"],10)+parseFloat(t["border"+i+"Width"],10)}var p=void 0,m=function(){return void 0===p&&(p=-1!==navigator.appVersion.indexOf("MSIE 10")),p};function v(t,e,n,i){return Math.max(e["offset"+t],e["scroll"+t],n["client"+t],n["offset"+t],n["scroll"+t],m()?n["offset"+t]+i["margin"+("Height"===t?"Top":"Left")]+i["margin"+("Height"===t?"Bottom":"Right")]:0)}function b(){var t=document.body,e=document.documentElement,n=m()&&getComputedStyle(e);return{height:v("Height",t,e,n),width:v("Width",t,e,n)}}var y=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},x=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),k=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},w=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};function M(t){return w({},t,{right:t.left+t.width,bottom:t.top+t.height})}function A(t){var e={};if(m())try{e=t.getBoundingClientRect();var n=f(t,"top"),i=f(t,"left");e.top+=n,e.left+=i,e.bottom+=n,e.right+=i}catch(t){}else e=t.getBoundingClientRect();var r={left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top},s="HTML"===t.nodeName?b():{},a=s.width||t.clientWidth||r.right-r.left,o=s.height||t.clientHeight||r.bottom-r.top,c=t.offsetWidth-a,h=t.offsetHeight-o;if(c||h){var u=l(t);c-=g(u,"x"),h-=g(u,"y"),r.width-=c,r.height-=h}return M(r)}function q(t,e){var n=m(),i="HTML"===e.nodeName,r=A(t),s=A(e),a=h(t),o=l(e),c=parseFloat(o.borderTopWidth,10),u=parseFloat(o.borderLeftWidth,10),d=M({top:r.top-s.top-c,left:r.left-s.left-u,width:r.width,height:r.height});if(d.marginTop=0,d.marginLeft=0,!n&&i){var _=parseFloat(o.marginTop,10),g=parseFloat(o.marginLeft,10);d.top-=c-_,d.bottom-=c-_,d.left-=u-g,d.right-=u-g,d.marginTop=_,d.marginLeft=g}return(n?e.contains(a):e===a&&"BODY"!==a.nodeName)&&(d=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=f(e,"top"),r=f(e,"left"),s=n?-1:1;return t.top+=i*s,t.bottom+=i*s,t.left+=r*s,t.right+=r*s,t}(d,e)),d}function z(t,e,n,i){var r={top:0,left:0},s=_(t,e);if("viewport"===i)r=function(t){var e=t.ownerDocument.documentElement,n=q(t,e),i=Math.max(e.clientWidth,window.innerWidth||0),r=Math.max(e.clientHeight,window.innerHeight||0),s=f(e),a=f(e,"left");return M({top:s-n.top+n.marginTop,left:a-n.left+n.marginLeft,width:i,height:r})}(s);else{var a=void 0;"scrollParent"===i?"BODY"===(a=h(c(e))).nodeName&&(a=t.ownerDocument.documentElement):a="window"===i?t.ownerDocument.documentElement:i;var o=q(a,s);if("HTML"!==a.nodeName||function t(e){var n=e.nodeName;return"BODY"!==n&&"HTML"!==n&&("fixed"===l(e,"position")||t(c(e)))}(s))r=o;else{var u=b(),d=u.height,g=u.width;r.top+=o.top-o.marginTop,r.bottom=d+o.top,r.left+=o.left-o.marginLeft,r.right=g+o.left}}return r.left+=n,r.top+=n,r.right-=n,r.bottom-=n,r}function E(t,e,n,i,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===t.indexOf("auto"))return t;var a=z(n,i,s,r),o={top:{width:a.width,height:e.top-a.top},right:{width:a.right-e.right,height:a.height},bottom:{width:a.width,height:a.bottom-e.bottom},left:{width:e.left-a.left,height:a.height}},l=Object.keys(o).map(function(t){return w({key:t},o[t],{area:function(t){return t.width*t.height}(o[t])})}).sort(function(t,e){return e.area-t.area}),c=l.filter(function(t){var e=t.width,i=t.height;return e>=n.clientWidth&&i>=n.clientHeight}),h=c.length>0?c[0].key:l[0].key,u=t.split("-")[1];return h+(u?"-"+u:"")}function S(t,e,n){return q(n,_(e,n))}function T(t){var e=getComputedStyle(t),n=parseFloat(e.marginTop)+parseFloat(e.marginBottom),i=parseFloat(e.marginLeft)+parseFloat(e.marginRight);return{width:t.offsetWidth+i,height:t.offsetHeight+n}}function L(t){var e={left:"right",right:"left",bottom:"top",top:"bottom"};return t.replace(/left|right|bottom|top/g,function(t){return e[t]})}function N(t,e,n){n=n.split("-")[0];var i=T(t),r={width:i.width,height:i.height},s=-1!==["right","left"].indexOf(n),a=s?"top":"left",o=s?"left":"top",l=s?"height":"width",c=s?"width":"height";return r[a]=e[a]+e[l]/2-i[l]/2,r[o]=n===o?e[o]-i[c]:e[L(o)],r}function O(t,e){return Array.prototype.find?t.find(e):t.filter(e)[0]}function C(t,e,n){return(void 0===n?t:t.slice(0,function(t,e,n){if(Array.prototype.findIndex)return t.findIndex(function(t){return t[e]===n});var i=O(t,function(t){return t[e]===n});return t.indexOf(i)}(t,"name",n))).forEach(function(t){t.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var n=t.function||t.fn;t.enabled&&o(n)&&(e.offsets.popper=M(e.offsets.popper),e.offsets.reference=M(e.offsets.reference),e=n(e,t))}),e}function j(t,e){return t.some(function(t){var n=t.name;return t.enabled&&n===e})}function B(t){for(var e=[!1,"ms","Webkit","Moz","O"],n=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<e.length-1;i++){var r=e[i],s=r?""+r+n:t;if(void 0!==document.body.style[s])return s}return null}function P(t){var e=t.ownerDocument;return e?e.defaultView:window}function D(t,e,n,i){n.updateBound=i,P(t).addEventListener("resize",n.updateBound,{passive:!0});var r=h(t);return function t(e,n,i,r){var s="BODY"===e.nodeName,a=s?e.ownerDocument.defaultView:e;a.addEventListener(n,i,{passive:!0}),s||t(h(a.parentNode),n,i,r),r.push(a)}(r,"scroll",n.updateBound,n.scrollParents),n.scrollElement=r,n.eventsEnabled=!0,n}function R(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=function(t,e){return P(t).removeEventListener("resize",e.updateBound),e.scrollParents.forEach(function(t){t.removeEventListener("scroll",e.updateBound)}),e.updateBound=null,e.scrollParents=[],e.scrollElement=null,e.eventsEnabled=!1,e}(this.reference,this.state))}function F(t){return""!==t&&!isNaN(parseFloat(t))&&isFinite(t)}function I(t,e){Object.keys(e).forEach(function(n){var i="";-1!==["width","height","top","right","bottom","left"].indexOf(n)&&F(e[n])&&(i="px"),t.style[n]=e[n]+i})}function U(t,e,n){var i=O(t,function(t){return t.name===e}),r=!!i&&t.some(function(t){return t.name===n&&t.enabled&&t.order<i.order});if(!r){var s="`"+e+"`",a="`"+n+"`";console.warn(a+" modifier is required by "+s+" modifier in order to work, be sure to include it before "+s+"!")}return r}var H=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],Y=H.slice(3);function V(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Y.indexOf(t),i=Y.slice(n+1).concat(Y.slice(0,n));return e?i.reverse():i}var W={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function G(t,e,n,i){var r=[0,0],s=-1!==["right","left"].indexOf(i),a=t.split(/(\+|\-)/).map(function(t){return t.trim()}),o=a.indexOf(O(a,function(t){return-1!==t.search(/,|\s/)}));a[o]&&-1===a[o].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,c=-1!==o?[a.slice(0,o).concat([a[o].split(l)[0]]),[a[o].split(l)[1]].concat(a.slice(o+1))]:[a];return(c=c.map(function(t,i){var r=(1===i?!s:s)?"height":"width",a=!1;return t.reduce(function(t,e){return""===t[t.length-1]&&-1!==["+","-"].indexOf(e)?(t[t.length-1]=e,a=!0,t):a?(t[t.length-1]+=e,a=!1,t):t.concat(e)},[]).map(function(t){return function(t,e,n,i){var r=t.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),s=+r[1],a=r[2];if(!s)return t;if(0===a.indexOf("%")){var o=void 0;switch(a){case"%p":o=n;break;case"%":case"%r":default:o=i}return M(o)[e]/100*s}if("vh"===a||"vw"===a)return("vh"===a?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*s;return s}(t,r,e,n)})})).forEach(function(t,e){t.forEach(function(n,i){F(n)&&(r[e]+=n*("-"===t[i-1]?-1:1))})}),r}var Z={placement:"bottom",eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(t){var e=t.placement,n=e.split("-")[0],i=e.split("-")[1];if(i){var r=t.offsets,s=r.reference,a=r.popper,o=-1!==["bottom","top"].indexOf(n),l=o?"left":"top",c=o?"width":"height",h={start:k({},l,s[l]),end:k({},l,s[l]+s[c]-a[c])};t.offsets.popper=w({},a,h[i])}return t}},offset:{order:200,enabled:!0,fn:function(t,e){var n=e.offset,i=t.placement,r=t.offsets,s=r.popper,a=r.reference,o=i.split("-")[0],l=void 0;return l=F(+n)?[+n,0]:G(n,s,a,o),"left"===o?(s.top+=l[0],s.left-=l[1]):"right"===o?(s.top+=l[0],s.left+=l[1]):"top"===o?(s.left+=l[0],s.top-=l[1]):"bottom"===o&&(s.left+=l[0],s.top+=l[1]),t.popper=s,t},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(t,e){var n=e.boundariesElement||u(t.instance.popper);t.instance.reference===n&&(n=u(n));var i=z(t.instance.popper,t.instance.reference,e.padding,n);e.boundaries=i;var r=e.priority,s=t.offsets.popper,a={primary:function(t){var n=s[t];return s[t]<i[t]&&!e.escapeWithReference&&(n=Math.max(s[t],i[t])),k({},t,n)},secondary:function(t){var n="right"===t?"left":"top",r=s[n];return s[t]>i[t]&&!e.escapeWithReference&&(r=Math.min(s[n],i[t]-("right"===t?s.width:s.height))),k({},n,r)}};return r.forEach(function(t){var e=-1!==["left","top"].indexOf(t)?"primary":"secondary";s=w({},s,a[e](t))}),t.offsets.popper=s,t},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(t){var e=t.offsets,n=e.popper,i=e.reference,r=t.placement.split("-")[0],s=Math.floor,a=-1!==["top","bottom"].indexOf(r),o=a?"right":"bottom",l=a?"left":"top",c=a?"width":"height";return n[o]<s(i[l])&&(t.offsets.popper[l]=s(i[l])-n[c]),n[l]>s(i[o])&&(t.offsets.popper[l]=s(i[o])),t}},arrow:{order:500,enabled:!0,fn:function(t,e){var n;if(!U(t.instance.modifiers,"arrow","keepTogether"))return t;var i=e.element;if("string"==typeof i){if(!(i=t.instance.popper.querySelector(i)))return t}else if(!t.instance.popper.contains(i))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),t;var r=t.placement.split("-")[0],s=t.offsets,a=s.popper,o=s.reference,c=-1!==["left","right"].indexOf(r),h=c?"height":"width",u=c?"Top":"Left",d=u.toLowerCase(),_=c?"left":"top",f=c?"bottom":"right",g=T(i)[h];o[f]-g<a[d]&&(t.offsets.popper[d]-=a[d]-(o[f]-g)),o[d]+g>a[f]&&(t.offsets.popper[d]+=o[d]+g-a[f]),t.offsets.popper=M(t.offsets.popper);var p=o[d]+o[h]/2-g/2,m=l(t.instance.popper),v=parseFloat(m["margin"+u],10),b=parseFloat(m["border"+u+"Width"],10),y=p-t.offsets.popper[d]-v-b;return y=Math.max(Math.min(a[h]-g,y),0),t.arrowElement=i,t.offsets.arrow=(k(n={},d,Math.round(y)),k(n,_,""),n),t},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(t,e){if(j(t.instance.modifiers,"inner"))return t;if(t.flipped&&t.placement===t.originalPlacement)return t;var n=z(t.instance.popper,t.instance.reference,e.padding,e.boundariesElement),i=t.placement.split("-")[0],r=L(i),s=t.placement.split("-")[1]||"",a=[];switch(e.behavior){case W.FLIP:a=[i,r];break;case W.CLOCKWISE:a=V(i);break;case W.COUNTERCLOCKWISE:a=V(i,!0);break;default:a=e.behavior}return a.forEach(function(o,l){if(i!==o||a.length===l+1)return t;i=t.placement.split("-")[0],r=L(i);var c=t.offsets.popper,h=t.offsets.reference,u=Math.floor,d="left"===i&&u(c.right)>u(h.left)||"right"===i&&u(c.left)<u(h.right)||"top"===i&&u(c.bottom)>u(h.top)||"bottom"===i&&u(c.top)<u(h.bottom),_=u(c.left)<u(n.left),f=u(c.right)>u(n.right),g=u(c.top)<u(n.top),p=u(c.bottom)>u(n.bottom),m="left"===i&&_||"right"===i&&f||"top"===i&&g||"bottom"===i&&p,v=-1!==["top","bottom"].indexOf(i),b=!!e.flipVariations&&(v&&"start"===s&&_||v&&"end"===s&&f||!v&&"start"===s&&g||!v&&"end"===s&&p);(d||m||b)&&(t.flipped=!0,(d||m)&&(i=a[l+1]),b&&(s=function(t){return"end"===t?"start":"start"===t?"end":t}(s)),t.placement=i+(s?"-"+s:""),t.offsets.popper=w({},t.offsets.popper,N(t.instance.popper,t.offsets.reference,t.placement)),t=C(t.instance.modifiers,t,"flip"))}),t},behavior:"flip",padding:5,boundariesElement:"viewport"},inner:{order:700,enabled:!1,fn:function(t){var e=t.placement,n=e.split("-")[0],i=t.offsets,r=i.popper,s=i.reference,a=-1!==["left","right"].indexOf(n),o=-1===["top","left"].indexOf(n);return r[a?"left":"top"]=s[n]-(o?r[a?"width":"height"]:0),t.placement=L(e),t.offsets.popper=M(r),t}},hide:{order:800,enabled:!0,fn:function(t){if(!U(t.instance.modifiers,"hide","preventOverflow"))return t;var e=t.offsets.reference,n=O(t.instance.modifiers,function(t){return"preventOverflow"===t.name}).boundaries;if(e.bottom<n.top||e.left>n.right||e.top>n.bottom||e.right<n.left){if(!0===t.hide)return t;t.hide=!0,t.attributes["x-out-of-boundaries"]=""}else{if(!1===t.hide)return t;t.hide=!1,t.attributes["x-out-of-boundaries"]=!1}return t}},computeStyle:{order:850,enabled:!0,fn:function(t,e){var n=e.x,i=e.y,r=t.offsets.popper,s=O(t.instance.modifiers,function(t){return"applyStyle"===t.name}).gpuAcceleration;void 0!==s&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var a=void 0!==s?s:e.gpuAcceleration,o=A(u(t.instance.popper)),l={position:r.position},c={left:Math.floor(r.left),top:Math.floor(r.top),bottom:Math.floor(r.bottom),right:Math.floor(r.right)},h="bottom"===n?"top":"bottom",d="right"===i?"left":"right",_=B("transform"),f=void 0,g=void 0;if(g="bottom"===h?-o.height+c.bottom:c.top,f="right"===d?-o.width+c.right:c.left,a&&_)l[_]="translate3d("+f+"px, "+g+"px, 0)",l[h]=0,l[d]=0,l.willChange="transform";else{var p="bottom"===h?-1:1,m="right"===d?-1:1;l[h]=g*p,l[d]=f*m,l.willChange=h+", "+d}var v={"x-placement":t.placement};return t.attributes=w({},v,t.attributes),t.styles=w({},l,t.styles),t.arrowStyles=w({},t.offsets.arrow,t.arrowStyles),t},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(t){return I(t.instance.popper,t.styles),function(t,e){Object.keys(e).forEach(function(n){!1!==e[n]?t.setAttribute(n,e[n]):t.removeAttribute(n)})}(t.instance.popper,t.attributes),t.arrowElement&&Object.keys(t.arrowStyles).length&&I(t.arrowElement,t.arrowStyles),t},onLoad:function(t,e,n,i,r){var s=S(0,e,t),a=E(n.placement,s,e,t,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);return e.setAttribute("x-placement",a),I(e,{position:"absolute"}),n},gpuAcceleration:void 0}}},K=function(){function t(e,n){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};y(this,t),this.scheduleUpdate=function(){return requestAnimationFrame(i.update)},this.update=a(this.update.bind(this)),this.options=w({},t.Defaults,r),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=e&&e.jquery?e[0]:e,this.popper=n&&n.jquery?n[0]:n,this.options.modifiers={},Object.keys(w({},t.Defaults.modifiers,r.modifiers)).forEach(function(e){i.options.modifiers[e]=w({},t.Defaults.modifiers[e]||{},r.modifiers?r.modifiers[e]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(t){return w({name:t},i.options.modifiers[t])}).sort(function(t,e){return t.order-e.order}),this.modifiers.forEach(function(t){t.enabled&&o(t.onLoad)&&t.onLoad(i.reference,i.popper,i.options,t,i.state)}),this.update();var s=this.options.eventsEnabled;s&&this.enableEventListeners(),this.state.eventsEnabled=s}return x(t,[{key:"update",value:function(){return function(){if(!this.state.isDestroyed){var t={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};t.offsets.reference=S(this.state,this.popper,this.reference),t.placement=E(this.options.placement,t.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),t.originalPlacement=t.placement,t.offsets.popper=N(this.popper,t.offsets.reference,t.placement),t.offsets.popper.position="absolute",t=C(this.modifiers,t),this.state.isCreated?this.options.onUpdate(t):(this.state.isCreated=!0,this.options.onCreate(t))}}.call(this)}},{key:"destroy",value:function(){return function(){return this.state.isDestroyed=!0,j(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.left="",this.popper.style.position="",this.popper.style.top="",this.popper.style[B("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}.call(this)}},{key:"enableEventListeners",value:function(){return function(){this.state.eventsEnabled||(this.state=D(this.reference,this.options,this.state,this.scheduleUpdate))}.call(this)}},{key:"disableEventListeners",value:function(){return R.call(this)}}]),t}();K.Utils=("undefined"!=typeof window?window:t).PopperUtils,K.placements=H,K.Defaults=Z,e.default=K}.call(this,n(69))},function(t,e,n){n(30),t.exports=n(34)},function(t,e,n){var i=n(31);"string"==typeof i&&(i=[[t.i,i,""]]);n(33)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(32)()).push([t.i,'/* Copyright 2015 Bloomberg Finance L.P.\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n.theme-light .bqplot,\n[data-theme-light="true"] .bqplot {\n  box-sizing: border-box;\n  display: flex;\n  width: 640px;\n  height: 480px;\n}\n.theme-light .bqplot > svg,\n[data-theme-light="true"] .bqplot > svg {\n  font: 11px sans-serif;\n  user-select: none;\n  -ms-user-select: none;\n  -khtml-user-select: none;\n  -webkit-user-select: none;\n  flex-grow: 1;\n}\n.theme-light .bqplot > svg .axis line,\n[data-theme-light="true"] .bqplot > svg .axis line {\n  shape-rendering: crispEdges;\n  font: 10px sans-serif;\n  stroke-width: 1px;\n}\n.theme-light .bqplot > svg .axis path,\n[data-theme-light="true"] .bqplot > svg .axis path,\n.theme-light .bqplot > svg .axis line,\n[data-theme-light="true"] .bqplot > svg .axis line {\n  fill: none;\n}\n.theme-light .bqplot > svg .axis text.axislabel,\n[data-theme-light="true"] .bqplot > svg .axis text.axislabel,\n.theme-light .bqplot > svg .axis tspan.axislabel,\n[data-theme-light="true"] .bqplot > svg .axis tspan.axislabel {\n  text-anchor: end;\n  font: 14px sans-serif;\n}\n.theme-light .bqplot > svg .axis .tick text,\n[data-theme-light="true"] .bqplot > svg .axis .tick text {\n  cursor: default;\n}\n.theme-light .bqplot > svg .axis.axisbold path,\n[data-theme-light="true"] .bqplot > svg .axis.axisbold path {\n  stroke-width: 3px;\n}\n.theme-light .bqplot > svg .axis.axisbold text,\n[data-theme-light="true"] .bqplot > svg .axis.axisbold text,\n.theme-light .bqplot > svg .axis.axisbold text.axislabel,\n[data-theme-light="true"] .bqplot > svg .axis.axisbold text.axislabel {\n  font-weight: bolder;\n}\n.theme-light .bqplot > svg text.mainheading,\n[data-theme-light="true"] .bqplot > svg text.mainheading {\n  text-anchor: middle;\n  font: 16px sans-serif;\n}\n.theme-light .bqplot > svg .zeroLine,\n[data-theme-light="true"] .bqplot > svg .zeroLine {\n  shape-rendering: crispEdges;\n}\n.theme-light .bqplot > svg .brushintsel,\n[data-theme-light="true"] .bqplot > svg .brushintsel,\n.theme-light .bqplot > svg .intsel,\n[data-theme-light="true"] .bqplot > svg .intsel {\n  pointer-events: none;\n}\n.theme-light .bqplot > svg .indsel,\n[data-theme-light="true"] .bqplot > svg .indsel {\n  stroke: red;\n}\n.theme-light .bqplot > svg .brushintsel,\n[data-theme-light="true"] .bqplot > svg .brushintsel,\n.theme-light .bqplot > svg .intsel,\n[data-theme-light="true"] .bqplot > svg .intsel {\n  fill-opacity: 0.2;\n}\n.theme-light .bqplot > svg .intselmouse,\n[data-theme-light="true"] .bqplot > svg .intselmouse {\n  visibility: hidden;\n  pointer-events: all;\n  /*none?*/\n}\n.theme-light .bqplot > svg text.legendtext,\n[data-theme-light="true"] .bqplot > svg text.legendtext {\n  text-anchor: start;\n  font: 14px sans-serif;\n}\n.theme-light .bqplot > svg .multiselector .active,\n[data-theme-light="true"] .bqplot > svg .multiselector .active {\n  pointer-events: all  !important;\n  stroke: green;\n}\n.theme-light .bqplot > svg .multiselector .inactive,\n[data-theme-light="true"] .bqplot > svg .multiselector .inactive {\n  pointer-events: none !important;\n  stroke: red;\n}\n.theme-light .bqplot > svg .multiselector .visible,\n[data-theme-light="true"] .bqplot > svg .multiselector .visible {\n  pointer-events: visible !important;\n  stroke: red;\n}\n.theme-light .bqplot > svg .lassoselector .selected,\n[data-theme-light="true"] .bqplot > svg .lassoselector .selected {\n  opacity: 0.3;\n}\n.theme-light .bqplot > svg .lassoselector path,\n[data-theme-light="true"] .bqplot > svg .lassoselector path {\n  fill: none;\n  stroke: orange;\n  stroke-width: 4;\n}\n.theme-light .tooltip_div,\n[data-theme-light="true"] .tooltip_div {\n  z-index: 1001;\n}\n.theme-light .mark_tooltip,\n[data-theme-light="true"] .mark_tooltip {\n  pointer-events: none;\n  z-index: 1001;\n}\n.theme-light .mark_tooltip table,\n[data-theme-light="true"] .mark_tooltip table {\n  border-radius: 5px;\n}\n.theme-light .mark_tooltip .tooltiptext,\n[data-theme-light="true"] .mark_tooltip .tooltiptext {\n  text-align: center;\n  padding: 0.5em;\n}\n.theme-light .world_map .hovered,\n[data-theme-light="true"] .world_map .hovered {\n  fill: Orange;\n  stroke: Orange;\n  stroke-width: 2.5px;\n}\n.theme-light .world_map #container,\n[data-theme-light="true"] .world_map #container {\n  margin: 10px 10%;\n  border: 2px solid #000;\n  border-radius: 5px;\n  height: 100%;\n  overflow: hidden;\n  background: #F0F8FF;\n}\n.theme-light .world_map .graticule,\n[data-theme-light="true"] .world_map .graticule {\n  fill: none;\n  stroke: #bbb;\n  stroke-width: .5px;\n  stroke-opacity: .5;\n}\n.theme-light .g_legend,\n[data-theme-light="true"] .g_legend {\n  fill: none;\n}\n.theme-light .bqplot > svg .axis rect,\n[data-theme-light="true"] .bqplot > svg .axis rect {\n  stroke: white;\n  opacity: 1.0;\n}\n.theme-light .bqplot > svg .axis .tick line,\n[data-theme-light="true"] .bqplot > svg .axis .tick line {\n  stroke: white;\n  stroke-width: 1;\n  opacity: 1.0;\n}\n.theme-light .bqplot > svg .axis .tick.short line,\n[data-theme-light="true"] .bqplot > svg .axis .tick.short line {\n  stroke: #8B8B8B;\n}\n.theme-light .bqplot > svg .axis .tick text,\n[data-theme-light="true"] .bqplot > svg .axis .tick text {\n  fill: #8B8B8B;\n  font: 12px sans-serif;\n}\n.theme-light .bqplot > svg .stick,\n[data-theme-light="true"] .bqplot > svg .stick,\n.theme-light .bqplot > svg .zeroLine,\n[data-theme-light="true"] .bqplot > svg .zeroLine {\n  stroke: black;\n  fill: black;\n}\n.theme-light .bqplot > svg .bargroup rect,\n[data-theme-light="true"] .bqplot > svg .bargroup rect,\n.theme-light .bqplot > svg .boxplot rect,\n[data-theme-light="true"] .bqplot > svg .boxplot rect,\n.theme-light .bqplot > svg .slice rect,\n[data-theme-light="true"] .bqplot > svg .slice rect,\n.theme-light .bqplot > svg .bargroup path,\n[data-theme-light="true"] .bqplot > svg .bargroup path,\n.theme-light .bqplot > svg .boxplot path,\n[data-theme-light="true"] .bqplot > svg .boxplot path,\n.theme-light .bqplot > svg .slice path,\n[data-theme-light="true"] .bqplot > svg .slice path,\n.theme-light .bqplot > svg .bargroup line,\n[data-theme-light="true"] .bqplot > svg .bargroup line,\n.theme-light .bqplot > svg .boxplot line,\n[data-theme-light="true"] .bqplot > svg .boxplot line,\n.theme-light .bqplot > svg .slice line,\n[data-theme-light="true"] .bqplot > svg .slice line {\n  stroke: black;\n}\n.theme-light .bqplot > svg .sticktext,\n[data-theme-light="true"] .bqplot > svg .sticktext,\n.theme-light .bqplot > svg .dot_text,\n[data-theme-light="true"] .bqplot > svg .dot_text {\n  fill: black;\n}\n.theme-light .bqplot > svg .brushintsel,\n[data-theme-light="true"] .bqplot > svg .brushintsel,\n.theme-light .bqplot > svg .intsel,\n[data-theme-light="true"] .bqplot > svg .intsel {\n  fill: #000000;\n}\n.theme-light .bqplot > svg text.axislabel,\n[data-theme-light="true"] .bqplot > svg text.axislabel,\n.theme-light .bqplot > svg tspan.axislabel,\n[data-theme-light="true"] .bqplot > svg tspan.axislabel {\n  fill: black;\n  font: serif;\n}\n.theme-light .bqplot > svg text.mainheading,\n[data-theme-light="true"] .bqplot > svg text.mainheading {\n  fill: black;\n  font: serif;\n  font-size: large;\n}\n.theme-light .bqplot > svg .plotarea_background,\n[data-theme-light="true"] .bqplot > svg .plotarea_background {\n  fill: #F7F7F7;\n}\n.theme-light .mark_tooltip,\n[data-theme-light="true"] .mark_tooltip {\n  border: 2px solid black;\n  border-radius: 5px;\n  box-shadow: 1px 1px 2px rgba(10, 10, 10, 0.8);\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  background-color: #FCFCFC;\n}\n.theme-light .mark_tooltip td,\n[data-theme-light="true"] .mark_tooltip td {\n  border: thin solid black;\n}\n.theme-light .mark_tooltip table,\n[data-theme-light="true"] .mark_tooltip table {\n  background: #ececec;\n}\n.theme-light .world_map path,\n[data-theme-light="true"] .world_map path {\n  stroke: #FFF;\n  stroke-width: 0.25px;\n  fill: dodgerblue;\n}\n.theme-light .pie polyline,\n[data-theme-light="true"] .pie polyline {\n  opacity: .3;\n  stroke: black;\n  stroke-width: 1px;\n  fill: none;\n}\n.theme-light .network .node .element,\n[data-theme-light="true"] .network .node .element {\n  fill: #ccc;\n  stroke: #000;\n  stroke-width: 1.5px;\n}\n.theme-light .network .link,\n[data-theme-light="true"] .network .link {\n  fill: none;\n  stroke: #666;\n  stroke-width: 1.5px;\n}\n.theme-light .network .node .label,\n[data-theme-light="true"] .network .node .label {\n  font: 12px sans-serif;\n  pointer-events: none;\n  text-shadow: 0 1px 0 #fff, 1px 0 0 #fff, 0 -1px 0 #fff, -1px 0 0 #fff;\n}\n.theme-light .linkarrow,\n[data-theme-light="true"] .linkarrow {\n  fill: #000;\n}\n/* by default, activate theme-light*/\n.bqplot {\n  box-sizing: border-box;\n  display: flex;\n  width: 640px;\n  height: 480px;\n}\n.bqplot > svg {\n  font: 11px sans-serif;\n  user-select: none;\n  -ms-user-select: none;\n  -khtml-user-select: none;\n  -webkit-user-select: none;\n  flex-grow: 1;\n}\n.bqplot > svg .axis line {\n  shape-rendering: crispEdges;\n  font: 10px sans-serif;\n  stroke-width: 1px;\n}\n.bqplot > svg .axis path,\n.bqplot > svg .axis line {\n  fill: none;\n}\n.bqplot > svg .axis text.axislabel,\n.bqplot > svg .axis tspan.axislabel {\n  text-anchor: end;\n  font: 14px sans-serif;\n}\n.bqplot > svg .axis .tick text {\n  cursor: default;\n}\n.bqplot > svg .axis.axisbold path {\n  stroke-width: 3px;\n}\n.bqplot > svg .axis.axisbold text,\n.bqplot > svg .axis.axisbold text.axislabel {\n  font-weight: bolder;\n}\n.bqplot > svg text.mainheading {\n  text-anchor: middle;\n  font: 16px sans-serif;\n}\n.bqplot > svg .zeroLine {\n  shape-rendering: crispEdges;\n}\n.bqplot > svg .brushintsel,\n.bqplot > svg .intsel {\n  pointer-events: none;\n}\n.bqplot > svg .indsel {\n  stroke: red;\n}\n.bqplot > svg .brushintsel,\n.bqplot > svg .intsel {\n  fill-opacity: 0.2;\n}\n.bqplot > svg .intselmouse {\n  visibility: hidden;\n  pointer-events: all;\n  /*none?*/\n}\n.bqplot > svg text.legendtext {\n  text-anchor: start;\n  font: 14px sans-serif;\n}\n.bqplot > svg .multiselector .active {\n  pointer-events: all  !important;\n  stroke: green;\n}\n.bqplot > svg .multiselector .inactive {\n  pointer-events: none !important;\n  stroke: red;\n}\n.bqplot > svg .multiselector .visible {\n  pointer-events: visible !important;\n  stroke: red;\n}\n.bqplot > svg .lassoselector .selected {\n  opacity: 0.3;\n}\n.bqplot > svg .lassoselector path {\n  fill: none;\n  stroke: orange;\n  stroke-width: 4;\n}\n.tooltip_div {\n  z-index: 1001;\n}\n.mark_tooltip {\n  pointer-events: none;\n  z-index: 1001;\n}\n.mark_tooltip table {\n  border-radius: 5px;\n}\n.mark_tooltip .tooltiptext {\n  text-align: center;\n  padding: 0.5em;\n}\n.world_map .hovered {\n  fill: Orange;\n  stroke: Orange;\n  stroke-width: 2.5px;\n}\n.world_map #container {\n  margin: 10px 10%;\n  border: 2px solid #000;\n  border-radius: 5px;\n  height: 100%;\n  overflow: hidden;\n  background: #F0F8FF;\n}\n.world_map .graticule {\n  fill: none;\n  stroke: #bbb;\n  stroke-width: .5px;\n  stroke-opacity: .5;\n}\n.g_legend {\n  fill: none;\n}\n.bqplot > svg .axis rect {\n  stroke: white;\n  opacity: 1.0;\n}\n.bqplot > svg .axis .tick line {\n  stroke: white;\n  stroke-width: 1;\n  opacity: 1.0;\n}\n.bqplot > svg .axis .tick.short line {\n  stroke: #8B8B8B;\n}\n.bqplot > svg .axis .tick text {\n  fill: #8B8B8B;\n  font: 12px sans-serif;\n}\n.bqplot > svg .stick,\n.bqplot > svg .zeroLine {\n  stroke: black;\n  fill: black;\n}\n.bqplot > svg .bargroup rect,\n.bqplot > svg .boxplot rect,\n.bqplot > svg .slice rect,\n.bqplot > svg .bargroup path,\n.bqplot > svg .boxplot path,\n.bqplot > svg .slice path,\n.bqplot > svg .bargroup line,\n.bqplot > svg .boxplot line,\n.bqplot > svg .slice line {\n  stroke: black;\n}\n.bqplot > svg .sticktext,\n.bqplot > svg .dot_text {\n  fill: black;\n}\n.bqplot > svg .brushintsel,\n.bqplot > svg .intsel {\n  fill: #000000;\n}\n.bqplot > svg text.axislabel,\n.bqplot > svg tspan.axislabel {\n  fill: black;\n  font: serif;\n}\n.bqplot > svg text.mainheading {\n  fill: black;\n  font: serif;\n  font-size: large;\n}\n.bqplot > svg .plotarea_background {\n  fill: #F7F7F7;\n}\n.mark_tooltip {\n  border: 2px solid black;\n  border-radius: 5px;\n  box-shadow: 1px 1px 2px rgba(10, 10, 10, 0.8);\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  background-color: #FCFCFC;\n}\n.mark_tooltip td {\n  border: thin solid black;\n}\n.mark_tooltip table {\n  background: #ececec;\n}\n.world_map path {\n  stroke: #FFF;\n  stroke-width: 0.25px;\n  fill: dodgerblue;\n}\n.pie polyline {\n  opacity: .3;\n  stroke: black;\n  stroke-width: 1px;\n  fill: none;\n}\n.network .node .element {\n  fill: #ccc;\n  stroke: #000;\n  stroke-width: 1.5px;\n}\n.network .link {\n  fill: none;\n  stroke: #666;\n  stroke-width: 1.5px;\n}\n.network .node .label {\n  font: 12px sans-serif;\n  pointer-events: none;\n  text-shadow: 0 1px 0 #fff, 1px 0 0 #fff, 0 -1px 0 #fff, -1px 0 0 #fff;\n}\n.linkarrow {\n  fill: #000;\n}\n.theme-dark .bqplot,\n[data-theme-light="false"] .bqplot {\n  box-sizing: border-box;\n  display: flex;\n  width: 640px;\n  height: 480px;\n}\n.theme-dark .bqplot > svg,\n[data-theme-light="false"] .bqplot > svg {\n  font: 11px sans-serif;\n  user-select: none;\n  -ms-user-select: none;\n  -khtml-user-select: none;\n  -webkit-user-select: none;\n  flex-grow: 1;\n}\n.theme-dark .bqplot > svg .axis line,\n[data-theme-light="false"] .bqplot > svg .axis line {\n  shape-rendering: crispEdges;\n  font: 10px sans-serif;\n  stroke-width: 1px;\n}\n.theme-dark .bqplot > svg .axis path,\n[data-theme-light="false"] .bqplot > svg .axis path,\n.theme-dark .bqplot > svg .axis line,\n[data-theme-light="false"] .bqplot > svg .axis line {\n  fill: none;\n}\n.theme-dark .bqplot > svg .axis text.axislabel,\n[data-theme-light="false"] .bqplot > svg .axis text.axislabel,\n.theme-dark .bqplot > svg .axis tspan.axislabel,\n[data-theme-light="false"] .bqplot > svg .axis tspan.axislabel {\n  text-anchor: end;\n  font: 14px sans-serif;\n}\n.theme-dark .bqplot > svg .axis .tick text,\n[data-theme-light="false"] .bqplot > svg .axis .tick text {\n  cursor: default;\n}\n.theme-dark .bqplot > svg .axis.axisbold path,\n[data-theme-light="false"] .bqplot > svg .axis.axisbold path {\n  stroke-width: 3px;\n}\n.theme-dark .bqplot > svg .axis.axisbold text,\n[data-theme-light="false"] .bqplot > svg .axis.axisbold text,\n.theme-dark .bqplot > svg .axis.axisbold text.axislabel,\n[data-theme-light="false"] .bqplot > svg .axis.axisbold text.axislabel {\n  font-weight: bolder;\n}\n.theme-dark .bqplot > svg text.mainheading,\n[data-theme-light="false"] .bqplot > svg text.mainheading {\n  text-anchor: middle;\n  font: 16px sans-serif;\n}\n.theme-dark .bqplot > svg .zeroLine,\n[data-theme-light="false"] .bqplot > svg .zeroLine {\n  shape-rendering: crispEdges;\n}\n.theme-dark .bqplot > svg .brushintsel,\n[data-theme-light="false"] .bqplot > svg .brushintsel,\n.theme-dark .bqplot > svg .intsel,\n[data-theme-light="false"] .bqplot > svg .intsel {\n  pointer-events: none;\n}\n.theme-dark .bqplot > svg .indsel,\n[data-theme-light="false"] .bqplot > svg .indsel {\n  stroke: red;\n}\n.theme-dark .bqplot > svg .brushintsel,\n[data-theme-light="false"] .bqplot > svg .brushintsel,\n.theme-dark .bqplot > svg .intsel,\n[data-theme-light="false"] .bqplot > svg .intsel {\n  fill-opacity: 0.2;\n}\n.theme-dark .bqplot > svg .intselmouse,\n[data-theme-light="false"] .bqplot > svg .intselmouse {\n  visibility: hidden;\n  pointer-events: all;\n  /*none?*/\n}\n.theme-dark .bqplot > svg text.legendtext,\n[data-theme-light="false"] .bqplot > svg text.legendtext {\n  text-anchor: start;\n  font: 14px sans-serif;\n}\n.theme-dark .bqplot > svg .multiselector .active,\n[data-theme-light="false"] .bqplot > svg .multiselector .active {\n  pointer-events: all  !important;\n  stroke: green;\n}\n.theme-dark .bqplot > svg .multiselector .inactive,\n[data-theme-light="false"] .bqplot > svg .multiselector .inactive {\n  pointer-events: none !important;\n  stroke: red;\n}\n.theme-dark .bqplot > svg .multiselector .visible,\n[data-theme-light="false"] .bqplot > svg .multiselector .visible {\n  pointer-events: visible !important;\n  stroke: red;\n}\n.theme-dark .bqplot > svg .lassoselector .selected,\n[data-theme-light="false"] .bqplot > svg .lassoselector .selected {\n  opacity: 0.3;\n}\n.theme-dark .bqplot > svg .lassoselector path,\n[data-theme-light="false"] .bqplot > svg .lassoselector path {\n  fill: none;\n  stroke: orange;\n  stroke-width: 4;\n}\n.theme-dark .tooltip_div,\n[data-theme-light="false"] .tooltip_div {\n  z-index: 1001;\n}\n.theme-dark .mark_tooltip,\n[data-theme-light="false"] .mark_tooltip {\n  pointer-events: none;\n  z-index: 1001;\n}\n.theme-dark .mark_tooltip table,\n[data-theme-light="false"] .mark_tooltip table {\n  border-radius: 5px;\n}\n.theme-dark .mark_tooltip .tooltiptext,\n[data-theme-light="false"] .mark_tooltip .tooltiptext {\n  text-align: center;\n  padding: 0.5em;\n}\n.theme-dark .world_map .hovered,\n[data-theme-light="false"] .world_map .hovered {\n  fill: Orange;\n  stroke: Orange;\n  stroke-width: 2.5px;\n}\n.theme-dark .world_map #container,\n[data-theme-light="false"] .world_map #container {\n  margin: 10px 10%;\n  border: 2px solid #000;\n  border-radius: 5px;\n  height: 100%;\n  overflow: hidden;\n  background: #F0F8FF;\n}\n.theme-dark .world_map .graticule,\n[data-theme-light="false"] .world_map .graticule {\n  fill: none;\n  stroke: #bbb;\n  stroke-width: .5px;\n  stroke-opacity: .5;\n}\n.theme-dark .g_legend,\n[data-theme-light="false"] .g_legend {\n  fill: none;\n}\n.theme-dark .bqplot > svg,\n[data-theme-light="false"] .bqplot > svg {\n  background: #1a1a1a;\n}\n.theme-dark .bqplot > svg .axis rect,\n[data-theme-light="false"] .bqplot > svg .axis rect {\n  stroke: #1A1A1A;\n}\n.theme-dark .bqplot > svg .axis path,\n[data-theme-light="false"] .bqplot > svg .axis path {\n  stroke: #b3b3b3;\n}\n.theme-dark .bqplot > svg .axis .tick line,\n[data-theme-light="false"] .bqplot > svg .axis .tick line {\n  stroke: #3b3b3b;\n}\n.theme-dark .bqplot > svg .axis .tick.short line,\n[data-theme-light="false"] .bqplot > svg .axis .tick.short line {\n  stroke: #B3B3B3;\n}\n.theme-dark .bqplot > svg .axis .tick text,\n[data-theme-light="false"] .bqplot > svg .axis .tick text {\n  fill: #B3B3B3;\n}\n.theme-dark .bqplot > svg .stick,\n[data-theme-light="false"] .bqplot > svg .stick,\n.theme-dark .bqplot > svg .zeroLine,\n[data-theme-light="false"] .bqplot > svg .zeroLine {\n  stroke: white;\n  fill: white;\n}\n.theme-dark .bqplot > svg .bargroup rect,\n[data-theme-light="false"] .bqplot > svg .bargroup rect,\n.theme-dark .bqplot > svg .slice rect,\n[data-theme-light="false"] .bqplot > svg .slice rect,\n.theme-dark .bqplot > svg .bargroup path,\n[data-theme-light="false"] .bqplot > svg .bargroup path,\n.theme-dark .bqplot > svg .slice path,\n[data-theme-light="false"] .bqplot > svg .slice path,\n.theme-dark .bqplot > svg .bargroup line,\n[data-theme-light="false"] .bqplot > svg .bargroup line,\n.theme-dark .bqplot > svg .slice line,\n[data-theme-light="false"] .bqplot > svg .slice line {\n  stroke: white;\n}\n.theme-dark .bqplot > svg .sticktext,\n[data-theme-light="false"] .bqplot > svg .sticktext,\n.theme-dark .bqplot > svg .dot_text,\n[data-theme-light="false"] .bqplot > svg .dot_text {\n  fill: white;\n}\n.theme-dark .bqplot > svg .brushintsel,\n[data-theme-light="false"] .bqplot > svg .brushintsel,\n.theme-dark .bqplot > svg .intsel,\n[data-theme-light="false"] .bqplot > svg .intsel {\n  fill: #ffffff;\n}\n.theme-dark .bqplot > svg text.axislabel,\n[data-theme-light="false"] .bqplot > svg text.axislabel,\n.theme-dark .bqplot > svg tspan.axislabel,\n[data-theme-light="false"] .bqplot > svg tspan.axislabel,\n.theme-dark .bqplot > svg text.mainheading,\n[data-theme-light="false"] .bqplot > svg text.mainheading {\n  fill: orange;\n}\n.theme-dark .bqplot > svg .plotarea_background,\n[data-theme-light="false"] .bqplot > svg .plotarea_background {\n  fill: #1a1a1a;\n}\n.theme-dark .mark_tooltip,\n[data-theme-light="false"] .mark_tooltip {\n  border: 2px solid whitesmoke;\n  border-radius: 5px;\n  box-shadow: 1px 1px 2px rgba(245, 245, 245, 0.8);\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  background-color: black;\n}\n.theme-dark .mark_tooltip td,\n[data-theme-light="false"] .mark_tooltip td {\n  border: thin solid whitesmoke;\n}\n.theme-dark .mark_tooltip table,\n[data-theme-light="false"] .mark_tooltip table {\n  background: black;\n}\n.theme-dark .world_map path,\n[data-theme-light="false"] .world_map path {\n  stroke: black;\n  stroke-width: 0.25px;\n  fill: seagreen;\n}\n.theme-dark .pie polyline,\n[data-theme-light="false"] .pie polyline {\n  opacity: .5;\n  stroke: white;\n  stroke-width: 1px;\n  fill: none;\n}\n.theme-dark .network .node .element,\n[data-theme-light="false"] .network .node .element {\n  fill: #666;\n  stroke: #000;\n  stroke-width: 1.5px;\n}\n.theme-dark .network .node .element,\n[data-theme-light="false"] .network .node .element {\n  fill: #666;\n  stroke: #000;\n  stroke-width: 1.5px;\n}\n.theme-dark .network .link,\n[data-theme-light="false"] .network .link {\n  fill: none;\n  stroke: #666;\n  stroke-width: 1.5px;\n}\n.theme-dark .network .node .label,\n[data-theme-light="false"] .network .node .label {\n  font: 12px sans-serif;\n  pointer-events: none;\n  text-shadow: 0 1px 0 #000, 1px 0 0 #000, 0 -1px 0 #000, -1px 0 0 #000;\n}\n.theme-dark .linkarrow,\n[data-theme-light="false"] .linkarrow {\n  fill: #ccc;\n}\n',""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},r=0;r<this.length;r++){var s=this[r][0];"number"==typeof s&&(i[s]=!0)}for(r=0;r<e.length;r++){var a=e[r];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(t,e){var n={},i=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}},r=i(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),s=i(function(){return document.head||document.getElementsByTagName("head")[0]}),a=null,o=0,l=[];function c(t,e){for(var i=0;i<t.length;i++){var r=t[i],s=n[r.id];if(s){s.refs++;for(var a=0;a<s.parts.length;a++)s.parts[a](r.parts[a]);for(;a<r.parts.length;a++)s.parts.push(f(r.parts[a],e))}else{var o=[];for(a=0;a<r.parts.length;a++)o.push(f(r.parts[a],e));n[r.id]={id:r.id,refs:1,parts:o}}}}function h(t){for(var e=[],n={},i=0;i<t.length;i++){var r=t[i],s=r[0],a={css:r[1],media:r[2],sourceMap:r[3]};n[s]?n[s].parts.push(a):e.push(n[s]={id:s,parts:[a]})}return e}function u(t,e){var n=s(),i=l[l.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),l.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function d(t){t.parentNode.removeChild(t);var e=l.indexOf(t);e>=0&&l.splice(e,1)}function _(t){var e=document.createElement("style");return e.type="text/css",u(t,e),e}function f(t,e){var n,i,r;if(e.singleton){var s=o++;n=a||(a=_(e)),i=p.bind(null,n,s,!1),r=p.bind(null,n,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return e.rel="stylesheet",u(t,e),e}(e),i=function(t,e){var n=e.css,i=e.sourceMap;i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var r=new Blob([n],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(r),s&&URL.revokeObjectURL(s)}.bind(null,n),r=function(){d(n),n.href&&URL.revokeObjectURL(n.href)}):(n=_(e),i=function(t,e){var n=e.css,i=e.media;i&&t.setAttribute("media",i);if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),r=function(){d(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");void 0===(e=e||{}).singleton&&(e.singleton=r()),void 0===e.insertAt&&(e.insertAt="bottom");var i=h(t);return c(i,e),function(t){for(var r=[],s=0;s<i.length;s++){var a=i[s];(o=n[a.id]).refs--,r.push(o)}t&&c(h(t),e);for(s=0;s<r.length;s++){var o;if(0===(o=r[s]).refs){for(var l=0;l<o.parts.length;l++)o.parts[l]();delete n[o.id]}}}};var g=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}();function p(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=g(e,r);else{var s=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(s,a[e]):t.appendChild(s)}}},function(t,e,n){t.exports={};var i=[n(17),n(35),n(4),n(36),n(37),n(5),n(38),n(39),n(40),n(41),n(42),n(43),n(7),n(44),n(45),n(46),n(47),n(48),n(49),n(9),n(18),n(50),n(51),n(52),n(53),n(54),n(55),n(56),n(22),n(57),n(19),n(23),n(58),n(13),n(24),n(59),n(60),n(15),n(10),n(61),n(12),n(11),n(62),n(25),n(63),n(64),n(65),n(66),n(67),n(68),n(8),n(26),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(79),n(16),n(3),n(80),n(81),n(82),n(83),n(84),n(85),n(86),n(87),n(88),n(89),n(90)];for(var r in i)if(i.hasOwnProperty(r)){var s=i[r];for(var a in s)s.hasOwnProperty(a)&&(t.exports[a]=s[a])}t.exports.version=n(6).version},function(t,e,n){n(0);var i=n(1),r=n(5),s=r.MarkModel.extend({defaults:function(){return i.extend(r.MarkModel.prototype.defaults(),{_model_name:"GridHeatMapModel",_view_name:"GridHeatMap",row:[],column:[],color:null,scales_metadata:{row:{orientation:"vertical",dimension:"y"},column:{orientation:"horizontal",dimension:"x"},color:{dimension:"color"}},null_color:"black",row_align:"start",column_align:"start",stroke:"black",opacity:1,anchor_style:{fill:"white",stroke:"blue"}})},initialize:function(){s.__super__.initialize.apply(this,arguments),this.on_some_change(["row","column","color"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data(),this.update_domains()},update_data:function(){this.dirty=!0;var t=this;this.colors=this.get_typed_field("color"),this.rows=this.get_typed_field("row"),this.columns=this.get_typed_field("column");this.colors.length;var e=this.colors[0].length,n=[];n=n.concat.apply(n,this.colors),this.mark_data=n.map(function(n,i){var r=Math.floor(i/e),s=i%e;return{row_num:r,row:t.rows[r],column:t.columns[s],column_num:s,color:n,_cell_num:i}}),this.identify_modes(),this.update_domains(),this.dirty=!1,this.trigger("data_updated")},update_domains:function(){if(this.mark_data){var t=this.get("scales"),e=t.row,n=t.column,i=t.color;this.get("preserve_domain").row?e.del_domain([],this.model_id+"_row"):e.compute_and_set_domain(this.rows,this.model_id+"_row"),this.get("preserve_domain").column?n.del_domain([],this.model_id+"_column"):n.compute_and_set_domain(this.columns,this.model_id+"_column"),null!==i&&void 0!==i&&(this.get("preserve_domain").color?i.del_domain([],this.model_id+"_color"):i.compute_and_set_domain(this.mark_data.map(function(t){return t.color}),this.model_id+"_color"))}},get_data_dict:function(t,e){return t},identify_modes:function(){var t={},e=this.get("scales"),n=e.row,i=e.column,r=this.colors.length,s=this.colors[0].length;"ordinal"===n.type?t.row="middle":r===this.rows.length-1?t.row="boundaries":r===this.rows.length?t.row="expand_one":r===this.rows.length+1&&(t.row="expand_two"),"ordinal"===i.type?t.column="middle":s===this.columns.length-1?t.column="boundaries":s===this.columns.length?t.column="expand_one":s===this.columns.length+1&&(t.column="expand_two"),this.modes=t}});t.exports={GridHeatMapModel:s}},function(t,e,n){var i=n(2),r=(n(0),n(1)),s=n(7),a="^"+n(6).version,o=s.BaseModel.extend({defaults:function(){return r.extend(i.WidgetModel.prototype.defaults(),{_model_name:"AxisModel",_view_name:"Axis",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:a,_view_module_version:a,orientation:"horizontal",side:null,label:"",grid_lines:"solid",tick_format:null,scale:void 0,num_ticks:null,tick_values:[],offset:{},label_location:"middle",label_color:null,grid_color:null,color:null,label_offset:null,visible:!0,tick_style:{},tick_rotate:0})},initialize:function(){o.__super__.initialize.apply(this,arguments),this.on("change:side",this.validate_orientation,this),this.on("change:orientation",this.validate_side,this),this.validate_orientation(),this.validate_side()},validate_side:function(){var t=this.get("orientation"),e=this.get("side");"vertical"===t?"left"!==e&&"right"!==e&&this.set("side","left"):"bottom"!==e&&"top"!==e&&this.set("side","bottom"),this.save_changes()},validate_orientation:function(){this.get("orientation");var t=this.get("side");t&&("left"===t||"right"===t?this.set("orientation","vertical"):this.set("orientation","horizontal"),this.save_changes())}},{serializers:r.extend({scale:{deserialize:i.unpack_models},offset:{deserialize:i.unpack_models}},i.WidgetModel.serializers)}),l=o.extend({defaults:function(){return r.extend(o.prototype.defaults(),{_model_name:"ColorAxisModel",_view_name:"ColorAxis"})}});t.exports={AxisModel:o,ColorAxisModel:l}},function(t,e,n){var i=n(0),r=n(3),s=n(9).Interaction.extend({render:function(){s.__super__.render.apply(this),this.d3el.style({cursor:"crosshair"}),this.active=!1;var t=this;this.set_lines_view().then(function(){t.d3el.on("mousedown",function(){return t.mousedown()}),t.set_limits()}),this.update_line_index(),this.listenTo(this.model,"change:line_index",this.update_line_index,this),this.model.on_some_change(["min_x","max_x"],this.set_limits,this)},set_lines_view:function(){var t=this.parent,e=this.model.get("lines"),n=this;return Promise.all(t.mark_views.views).then(function(i){var r=t.mark_views._models.map(function(t){return t.model_id}).indexOf(e.model_id);n.lines_view=i[r]})},mousedown:function(){this.active=!0,this.mouse_entry(!1);var t=this;this.d3el.on("mousemove",function(){t.mousemove()}),this.d3el.on("mouseleave",function(){t.mouseup()}),this.d3el.on("mouseup",function(){t.mouseup()})},mouseup:function(){if(this.active){this.mouse_entry(!0);var t=this.model.get("lines");t.set_typed_field("y",r.deepCopy(t.y_data)),this.lines_view.touch(),this.active=!1,this.d3el.on("mousemove",null),this.d3el.on("mouseleave",null),this.d3el.on("mouseup",null)}},mousemove:function(){this.mouse_entry(!0)},mouse_entry:function(t){if(this.active){var e=this.model.get("lines"),n=Math.min(this.line_index,e.x_data.length-1),r=i.mouse(this.el);t&&"previous_pos"in this||(this.previous_pos=r);for(var s=this.lines_view.scales.x.scale,a=this.lines_view.scales.y.scale,o=s.invert(r[0]),l=a.invert(r[1]),c=s.invert(this.previous_pos[0]),h=(a.invert(this.previous_pos[1]),this.nns(e.x_data[n],c)),u=this.nns(e.x_data[n],o),d=Math.min(h,u),_=Math.max(h,u),f=d;f<=_;++f)(!this.valid_min||e.x_data[n][f]>=this.min_x)&&(!this.valid_max||e.x_data[n][f]<=this.max_x)&&(e.y_data[this.line_index][f]=l);var g=this,p=e.x_data[n].map(function(t,n){return{x:t,y:e.y_data[g.line_index][n]}});this.lines_view.d3el.select("#curve"+(g.line_index+1)).attr("d",function(t){return g.lines_view.line(p)}),this.previous_pos=r}},capnfloor:function(t){return Math.max(Math.min(t,this.model.get("max_x")),this.model.get("min_x"))},set_limits:function(){"date"==this.lines_view.scales.x.model.type?(this.min_x=this.model.get_date_elem("min_x"),this.valid_min=!(null===this.min_x||void 0===this.min_x||isNaN(this.min_x.getTime())),this.max_x=this.model.get_date_elem("max_x"),this.valid_max=!(null===this.max_x||void 0===this.max_x||isNaN(this.max_x.getTime()))):(this.min_x=this.model.get("min_x"),this.max_x=this.model.get("max_x"),this.valid_min=!(null===this.min_x||void 0===this.min_x),this.valid_max=!(null===this.max_x||void 0===this.max_x))},nns:function(t,e){var n=this.lines_view.bisect(t,e);return e-t[n-1]>t[n]-e?n:n-1},update_line_index:function(){this.line_index=this.model.get("line_index")}});t.exports={HandDraw:s}},function(t,e,n){var i=n(0),r=n(1),s=n(4),a=n(3),o=s.Mark.extend({render:function(){this.padding=this.model.get("padding");var t=o.__super__.render.apply(this);this.set_internal_scales(),this.selected_indices=this.model.get("selected"),this.selected_style=this.model.get("selected_style"),this.unselected_style=this.model.get("unselected_style"),this.display_el_classes=["bar","legendtext"];var e=this;return this.displayed.then(function(){e.parent.tooltip_div.node().appendChild(e.tooltip_div.node()),e.create_tooltip()}),t.then(function(){e.event_listeners={},e.process_interactions(),e.create_listeners(),e.compute_view_padding(),e.draw()})},set_scale_orientation:function(){this.model.get("orientation");this.dom_scale=this.scales.x,this.range_scale=this.scales.y},set_ranges:function(){var t=this.model.get("orientation");this.set_scale_orientation();var e=this.dom_scale,n=this.range_scale,i="vertical"===t?"x":"y",r="vertical"===t?"y":"x";"ordinal"!==e.model.type?e.set_range(this.parent.padded_range(i,e.model)):e.set_range(this.parent.padded_range(i,e.model),this.padding),n.set_range(this.parent.padded_range(r,n.model)),this.dom_offset=0,this.range_offset="vertical"===t?n.offset:-n.offset},set_positional_scales:function(){var t=this.scales.x,e=this.scales.y;this.listenTo(t,"domain_changed",function(){this.model.dirty||this.draw()}),this.listenTo(e,"domain_changed",function(){this.model.dirty||this.draw()})},set_internal_scales:function(){this.x=i.scale.ordinal(),this.x1=i.scale.ordinal()},adjust_offset:function(){"ordinal"!==this.dom_scale.model.type?"center"===this.model.get("align")?this.dom_offset=-(this.x.rangeBand()/2).toFixed(2):"left"===this.model.get("align")?this.dom_offset=-this.x.rangeBand().toFixed(2):this.dom_offset=0:"center"===this.model.get("align")?this.dom_offset=0:"left"===this.model.get("align")?this.dom_offset=-this.x.rangeBand()/2:this.dom_offset=this.x.rangeBand()/2},create_listeners:function(){o.__super__.create_listeners.apply(this),this.d3el.on("mouseover",r.bind(function(){this.event_dispatcher("mouse_over")},this)).on("mousemove",r.bind(function(){this.event_dispatcher("mouse_move")},this)).on("mouseout",r.bind(function(){this.event_dispatcher("mouse_out")},this)),this.listenTo(this.model,"data_updated",function(){this.draw(!0)},this),this.listenTo(this.model,"change:colors",this.update_colors,this),this.listenTo(this.model,"colors_updated",this.update_colors,this),this.listenTo(this.model,"change:type",this.update_type,this),this.listenTo(this.model,"change:align",this.realign,this),this.listenTo(this.model,"change:orientation",this.relayout,this),this.listenTo(this.model,"change:padding",this.relayout,this),this.listenTo(this.model,"change:tooltip",this.create_tooltip,this),this.model.on_some_change(["stroke","opacities"],this.update_stroke_and_opacities,this),this.listenTo(this.model,"change:selected",this.update_selected),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.parent,"bg_clicked",function(){this.event_dispatcher("parent_clicked")})},process_interactions:function(){var t=this.model.get("interactions");r.isEmpty(t)?this.reset_interactions():(void 0!==t.click&&null!==t.click?"tooltip"===t.click?(this.event_listeners.element_clicked=function(){return this.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip):"select"===t.click&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.bar_click_handler):this.reset_click(),void 0!==t.hover&&null!==t.hover?"tooltip"===t.hover&&(this.event_listeners.mouse_over=this.refresh_tooltip,this.event_listeners.mouse_move=this.move_tooltip,this.event_listeners.mouse_out=this.hide_tooltip):this.reset_hover(),void 0!==t.legend_click&&null!==t.legend_click?"tooltip"===t.legend_click&&(this.event_listeners.legend_clicked=function(){return this.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip):this.event_listeners.legend_clicked=function(){},void 0!==t.legend_hover&&null!==t.legend_hover?"highlight_axes"===t.legend_hover&&(this.event_listeners.legend_mouse_over=r.bind(this.highlight_axes,this),this.event_listeners.legend_mouse_out=r.bind(this.unhighlight_axes,this)):this.reset_legend_hover())},realign:function(){this.relayout()},draw_zero_line:function(){this.set_scale_orientation();var t=this.range_scale;"vertical"===this.model.get("orientation")?this.d3el.select(".zeroLine").attr("x1",0).attr("x2",this.parent.plotarea_width).attr("y1",t.scale(this.model.base_value)).attr("y2",t.scale(this.model.base_value)):this.d3el.select(".zeroLine").attr("x1",t.scale(this.model.base_value)).attr("x2",t.scale(this.model.base_value)).attr("y1",0).attr("y2",this.parent.plotarea_height)},relayout:function(){this.set_ranges(),this.compute_view_padding();this.range_scale;this.draw_zero_line(),this.x.rangeRoundBands(this.set_x_range(),this.padding),this.adjust_offset(),this.x1.rangeRoundBands([0,this.x.rangeBand().toFixed(2)]),this.draw_bars()},invert_point:function(t){if(void 0===t)return this.model.set("selected",null),void this.touch();var e=this.x_pixels.map(function(e){return Math.abs(e-t)});this.model.set("selected",[e.indexOf(i.min(e))]),this.touch()},selector_changed:function(t,e){if(void 0===t)return this.model.set("selected",null),this.touch(),[];var n=this.pixel_coords,i=r.range(n.length),s=r.filter(i,function(t){for(var i=n[t],r=0;r<i.length;r++)if(e(i[r]))return!0;return!1});this.model.set("selected",s),this.touch()},update_selected:function(t,e){this.selected_indices=e,this.apply_styles()},draw:function(t){this.set_ranges();this.model.get("colors");var e=this,n=this.d3el.selectAll(".bargroup").data(this.model.mark_data,function(t){return t.key}),i=this.dom_scale;this.range_scale;if("ordinal"!==i.model.type){var s=this.model.mark_data.map(function(t){return t.key});this.x.domain(s)}else this.x.domain(i.scale.domain());this.x.rangeRoundBands(this.set_x_range(),this.padding),this.adjust_offset(),this.x1.rangeRoundBands([0,this.x.rangeBand().toFixed(2)]),this.model.mark_data.length>0&&this.x1.domain(r.range(this.model.mark_data[0].values.length)).rangeRoundBands([0,this.x.rangeBand().toFixed(2)]),n.enter().append("g").attr("class","bargroup"),n.order(),n.on("click",function(t,n){return e.event_dispatcher("element_clicked",{data:t,index:n})}),n.exit().remove();var a=n.selectAll(".bar").data(function(t){return t.values});a.enter().append("rect").attr("class","bar").attr("width",0).attr("height",0),a.exit().remove(),this.draw_bars(t),this.apply_styles(),this.d3el.selectAll(".zeroLine").remove(),this.d3el.append("g").append("line").attr("class","zeroLine"),this.draw_zero_line()},draw_bars:function(t){var e=this.d3el.selectAll(".bargroup"),n=e.selectAll(".bar"),r=!0===t?this.parent.model.get("animation_duration"):0,s=this,a=this.model.get("orientation"),o=this.dom_scale,l=this.range_scale,c="vertical"===a?"x":"y",h="vertical"===a?"y":"x",u="vertical"===a?"width":"height",d="vertical"===a?"height":"width";if("ordinal"===o.model.type){var _=i.max(this.parent.range(c));e.attr("transform",function(t){return"vertical"===a?"translate("+((void 0!==o.scale(t.key)?o.scale(t.key):_)+s.dom_offset)+", 0)":"translate(0, "+((void 0!==o.scale(t.key)?o.scale(t.key):_)+s.dom_offset)+")"})}else e.attr("transform",function(t){return"vertical"===a?"translate("+(o.scale(t.key)+s.dom_offset)+", 0)":"translate(0, "+(o.scale(t.key)+s.dom_offset)+")"});var f="stacked"===this.model.get("type");f?n.transition("draw_bars").duration(r).attr(c,0).attr(u,this.x.rangeBand().toFixed(2)).attr(h,function(t){return"y"===h?l.scale(t.y1):l.scale(t.y0)}).attr(d,function(t){return Math.abs(l.scale(t.y1+t.y_ref)-l.scale(t.y1))}):n.transition("draw_bars").duration(r).attr(c,function(t,e){return s.x1(e)}).attr(u,this.x1.rangeBand().toFixed(2)).attr(h,function(t){return i.min([l.scale(t.y),l.scale(s.model.base_value)])}).attr(d,function(t){return Math.abs(l.scale(s.model.base_value)-l.scale(t.y_ref))}),this.pixel_coords=this.model.mark_data.map(function(t){var e=t.key,n=o.scale(e)+s.dom_offset;return t.values.map(function(t){var e={};return e[c]=f?n:n+s.x1(t.sub_index),e[h]=f?"y"===h?l.scale(t.y1):l.scale(t.y0):i.min([l.scale(t.y),l.scale(s.model.base_value)]),e[u]=f?s.x.rangeBand():s.x1.rangeBand(),e[d]=f?Math.abs(l.scale(t.y1+t.y_ref)-l.scale(t.y1)):Math.abs(l.scale(s.model.base_value)-l.scale(t.y_ref)),[[e.x,e.x+e.width],[e.y,e.y+e.height]]})}),this.x_pixels=this.model.mark_data.map(function(t){return o.scale(t.key)+o.offset})},update_type:function(t,e){this.model.update_domains(),this.draw()},update_stroke_and_opacities:function(){var t=this.model.get("stroke"),e=this.model.get("opacities");this.d3el.selectAll(".bar").style("stroke",t).style("opacity",function(t,n){return e[n]})},update_colors:function(){var t=this,e=this.scales.color;this.model.mark_data.length>0&&(this.model.is_y_2d?this.d3el.selectAll(".bargroup").selectAll(".bar").style("fill",function(n,i){return void 0!==n.color&&void 0!==e?e.scale(n.color):t.get_colors(n.color_index)}):this.d3el.selectAll(".bar").style("fill",function(n,i){return void 0!==n.color&&void 0!==e?e.scale(n.color):t.get_colors(n.color_index)})),this.legend_el&&(this.legend_el.selectAll(".legendrect").style("fill",function(n,i){return n.color&&e?e.scale(n.color):t.get_colors(n.color_index)}),this.legend_el.selectAll(".legendtext").style("fill",function(n,i){return void 0!==n.color&&void 0!==e?e.scale(n.color):t.get_colors(n.color_index)}))},draw_legend:function(t,e,n,s,a){if(!this.model.is_y_2d&&1!==this.model.get("colors").length&&"element"!==this.model.get("color_mode"))return[0,0];var o=this.model.mark_data[0].values.map(function(t){return{index:t.sub_index,color:t.color,color_index:t.color_index}}),l=this.scales.color;this.legend_el=t.selectAll(".legend"+this.uuid).data(o);var c=this,h=.8*a;this.legend_el.enter().append("g").attr("class","legend"+this.uuid).attr("transform",function(t,e){return"translate(0, "+(e*a+n)+")"}).on("mouseover",r.bind(function(){this.event_dispatcher("legend_mouse_over")},this)).on("mouseout",r.bind(function(){this.event_dispatcher("legend_mouse_out")},this)).on("click",r.bind(function(){this.event_dispatcher("legend_clicked")},this)).append("rect").classed("legendrect",!0).style("fill",function(t,e){return void 0!==t.color&&void 0!==l?l.scale(t.color):c.get_colors(t.color_index)}).attr({x:0,y:0,width:h,height:h}),this.legend_el.append("text").attr("class","legendtext").attr("x",1.2*h).attr("y",h/2).attr("dy","0.35em").text(function(t,e){return c.model.get("labels")[e]}).style("fill",function(t,e){return void 0!==t.color&&void 0!==l?l.scale(t.color):c.get_colors(t.color_index)});var u=i.max(this.model.get("labels"),function(t){return t.length});return this.legend_el.exit().remove(),[this.model.mark_data[0].values.length,u]},clear_style:function(t,e){var n=this.d3el.selectAll(".bargroup");void 0!==e&&(n=n.filter(function(t,n){return-1!==e.indexOf(n)}));var i={};for(var r in t)i[r]=null;n.selectAll(".bar").style(i)},set_style_on_elements:function(t,e){if(void 0!==e&&null!==e&&0!==e.length&&0!==Object.keys(t).length){var n=this.d3el.selectAll(".bargroup");(n=n.filter(function(t,n){return-1!==e.indexOf(n)})).selectAll(".bar").style(t)}},set_default_style:function(t){this.update_colors(),this.update_stroke_and_opacities()},set_x_range:function(){var t=this.dom_scale;return"ordinal"===t.model.type?t.scale.rangeExtent():[t.scale(i.min(this.x.domain())),t.scale(i.max(this.x.domain()))]},bar_click_handler:function(t){t.data;var e=t.index,n=this.model.get("selected"),s=n?a.deepCopy(n):[],o=s.indexOf(e),l=i.event.ctrlKey||i.event.metaKey;if(o>-1&&l)s.splice(o,1);else if(i.event.shiftKey){if(o>-1)return;var c=0!==s.length?i.min(s):-1,h=0!==s.length?i.max(s):this.model.mark_data.length;e>h?r.range(h+1,e+1).forEach(function(t){s.push(t)}):e<c&&r.range(e,c).forEach(function(t){s.push(t)})}else l?s.push(e):(s=[]).push(e);this.model.set("selected",0===s.length?null:s,{updated_view:this}),this.touch(),i.event||(i.event=window.event);var u=i.event;void 0!==u.cancelBubble&&(u.cancelBubble=!0),u.stopPropagation&&u.stopPropagation(),u.preventDefault()},reset_selection:function(){this.model.set("selected",null),this.selected_indices=null,this.touch()},compute_view_padding:function(){var t=this.dom_scale,e=this.model.get("orientation"),n=0,i="vertical"===e?this.parent.plotarea_width:this.parent.plotarea_height;t&&null!==this.x&&void 0!==this.x&&0!==this.x.domain().length&&("ordinal"!==t.model.type?"center"===this.model.get("align")?n=i/(2*this.x.domain().length)+1:"left"!==this.model.get("align")&&"right"!==this.model.get("align")||(n=i/this.x.domain().length+1):"left"!==this.model.get("align")&&"right"!==this.model.get("align")||(n=(this.x.rangeBand()/2).toFixed(2))),"vertical"===e?n!==this.x_padding&&(this.x_padding=n,this.trigger("mark_padding_updated")):n!==this.y_padding&&(this.y_padding=n,this.trigger("mark_padding_updated"))}});t.exports={Bars:o}},function(t,e,n){var i=n(2),r=n(1),s=n(7),a="^"+n(6).version,o=s.BaseModel.extend({defaults:function(){return r.extend(i.WidgetModel.prototype.defaults(),{_model_name:"HandDrawModel",_view_name:"HandDraw",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:a,_view_module_version:a,lines:null,line_index:0,min_x:null,max_x:null})}},{serializers:r.extend({lines:{deserialize:i.unpack_models}},s.BaseModel.serializers)});t.exports={HandDrawModel:o}},function(t,e,n){var i=n(0),r=n(1),s=n(4).Mark.extend({render:function(){var t=s.__super__.render.apply(this),e=this;return this.displayed.then(function(){e.parent.tooltip_div.node().appendChild(e.tooltip_div.node()),e.create_tooltip()}),t.then(function(){e.create_listeners(),e.draw()},null)},set_ranges:function(){var t=this.scales.x;t&&t.set_range(this.parent.padded_range("x",t.model));var e=this.scales.y;e&&e.set_range(this.parent.padded_range("y",e.model))},set_positional_scales:function(){var t=this.scales.x,e=this.scales.y;this.listenTo(t,"domain_changed",function(){this.model.dirty||this.draw()}),this.listenTo(e,"domain_changed",function(){this.model.dirty||this.draw()})},create_listeners:function(){s.__super__.create_listeners.apply(this),this.d3el.on("mouseover",r.bind(this.mouse_over,this)).on("mousemove",r.bind(this.mouse_move,this)).on("mouseout",r.bind(this.mouse_out,this)),this.listenTo(this.model,"change:stroke",this.update_stroke,this),this.listenTo(this.model,"change:stroke_width",this.update_stroke_width,this),this.listenTo(this.model,"change:colors",this.update_colors,this),this.listenTo(this.model,"change:opacities",this.update_opacities,this),this.listenTo(this.model,"change:marker",this.update_marker,this),this.listenTo(this.model,"format_updated",this.draw,this),this.listenTo(this.model,"data_updated",this.draw)},update_stroke:function(){var t=this.model.get("stroke");this.d3el.selectAll(".stick").style("stroke",t),this.legend_el&&(this.legend_el.selectAll("path").style("stroke",t),this.legend_el.selectAll("text").style("fill",t))},update_stroke_width:function(){var t=this.model.get("stroke_width");this.d3el.selectAll(".stick").attr("stroke-width",t)},update_colors:function(){var t=this,e=this.model.get("colors"),n=e[0]?e[0]:"none",i=e[1]?e[1]:"none";this.d3el.selectAll(".stick").style("fill",function(e){return e.y[t.model.px.o]>e.y[t.model.px.c]?i:n}),this.legend_el&&this.legend_el.selectAll("path").style("fill",n)},update_opacities:function(){var t=this.model.get("opacities");this.d3el.selectAll(".stick").style("opacity",function(e,n){return t[n]}),this.legend_el&&this.legend_el.selectAll("path").attr("opacity",function(e,n){return t[n]})},update_marker:function(){var t=this.model.get("marker");this.legend_el&&this.rect_dim&&this.draw_legend_icon(this.rect_dim,this.legend_el),this.draw_mark_paths(t,this.d3el,this.model.mark_data.map(function(t,e){return t[1]}))},update_selected_colors:function(t,e){this.d3el.selectAll(".stick");var n=r.range(t,e+1);n.length==this.model.mark_data.length&&(n=[]);var i=this,s=this.model.get("stroke"),a=this.model.get("colors"),o=a[0]?a[0]:s,l=a[1]?a[1]:s,c=this.model.px;r.range(0,this.model.mark_data.length).forEach(function(t){i.d3el.selectAll("#stick"+t).style("stroke",s)}),n.forEach(function(t){i.d3el.selectAll("#stick"+t).style("stroke",function(t){return t[c.o]>t[c.c]?l:o})})},invert_range:function(t,e){if(void 0===t||void 0===e||0===this.model.mark_data.length)return this.update_selected_colors(-1,-1),s=[];var n=r.range(this.model.mark_data.length),i=this,s=r.filter(n,function(n){var r=i.x_pixels[n];return r>=t&&r<=e}),a=this.scales.x,o=-1,l=-1;return s.length>0&&(t!==a.scale.range()[0]||e!==a.scale.range()[1])&&(o=s[0],l=s[s.length-1]),this.update_selected_colors(o,l),this.model.set("selected",s),this.touch(),s},invert_point:function(t){this.scales.x;var e=this.x_pixels.map(function(e){return Math.abs(e-t)}),n=e.indexOf(i.min(e));return this.update_selected_colors(n,n),this.model.set("selected",[n]),this.touch(),n},draw:function(){var t=this.scales.x,e=this.scales.y;this.set_ranges();var n=this.model.get("colors"),r=this.model.get("opacities"),s=n[0]?n[0]:"none",a=n[1]?n[1]:"none",o=this.model.px,l=this.d3el.selectAll(".stick").data(this.model.mark_data.map(function(t,e){return{x:t[0],y:t[1],index:e}})),c=l.enter().append("g").attr("class","stick").attr("id",function(t,e){return"stick"+e}).style("stroke",this.model.get("stroke")).style("opacity",function(t,e){return r[e]});c.append("path").attr("class","stick_head"),c.append("path").attr("class","stick_tail"),c.append("path").attr("class","stick_body"),l.exit().remove();var h=this,u=o.h;if(-1===o.h&&(u=o.o),this.d3el.selectAll(".stick").style("fill",function(t,e){return t.y[o.o]>t.y[o.c]?a:s}).attr("stroke-width",this.model.get("stroke_width")),"ordinal"===t.model.type){var d=i.max(this.parent.range("x"));this.d3el.selectAll(".stick").attr("transform",function(n,i){return"translate("+((void 0!==t.scale(h.model.mark_data[i][0])?t.scale(h.model.mark_data[i][0]):d)+t.scale.rangeBand()/2)+","+(e.scale(n.y[u])+e.offset)+")"})}else this.d3el.selectAll(".stick").attr("transform",function(n,i){return"translate("+(t.scale(h.model.mark_data[i][0])+t.offset)+","+(e.scale(n.y[u])+e.offset)+")"});this.draw_mark_paths(this.model.get("marker"),this.d3el,this.model.mark_data.map(function(t){return t[1]})),this.x_pixels=this.model.mark_data.map(function(e){return t.scale(e[0])+t.offset})},draw_mark_paths:function(t,e,n){for(var i,r,s=this.model.px,a=this,o=[],l=[],c=[],h=[],u=[],d=[],_=[],f=[],g=this.calculate_mark_width(),p=this.scales.x,m=this.scales.y,v=0;v<n.length;v++)-1===s.o?o[v]=void 0:o[v]=m.scale(n[v][s.o]),-1===s.c?h[v]=void 0:h[v]=m.scale(n[v][s.c]),-1!==s.o&&-1!==s.c&&(u[v]=n[v][s.o]>n[v][s.c]?o[v]:h[v],d[v]=n[v][s.o]<n[v][s.c]?o[v]:h[v]),-1===s.h||-1===s.l?(l[v]=o[v],c[v]=h[v]):(l[v]=m.scale(n[v][s.h]),c[v]=m.scale(n[v][s.l])),r=a.model.mark_data[v][0],g instanceof Date&&(g=g.getTime()),r instanceof Date&&(r=r.getTime()),i=r+g,"ordinal"===p.model.type?f[v]=.75*p.scale.rangeBand():f[v]=.75*(p.scale(i)-p.scale(r)),_[v]=-1*f[v]/2;"candle"==t&&-1!==s.o&&-1!==s.c?(-1!==s.h||-1!==s.l?(e.selectAll(".stick_head").attr("d",function(t,e){return a.head_path_candle(u[e]-l[e])}),e.selectAll(".stick_tail").attr("d",function(t,e){return a.tail_path_candle(d[e]-l[e],c[e]-d[e])})):(e.selectAll(".stick_head").attr("d",""),e.selectAll(".stick_tail").attr("d","")),e.selectAll(".stick_body").attr("d",function(t,e){return a.body_path_candle(_[e],o[e]-l[e],f[e],h[e]-o[e])})):(-1!==s.o?e.selectAll(".stick_head").attr("d",function(t,e){return a.head_path_bar(_[e],o[e]-l[e],-1*_[e])}):e.selectAll(".stick_head").attr("d",""),-1!==s.c?e.selectAll(".stick_tail").attr("d",function(t,e){return a.tail_path_bar(h[e]-l[e],-1*_[e])}):e.selectAll(".stick_tail").attr("d",""),e.selectAll(".stick_body").attr("d",function(t,e){return a.body_path_bar(c[e]-l[e])}))},head_path_candle:function(t){return"m0,0 l0,"+t},tail_path_candle:function(t,e){return"m0,"+t+" l0,"+e},body_path_candle:function(t,e,n,i){return"m"+t+","+e+" l"+n+",0 l0,"+i+" l"+-1*n+",0 z"},head_path_bar:function(t,e,n){return"m"+t+","+e+" l"+n+",0"},tail_path_bar:function(t,e){return"m0,"+t+" l"+e+",0"},body_path_bar:function(t){return"m0,0 l0,"+t},calculate_mark_width:function(){for(var t=Number.POSITIVE_INFINITY,e=this.model.get("scales").x,n=1;n<this.model.mark_data.length;n++){var i=this.model.mark_data[n][0]-this.model.mark_data[n-1][0];i<t&&(t=i)}return t===Number.POSITIVE_INFINITY&&(t=(e.domain[1]-e.domain[0])/2),t<0&&(t*=-1),t},relayout:function(){s.__super__.relayout.apply(this),this.set_ranges(),this.d3el.select(".intselmouse").attr("width",this.width).attr("height",this.height),this.draw()},draw_legend:function(t,e,n,s,a){var o=this.model.get("stroke"),l=this.model.get("colors"),c=l[0]?l[0]:"none";l[1]&&l[1];this.rect_dim=.8*a;var h=this;this.legend_el=t.selectAll("#legend"+this.uuid).data([this.model.mark_data]);var u=this.legend_el.enter().append("g").attr("transform",function(t,e){return"translate(0, "+(e*a+n)+")"}).attr("class","legend").attr("id","legend"+this.uuid).style("fill",c).on("mouseover",r.bind(this.highlight_axes,this)).on("mouseout",r.bind(this.unhighlight_axes,this));u.append("path").attr("class","stick_head stick"),u.append("path").attr("class","stick_tail stick"),u.append("path").attr("class","stick_body stick").style("fill",c),u.selectAll("path").style("stroke",o).attr("transform","translate("+h.rect_dim/2+",0)"),this.draw_legend_icon(h.rect_dim,u),this.legend_el.append("text").attr("class","legendtext sticktext").attr("x",1.2*h.rect_dim).attr("y",h.rect_dim/2).attr("dy","0.35em").text(function(t,e){return h.model.get("labels")[e]}).style("fill",o);var d=i.max(this.model.get("labels"),function(t){return t.length});return this.legend_el.exit().remove(),[1,d]},draw_legend_icon:function(t,e){var n=t,i=t/2,r=3*t/4,s=t/4;"candle"===this.model.get("marker")?(e.selectAll(".stick_head").attr("d",this.head_path_candle(i/2)),e.selectAll(".stick_tail").attr("d",this.tail_path_candle(r,i/2)),e.selectAll(".stick_body").attr("d",this.body_path_candle(-1*i/2,s,i,n/2))):(e.selectAll(".stick_head").attr("d",this.head_path_bar(-1*i/2,r,i/2)),e.selectAll(".stick_tail").attr("d",this.tail_path_bar(s,i/2)),e.selectAll(".stick_body").attr("d",this.body_path_bar(n)))}});t.exports={OHLC:s}},function(t,e,n){var i=n(0),r=n(1),s=n(5),a=s.MarkModel.extend({defaults:function(){return r.extend(s.MarkModel.prototype.defaults(),{_model_name:"BarsModel",_view_name:"Bars",x:[],y:[],color:null,scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"},color:{dimension:"color"}},color_mode:"auto",type:"stacked",colors:i.scale.category10().range(),padding:.05,stroke:null,base:0,opacities:[],orientation:"vertical",align:"center"})},initialize:function(){a.__super__.initialize.apply(this,arguments),this.is_y_2d=!1,this.on_some_change(["x","y","base"],this.update_data,this),this.on("change:color",function(){this.update_color(),this.trigger("colors_updated")},this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data(),this.update_color(),this.update_domains()},update_data:function(){var t=this.get_typed_field("x"),e=this.get_typed_field("y"),n=this.get("scales");n.x,n.y;e=0===e.length||e[0]instanceof Array?e:[e];var r=this;this.base_value=this.get("base"),void 0!==this.base_value&&null!==this.base_value||(this.base_value=0),0===t.length||0===e.length?(this.mark_data=[],this.is_y_2d=!1):(t=t.slice(0,i.min(e.map(function(t){return t.length}))),this.mark_data=t.map(function(t,n){var i={},s=r.base_value,a=r.base_value,o=r.base_value;return i.key=t,i.values=e.map(function(e,i){var l=e[n]-r.base_value,c=l>=0;return{index:n,sub_index:i,x:t,y0:c?s:o+=l,y1:c?s+=l:(a+=l)-l,y_ref:l,y:e[n]}}),i.pos_max=s,i.neg_max=a,i}),this.is_y_2d=this.mark_data[0].values.length>1,this.update_color()),this.update_domains(),this.trigger("data_updated")},get_data_dict:function(t,e,n){return t},update_color:function(){if(this.mark_data){var t=this.get_typed_field("color"),e=this.get("scales").color,n=this.get("color_mode"),i="group"===n||"auto"===n&&!this.is_y_2d;this.mark_data.forEach(function(e,n){e.values.forEach(function(e,r){e.color_index=i?n:r,e.color=t[e.color_index]})}),e&&t.length>0&&(this.get("preserve_domain").color?e.del_domain([],this.model_id+"_color"):e.compute_and_set_domain(t,this.model_id+"_color"))}},update_domains:function(){if(this.mark_data){var t=this.get("scales"),e=(this.get("orientation"),t.x),n=t.y;if(this.get("preserve_domain").x?e.del_domain([],this.model_id+"_x"):e.compute_and_set_domain(this.mark_data.map(function(t){return t.key}),this.model_id+"_x"),this.get("preserve_domain").y)n.del_domain([],this.model_id+"_y");else if("stacked"===this.get("type"))n.compute_and_set_domain([i.min(this.mark_data,function(t){return t.neg_max}),i.max(this.mark_data,function(t){return t.pos_max}),this.base_value],this.model_id+"_y");else{var r=i.min(this.mark_data,function(t){return i.min(t.values,function(t){return t.y_ref})}),s=i.max(this.mark_data,function(t){return i.max(t.values,function(t){return t.y_ref})});n.compute_and_set_domain([r,s,this.base_value],this.model_id+"_y")}}}});t.exports={BarsModel:a}},function(t,e,n){var i=n(1),r=n(0),s=n(3),a=n(4).Mark.extend({render:function(){var t=a.__super__.render.apply(this);this.bars_selected=[],this.display_el_classes=["rect","legendtext"];var e=this;return this.displayed.then(function(){e.parent.tooltip_div.node().appendChild(e.tooltip_div.node()),e.create_tooltip()}),t.then(function(){e.event_listeners={},e.process_interactions(),e.create_listeners(),e.draw(),e.update_selected(e.model,e.model.get("selected"))})},set_ranges:function(){var t=this.scales.sample;t&&t.set_range(this.parent.padded_range("x",t.model));var e=this.scales.count;e&&e.set_range(this.parent.padded_range("y",e.model))},set_positional_scales:function(){var t=this.scales.sample,e=this.scales.count;this.listenTo(t,"domain_changed",function(){this.model.dirty||this.model.update_data()}),this.listenTo(e,"domain_changed",function(){this.model.dirty||this.draw()})},create_listeners:function(){a.__super__.create_listeners.apply(this),this.d3el.on("mouseover",i.bind(function(){this.event_dispatcher("mouse_over")},this)).on("mousemove",i.bind(function(){this.event_dispatcher("mouse_move")},this)).on("mouseout",i.bind(function(){this.event_dispatcher("mouse_out")},this)),this.listenTo(this.model,"change:tooltip",this.create_tooltip,this),this.listenTo(this.model,"data_updated",this.draw,this),this.listenTo(this.model,"change:colors",this.update_colors,this),this.model.on_some_change(["stroke","opacities"],this.update_stroke_and_opacities,this),this.listenTo(this.model,"change:selected",this.update_selected,this),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.parent,"bg_clicked",function(){this.event_dispatcher("parent_clicked")})},process_interactions:function(){var t=this.model.get("interactions");i.isEmpty(t)?this.reset_interactions():(void 0!==t.click&&null!==t.click?"tooltip"===t.click?(this.event_listeners.element_clicked=function(){return this.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip):"select"===t.click&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.bar_click_handler):this.reset_click(),void 0!==t.hover&&null!==t.hover?"tooltip"===t.hover&&(this.event_listeners.mouse_over=this.refresh_tooltip,this.event_listeners.mouse_move=this.move_tooltip,this.event_listeners.mouse_out=this.hide_tooltip):this.reset_hover(),void 0!==t.legend_click&&null!==t.legend_click?"tooltip"===t.legend_click&&(this.event_listeners.legend_clicked=function(){return this.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip):this.event_listeners.legend_clicked=function(){},void 0!==t.legend_hover&&null!==t.legend_hover?"highlight_axes"===t.legend_hover&&(this.event_listeners.legend_mouse_over=i.bind(this.highlight_axes,this),this.event_listeners.legend_mouse_out=i.bind(this.unhighlight_axes,this)):this.reset_legend_hover())},update_colors:function(t,e){this.d3el.selectAll(".bargroup").selectAll("rect").style("fill",this.get_colors(0)),t.get("labels")&&e.length>1&&this.d3el.selectAll(".bargroup").selectAll("text").style("fill",this.get_colors(1)),this.legend_el&&(this.legend_el.selectAll("rect").style("fill",this.get_colors(0)),this.legend_el.selectAll("text").style("fill",this.get_colors(0)))},update_stroke_and_opacities:function(){var t=this.model.get("stroke"),e=this.model.get("opacities");this.d3el.selectAll(".rect").style("stroke",t).style("opacity",function(t,n){return e[n]})},calculate_bar_width:function(){var t=this.scales.sample,e=(t.scale(this.model.max_x)-t.scale(this.model.min_x))/this.model.num_bins;return e>=10&&(e-=2),e},relayout:function(){this.set_ranges();var t=this.scales.sample,e=this.scales.count;this.d3el.selectAll(".bargroup").attr("transform",function(n){return"translate("+t.scale(n.x)+","+e.scale(n.y)+")"});var n=this.calculate_bar_width();this.d3el.selectAll(".bargroup").select("rect").transition("relayout").duration(this.parent.model.get("animation_duration")).attr("x",2).attr("width",n).attr("height",function(t){return e.scale(0)-e.scale(t.y)})},draw:function(){this.set_ranges();var t=this.model.get("colors"),e=t[0],n=(t.length>1&&t[1],[]);this.model.mark_data.forEach(function(t,e){n.push(e)});var i=this.scales.sample,r=this.scales.count,s=this,a=this.calculate_bar_width(),o=this.d3el.selectAll(".bargroup").data(this.model.mark_data);o.enter().append("g").attr("class","bargroup").append("rect").attr("class","rect").attr("x",2).attr("width",0).attr("height",0),o.attr("transform",function(t){return"translate("+i.scale(t.x)+","+r.scale(t.y)+")"}),o.select(".rect").style("fill",e).on("click",function(t,e){return s.event_dispatcher("element_clicked",{data:t,index:e})}).attr("id",function(t,e){return"rect"+e}).transition("draw").duration(this.parent.model.get("animation_duration")).attr("width",a).attr("height",function(t){return r.scale(0)-r.scale(t.y)}),o.exit().remove(),this.bin_pixels=this.model.x_bins.map(function(t){return i.scale(t)+i.offset}),this.pixel_coords=this.model.mark_data.map(function(t){var e=i.scale(t.x);return[[e,e+a],[0,t.y].map(r.scale)]}),this.update_stroke_and_opacities()},bar_click_handler:function(t){t.data;var e=t.index,n=this.bars_selected,a=n?s.deepCopy(n):[],o=a.indexOf(e),l=r.event.ctrlKey||r.event.metaKey;if(o>-1&&l)a.splice(o,1);else if(r.event.shiftKey){if(o>-1)return;var c=0!==a.length?r.min(a):-1,h=0!==a.length?r.max(a):this.model.mark_data.length;e>h?i.range(h+1,e+1).forEach(function(t){a.push(t)}):e<c&&i.range(e,c).forEach(function(t){a.push(t)})}else l?a.push(e):(a=[]).push(e);this.bars_selected=a,this.model.set("selected",0===a.length?null:this.calc_data_indices(a),{updated_view:this}),this.touch(),r.event||(r.event=window.event);var u=r.event;void 0!==u.cancelBubble&&(u.cancelBubble=!0),u.stopPropagation&&u.stopPropagation(),u.preventDefault()},draw_legend:function(t,e,n,s,a){this.legend_el=t.selectAll(".legend"+this.uuid).data([this.model.mark_data[0]]);var o=this,l=.8*a;this.legend_el.enter().append("g").attr("class","legend"+this.uuid).attr("transform",function(t,e){return"translate(0, "+(e*a+n)+")"}).on("mouseover",i.bind(function(){this.event_dispatcher("legend_mouse_over")},this)).on("mouseout",i.bind(function(){this.event_dispatcher("legend_mouse_out")},this)).on("click",i.bind(function(){this.event_dispatcher("legend_clicked")},this)).append("rect").style("fill",function(t,e){return o.get_colors(e)}).attr({x:0,y:0,width:l,height:l}),this.legend_el.append("text").attr("class","legendtext").attr("x",1.2*l).attr("y",l/2).attr("dy","0.35em").text(function(t,e){return o.model.get("labels")[e]}).style("fill",function(t,e){return o.get_colors(e)});var c=r.max(this.model.get("labels"),function(t){return t.length});return this.legend_el.exit().remove(),[1,c]},reset_colors:function(t,e){this.d3el.selectAll("#rect"+t).style("fill",e)},update_selected:function(t,e){if(void 0!==e&&null!==e&&0!==e.length){var n=this.calc_bar_indices_from_data_idx(e);this.update_selected_colors(n)}else this.update_selected_colors([])},update_selected_colors:function(t){var e=this.model.get("colors"),n=e.length>1?e[1]:"red",r=e[0],s=(this.d3el.selectAll(".bargroup"),this);i.difference(i.range(0,this.model.num_bins),t).forEach(function(t){s.d3el.selectAll("#rect"+t).style("fill",r)}),t.forEach(function(t){s.d3el.selectAll("#rect"+t).style("fill",n)})},invert_point:function(t){if(void 0===t)return this.model.set("selected",null),void this.touch();var e=this.calculate_bar_width(),n=(this.scales.sample,this.bin_pixels.map(function(n){return Math.abs(n+e/2-t)})),i=n.indexOf(r.min(n));this.model.set("selected",this.calc_data_indices([i])),this.touch()},selector_changed:function(t,e){if(void 0===t)return this.model.set("selected",null),this.touch(),[];var n=this.pixel_coords,r=i.range(n.length),s=i.filter(r,function(t){return e(n[t])});this.model.set("selected",this.calc_data_indices(s)),this.touch()},calc_data_indices:function(t){var e=this.reduce_intervals(t);if(0===e.length)return[];var n=this.model.get_typed_field("sample"),r=e.length;return i.filter(i.range(n.length),function(t){var i=n[t],s=0;for(s=0;s<r;s++)if(i<=e[s][1]&&i>=e[s][0])return!0;return!1})},reduce_intervals:function(t){var e=[];if(0!==t.length){t.sort();for(var n=t[0],i=t[0],r=1;r<t.length;r++)t[r]===i+1?i++:(e.push([this.model.x_bins[n],this.model.x_bins[i+1]]),n=i=t[r]);e.push([this.model.x_bins[n],this.model.x_bins[i+1]])}return e},calc_data_indices_from_data_range:function(t,e){this.scales.sample;var n=r.max([0,r.bisectLeft(this.bin_pixels,t)-1]),s=r.min([this.model.num_bins,r.bisectRight(this.bin_pixels,e)]),a=this.model.get_typed_field("sample"),o=this;return i.filter(i.range(a.length),function(t){return a[t]>=o.model.x_bins[n]&&a[t]<=o.model.x_bins[s]})},calc_bar_indices_from_data_idx:function(t){for(var e=this.model.get_typed_field("sample"),n=t.map(function(t){return e[t]}),r=[],s=0;s<n.length;s++){var a=Math.min(i.indexOf(this.model.x_bins,n[s],!0),this.model.x_bins.length-2);-1===a&&(a=i.sortedIndex(this.model.x_bins,n[s])-1),r.push(a)}return r.sort(),r=i.uniq(r,!0)},reset_selection:function(){this.bars_selected=[],this.model.set("selected",null),this.touch()}});t.exports={Hist:a}},function(t,e,n){var i=n(0),r=n(1),s=n(5),a=s.MarkModel.extend({defaults:function(){return r.extend(s.MarkModel.prototype.defaults(),{_model_name:"OHLCModel",_view_name:"OHLC",x:[],y:[],scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"}},stroke:null,box_fill_color:"dodgerblue",outlier_fill_color:"gray",opacities:[]})},initialize:function(){a.__super__.initialize.apply(this,arguments),this.on_some_change(["x","y"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.on("change:format",this.update_format,this),this.px={o:-1,h:-1,l:-1,c:-1},this.mark_data=[],this.display_el_classes=["stick_body"],this.update_data(),this.update_domains(),this.update_format()},update_format:function(){this.update_data(),this.trigger("format_updated")},update_data:function(){var t=this.get_typed_field("x"),e=this.get_typed_field("y"),n=this.get("format");function s(t){console&&console.error("Invalid OHLC format: '"+t+"'")}if(this.px=n.toLowerCase().split("").reduce(function(i,r,a){return-1!==i[r]&&(s(n),t=[],e=[]),i[r]=a,i},{o:-1,h:-1,l:-1,c:-1}),-1!==this.px.h&&-1===this.px.l||-1===this.px.h&&-1!==this.px.l||n.length<2||n.length>4)s(n),t=[],e=[];else{var a=this.px;(-1===this.px.h||e.every(function(t){return t[a.h]===i.max(t)&&t[a.l]===i.min(t)}))&&e.every(function(t){return t.length===n.length})||(t=[],e=[],console&&console.error("Invalid OHLC data"))}t.length>e.length?t=t.slice(0,e.length):t.length<e.length&&(e=e.slice(0,t.length)),this.mark_data=r.zip(t,e),this.mark_data.forEach(function(t,e){t.index=e}),this.update_domains(),this.trigger("data_updated")},update_domains:function(){if(this.mark_data){for(var t,e,n=this.get("scales"),r=n.x,s=n.y,a=Number.POSITIVE_INFINITY,o=0,l=0,c=0,h=0;h<this.mark_data.length;h++)h>0&&(l=this.mark_data[h][0]-this.mark_data[h-1][0])<a&&(a=l),(c=this.mark_data[h][this.px.h]-this.mark_data[h][this.px.l])>o&&(o=c);if(this.mark_data.length<2&&(a=0),this.get("preserve_domain").x||0===this.mark_data.length?r.del_domain([],this.model_id+"_x"):"ordinal"===r.type?r.compute_and_set_domain(this.mark_data.map(function(t){return t[0]})):(t=i.min(this.mark_data.map(function(t){return t[0]})),(e=i.max(this.mark_data.map(function(t){return t[0]})))instanceof Date&&(e=e.getTime()),r.set_domain([t-a/2,e+a/2],this.model_id+"_x")),this.get("preserve_domain").y||0===this.mark_data.length)s.del_domain([],this.model_id+"_y");else{var u=this.px.h,d=this.px.l;-1!==u&&-1!==d||(u=this.px.o,d=this.px.c),t=i.min(this.mark_data.map(function(t){return t[1][d]<t[1][u]?t[1][d]:t[1][u]})),(e=i.max(this.mark_data.map(function(t){return t[1][u]>t[1][d]?t[1][u]:t[1][d]})))instanceof Date&&(e=e.getTime()),s.set_domain([t-o,e+o],this.model_id+"_y")}}},get_data_dict:function(t,e){var n=this,i={};return i.index=e,i.x=t.x,["open","low","high","close"].forEach(function(e){i[e]=t.y[n.px[e.substr(0,1)]]}),i}});t.exports={OHLCModel:a}},function(t,e,n){var i=n(1),r=n(0),s=n(5),a=s.MarkModel.extend({defaults:function(){return i.extend(s.MarkModel.prototype.defaults(),{_model_name:"HistModel",_view_name:"Hist",sample:[],count:[],scales_metadata:{sample:{orientation:"horizontal",dimension:"x"},count:{orientation:"vertical",dimension:"y"}},bins:10,midpoints:[],colors:r.scale.category10().range(),stroke:null,opacities:[],normalized:!1})},initialize:function(){a.__super__.initialize.apply(this,arguments),this.mark_data=[],this.on_some_change(["bins","sample","preserve_domain"],this.update_data,this),this.update_data(),this.on("change:normalized",function(){this.normalize_data(!0)},this),this.normalize_data(!0)},update_data:function(){var t=this.get_typed_field("sample"),e=this.get("scales").sample;if(this.num_bins=this.get("bins"),0==t.length)this.mark_data=[],this.x_mid=[],this.count=[],this.x_bins=[];else{this.get("preserve_domain").sample?e.del_domain([],this.model_id+"_sample"):e.compute_and_set_domain(t,this.model_id+"_sample"),this.min_x=e.domain[0],this.max_x=e.domain[1];var n=this,i=(t=t.filter(function(t){return t<=n.max_x&&t>=n.min_x})).map(function(t,e){return{index:e,value:t}});this.x_bins=this.create_uniform_bins(this.min_x,this.max_x,this.num_bins),this.x_mid=this.x_bins.map(function(t,e){return.5*(t+n.x_bins[e-1])}).slice(1),this.mark_data=r.layout.histogram().bins(this.x_bins).value(function(t){return t.value})(i),this.mark_data.forEach(function(t,e){t.index=e})}this.normalize_data(!1),this.set("midpoints",this.x_mid),this.set_typed_field("count",this.count),this.update_domains(),this.save_changes(),this.trigger("data_updated")},normalize_data:function(t){if(this.count=this.mark_data.map(function(t){return t.length}),this.get("normalized")){var e=1;this.mark_data.length>0&&(e=this.mark_data[0].dx);var n=this.count.reduce(function(t,e){return t+e},0);0!=n&&(this.count=this.count.map(function(t){return t/(n*e)}))}var i=this;this.mark_data.forEach(function(t,e){t.y=i.count[e]}),t&&(this.set_typed_field("count",this.count),this.update_domains(),this.save_changes(),this.trigger("data_updated"))},get_data_dict:function(t,e){var n={};return n.midpoint=this.x_mid[e],n.bin_start=this.x_bins[e],n.bin_end=this.x_bins[e+1],n.index=e,n.count=this.count[e],n},update_domains:function(){if(this.mark_data){var t=this.get("scales").count;this.get("preserve_domain").count||t.set_domain([0,1.05*r.max(this.mark_data,function(t){return t.y})],this.model_id+"_count")}},create_uniform_bins:function(t,e,n){for(var i=(e-t)/n,r=[],s=0;s<n;s++)r[s]=t+s*i;return r[n]=e,r}});t.exports={HistModel:a}},function(t,e,n){var i=n(2),r=n(1),s=n(7),a="^"+n(6).version,o=s.BaseModel.extend({defaults:function(){return r.extend(s.BaseModel.prototype.defaults(),{_model_name:"SelectorModel",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:a,_view_module_version:a,marks:[]})}},{serializers:r.extend({marks:{deserialize:i.unpack_models}},s.BaseModel.serializers)}),l=o.extend({defaults:function(){return r.extend(o.prototype.defaults(),{_model_name:"OneDSelectorModel",scale:null})}},{serializers:r.extend({scale:{deserialize:i.unpack_models}},o.serializers)}),c=o.extend({defaults:function(){return r.extend(o.prototype.defaults(),{_model_name:"TwoDSelectorModel",x_scale:null,y_scale:null})}},{serializers:r.extend({x_scale:{deserialize:i.unpack_models},y_scale:{deserialize:i.unpack_models}},o.serializers)}),h=l.extend({defaults:function(){return r.extend(l.prototype.defaults(),{_model_name:"FastIntervalSelectorModel",_view_name:"FastIntervalSelector",selected:{},color:null,size:null})}}),u=l.extend({defaults:function(){return r.extend(l.prototype.defaults(),{_model_name:"IndexSelectorModel",_view_name:"IndexSelector",selected:{},line_width:2,color:null})}}),d=l.extend({defaults:function(){return r.extend(l.prototype.defaults(),{_model_name:"BrushIntervalSelectorModel",_view_name:"BrushIntervalSelector",brushing:!1,selected:{},color:null,orientation:"horizontal"})}}),_=c.extend({defaults:function(){return r.extend(c.prototype.defaults(),{_model_name:"BrushSelectorModel",_view_name:"BrushSelector",clear:!1,brushing:!1,selected_x:{},selected_y:{},color:null})}}),f=l.extend({defaults:function(){return r.extend(l.prototype.defaults(),{_model_name:"MultiSelectorModel",_view_name:"MultiSelector",names:[],brushing:!1,selected:{},_selected:{},show_names:!0})}}),g=c.extend({defaults:function(){return r.extend(l.prototype.defaults(),{_model_name:"LassoSelectorModel",_view_name:"LassoSelector",color:null})}});t.exports={SelectorModel:o,OneDSelectorModel:l,TwoDSelectorModel:c,FastIntervalSelectorModel:h,IndexSelectorModel:u,BrushIntervalSelectorModel:d,BrushSelectorModel:_,MultiSelectorModel:f,LassoSelectorModel:g}},function(t,e,n){var i=n(0),r=n(1),s=n(4).Mark.extend({render:function(){var t=this;return s.__super__.render.apply(this).then(function(){t.create_listeners(),t.draw()},null)},set_ranges:function(){var t=this.scales.x;t&&t.set_range(this.parent.padded_range("x",t.model));var e=this.scales.y;e&&e.set_range(this.parent.padded_range("y",e.model))},set_positional_scales:function(){var t=this.scales.x;this.listenTo(t,"domain_changed",function(){this.model.dirty||this.draw()});var e=this.scales.y;this.listenTo(e,"domain_changed",function(){this.model.dirty||this.draw()})},create_listeners:function(){s.__super__.create_listeners.apply(this),this.listenTo(this.model,"change:stroke",this.update_stroke,this),this.listenTo(this.model,"change:opacities",this.update_opacities,this),this.listenTo(this.model,"change:marker",this.update_marker,this),this.listenTo(this.model,"change:outlier_fill_color",this.update_outlier_fill_color,this),this.listenTo(this.model,"change:box_fill_color",this.update_box_fill_color,this),this.listenTo(this.model,"data_updated",this.draw,this),this.listenTo(this.model,"change:box_width",this.update_box_width,this)},update_stroke:function(){var t=this.model.get("stroke");this.d3el.selectAll(".boxplot").selectAll("path, rect").style("stroke",t),this.d3el.selectAll(".outlier").style("stroke",t),this.legend_el&&(this.legend_el.selectAll("path").attr("stroke",t),this.legend_el.selectAll("text").style("fill",t))},update_outlier_fill_color:function(){this.d3el.selectAll(".outlier").style("fill",this.model.get("outlier_fill_color"))},update_box_fill_color:function(){this.d3el.selectAll(".box").style("fill",this.model.get("box_fill_color"))},update_opacities:function(){var t=this.model.get("opacities");this.d3el.selectAll(".boxplot").style("opacity",function(e,n){return t[n]}),this.legend_el&&this.legend_el.selectAll("path").attr("opacity",function(e,n){return t[n]})},update_marker:function(){var t=this.model.get("marker");if(this.legend_el&&this.rect_dim){var e=[.25*this.rect_dim,0,this.rect_dim,.75*this.rect_dim];this.draw_mark_paths(t,this.rect_dim/2,this.legend_el,[e])}this.draw_mark_paths(t,this.calculate_mark_max_width(),this.d3el,this.model.mark_data)},get_box_width:function(){var t=this.model.get("box_width");if(!t){var e=this.parent.plotarea_width,n=e/10;t=e/(this.model.mark_data.length+1)/1.5,t=Math.min(t,n)}return t},compute_view_padding:function(){var t=this.get_box_width()/2+1;t!==this.x_padding&&(this.x_padding=t,this.trigger("mark_padding_updated"))},update_box_width:function(){this.compute_view_padding(),this.draw()},update_idx_selected:function(t,e){this.selected_indices=e,this.apply_styles(e)},apply_styles:function(t){var e=r.range(this.model.mark_data.length);this.set_default_style(e),this.set_style_on_elements(this.selected_style,this.selected_indices);var n=void 0===t?[]:r.difference(e,t);this.set_style_on_elements(this.unselected_style,n)},set_style_on_elements:function(t,e){if(void 0!==e&&0!==e.length){var n=this.d3el.selectAll(".boxplot");(n=n.filter(function(t,n){return-1!=e.indexOf(n)})).style(t)}},set_default_style:function(t){if(void 0!==t&&0!==t.length){var e=this.model.get("color"),n=this.model.get("stroke"),i=this.model.get("opacities"),r=this.d3el.selectAll(".boxplot").filter(function(e,n){return-1!=t.indexOf(n)});r.style("fill",function(t){return t[0]>t[3]?e:"none"}).style("opacity",function(t,e){return i[e]}),r.selectAll("path, rect").style("stroke",n),r.selectAll(".outliers").style("stroke",n)}},clear_style:function(t,e){var n=this.d3el.selectAll(".boxplot");void 0!==e&&(n=n.filter(function(t,n){return-1!=e.indexOf(n)}));var i={};for(var r in t)i[r]=null;n.style(i)},style_updated:function(t,e){this.set_default_style(e),this.set_style_on_elements(t,e)},selected_style_updated:function(t,e){this.selected_style=e,this.style_updated(e,this.selected_indices)},unselected_style_updated:function(t,e){this.unselected_style=e;var n=this.selected_indices,i=n?r.range(this.model.mark_data.length).filter(function(t){return-1==n.indexOf(t)}):[];this.style_updated(e,i)},update_selected_colors:function(t){var e=this.model.get("stroke"),n=e;this.d3el.selectAll(".boxplot").style("stroke",function(i,r){return t.indexOf(r)>-1?n:e})},selector_changed:function(t,e){if(void 0===t)return this.model.set("selected",null),this.touch(),this.update_selected_colors([]),[];var n=this.pixel_coords,i=r.range(n.length),s=r.filter(i,function(t){return e(n[t])});this.update_selected_colors(s),this.model.set("selected",s),this.touch()},invert_point:function(t){if(void 0===t)return this.update_selected_colors([]),this.model.set("selected",null),void this.touch();var e=this.x_pixels.map(function(e){return Math.abs(e-t)}),n=e.indexOf(i.min(e));return this.model.set("selected",[n]),this.update_selected_colors([n]),this.touch(),n},prepareBoxPlots:function(){var t=!1!==this.model.get("auto_detect_outliers"),e=this.scales.x,n=this.scales.y;this.plotData=[],this.outlierData=[];for(var r=0;r<this.model.mark_data.length;++r){var s=this.model.mark_data[r],a={};a.x=e.scale(s[0]),a.boxUpper=n.scale(i.quantile(s[1],.75)),a.boxLower=n.scale(i.quantile(s[1],.25)),a.boxMedian=n.scale(i.quantile(s[1],.5));var o=a.boxLower-a.boxUpper,l=a.boxLower+1.5*o,c=a.boxUpper-1.5*o;a.whiskerMax=Number.MAX_VALUE,a.whiskerMin=Number.MIN_VALUE;for(var h=0;h<s[1].length;++h){var u=n.scale(s[1][h]);t&&(u>l||u<c)?this.outlierData.push({x:e.scale(s[0]),y:u}):(u>a.whiskerMin&&(a.whiskerMin=u),u<a.whiskerMax&&(a.whiskerMax=u))}this.plotData.push(a)}},draw:function(){this.set_ranges();var t=this.scales.x;this.prepareBoxPlots(),this.draw_mark_paths(".boxplot",this.d3el),this.x_pixels=this.model.mark_data.map(function(e){return t.scale(e[0])+t.offset});var e=this.get_box_width()/2;this.pixel_coords=this.plotData.map(function(t){return[[t.x-e,t.x+e],[t.boxLower,t.boxUpper]]})},draw_mark_paths:function(t,e){var n=this.plotData,i=this.outlierData,r=(this.calculate_mark_max_width(),this.model.get("color")),s=this.d3el.selectAll(t).data(n),a=this.model.get("box_fill_color"),o=(this.model.get("start_time"),s.enter().append("g").attr("class","boxplot").attr("id",function(t,e){return"boxplot"+e}));o.append("path").attr("class","whisker_max"),o.append("path").attr("class","whisker_max_end"),o.append("path").attr("class","whisker_min"),o.append("path").attr("class","whisker_min_end"),o.append("rect").attr("class","box"),o.append("path").attr("class","median_line"),o.append("g").attr("class","outliers");var l=0,c=this.scales.x;"ordinal"===c.model.type&&(l=c.scale.rangeBand()/2),e.selectAll(".boxplot").data(n).style("stroke",this.model.get("stroke")).style("opacity",r).attr("transform",function(t,e){return"translate("+(t.x+l)+", 0)"});var h=this.get_box_width();e.selectAll(".box").data(n).style("fill",a).attr("x",-h/2).attr("width",h).attr("y",function(t,e){return t.boxUpper}).attr("height",function(t,e){return t.boxLower-t.boxUpper}),e.selectAll(".median_line").data(n).style("stroke-width",2).attr("d",function(t,e){var n=t.boxMedian;return"M"+(0-h/2)+","+n+" L"+(0+h/2)+","+n}),e.selectAll(".whisker_max").data(n).attr("d",function(t,e){return"M0,"+t.whiskerMax+" L0,"+t.boxUpper}).attr("stroke-dasharray",function(t,e){return"5,5"}),e.selectAll(".whisker_max_end").data(n).attr("d",function(t,e){var n=t.whiskerMax;return"M"+(0-h/2)+","+n+" L"+(0+h/2)+","+n}),e.selectAll(".whisker_min").data(n).attr("d",function(t,e){return"M0,"+t.whiskerMin+" L0,"+t.boxLower}).attr("stroke-dasharray",function(t,e){return"5,5"}),e.selectAll(".whisker_min_end").data(n).attr("d",function(t,e){var n=t.whiskerMin;return"M"+(0-h/2)+","+n+" L"+(0+h/2)+","+n}),s.exit().remove();var u=e.selectAll(".outlier").data(i);u.enter().append("circle").attr("class","outlier"),u.exit().remove(),e.selectAll(".outlier").data(i).style("fill",this.model.get("outlier_fill_color")).attr("cx",function(t){return t.x+l}).attr("r",3).attr("cy",function(t){return t.y}),this.apply_styles(this.selected_indices)},calculate_mark_max_width:function(){for(var t=1/0,e=this.scales.x,n=1;n<this.model.mark_data.length;n++){var i=e.scale(this.model.mark_data[n][0])-e.scale(this.model.mark_data[n-1][0]);(i=i<0?-1*i:i)<t&&(t=i)}return t==1/0?(e.scale(this.model.max_x)-e.scale(this.model.min_x))/2:t},relayout:function(){s.__super__.relayout.apply(this),this.set_ranges(),this.compute_view_padding(),this.d3el.select(".intselmouse").attr("width",this.width).attr("height",this.height),this.draw()},draw_legend:function(t,e,n,s,a){var o=this.model.get("stroke");this.model.get("colors");this.rect_dim=.8*a;var l=this;this.legend_el=t.selectAll(".legend"+this.uuid).data([this.model.mark_data]),this.legend_el.enter().append("g").attr("transform",function(t,e){return"translate(0, "+(e*a+n)+")"}).attr("class","legend"+this.uuid).on("mouseover",r.bind(this.highlight_axes,this)).on("mouseout",r.bind(this.unhighlight_axes,this)).selectAll("path").attr("stroke",o).attr("transform","translate("+l.rect_dim/2+",0)"),this.legend_el.append("text").attr("class","legendtext").attr("x",1.2*l.rect_dim).attr("y",l.rect_dim/2).attr("dy","0.35em").text(function(t,e){return l.model.get("labels")[e]}).style("fill",o);var c=i.max(this.model.get("labels"),function(t){return t.length});return this.legend_el.exit().remove(),[1,c]}});t.exports={Boxplot:s}},function(t,e,n){var i=n(0),r=n(1),s=n(8).BaseXSelector.extend({render:function(){s.__super__.render.apply(this),this.active=!1,this.dirty=!1;var t=this,e=this.create_scales();Promise.all([this.mark_views_promise,e]).then(function(){t.line=t.d3el.append("line").attr("class","selector indsel").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",t.height).attr("stroke-width",t.model.get("line_width")).attr("pointer-events","none").attr("visibility","hidden"),t.color_change(),t.background=t.d3el.append("rect").attr("x",0).attr("y",0).attr("width",t.width).attr("height",t.height).attr("class","selector selectormouse").attr("pointer-events","all").attr("visibility","hidden"),t.background.on("mousemove",r.bind(t.mousemove,t)).on("click",r.bind(t.initial_click,t)),t.create_listeners(),t.selected_changed()})},create_listeners:function(){s.__super__.create_listeners.apply(this),this.listenTo(this.model,"change:color",this.color_change,this)},color_change:function(){null!==this.model.get("color")&&this.line.style("stroke",this.model.get("color"))},initial_click:function(){this.line.attr("visibility","visible"),this.click(),this.background.on("click",r.bind(this.click,this))},click:function(){this.active=!this.active},mousemove:function(){if(this.active){this.dirty=!0;var t=i.mouse(this.background.node())[0];this.line.attr({x1:t,x2:t}),this.model.set_typed_field("selected",[this.invert_pixel(t)]),r.each(this.mark_views,function(e){e.invert_point(t)}),this.touch(),this.dirty=!1}},invert_pixel:function(t){return this.scale.invert(t)},reset:function(){this.active=!1,void 0!==this.line&&null!==this.line&&this.line.attr({x1:0,x2:0,visibility:"hidden"}),void 0!==this.background&&null!==this.background&&this.background.on("click",r.bind(this.initial_click,this)),this.model.set_typed_field("selected",{}),r.each(this.mark_views,function(t){t.invert_point()}),this.touch()},update_scale_domain:function(t){s.__super__.update_scale_domain.apply(this),!0!==t&&this.selected_changed()},selected_changed:function(t,e){if(!this.dirty){var n=this.model.get_typed_field("selected");if(0===n.length)this.reset();else{if(1!=n.length)return;var i=this.scale.scale(n[0]);void 0!==this.line&&null!==this.line&&this.line.attr({x1:i,x2:i,visibility:"visible"}),this.background.on("click",r.bind(this.click,this)),r.each(this.mark_views,function(t){t.invert_point(i)})}}},relayout:function(){s.__super__.relayout.apply(this),this.line.attr("y1",0).attr("y2",this.height),this.background.attr("width",this.width).attr("height",this.height),this.set_range([this.scale])},scale_changed:function(){this.reset(),this.scale=this.parent.x_scale},set_range:function(t){for(var e=0;e<t.length;e++)t[e].set_range([0,this.width])}});t.exports={IndexSelector:s}},function(t,e,n){n(0);var i=n(18),r=n(13),s=i.OrdinalScale.extend({render:function(){s.__super__.render.apply(this),this.listenTo(this.model,"domain_changed",this.model_domain_changed,this),this.listenTo(this.model,"set_ticks",this.model_ticks_changed,this),this.model.on_some_change(["colors","scheme"],this.colors_changed,this),this.set_range()},set_range:function(){this.model.get("colors").length>0?this.scale.range(r.cycle_colors(this.model.get("colors"),this.scale.domain().length)):this.scale.range(r.get_ordinal_scale_range(this.model.get("scheme"),this.scale.domain().length)),this.trigger("color_scale_range_changed")},model_domain_changed:function(){s.__super__.model_domain_changed.apply(this),this.set_range()},colors_changed:function(){this.set_range()}});t.exports={OrdinalColorScale:s}},function(t,e,n){var i=n(0),r=n(1),s=n(5),a=s.MarkModel.extend({defaults:function(){return r.extend(s.MarkModel.prototype.defaults(),{_model_name:"BoxplotModel",_view_name:"Boxplot",x:[],y:[],scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"}},stroke:null,box_fill_color:"dodgerblue",outlier_fill_color:"gray",opacities:[],box_width:null,auto_detect_outliers:!0})},initialize:function(){a.__super__.initialize.apply(this,arguments),this.on_some_change(["x","y"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data(),this.update_domains()},update_data:function(){var t=this.get_typed_field("x"),e=this.get_typed_field("y");e.forEach(function(t){t.sort(function(t,e){return t-e})}),t.length>e.length?t=t.slice(0,e.length):t.length<e.length&&(e=e.slice(0,t.length)),this.mark_data=r.zip(t,e),this.update_domains(),this.trigger("data_updated")},update_domains:function(){var t=this.get("scales"),e=t.x,n=t.y;t.size,t.opacity;if(!this.get("preserve_domain").x&&this.mark_data?e.compute_and_set_domain(this.mark_data.map(function(t){return t[0]}),this.model_id+"_x"):e.del_domain([],this.model_id+"_x"),!this.get("preserve_domain").y&&this.mark_data){var r=i.min(this.mark_data.map(function(t){return t[1][0]})),s=i.max(this.mark_data.map(function(t){var e=t[1];return e[e.length-1]}));n.set_domain([r,s],this.model_id+"_y")}else n.del_domain([],this.model_id+"_y")}});t.exports={BoxplotModel:a}},function(t,e,n){var i=n(0),r=n(20).ScatterBase.extend({create_listeners:function(){r.__super__.create_listeners.apply(this),this.model.on_some_change(["font_weight","font_size","colors","align","font_unit"],this.update_style,this),this.model.on_some_change(["x","y","x_offset","y_offset","rotate_angle"],this.update_position,this)},update_default_opacities:function(t){if(!this.model.dirty){this.model.get("default_opacities").length;var e=!0===t?this.parent.model.get("animation_duration"):0,n=this;this.d3el.selectAll(".label").transition("update_default_opacities").duration(e).style("opacity",function(t,e){return n.get_element_opacity(t,e)})}},update_default_size:function(t){if(this.compute_view_padding(),!this.model.dirty){var e=!0===t?this.parent.model.get("animation_duration"):0,n=this;this.d3el.selectAll(".label").transition("update_default_size").duration(e).style("font-size",function(t,e){return n.get_element_size(t)})}},create_listeners:function(){r.__super__.create_listeners.apply(this),this.model.on_some_change(["font_weight","default_size","colors","align","font_unit"],this.update_style,this),this.model.on_some_change(["x","y","x_offset","y_offset","rotate_angle"],this.update_position,this)},relayout:function(){this.set_ranges(),this.update_position()},draw_elements:function(t,e){e.append("text").classed("label element",!0),this.update_text(),this.update_style(),this.update_default_opacities(!0)},update_text:function(){this.d3el.selectAll(".object_grp").select(".label").text(function(t){return t.text})},get_element_size:function(t){var e=this.scales.size,n=this.model.get("font_unit");return e&&void 0!==t.size?e.scale(t.size)+n:this.model.get("default_size")+n},get_element_rotation:function(t){var e=this.scales.rotation;return e&&t.rotation?"rotate("+e.scale(t.rotation)+")":"rotate("+this.model.get("rotate_angle")+")"},update_position:function(){var t=this,e=this.x_scale,n=this.y_scale,i=("date"===e.model.type?this.model.get_date_elem("x"):this.model.get("x"),"date"===n.model.type?this.model.get_date_elem("y"):this.model.get("y"),this.model.get("x_offset")),r=this.model.get("y_offset");this.d3el.selectAll(".object_grp").attr("transform",function(s){return"translate("+(e.scale(s.x)+e.offset+i)+","+(n.scale(s.y)+n.offset+r)+")"+t.get_element_rotation(s)})},update_style:function(){var t=this;this.d3el.selectAll(".object_grp").select("text").attr("dominant-baseline","central").style("font-size",function(e,n){return t.get_element_size(e)}).style("font-weight",this.model.get("font_weight")).style("text-anchor",this.model.get("align")),this.d3el.selectAll(".label").style("fill",function(e,n){return t.get_element_color(e,n)})},color_scale_updated:function(t){var e=this,n=!0===t?this.parent.model.get("animation_duration"):0;this.d3el.selectAll(".object_grp").select("text").transition("color_scale_updated").duration(n).style("fill",function(t,n){return e.get_element_color(t,n)})},set_default_style:function(t){if(t&&0!==t.length){var e=this;this.d3el.selectAll(".element").filter(function(e,n){return-1!==t.indexOf(n)}).style("font-size",function(t,n){return e.get_element_size(t)}).style("font-weight",this.model.get("font_weight")).style("text-anchor",this.model.get("align")).style("fill",function(t,n){return e.get_element_color(t,n)})}},set_drag_style:function(t,e,n){var r=this.model.get("drag_size")*this.model.get("default_size")+this.model.get("font_unit");i.select(n).select("text").classed("drag_label",!0).transition("set_drag_style").style("font-size",r)},reset_drag_style:function(t,e,n){i.select(n).select("text").classed("drag_label",!1).transition("reset_drag_style").style("font-size",this.get_element_size(t))}});t.exports={Label:r}},function(t,e,n){n(0);var i=n(1),r=n(21),s=r.ScatterBaseModel.extend({defaults:function(){return i.extend(r.ScatterBaseModel.prototype.defaults(),{_model_name:"LabelModel",_view_name:"Label",x_offset:0,y_offset:0,rotate_angle:0,text:[],font_size:16,font_unit:"px",drag_size:1,font_weight:"bold",align:"start"})},initialize:function(){s.__super__.initialize.apply(this,arguments),this.on("change:text",this.update_data,this)},update_mark_data:function(){s.__super__.update_mark_data.apply(this);var t=this.get_typed_field("text");this.mark_data.forEach(function(e,n){e.text=t[n]})},update_unique_ids:function(){this.mark_data.forEach(function(t,e){t.unique_id="Label"+e})}});t.exports={LabelModel:s}},function(t,e,n){var i=n(1),r=(n(0),n(11)),s=r.ScaleModel.extend({defaults:function(){return i.extend(r.ScaleModel.prototype.defaults(),{_model_name:"OrdinalScaleModel",_view_name:"OrdinalScale",min:null,max:null})},initialize:function(){s.__super__.initialize.apply(this,arguments)},set_init_state:function(){this.type="ordinal",this.min_from_data=!0,this.max_from_data=!0},set_listeners:function(){this.on("change:domain",this.domain_changed,this),this.domain_changed(),this.on("change:reverse",this.reverse_changed,this),this.reverse_changed()},domain_changed:function(){this.ord_domain=this.get("domain"),null!==this.ord_domain&&0!==this.ord_domain.length?(this.max_from_data=!1,this.min_from_data=!1,this.domain=this.ord_domain.map(function(t){return t}),this.trigger("domain_changed")):(this.max_from_data=!0,this.min_from_data=!0,this.domain=[],this.update_domain())},reverse_changed:function(t,e,n){var i=void 0!==t&&t.previous("reverse");this.reverse=this.get("reverse");var r=(i+this.reverse)%2;this.domain.length>0&&1===r&&(this.domain.reverse(),this.trigger("domain_changed",this.domain))},update_domain:function(){var t=[];for(var e in this.domains)t=i.union(t,this.domains[e]);this.domain.length===t.length&&i.intersection(this.domain,t).length===t.length||(this.domain=t,this.trigger("domain_changed",t))},compute_and_set_domain:function(t,e){if(this.min_from_data||this.max_from_data)if(0!==t.length){var n=i.flatten(t);this.get("reverse")&&n.reverse(),this.set_domain(n,e)}else this.set_domain([],e)}});t.exports={OrdinalScaleModel:s}},function(t,e,n){var i=n(0),r=n(1),s=n(8),a=n(3),o=n(14),l={brush_render:function(){var t=this,e=this.create_scales();this.brushing=!1,Promise.all([this.mark_views_promise,e]).then(function(){t.brush=i.svg.brush().on("brushstart",r.bind(t.brush_start,t)).on("brush",r.bind(t.brush_move,t)).on("brushend",r.bind(t.brush_end,t)),t.set_brush_scale(),t.d3el.attr("class","selector brushintsel"),t.brushsel=t.d3el.call(t.brush),t.adjust_rectangle(),t.color_change(),t.create_listeners(),t.selected_changed()})},color_change:function(){null!==this.model.get("color")&&this.brushsel.style("fill",this.model.get("color"))},brush_start:function(){this.model.set("brushing",!0),this.touch(),this.brushing=!0},brush_move:function(){var t=this.brush.empty()?[]:this.brush.extent();this.convert_and_save(t)},brush_end:function(){var t=this.brush.empty()?[]:this.brush.extent();this.model.set("brushing",!1),this.convert_and_save(t),this.brushing=!1},scale_changed:function(){this.brush.clear(),this.create_scales(),this.set_brush_scale()},adjust_rectangle:function(){"vertical"==this.model.get("orientation")?this.d3el.selectAll("rect").attr("x",0).attr("width",this.width):this.d3el.selectAll("rect").attr("y",0).attr("height",this.height)},_update_brush:function(){this.brushsel=this.d3el.call(this.brush)},clear_brush:function(){this.brush.clear(),this._update_brush()},update_mark_selected:function(t,e){if(void 0!==t&&0!==t.length){if(void 0===e)var n=this.model.get("orientation"),i="vertical"==n?[]:t,s="vertical"==n?t:[];else i=t,s=e;var a=function(t){return o.point_in_rectangle(t,i,s)},l=function(t){return o.rect_inter_rect(t[0],t[1],i,s)};r.each(this.mark_views,function(t){t.selector_changed(a,l)},this)}else r.each(this.mark_views,function(t){return t.selector_changed()})}},c=s.BaseXYSelector.extend(l).extend({render:function(){c.__super__.render.apply(this),this.brush_render()},create_listeners:function(){c.__super__.create_listeners.apply(this),this.listenTo(this.model,"change:color",this.color_change,this),this.listenTo(this.model,"change:selected_x",this.selected_changed),this.listenTo(this.model,"change:selected_y",this.selected_changed)},empty_selection:function(){this.update_mark_selected(),this.model.set("selected_x",{}),this.model.set("selected_y",{}),this.touch()},convert_and_save:function(t){if(0!==t.length){var e=[t[0][0],t[1][0]],n=[t[0][1],t[1][1]],i="ordinal"===this.x_scale.model.type,r="ordinal"===this.y_scale.model.type,s=i?e:e.map(this.x_scale.scale),a=r?n:n.map(this.y_scale.scale);e=i?this.x_scale.invert_range(e):e,n=r?this.y_scale.invert_range(n):n,this.update_mark_selected(s,a),this.model.set_typed_field("selected_x",e),this.model.set_typed_field("selected_y",n),this.touch()}else this.empty_selection()},selected_changed:function(t,e){if(!this.brushing){var n=this.model.get_typed_field("selected_x"),i=this.model.get_typed_field("selected_y");if(0===n.length||0===i.length)this.clear_brush(),this.update_mark_selected();else{if(2!=n.length||2!=i.length)return;var r=[[n[0],i[0]],[n[1],i[1]]];this.brush.extent(r),this._update_brush();var s=n.map(this.x_scale.scale).sort(function(t,e){return t-e}),a=i.map(this.y_scale.scale).sort(function(t,e){return t-e});this.update_mark_selected(s,a)}}},relayout:function(){c.__super__.relayout.apply(this),this.d3el.select(".background").attr("width",this.width).attr("height",this.height),this.set_x_range([this.x_scale]),this.set_y_range([this.y_scale])},adjust_rectangle:function(){},set_brush_scale:function(){this.brush.y(this.y_scale.scale).x(this.x_scale.scale)},update_xscale_domain:function(){c.__super__.update_xscale_domain.apply(this),void 0!==this.brush&&null!==this.brush&&this.brush.x(this.x_scale.scale)},update_yscale_domain:function(){c.__super__.update_yscale_domain.apply(this),void 0!==this.brush&&null!==this.brush&&this.brush.y(this.y_scale.scale)}}),h=s.BaseXSelector.extend(l).extend({render:function(){h.__super__.render.apply(this),this.brush_render()},create_listeners:function(){h.__super__.create_listeners.apply(this),this.listenTo(this.model,"change:color",this.change_color,this)},empty_selection:function(){this.update_mark_selected(),this.model.set_typed_field("selected",[]),this.touch()},convert_and_save:function(t){if(0!==t.length){var e="ordinal"===this.scale.model.type,n=e?t:t.map(this.scale.scale);t=e?this.scale.invert_range(t):t,this.update_mark_selected(n),this.model.set_typed_field("selected",t),this.touch()}else this.empty_selection()},update_scale_domain:function(t){h.__super__.update_scale_domain.apply(this),void 0!==this.brush&&null!==this.brush&&this.set_brush_scale(),!0!==t&&this.selected_changed()},set_brush_scale:function(){"vertical"==this.model.get("orientation")?this.brush.y(this.scale.scale):this.brush.x(this.scale.scale)},selected_changed:function(t,e){if(!this.brushing){var n=this.model.get_typed_field("selected");if(0===n.length)this.clear_brush(),this.update_mark_selected();else{if(2!=n.length)return;var i=[n[0],n[1]];this.brush.extent(i),this._update_brush();var r=i.map(this.scale.scale).sort(function(t,e){return t-e});this.update_mark_selected(r)}}},remove:function(){this.brush.clear(),h.__super__.remove.apply(this)},relayout:function(){h.__super__.relayout.apply(this),this.adjust_rectangle(),this.d3el.select(".background").attr("width",this.width).attr("height",this.height),this.set_range([this.scale])}}),u=function(t,e,n){n&&n.forEach(function(e){t.classed(e,!1)}),e&&e.forEach(function(e){t.classed(e,!0)})},d=s.BaseXSelector.extend(l).extend({render:function(){d.__super__.render.apply(this);var t=this;this.names=this.model.get("names"),this.curr_index=0;var e=this.create_scales();Promise.all([this.mark_views_promise,e]).then(function(){t.d3el.attr("class","multiselector"),t.create_brush(),t.selecting_brush=!1,t.create_listeners()})},create_listeners:function(){d.__super__.create_listeners.apply(this),this.listenTo(this.model,"change:names",this.labels_change,this),this.listenTo(this.model,"change:color",this.color_change,this)},labels_change:function(t,e){var n=t.previous("names");this.names=e;var i=r.range(this.curr_index+1),s=this,o=a.deepCopy(this.model.get("selected"));i.forEach(function(t){var e=s.get_label(t),i=s.get_label(t,n);i!==e&&(s.d3el.select(".brush_text_"+t).text(e),o[e]=o[i],delete o[i])}),this.model.set_typed_field("_selected",o),this.touch()},create_brush:function(t){var e=this,n=this.curr_index,r=i.svg.brush().on("brushstart",function(){e.brush_start()}).on("brush",function(){e.brush_move(n,this)}).on("brushend",function(){e.brush_end(n,this)}),s=this.d3el.append("g").attr("class","selector brushintsel active");s.append("text").text(this.get_label(this.curr_index)).attr("class","brush_text_"+this.curr_index).style("text-anchor","middle").style("stroke","yellow").style("font-size","16px").style("display","none"),"vertical"==this.model.get("orientation")?(r.y(this.scale.scale),s.select("text").attr("x",30)):(r.x(this.scale.scale),s.select("text").attr("y",30)),s.call(r),this.color_change(),this.adjust_rectangle();var a=s.on("mousedown.brush");s.on("mousedown.brush",function(){u(e.d3el.selectAll(".selector"),["inactive"],["visible"]),u(i.select(this),["active"],["inactive"]),a.call(this),i.select(this).on("mousedown.brush",function(){var t=i.event.ctrlKey||i.event.metaKey;i.event.shiftKey&&t&&i.event.altKey?e.reset():t?(u(i.select(this),["inactive"],["active"]),e.create_brush(i.event)):i.event.shiftKey&&!1===e.selecting_brush?(u(e.d3el.selectAll(".selector"),["visible"],["active","inactive"]),e.selecting_brush=!0):(u(e.d3el.selectAll(".selector"),["inactive"],["visible"]),u(i.select(this),["active"],["inactive"]),a.call(this),e.selecting_brush=!1)})}),this.curr_index=this.curr_index+1},get_label:function(t,e){return void 0!==e&&null!==e||(e=this.names),e.length>t?e[t]:t},brush_start:function(){this.model.set("brushing",!0),this.touch()},brush_move:function(t,e){var n=i.event.target,r=n.empty()?this.scale.scale.domain():n.extent(),s=!this.model.get("show_names");i.select(e).select("text").style("display",n.empty()||s?"none":"inline"),this.set_text_location(e,r),this.convert_and_save(r,t)},set_text_location:function(t,e){var n=(e[0]+e[1])/2;"date"===this.scale.model.type&&(n=new Date((e[0].getTime()+e[1].getTime())/2));var r="vertical"==this.model.get("orientation")?"y":"x";i.select(t).select("text").attr(r,this.scale.scale(n))},brush_end:function(t,e){var n=i.event.target,r=n.empty()?this.scale.scale.domain():n.extent();this.model.set("brushing",!1),this.convert_and_save(r,t)},reset:function(){this.d3el.selectAll(".selector").remove(),this.model.set("_selected",{}),this.curr_index=0,this.touch(),this.create_brush()},convert_and_save:function(t,e){var n=a.deepCopy(this.model.get("_selected"));n[this.get_label(e)]=t;var i=t.map(this.scale.scale);this.update_mark_selected(i),this.model.set("_selected",n),this.touch()},scale_changed:function(){this.d3el.selectAll(".selector").remove(),this.curr_index=0,this.create_scale(),this.create_brush()},color_change:function(){null!==this.model.get("color")&&this.d3el.selectAll(".selector").style("fill",this.model.get("color"))},relayout:function(){d.__super__.relayout.apply(this),this.adjust_rectangle(),this.d3el.select(".background").attr("width",this.width).attr("height",this.height),this.set_range([this.scale])},remove:function(){this.model.off("change:names",null,this),d.__super__.remove.apply(this)}});t.exports={BrushSelector:c,BrushIntervalSelector:h,MultiSelector:d}},function(t,e,n){var i=n(0),r=n(1),s=(n(3),n(8)),a=n(14),o=s.BaseXYSelector.extend({render:function(){o.__super__.render.apply(this);var t=this.create_scales();this.line=i.svg.line(),this.all_vertices={},this.lasso_counter=0;var e=this;Promise.all([this.mark_views_promise,t]).then(function(){var t=i.behavior.drag().on("dragstart",r.bind(e.drag_start,e)).on("drag",r.bind(e.drag_move,e)).on("dragend",r.bind(e.drag_end,e));i.select(window).on("keydown",r.bind(e.keydown,e)),e.d3el.attr("class","lassoselector"),e.background=e.d3el.append("rect").attr("x",0).attr("y",0).attr("width",e.width).attr("height",e.height).attr("visibility","hidden").attr("pointer-events","all").style("cursor","crosshair").call(t),e.create_listeners()})},create_listeners:function(){o.__super__.create_listeners.apply(this),this.listenTo(this.model,"change:color",this.change_color,this)},change_color:function(t,e){e&&this.d3el.selectAll("path").style("stroke",e)},create_new_lasso:function(){var t=this.d3el.append("path").attr("id","l"+ ++this.lasso_counter).on("click",function(){var t=i.select(this);t.classed("selected",!t.classed("selected"))}),e=this.model.get("color");e&&t.style("stroke",e)},drag_start:function(){this.current_vertices=[],this.create_new_lasso()},drag_move:function(){this.current_vertices.push(i.mouse(this.background.node())),this.d3el.select("#l"+this.lasso_counter).attr("d",this.line(this.current_vertices))},drag_end:function(){var t="l"+this.lasso_counter;this.d3el.select("#"+t).attr("d",this.line(this.current_vertices)+"Z"),this.all_vertices[t]=this.current_vertices,this.update_mark_selected(this.all_vertices)},update_mark_selected:function(t){void 0!==t&&0!==t.length||r.each(this.mark_views,function(t){return t.selector_changed()});var e=function(e){for(var n in t)if(a.point_in_lasso(e,t[n]))return!0;return!1},n=function(e){for(var n in t)if(a.lasso_inter_rect(e[0],e[1],t[n]))return!0;return!1};r.each(this.mark_views,function(t){t.selector_changed(e,n)},this)},relayout:function(){o.__super__.relayout.apply(this),this.background.attr("width",this.width).attr("height",this.height)},keydown:function(){if(46===i.event.keyCode){var t=this.d3el.selectAll(".selected"),e=this.all_vertices;t.each(function(){var t=i.select(this).attr("id");delete e[t]}),t.remove(),this.update_mark_selected(this.all_vertices)}},reset:function(){this.lasso_counter=0,this.all_vertices={},this.d3el.selectAll("path").remove(),this.update_mark_selected()}});t.exports={LassoSelector:o}},function(t,e,n){var i=n(2),r=n(1),s=n(0),a=n(9).Interaction.extend({render:function(){a.__super__.render.apply(this);var t=this;this.d3el.style({cursor:"move"}).on("mousedown",function(){t.mousedown()}).on("mousemove",function(){t.mousemove()}).on("mouseup",function(){t.mouseup()}).on("mousewheel",function(){t.mousewheel()}).on("DOMMouseScroll.zoom",function(){t.mousewheel()}).on("mousewheel.zoom",null).on("wheel.zoom",null),this.active=!1,this.update_scales(),this.listenTo(this.model,"change:scales",this.update_scales,this),this.set_ranges(),this.listenTo(this.parent,"margin_updated",this.set_ranges,this)},update_scales:function(){var t=this.model.get("scales"),e=this;this.scale_promises=i.resolvePromisesDict({x:Promise.all((t.x||[]).map(function(t){return e.create_child_view(t)})),y:Promise.all((t.y||[]).map(function(t){return e.create_child_view(t)}))}),i.resolvePromisesDict(this.scale_promises).then(r.bind(this.set_ranges,this))},set_ranges:function(){var t,e=this;this.scale_promises.then(function(n){var i=n.x;for(t=0;t<i.length;t++)i[t].set_range(e.parent.padded_range("x",i[t].model));var r=n.y;for(t=0;t<r.length;t++)r[t].set_range(e.parent.padded_range("y",r[t].model))})},mousedown:function(){var t=this.model.get("scales");this.active=!0,this.d3el.style({cursor:"move"}),this.previous_pos=s.mouse(this.el),this.domains={x:(t.x||[]).map(function(t){return t.domain.slice(0)}),y:(t.y||[]).map(function(t){return t.domain.slice(0)})}},mouseup:function(){this.active=!1},mousemove:function(){if(this.active&&this.model.get("allow_pan")){var t=s.mouse(this.el);"previous_pos"in this||(this.previous_pos=t);var e=this.model.get("scales"),n=this;this.scale_promises.then(function(i){var r,s,a,o,l=i.x,c=n.domains.x,h=l.map(function(e){if(e.scale.invert)return e.scale.invert(t[0])-e.scale.invert(n.previous_pos[0])});for(r=0;r<l.length;r++)a=(s=c[r])[0]-h[r],o=s[1]-h[r],n.set_scale_attribute(e.x[r],"min",a),n.set_scale_attribute(e.x[r],"max",o),l[r].touch();var u=i.y,d=n.domains.y,_=u.map(function(e){if(e.scale.invert)return e.scale.invert(t[1])-e.scale.invert(n.previous_pos[1])});for(r=0;r<u.length;r++)a=(s=d[r])[0]-_[r],o=s[1]-_[r],n.set_scale_attribute(e.y[r],"min",a),n.set_scale_attribute(e.y[r],"max",o),u[r].touch()})}},mousewheel:function(){if(this.model.get("allow_zoom")){s.event.preventDefault();var t=s.event.wheelDelta||-40*s.event.detail,e=s.mouse(this.el);if(t){t>0?this.d3el.style({cursor:"zoom-in"}):this.d3el.style({cursor:"zoom-out"});var n=this.model.get("scales"),i=this;this.scale_promises.then(function(r){var s,a,o,l,c=r.x,h=c.map(function(t){return t.scale.invert(e[0])}),u=Math.exp(.001*-t);for(s=0;s<c.length;s++)o=(a=n.x[s].domain)[0],l=a[1],i.set_scale_attribute(n.x[s],"min",(1-u)*h[s]+u*o),i.set_scale_attribute(n.x[s],"max",(1-u)*h[s]+u*l),c[s].touch();var d=r.y,_=d.map(function(t){return t.scale.invert(e[1])});for(s=0;s<d.length;s++)o=(a=n.y[s].domain)[0],l=a[1],i.set_scale_attribute(n.y[s],"min",(1-u)*_[s]+u*o),i.set_scale_attribute(n.y[s],"max",(1-u)*_[s]+u*l),d[s].touch()})}}},set_scale_attribute:function(t,e,n){"date"==t.type?(n=n instanceof Date?n:new Date(n),t.set_date_elem(e,n)):t.set(e,n)}});t.exports={PanZoom:a}},function(t,e,n){var i=n(0),r=(n(1),n(3),n(17).Axis.extend({render:function(){this.parent=this.options.parent,this.margin=this.parent.margin,this.vertical="vertical"===this.model.get("orientation"),this.height=this.parent.height-(this.margin.top+this.margin.bottom),this.width=this.parent.width-(this.margin.left+this.margin.right);var t=this.set_scale(this.model.get("scale"));this.side=this.model.get("side"),this.x_offset=100,this.y_offset=40,this.bar_height=20,this.d3el.attr("class","ColorBar").attr("display",this.model.get("visible")?"inline":"none").attr("transform",this.get_topg_transform()),this.ordinal=!1,this.num_ticks=this.model.get("num_ticks");var e=this;t.then(function(){e.create_listeners(),e.tick_format=e.generate_tick_formatter(),e.set_scales_range(),e.append_axis()})},create_listeners:function(){this.listenTo(this.model,"change:scale",function(t,e){this.update_scale(t.previous("scale"),e),this.axis.scale(this.axis_scale.scale),this.rescale_axis()},this),this.listenTo(this.model,"change:tick_format",this.tickformat_changed,this),this.axis_scale.on("domain_changed",this.redraw_axisline,this),this.axis_scale.on("color_scale_range_changed",this.redraw_axis,this),this.axis_scale.on("highlight_axis",this.highlight,this),this.axis_scale.on("unhighlight_axis",this.unhighlight,this),this.parent.on("margin_updated",this.parent_margin_updated,this),this.listenTo(this.model,"change:visible",this.update_visibility,this),this.listenTo(this.model,"change:label",this.update_label,this),this.model.on_some_change(["side","orientation"],this.update_display,this)},update_display:function(){this.side=this.model.get("side"),this.vertical="vertical"===this.model.get("orientation"),this.rescale_axis(),this.d3el.select("#colorBarG"+this.cid).attr("transform",this.get_colorbar_transform()),this.d3el.select("#colorBarG"+this.cid).select(".g-rect").attr("transform",this.vertical?"rotate(-90)":""),this.redraw_axisline()},set_scale:function(t){var e=this;return this.axis_scale&&this.axis_scale.remove(),this.create_child_view(t).then(function(t){e.displayed.then(function(){t.trigger("displayed")}),e.axis_scale=t,"date_color_linear"===e.axis_scale.model.type?e.axis_line_scale=i.time.scale().nice():"ordinal"===e.axis_scale.model.type?(e.axis_line_scale=i.scale.ordinal(),e.ordinal=!0):e.axis_line_scale=i.scale.linear()})},append_axis:function(){void 0!==this.model.get("label")&&null!==this.model.get("label")&&this.d3el.append("g").attr("transform",this.get_label_transform()).attr("class","axis label_g").append("text").append("tspan").attr("id","text_elem").attr("dy","0.5ex").text(this.model.get("label")).attr("class","axislabel").style("text-anchor",this.vertical?"middle":"end");var t=this.d3el.append("g").attr("id","colorBarG"+this.cid);this.draw_color_bar(),this.set_axisline_domain(),this.g_axisline=t.append("g").attr("class","axis"),this.axis=i.svg.axis().tickFormat(this.tick_format),this.redraw_axisline()},draw_color_bar:function(){var t=this.d3el.select("#colorBarG"+this.cid);t.attr("transform",this.get_colorbar_transform());var e=this;t.selectAll(".g-rect").remove(),t.selectAll(".g-defs").remove(),this.colors=this.axis_scale.scale.range();var n=100/(this.colors.length-1);if(this.ordinal){var i=this.get_color_bar_width()/this.colors.length,r=t.append("g").attr("class","g-rect axis").selectAll("rect").data(this.colors);r.enter().append("rect").attr("y",0).attr("height",this.bar_height).attr("width",i).style("fill",function(t){return t}),this.vertical?r.attr("x",function(t,n){return n*i-(e.height-2*e.x_offset)}):r.attr("x",function(t,e){return e*i})}else t.append("g").attr("class","g-defs").append("defs").append("linearGradient").attr({id:"colorBarGradient"+this.cid,x1:"0%",y1:"0%",x2:"100%",y2:"0%"}).selectAll("stop").data(this.colors).enter().append("stop").attr({offset:function(t,e){return n*e+"%"},"stop-color":function(t,n){return e.colors[n]},"stop-opacity":1}),t.append("g").attr("class","g-rect axis").append("rect").attr({width:this.get_color_bar_width(),height:this.bar_height,x:this.vertical?-(this.height-2*this.x_offset):0,y:0,"stroke-width":1}).style("fill","url(#colorBarGradient"+this.cid+")");this.vertical&&t.select(".g-rect").attr("transform","rotate(-90)")},get_topg_transform:function(){return this.vertical?"right"===this.side?"translate("+String(this.get_basic_transform()+this.margin.right/2-this.bar_height)+", 0)":"translate("+String(this.get_basic_transform()-this.margin.left/2+this.bar_height)+", 0)":"top"===this.side?"translate(0, "+String(this.get_basic_transform()-this.margin.top+this.bar_height+24)+")":"translate(0, "+String(this.get_basic_transform()+this.margin.bottom-this.bar_height-24)+")"},get_label_transform:function(){return this.vertical?"translate("+("right"===this.side?this.bar_height/2:-this.bar_height/2)+", "+(this.x_offset-15)+")":"translate("+(this.x_offset-5)+", "+this.bar_height/2+")"},get_colorbar_transform:function(){return this.vertical?"translate(0, "+String(this.x_offset)+")":"translate("+String(this.x_offset)+", 0)"},set_axisline_scale_range:function(){var t=this.vertical?[this.height-2*this.x_offset,0]:[0,this.width-2*this.x_offset];if(this.ordinal)this.axis_line_scale.rangeRoundBands(t,.05);else{var e=this.axis_scale.model.mid;void 0===e||null===e?this.axis_line_scale.range(t):this.axis_line_scale.range([t[0],.5*(t[0]+t[1]),t[1]])}},set_scales_range:function(){this.axis_scale.set_range(),this.set_axisline_scale_range()},get_color_bar_width:function(){return this.vertical?this.height-2*this.x_offset:this.width-2*this.x_offset},update_label:function(t,e){this.d3el.select("#text_elem").text(this.model.get("label"))},rescale_axis:function(){this.set_axisline_scale_range(),this.d3el.attr("transform",this.get_topg_transform());var t=this,e=this.get_color_bar_width()/this.colors.length;if(this.ordinal){var n=this.d3el.select("#colorBarG"+this.cid).select(".g-rect").selectAll("rect").attr("width",e);this.vertical?n.attr("x",function(n,i){return i*e-(t.height-2*t.x_offset)}):n.attr("x",function(t,n){return n*e})}else this.d3el.select("#colorBarG"+this.cid).select(".g-rect").selectAll("rect").attr("width",this.get_color_bar_width()).attr("x",this.vertical?-(this.height-2*this.x_offset):0);void 0!==this.model.get("label")&&null!==this.model.get("label")&&this.d3el.select(".label_g").attr("transform",this.get_label_transform()).select("#text_elem").style("text-anchor",this.vertical?"middle":"end"),this.g_axisline.call(this.axis)},redraw_axisline:function(){var t;this.axis&&(this.set_axisline_domain(),this.set_axisline_scale_range(),this.axis.orient(this.side).scale(this.axis_line_scale),this.set_tick_values(),t=this.vertical?"translate("+("right"===this.side?this.bar_height:0)+", 0)":"translate(0, "+("top"===this.side?0:this.bar_height)+")",this.g_axisline.attr("transform",t).call(this.axis))},set_axisline_domain:function(){var t=this.axis_scale.scale.domain();if(this.ordinal)this.axis_line_scale.domain(t);else{var e=this.axis_scale.model.mid;void 0===e||null===e?this.axis_line_scale.domain([t[0],t[t.length-1]]):this.axis_line_scale.domain([t[0],e,t[t.length-1]])}},redraw_axis:function(){this.draw_color_bar(),this.redraw_axisline()}}));t.exports={ColorAxis:r}},function(t,e,n){var i=n(2),r=n(1),s=n(7),a="^"+n(6).version,o=s.BaseModel.extend({defaults:function(){return r.extend(s.BaseModel.prototype.defaults(),{_model_name:"PanZoomModel",_view_name:"PanZoom",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:a,_view_module_version:a,scales:{},allow_pan:!0,allow_zoom:!0})},initialize:function(){o.__super__.initialize.apply(this,arguments),this.on("change:scales",this.snapshot_scales,this),this.snapshot_scales()},reset_scales:function(){var t=this;i.resolvePromisesDict(this.get("scales")).then(function(e){r.each(Object.keys(e),function(n){r.each(e[n],function(e,i){e.set_state(t.scales_states[n][i])},t)},t)})},snapshot_scales:function(){var t=this;i.resolvePromisesDict(this.get("scales")).then(function(e){t.scales_states=Object.keys(e).reduce(function(t,n){return t[n]=e[n].map(function(t){return t.get_state()}),t},{})})}},{serializers:r.extend({scales:{deserialize:i.unpack_models}},s.BaseModel.serializers)});t.exports={PanZoomModel:o}},function(t,e,n){var i=n(0),r=n(4),s=n(3),a=n(1),o=r.Mark.extend({render:function(){var t=o.__super__.render.apply(this);this.selected_indices=this.model.get("selected"),this.selected_style=this.model.get("selected_style"),this.unselected_style=this.model.get("unselected_style"),this.display_el_classes=["slice","text"];var e=this;this.pie_g=this.d3el.append("g").attr("class","pie"),this.pie_g.append("g").attr("class","slices"),this.pie_g.append("g").attr("class","labels"),this.pie_g.append("g").attr("class","lines");var n=this.model.get("radius"),r=this.model.get("inner_radius");return"outside"===this.model.get("display_labels")?(this.arc=i.svg.arc().outerRadius(.8*n).innerRadius(.8*r),this.outer_arc=i.svg.arc().innerRadius(.9*n).outerRadius(.9*n)):this.arc=i.svg.arc().outerRadius(n).innerRadius(r),this.displayed.then(function(){e.parent.tooltip_div.node().appendChild(e.tooltip_div.node()),e.create_tooltip()}),t.then(function(){e.event_listeners={},e.process_interactions(),e.create_listeners(),e.compute_view_padding(),e.draw()},null)},set_ranges:function(){var t=this.scales.x;t&&(t.set_range(this.parent.padded_range("x",t.model)),this.x_offset=t.offset);var e=this.scales.y;e&&(e.set_range(this.parent.padded_range("y",e.model)),this.y_offset=e.offset)},set_positional_scales:function(){var t=this.scales.x?this.scales.x:this.parent.scale_x,e=this.scales.y?this.scales.y:this.parent.scale_y,n=this;this.listenTo(t,"domain_changed",function(){n.model.dirty||n.draw()}),this.listenTo(e,"domain_changed",function(){n.model.dirty||n.draw()})},create_listeners:function(){o.__super__.create_listeners.apply(this),this.d3el.on("mouseover",a.bind(function(){this.event_dispatcher("mouse_over")},this)).on("mousemove",a.bind(function(){this.event_dispatcher("mouse_move")},this)).on("mouseout",a.bind(function(){this.event_dispatcher("mouse_out")},this)),this.listenTo(this.model,"data_updated",function(){this.draw(!0)},this),this.listenTo(this.model,"change:colors",this.update_colors,this),this.listenTo(this.model,"colors_updated",this.update_colors,this),this.model.on_some_change(["inner_radius","radius"],function(){this.compute_view_padding();this.update_radii(!0)},this),this.model.on_some_change(["stroke","opacities"],this.update_stroke_and_opacities,this),this.model.on_some_change(["x","y"],this.position_center,this),this.model.on_some_change(["display_labels","label_color","font_size","font_weight"],this.update_labels,this),this.model.on_some_change(["start_angle","end_angle","sort"],function(){this.draw(!0)},this),this.model.on_some_change(["display_values","values_format"],this.update_values,this),this.listenTo(this.model,"labels_updated",function(){this.draw(!0)},this),this.listenTo(this.model,"change:selected",function(){this.selected_indices=this.model.get("selected"),this.apply_styles()},this),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.parent,"bg_clicked",function(){this.event_dispatcher("parent_clicked")})},process_interactions:function(){var t=this.model.get("interactions");a.isEmpty(t)?this.reset_interactions():(void 0!==t.click&&null!==t.click?"tooltip"===t.click?(this.event_listeners.element_clicked=function(){return this.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip):"select"===t.click&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.click_handler):this.reset_click(),void 0!==t.hover&&null!==t.hover?"tooltip"===t.hover&&(this.event_listeners.mouse_over=this.refresh_tooltip,this.event_listeners.mouse_move=this.move_tooltip,this.event_listeners.mouse_out=this.hide_tooltip):this.reset_hover(),void 0!==t.legend_click&&null!==t.legend_click?"tooltip"===t.legend_click&&(this.event_listeners.legend_clicked=function(){return this.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip):this.event_listeners.legend_clicked=function(){},void 0!==t.legend_hover&&null!==t.legend_hover?"highlight_axes"===t.legend_hover&&(this.event_listeners.legend_mouse_over=a.bind(this.highlight_axes,this),this.event_listeners.legend_mouse_out=a.bind(this.unhighlight_axes,this)):this.reset_legend_hover())},relayout:function(){this.set_ranges(),this.position_center(),this.update_radii()},position_center:function(t){var e=!0===t?this.parent.model.get("animation_duration"):0,n=this.scales.x?this.scales.x:this.parent.scale_x,i=this.scales.y?this.scales.y:this.parent.scale_y,r="date"===n.model.type?this.model.get_date_elem("x"):this.model.get("x"),s="date"===i.model.type?this.model.get_date_elem("y"):this.model.get("y"),a="translate("+(n.scale(r)+n.offset)+", "+(i.scale(s)+i.offset)+")";this.pie_g.transition("position_center").duration(e).attr("transform",a)},update_radii:function(t){var e=!0===t?this.parent.model.get("animation_duration"):0,n=this.model.get("radius"),i=this.model.get("inner_radius"),r=this.model.get("display_labels");"inside"===r?this.arc.outerRadius(n).innerRadius(i):"outside"===r&&(this.arc.outerRadius(.8*n).innerRadius(.8*i),this.outer_arc.innerRadius(.9*n).outerRadius(.9*n));var s=this.pie_g.select(".slices"),a=this.pie_g.select(".labels"),o=this.pie_g.select(".lines"),l=this;s.selectAll("path.slice").transition("update_radii").duration(e).attr("d",this.arc),"inside"===r?a.selectAll("text").transition("update_radii").duration(e).attr("transform",function(t){return"translate("+l.arc.centroid(t)+")"}):"outside"===r&&(a.selectAll("text").transition("update_radii").duration(e).attr("transform",function(t){var e=l.outer_arc.centroid(t);return e[0]=n*("left"===l.mid_angle_location(t)?-1:1),"translate("+e+")"}),o.selectAll("polyline").transition("update_radii").duration(e).attr("points",function(t){var e=l.outer_arc.centroid(t);return e[0]=.95*n*("left"===l.mid_angle_location(t)?-1:1),[l.arc.centroid(t),l.outer_arc.centroid(t),e]}))},mid_angle_location:function(t){var e=(t.startAngle+t.endAngle)/2;return e>Math.PI||e<0&&e>-Math.PI?"left":"right"},draw:function(t){this.set_ranges(),this.position_center(t);var e=i.layout.pie().startAngle(2*this.model.get("start_angle")*Math.PI/360).endAngle(2*this.model.get("end_angle")*Math.PI/360).value(function(t){return t.size});this.model.get("sort")||e.sort(null);var n=this,r=!0===t?this.parent.model.get("animation_duration"):0,s=this.pie_g.select(".slices").selectAll("path.slice").data(e(this.model.mark_data));s.enter().insert("path").attr("class","slice").style("fill",function(t){return n.get_colors(t.data.index)}).each(function(t){this._current=t}),s.transition("draw").duration(r).attrTween("d",function(t){var e=i.interpolate(this._current,t);return this._current=t,function(t){return n.arc(e(t))}}),s.exit().transition("draw").remove();var a=this.pie_g.select(".labels").selectAll("text").data(e(this.model.mark_data));a.enter().append("text").attr("dy",".35em").style("opacity",0).text(function(t){return t.data.label}).each(function(t){this._current=t});var o=a.transition("draw").duration(r).style("opacity",function(t){return 0===t.data.value?0:1}),l=this.model.get("display_labels");if("inside"===l?o.attr("transform",function(t){return"translate("+n.arc.centroid(t)+")"}).style("text-anchor","middle"):"outside"===l&&o.attrTween("transform",function(t){var e=i.interpolate(this._current,t),r=this;return function(i){var s=e(i);r._current=s;var a=n.outer_arc.centroid(s);return a[0]=n.model.get("radius")*("left"===n.mid_angle_location(t)?-1:1),"translate("+a+")"}}).styleTween("text-anchor",function(t){var e=i.interpolate(this._current,t);return function(t){var i=e(t);return"left"===n.mid_angle_location(i)?"end":"start"}}),a.exit().remove(),"outside"===l){var c=this.pie_g.select(".lines").selectAll("polyline").data(e(this.model.mark_data));c.enter().append("polyline").style("opacity",0).each(function(t){this._current=t}),c.transition("draw").duration(r).style("opacity",function(t){return 0===t.data.value?0:.5}).style("visibility",function(t){return""===t.data.label?"hidden":"visible"}).attrTween("points",function(t){this._current=this._current;var e=i.interpolate(this._current,t),r=this;return function(t){var i=e(t);r._current=i;var s=n.outer_arc.centroid(i);return s[0]=.95*n.model.get("radius")*("left"===n.mid_angle_location(i)?-1:1),[n.arc.centroid(i),n.outer_arc.centroid(i),s]}}),c.exit().remove()}s.on("click",function(t,e){return n.event_dispatcher("element_clicked",{data:t,index:e})}),this.update_labels(),this.update_values(),this.apply_styles()},update_stroke_and_opacities:function(){var t=this.model.get("stroke"),e=this.model.get("opacities");this.pie_g.selectAll("path.slice").style("stroke",t).style("opacity",function(t,n){return e[n]})},update_colors:function(){var t=this,e=this.scales.color;this.pie_g.select(".slices").selectAll("path.slice").style("fill",function(n,i){return void 0!==n.data.color&&void 0!==e?e.scale(n.data.color):t.get_colors(n.data.index)})},update_labels:function(){var t=this.model.get("display_labels"),e=this.pie_g.selectAll(".labels text").style("visibility","none"===t?"hidden":"visible").style("font-weight",this.model.get("font_weight")).style("font-size",this.model.get("font_size")),n=this.model.get("label_color");void 0!==n&&e.style("fill",n)},update_values:function(){var t=this.model.get("display_values"),e=i.format(this.model.get("values_format"));this.pie_g.selectAll(".labels text").text(function(n){return n.data.label+(t?": "+e(n.data.size):"")})},clear_style:function(t,e){var n=this.pie_g.selectAll("path.slice");e&&(n=n.filter(function(t,n){return-1!==e.indexOf(n)}));var i={};for(var r in t)i[r]=null;n.style(i)},set_style_on_elements:function(t,e){if(void 0!==e&&null!==e&&0!==e.length){var n=this.pie_g.selectAll(".slice");(n=n.filter(function(t,n){return-1!==e.indexOf(n)})).style(t)}},set_default_style:function(t){this.update_colors(),this.update_stroke_and_opacities()},click_handler:function(t){t.data;var e=t.index,n=this.model.get("selected"),r=n?s.deepCopy(n):[],o=r.indexOf(e),l=i.event.ctrlKey||i.event.metaKey;if(o>-1&&l)r.splice(o,1);else{if(i.event.shiftKey){if(o>-1)return;var c=0!==r.length?i.min(r):-1,h=0!==r.length?i.max(r):this.model.mark_data.length;e>h?a.range(h+1,e).forEach(function(t){r.push(t)}):e<c&&a.range(e+1,c).forEach(function(t){r.push(t)})}else l||(r=[]);r.push(e)}this.model.set("selected",0===r.length?null:r,{updated_view:this}),this.touch(),i.event||(i.event=window.event);var u=i.event;void 0!==u.cancelBubble&&(u.cancelBubble=!0),u.stopPropagation&&u.stopPropagation(),u.preventDefault(),this.selected_indices=r,this.apply_styles()},reset_selection:function(){this.model.set("selected",null),this.touch(),this.selected_indices=null,this.clear_style(this.selected_style),this.clear_style(this.unselected_style),this.set_default_style()},compute_view_padding:function(){var t=this.model.get("scales"),e=i.max([this.model.get("radius"),this.model.get("inner_radius")]),n=t.x?e+1:0,r=t.y?e+1:0;n===this.x_padding&&r===this.y_padding||(this.x_padding=n,this.y_padding=r,this.trigger("mark_padding_updated"))}});t.exports={Pie:o}},function(t,e,n){var i=n(0),r=n(1),s=n(5),a=s.MarkModel.extend({defaults:function(){return r.extend(s.MarkModel.prototype.defaults(),{_model_name:"PieModel",_view_name:"Pie",sizes:[],color:null,x:.5,y:.5,scales_metadata:{color:{dimension:"color"}},sort:!1,colors:i.scale.category10().range(),stroke:null,opacities:[],radius:180,inner_radius:.1,start_angle:0,end_angle:360})},initialize:function(){a.__super__.initialize.apply(this,arguments),this.on("change:sizes",this.update_data,this),this.on("change:color",function(){this.update_color(),this.trigger("colors_updated")},this),this.on("change:labels",this.update_labels,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data(),this.update_color(),this.update_labels(),this.update_domains()},update_data:function(){var t=this.get_typed_field("sizes"),e=this.get_typed_field("color"),n=this.get("labels");this.mark_data=t.map(function(t,i){return{size:t,color:e[i],label:null==n[i]?"":n[i],index:i}}),this.update_color(),this.update_domains(),this.trigger("data_updated")},update_labels:function(){if(this.mark_data){var t=this.get("labels");this.mark_data.forEach(function(e,n){e.label=null==t[n]?"":t[n]}),this.trigger("labels_updated")}},update_color:function(){if(this.mark_data){var t=this.get_typed_field("color"),e=this.get("scales").color;e&&(this.get("preserve_domain").color?e.del_domain([],this.model_id+"_color"):e.compute_and_set_domain(t,this.model_id+"_color"))}},update_domains:function(){if(this.mark_data){var t=this.get("scales"),e=t.x,n=t.y;if(e){var i="date"===e.type?this.get_date_elem("x"):this.get("x");this.get("preserve_domain").x?e.del_domain([],this.model_id+"_x"):e.compute_and_set_domain([i],this.model_id+"_x")}n&&(this.get("preserve_domain").y?n.del_domain([],this.model_id+"_y"):n.compute_and_set_domain([this.get("y")],this.model_id+"_y"))}},get_data_dict:function(t,e){return t.data}});t.exports={PieModel:a}},function(t,e,n){var i=n(0),r=n(23).ColorScale.extend({create_d3_scale:function(){this.scale=i.time.scale()}});t.exports={DateColorScale:r}},function(t,e,n){n(0);var i=n(1),r=n(24),s=r.ColorScaleModel.extend({defaults:function(){return i.extend(r.ColorScaleModel.prototype.defaults(),{_model_name:"DateColorScaleModel",_view_name:"DateColorScale"})},set_init_state:function(){this.type="date_color_linear",this.color_range=[],this.mid=null,this.global_min=(new Date).setTime(0),this.global_max=new Date},min_max_changed:function(){this.min=this.get_date_elem("min"),this.max=this.get_date_elem("max"),this.min_from_data=null===this.min,this.max_from_data=null===this.max,this.update_domain()}});t.exports={DateColorScaleModel:s}},function(t,e,n){var i=n(0),r=(n(1),n(15).LinearScale.extend({render:function(){this.scale=i.time.scale(),this.model.domain.length>0&&this.scale.domain(this.model.domain),this.offset=0,this.create_event_listeners()}}));t.exports={DateScale:r}},function(t,e,n){var i=n(20),r=n(16),s=n(0),a=r.symbol,o=i.ScatterBase.extend({render:function(){return this.dot=a().type(this.model.get("marker")).size(this.model.get("default_size")).skew(this.model.get("default_skew")),o.__super__.render.apply(this)},create_listeners:function(){o.__super__.create_listeners.apply(this),this.listenTo(this.model,"change:colors",this.update_colors,this),this.listenTo(this.model,"change:stroke",this.update_stroke,this),this.listenTo(this.model,"change:stroke_width",this.update_stroke_width,this),this.listenTo(this.model,"change:default_opacities",this.update_default_opacities,this),this.listenTo(this.model,"change:default_skew",this.update_default_skew,this),this.listenTo(this.model,"change:default_rotation",this.update_xy_position,this),this.listenTo(this.model,"change:marker",this.update_marker,this),this.listenTo(this.model,"change:default_size",this.update_default_size,this),this.listenTo(this.model,"change:fill",this.update_fill,this),this.listenTo(this.model,"change:display_names",this.update_names,this)},update_colors:function(t,e){if(!this.model.dirty){var n=this,i=this.model.get("stroke"),r=e.length;this.d3el.selectAll(".dot").style("fill",this.model.get("fill")?function(t,e){return n.get_element_color(t,e)}:"none").style("stroke",i||function(t,e){return n.get_element_color(t,e)}),this.legend_el&&(this.legend_el.select("path").style("fill",function(t,n){return e[n%r]}).style("stroke",i||function(t,n){return e[n%r]}),this.legend_el.select("text").style("fill",this.model.get("fill")?function(t,n){return e[n%r]}:"none"))}this.apply_styles()},update_fill:function(t,e){var n=this,i=this.model.get("colors"),r=i.length;this.d3el.selectAll(".dot").style("fill",e?function(t,e){return n.get_element_color(t,e)}:"none"),this.legend_el&&this.legend_el.selectAll("path").style("fill",e?function(t,e){return i[e%r]}:"none")},update_stroke_width:function(){var t=this.model.get("stroke_width");this.d3el.selectAll(".dot").style("stroke-width",t),this.legend_el&&this.legend_el.selectAll("path").style("stroke-width",t)},update_stroke:function(t,e){var n=this,i=this.model.get("stroke");this.d3el.selectAll(".dot").style("stroke",i||function(t,e){return n.get_element_color(t,e)}),this.legend_el&&this.legend_el.selectAll("path").style("stroke",i)},update_default_opacities:function(t){if(!this.model.dirty){var e=this.model.get("default_opacities"),n=this.model.get("colors"),i=n.length,r=e.length,s=!0===t?this.parent.model.get("animation_duration"):0,a=this;this.d3el.selectAll(".dot").transition("update_default_opacities").duration(s).style("opacity",function(t,e){return a.get_element_opacity(t,e)}),this.legend_el&&this.legend_el.select("path").style("opacity",function(t,n){return e[n%r]}).style("fill",function(t,e){return n[e%i]})}},update_marker:function(t,e){this.model.dirty||(this.d3el.selectAll(".dot").transition("update_marker").duration(this.parent.model.get("animation_duration")).attr("d",this.dot.type(e)),this.legend_el&&this.legend_el.select("path").attr("d",this.dot.type(e)))},update_default_skew:function(t){if(!this.model.dirty){var e=!0===t?this.parent.model.get("animation_duration"):0,n=this;this.d3el.selectAll(".dot").transition("update_default_skew").duration(e).attr("d",this.dot.skew(function(t){return n.get_element_skew(t)}))}},update_default_size:function(t){if(this.compute_view_padding(),!this.model.dirty){var e=!0===t?this.parent.model.get("animation_duration"):0,n=this;this.d3el.selectAll(".dot").transition("update_default_size").duration(e).attr("d",this.dot.size(function(t){return n.get_element_size(t)})),this.update_names(t)}},update_names:function(t){var e=this,n=this.model.get_typed_field("names"),i=this.model.get("display_names")&&0!==n.length,r=t?this.parent.model.get("animation_duration"):0;this.d3el.selectAll(".object_grp").select("text").text(function(t){return t.name}).transition("update_names").duration(r).attr("transform",function(t){var n=Math.sqrt(e.get_element_size(t))/2;return"translate("+n+","+-n+")"}).attr("display",function(t){return i?"inline":"none"})},color_scale_updated:function(t){var e=this,n=this.model.get("fill"),i=this.model.get("stroke"),r=!0===t?this.parent.model.get("animation_duration"):0;this.d3el.selectAll(".object_grp").select("path").transition("color_scale_updated").duration(r).style("fill",n?function(t,n){return e.get_element_color(t,n)}:"none").style("stroke",i||function(t,n){return e.get_element_color(t,n)})},draw_elements:function(t,e){var n=this,i=!0===t?this.parent.model.get("animation_duration"):0,r=this.d3el.selectAll(".object_grp");e.append("path").attr("class","dot element"),e.append("text").attr("class","dot_text"),r.select("path").transition("draw_elements").duration(i).attr("d",this.dot.size(function(t){return n.get_element_size(t)}).skew(function(t){return n.get_element_skew(t)})),this.update_names(t),this.apply_styles()},draw_legend_elements:function(t,e){var n=this.model.get("colors"),i=n.length,r=this.model.get("stroke");t.append("path").attr("transform",function(t,n){return"translate( "+e/2+", "+e/2+")"}).attr("d",this.dot.size(64)).style("fill",this.model.get("fill")?function(t,e){return n[e%i]}:"none").style("stroke",r||function(t,e){return n[e%i]})},set_default_style:function(t){if(t&&0!==t.length){var e=this.d3el.selectAll(".element").filter(function(e,n){return-1!==t.indexOf(n)}),n=this.model.get("fill"),i=this.model.get("stroke"),r=this.model.get("stroke_width"),s=this;e.style("fill",n?function(t,e){return s.get_element_color(t,e)}:"none").style("stroke",i||function(t,e){return s.get_element_color(t,e)}).style("opacity",function(t,e){return s.get_element_opacity(t,e)}).style("stroke-width",r)}},set_drag_style:function(t,e,n){s.select(n).select("path").classed("drag_scatter",!0).transition("set_drag_style").attr("d",this.dot.size(5*this.model.get("default_size")));var i=this.model.get("drag_color");i&&s.select(n).select("path").style("fill",i).style("stroke",i)},reset_drag_style:function(t,e,n){var i=this.model.get("stroke"),r=this.get_element_color(t,e);s.select(n).select("path").classed("drag_scatter",!1).transition("reset_drag_style").attr("d",this.dot.size(this.get_element_size(t))),this.model.get("drag_color")&&s.select(n).select("path").style("fill",r).style("stroke",i||r)}});t.exports={Scatter:o}},function(t,e,n){n(0);var i=n(1),r=n(12),s=r.LinearScaleModel.extend({defaults:function(){return i.extend(r.LinearScaleModel.prototype.defaults(),{_model_name:"DateScaleModel",_view_name:"DateScale"})},initialize:function(){s.__super__.initialize.apply(this,arguments)},set_init_state:function(){this.type="date",this.global_min=(new Date).setTime(0),this.global_max=new Date},min_max_changed:function(){this.min=this.get_date_elem("min"),this.max=this.get_date_elem("max"),this.min_from_data=null===this.min,this.max_from_data=null===this.max,this.update_domain()}});t.exports={DateScaleModel:s}},function(t,e,n){var i=n(0),r=n(1),s=n(5),a=s.MarkModel.extend({defaults:function(){return r.extend(s.MarkModel.prototype.defaults(),{_model_name:"LinesModel",_view_name:"Lines",x:[],y:[],color:null,scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"},color:{dimension:"color"}},colors:i.scale.category10().range(),fill_colors:i.scale.category10().range(),stroke_width:2,labels_visibility:"none",curves_subset:[],line_style:"solid",interpolation:"linear",close_path:!1,fill:"none",marker:null,marker_size:64,opacities:[],fill_opacities:[]})},initialize:function(){a.__super__.initialize.apply(this,arguments),this.on_some_change(["x","y","color"],this.update_data,this),this.on("change:labels",this.update_labels,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data(),this.update_domains()},update_data:function(){this.dirty=!0;var t=this;this.x_data=this.get_typed_field("x"),this.y_data=this.get_typed_field("y"),this.color_data=this.get_typed_field("color");var e=this.get("scales"),n=(e.x,e.y,this.get("labels"));if(0===this.x_data.length||0===this.y_data.length)this.mark_data=[];else{this.x_data=this.x_data[0]instanceof Array?this.x_data:[this.x_data],this.y_data=this.y_data[0]instanceof Array?this.y_data:[this.y_data],n=this.get_labels();var r=this.y_data.length;1==this.x_data.length&&r>1?this.mark_data=n.map(function(e,n){return{name:e,values:t.y_data[n].map(function(e,i){return{x:t.x_data[0][i],y:e,y0:t.y_data[Math.min(n+1,r-1)][i],sub_index:i}}),color:t.color_data[n],index:n}}):this.mark_data=n.map(function(e,n){return{name:e,values:i.zip(t.x_data[n],t.y_data[n]).map(function(e,i){return{x:e[0],y:e[1],y0:t.y_data[Math.min(n+1,r-1)][i],sub_index:i}}),color:t.color_data[n],index:n}})}this.update_domains(),this.dirty=!1,this.trigger("data_updated")},update_labels:function(){var t=this.get_labels();this.mark_data.forEach(function(e,n){e.name=t[n]}),this.trigger("labels_updated")},get_labels:function(){var t=this.get("labels"),e=1==this.x_data.length?this.y_data.length:Math.min(this.x_data.length,this.y_data.length);return t.length>e?t=t.slice(0,e):t.length<e&&r.range(t.length,e).forEach(function(e){t[e]="C"+(e+1)}),t},update_domains:function(){if(this.mark_data){var t=this.get("scales"),e=t.x,n=t.y,i=t.color;this.get("preserve_domain").x?e.del_domain([],this.model_id+"_x"):e.compute_and_set_domain(this.mark_data.map(function(t){return t.values.map(function(t){return t.x})}),this.model_id+"_x"),this.get("preserve_domain").y?n.del_domain([],this.model_id+"_y"):n.compute_and_set_domain(this.mark_data.map(function(t){return t.values.map(function(t){return t.y})}),this.model_id+"_y"),null!==i&&void 0!==i&&(this.get("preserve_domain").color?i.del_domain([],this.model_id+"_color"):i.compute_and_set_domain(this.mark_data.map(function(t){return t.color}),this.model_id+"_color"))}},get_data_dict:function(t,e){return t}}),o=a.extend({defaults:function(){return r.extend(a.prototype.defaults(),{_model_name:"FlexLineModel",_view_name:"FlexLine",x:[],y:[],color:null,scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"},color:{dimension:"color"}},colors:i.scale.category10().range(),fill_colors:i.scale.category10().range(),stroke_width:2,labels_visibility:"none",curves_subset:[],line_style:"solid",interpolation:"linear",close_path:!1,fill:"none",marker:null,marker_size:64,opacities:[],fill_opacities:[]})},update_data:function(){this.dirty=!0;var t=this;this.x_data=this.get_typed_field("x"),this.y_data=this.get_typed_field("y");var e=this.get("scales"),n=(e.x,e.y,this.get("labels"));if(0===this.x_data.length||0===this.y_data.length)this.mark_data=[],this.data_len=0;else{this.x_data=this.x_data[0]instanceof Array?this.x_data:[this.x_data],this.y_data=this.y_data[0]instanceof Array?this.y_data:[this.y_data],n=this.get_labels();var i=this.get_typed_field("color"),s=this.get_typed_field("width");this.data_len=Math.min(this.x_data[0].length,this.y_data[0].length),this.mark_data=[{name:n[0],values:r.range(this.data_len-1).map(function(e,n){return{x1:t.x_data[0][n],y1:t.y_data[0][n],x2:t.x_data[0][n+1],y2:t.y_data[0][n+1],color:i[n],size:s[n]}})}]}this.update_domains(),this.dirty=!1,this.trigger("data_updated")},update_domains:function(){if(this.mark_data){var t=this.get("scales"),e=t.x,n=t.y,i=t.color,r=t.width;this.get("preserve_domain").x?e.del_domain([],this.model_id+"_x"):e.compute_and_set_domain(this.x_data[0].slice(0,this.data_len),this.model_id+"_x"),this.get("preserve_domain").y?n.del_domain([],this.model_id+"_y"):n.compute_and_set_domain(this.y_data[0].slice(0,this.data_len),this.model_id+"_y"),null!==i&&void 0!==i&&(this.get("preserve_domain").color?i.del_domain([],this.model_id+"_color"):i.compute_and_set_domain(this.mark_data.map(function(t){return t.values.map(function(t){return t.color})}),this.model_id+"_color")),null!==r&&void 0!==r&&(this.get("preserve_domain").width?r.del_domain([],this.model_id+"_width"):r.compute_and_set_domain(this.mark_data.map(function(t){return t.values.map(function(t){return t.size})}),this.model_id+"_width"))}}});t.exports={LinesModel:a,FlexLineModel:o}},function(t,e,n){n(0);var i=n(1),r=n(21),s=r.ScatterBaseModel.extend({defaults:function(){return i.extend(r.ScatterBaseModel.prototype.defaults(),{_model_name:"ScatterModel",_view_name:"Scatter",skew:null,marker:"circle",stroke:null,stroke_width:1.5,default_skew:.5,default_size:64,names:[],display_names:!0,fill:!0,drag_color:null,drag_size:5,names_unique:!0})},initialize:function(){s.__super__.initialize.apply(this,arguments),this.on("change:skew",this.update_data,this),this.on_some_change(["names","names_unique"],function(){this.update_unique_ids(),this.trigger("data_updated")},this)},update_mark_data:function(){s.__super__.update_mark_data.apply(this);var t=this.get_typed_field("skew");this.mark_data.forEach(function(e,n){e.skew=t[n]})},update_unique_ids:function(){var t=this.get_typed_field("names"),e=0!==t.length;t=e?t:this.mark_data.map(function(t,e){return"Dot"+e});var n=[];n=this.get("names_unique")?t.slice(0):i.range(this.mark_data.length),this.mark_data.forEach(function(e,i){e.name=t[i],e.unique_id=n[i]})}});t.exports={ScatterModel:s}},function(t,e,n){var i=n(1),r=n(0),s=n(8),a=(n(4),n(14)),o=s.BaseXSelector.extend({render:function(){o.__super__.render.apply(this),this.freeze_but_move=!0,this.freeze_dont_move=!1,this.active=!1,this.dirty=!1,this.size=this.model.get("size"),this.width=this.parent.width-this.parent.margin.left-this.parent.margin.right,this.height=this.parent.height-this.parent.margin.top-this.parent.margin.bottom;var t=this,e=this.create_scales();Promise.all([this.mark_views_promise,e]).then(function(){t.background=t.d3el.append("rect").attr("x",0).attr("y",0).attr("width",t.width).attr("height",t.height).attr("class","selector selectormouse").attr("pointer-events","all").attr("visibility","hidden"),t.background.on("mousemove",i.bind(t.mousemove,t)).on("click",i.bind(t.click,t)).on("dblclick",i.bind(t.dblclick,t)),t.rect=t.d3el.append("rect").attr("class","selector intsel").attr("x",0).attr("y",0).attr("width",t.size).attr("height",t.height).attr("pointer-events","none").attr("display","none"),t.color_change(),t.selected_changed(),t.create_listeners()})},create_listeners:function(){o.__super__.create_listeners.apply(this),this.listenTo(this.model,"change:color",this.color_change,this)},color_change:function(){null!==this.model.get("color")&&this.rect.style("fill",this.model.get("color"))},click:function(){this.active=!0,this.rect.style("display","inline"),this.freeze_but_move=!!this.model.get("size")||!this.freeze_but_move},dblclick:function(){this.freeze_dont_move=!this.freeze_dont_move},mousemove:function(){if(!this.freeze_dont_move&&this.active){this.dirty=!0;var t,e=r.mouse(this.background.node()),n=this.size>0?this.size:parseInt(this.rect.attr("width")),i=(this.height-e[1])/this.height,s=this.freeze_but_move?n:Math.round(i*this.width);t=e[0]-s/2<0?0:e[0]+s/2>this.width?this.width-s:e[0]-s/2,this.rect.attr("x",t),this.rect.attr("width",s);var a=[t,t+s];this.model.set_typed_field("selected",this.scale.invert_range(a)),this.update_mark_selected(a),this.touch(),this.dirty=!1}},update_mark_selected:function(t,e){if(void 0!==t&&0!==t.length||i.each(this.mark_views,function(t){return t.selector_changed()}),void 0===e)var n=this.model.get("orientation"),r="vertical"==n?[]:t,s="vertical"==n?t:[];else r=t,s=e;var o=function(t){return a.point_in_rectangle(t,r,s)},l=function(t){return a.rect_inter_rect(t[0],t[1],r,s)};i.each(this.mark_views,function(t){t.selector_changed(o,l)},this)},scale_changed:function(){this.reset(),this.create_scale()},relayout:function(){o.__super__.relayout.apply(this),this.adjust_rectangle(),this.background.attr("width",this.width).attr("height",this.height),this.set_range([this.scale])},reset:function(){this.rect.attr("x",0).attr("width",0),this.model.set_typed_field("selected",[]),this.update_mark_selected(),this.touch()},update_scale_domain:function(t){o.__super__.update_scale_domain.apply(this),!0!==t&&this.selected_changed()},selected_changed:function(t,e){if(!this.dirty){var n=this.model.get_typed_field("selected");if(0===n.length)this.reset();else{if(2!=n.length)return;var i=n.map(this.scale.scale);i=i.sort(function(t,e){return t-e}),this.rect.attr({x:i[0],width:i[1]-i[0]}).style("display","inline"),this.active=!0,this.update_mark_selected(i)}}},adjust_rectangle:function(){"vertical"==this.model.get("orientation")?this.d3el.selectAll("rect").attr("x",0).attr("width",this.width):this.d3el.selectAll("rect").attr("y",0).attr("height",this.height)}});t.exports={FastIntervalSelector:o}},function(t,e,n){var i=n(0),r=n(15).LinearScale.extend({render:function(){this.scale=i.scale.log(),this.model.domain.length>0&&this.scale.domain(this.model.domain),this.offset=0,this.create_event_listeners()}});t.exports={LogScale:r}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){n(0);var i=n(1),r=n(12),s=r.LinearScaleModel.extend({defaults:function(){return i.extend(r.LinearScaleModel.prototype.defaults(),{_model_name:"LogScaleModel",_view_name:"LogScale",domain:[]})},initialize:function(){s.__super__.initialize.apply(this,arguments)},set_init_state:function(){this.type="log",this.global_min=Number.MIN_VALUE,this.global_max=Number.POSITIVE_INFINITY}});t.exports={LogScaleModel:s}},function(t,e,n){var i=n(2),r=(n(1),n(0)),s=i.DOMWidgetView.extend({render:function(){this.width=this.model.get("width"),this.height=this.model.get("height"),this.margin=this.model.get("margin"),this.el.style.width=this.width+this.margin.left+this.margin.right,this.el.style.height=this.height+this.margin.top+this.margin.bottom;var t=this.model.get("data");this.colors=this.model.get("colors"),this.mode=this.model.get("mode");var e=r.scale.category10();this.d3el.append("div").style("position","relative").style("width",this.width+this.margin.left+this.margin.right+"px").style("height",this.height+this.margin.top+this.margin.bottom+"px").style("left",this.margin.left+"px").style("top",this.margin.top+"px"),this.margin=this.model.get("margin"),this.tree_map=r.layout.treemap().size([this.width,this.height]).sticky(!0).padding(null).mode(this.mode).value(function(t){return t.size});this.d3el.datum(t).selectAll(".node").data(this.tree_map.nodes).enter().append("div").attr("class","node").call(this.position).style({background:function(t,n){return t.children?e(t.name):null},border:"solid white"}).text(function(t){return t.children?null:t.name}).style({font:"11px sans-serif",position:"absolute","text-align":"center",overflow:"hidden",color:"white"})},position:function(){this.style("left",function(t){return t.x+"px"}).style("top",function(t){return t.y+"px"}).style("width",function(t){return Math.max(0,t.dx-1)+"px"}).style("height",function(t){return Math.max(0,t.dy-1)+"px"})}});t.exports={SquareMarketMap:s}},function(t,e,n){var i=n(2),r=(n(0),n(1)),s=n(7),a="^"+n(6).version,o=s.BaseModel.extend({defaults:function(){return r.extend(s.BaseModel.prototype.defaults(),{_model_name:"FigureModel",_view_name:"Figure",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:a,_view_module_version:a,title:"",axes:[],marks:[],interaction:null,scale_x:void 0,scale_y:void 0,fig_color:null,title_style:{},background_style:{},legend_style:{},legend_text:{},preserve_aspect:!1,min_aspect_ratio:0,max_aspect_ratio:100,fig_margin:{top:60,bottom:60,left:60,right:60},padding_x:0,padding_y:.025,legend_location:"top-right",animation_duration:0})},initialize:function(){o.__super__.initialize.apply(this,arguments),this.on("msg:custom",this.handle_custom_messages,this)},handle_custom_messages:function(t){"save_png"===t.type?this.trigger("save_png",t.filename,t.scale):"save_svg"===t.type&&this.trigger("save_svg",t.filename)},save_png:function(){this.trigger("save_png")}},{serializers:r.extend({marks:{deserialize:i.unpack_models},axes:{deserialize:i.unpack_models},interaction:{deserialize:i.unpack_models},scale_x:{deserialize:i.unpack_models},scale_y:{deserialize:i.unpack_models},layout:{deserialize:i.unpack_models}},s.BaseModel.serializers)});t.exports={FigureModel:o}},function(t,e,n){var i=n(2),r=n(0),s=n(1),a=n(4),o=n(3),l=a.Mark.extend({render:function(){var t=l.__super__.render.apply(this);this.map=this.d3el.append("svg").attr("viewBox","0 0 1200 980"),this.width=this.parent.plotarea_width,this.height=this.parent.plotarea_height,this.map_id=i.uuid(),this.enable_hover=this.model.get("enable_hover"),this.display_el_classes=["event_layer"];var e=this;return this.displayed.then(function(){e.parent.tooltip_div.node().appendChild(e.tooltip_div.node()),e.create_tooltip()}),t.then(function(){e.event_listeners={},e.process_interactions(),e.create_listeners(),e.draw()})},set_ranges:function(){},set_positional_scales:function(){var t=this.scales.projection;this.listenTo(t,"domain_changed",function(){this.model.dirty||this.draw()})},initialize_additional_scales:function(){var t=this.scales.color;t&&(this.listenTo(t,"domain_changed",function(){this.update_style()}),t.on("color_scale_range_changed",this.update_style,this))},remove_map:function(){r.selectAll(".world_map.map"+this.map_id).remove()},draw:function(){this.set_ranges();var t=this;this.remove_map(),this.transformed_g=this.map.append("g").attr("class","world_map map"+this.map_id),this.fill_g=this.transformed_g.append("g"),this.highlight_g=this.transformed_g.append("g"),this.stroke_g=this.transformed_g.append("g");var e=this.scales.projection;this.fill_g.selectAll("path").data(t.model.geodata).enter().append("path").attr("d",e.path).style("fill",function(e,n){return t.fill_g_colorfill(e,n)}),this.stroke_g.selectAll("path").data(t.model.geodata).enter().append("path").attr("class","event_layer").attr("d",e.path).style("fill-opacity",0).on("click",function(e,n){return t.event_dispatcher("element_clicked",{data:e,index:n})}),this.validate_color(this.model.get("stroke_color"))&&this.stroke_g.selectAll("path").style("stroke",this.model.get("stroke_color")),this.zoom=r.behavior.zoom().scaleExtent([1,8]).on("zoom",function(){t.zoomed(t,!1)}),this.parent.bg.call(this.zoom),this.parent.bg.on("dblclick.zoom",null),this.parent.bg.on("dblclick",function(){t.zoomed(t,!0)})},validate_color:function(t){return""!==t},mouseover_handler:function(){if(this.model.get("hover_highlight")){var t=r.select(r.event.target);if(this.is_hover_element(t)){var e=t.data()[0],n=this.model.get("selected"),i=n?o.deepCopy(n):[],s=this.highlight_g.append(function(){return t.node().cloneNode(!0)});s.classed("hovered",!0),s.classed("event_layer",!1),this.validate_color(this.model.get("hovered_styles").hovered_stroke)&&-1===i.indexOf(e.id)&&s.style("stroke",this.model.get("hovered_styles").hovered_stroke).style("stroke-width",this.model.get("hovered_styles").hovered_stroke_width);var a=this;this.validate_color(this.model.get("hovered_styles").hovered_fill)&&-1===i.indexOf(e.id)&&s.style("fill-opacity",1).style("fill",function(){return a.model.get("hovered_styles").hovered_fill})}}},mouseout_handler:function(){if(this.model.get("hover_highlight")){var t=r.select(r.event.target);if(this.is_hover_element(t)){var e=this;t.transition("mouseout_handler").style("fill",function(t,n){return e.fill_g_colorfill(t,n)}).style("stroke",function(t,n){return e.hoverfill(t,n)}),e.highlight_g.selectAll(".hovered").remove()}}},click_handler:function(){var t=r.select(r.event.target);if(this.is_hover_element(t)){var e=t.data()[0],n=this.model.get("selected"),i=n?o.deepCopy(n):[],s=i.indexOf(e.id);if(s>-1){i.splice(s,1),t.transition("click_handler").style("fill-opacity",0),this.highlight_g.selectAll(".hovered").remove();var a="#c".concat(e.id.toString());r.select(a).remove()}else this.highlight_g.selectAll(".hovered").remove(),this.highlight_g.append(function(){return t.node().cloneNode(!0)}).attr("id","c"+e.id).classed("selected",!0).classed("event_layer",!1),this.validate_color(this.model.get("selected_styles").selected_fill)&&this.highlight_g.selectAll(".selected").style("fill-opacity",1).style("fill",this.model.get("selected_styles").selected_fill),this.validate_color(this.model.get("selected_styles").selected_stroke)&&this.highlight_g.selectAll(".selected").style("stroke",this.model.get("selected_styles").selected_stroke).style("stroke-width",this.model.get("selected_styles").selected_stroke_width),i.push(e.id),this.model.set("selected",i),this.touch();this.model.set("selected",0===i.length?null:i,{updated_view:this}),this.touch()}},zoomed:function(t,e){var n=e?[0,0]:r.event.translate,i=e?1:r.event.scale,s=t.height/3,a=e?t.width:2*t.width;n[0]=Math.min(t.width/2*(i-1),Math.max(a/2*(1-i),n[0])),n[1]=Math.min(t.height/2*(i-1)+this.height*i,Math.max(s/2*(1-i)-t.width*i,n[1])),t.zoom.translate(n),e&&t.zoom.scale(i),t.transformed_g.style("stroke-width",1/i).attr("transform","translate("+n+")scale("+i+")")},create_listeners:function(){var t=this;this.d3el.on("mouseover",s.bind(function(){this.event_dispatcher("mouse_over")},this)).on("mousemove",s.bind(function(){this.event_dispatcher("mouse_move")},this)).on("mouseout",s.bind(function(){this.event_dispatcher("mouse_out")},this)),this.listenTo(this.model,"data_updated",this.draw,this),this.listenTo(this.model,"change:color",this.update_style,this),this.listenTo(this.model,"change:stroke_color",this.change_stroke_color,this),this.listenTo(this.model,"change:colors",this.change_map_color,this),this.listenTo(this.model,"change:selected",this.change_selected,this),this.listenTo(this.model,"change:selected_styles",function(){t.change_selected_fill(),t.change_selected_stroke()}),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.parent,"bg_clicked",function(){this.event_dispatcher("parent_clicked")})},process_interactions:function(){var t=this.model.get("interactions");s.isEmpty(t)?this.reset_interactions():(void 0!==t.click&&null!==t.click?"tooltip"===t.click?(this.event_listeners.element_clicked=function(){return this.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip):"select"===t.click&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.click_handler):this.reset_click(),void 0!==t.hover&&null!==t.hover?"tooltip"===t.hover&&(this.event_listeners.mouse_over=function(){return this.mouseover_handler(),this.refresh_tooltip()},this.event_listeners.mouse_move=this.move_tooltip,this.event_listeners.mouse_out=function(){return this.mouseout_handler(),this.hide_tooltip()}):this.reset_hover(),void 0!==t.legend_click&&null!==t.legend_click?"tooltip"===t.legend_click&&(this.event_listeners.legend_clicked=function(){return this.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip):this.event_listeners.legend_clicked=function(){})},change_selected_fill:function(){this.validate_color(this.model.get("selected_styles").selected_fill)?this.highlight_g.selectAll(".selected").style("fill-opacity",1).style("fill",this.model.get("selected_styles").selected_fill):this.highlight_g.selectAll(".selected").style("fill-opacity",0)},change_selected_stroke:function(){this.validate_color(this.model.get("selected_styles").selected_stroke)?this.highlight_g.selectAll(".selected").style("stroke-width",this.model.get("selected_styles").selected_stroke_width).style("stroke",this.model.get("selected_styles").selected_stroke):this.highlight_g.selectAll(".selected").style("stroke-width",0)},change_selected:function(){this.highlight_g.selectAll("path").remove();var t=this,e=this.model.get("selected"),n=e||[],i=this.stroke_g.selectAll("path").data();this.stroke_g.selectAll("path").style("stroke",function(e,n){return t.hoverfill(e,n)});for(var r=this.stroke_g.selectAll("path"),s=0;s<i.length;s++)n.indexOf(i[s].id)>-1&&t.highlight_g.append(function(){return r[0][s].cloneNode(!0)}).attr("id",i[s].id).style("fill-opacity",function(){return t.validate_color(t.model.get("selected_styles").selected_fill)?1:0}).style("fill",t.model.get("selected_styles").selected_fill).style("stroke-opacity",function(){return t.validate_color(t.model.get("selected_styles").selected_stroke)?1:0}).style("stroke",t.model.get("selected_styles").selected_stroke).style("stroke-width",t.model.get("selected_styles").selected_stroke_width).classed("selected",!0)},reset_selection:function(){this.model.set("selected",[]),this.touch(),this.highlight_g.selectAll(".selected").remove(),r.select(this.d3el.parentNode).selectAll("path").classed("selected",!1),r.select(this.d3el.parentNode).selectAll("path").classed("hovered",!1);var t=this;this.stroke_g.selectAll("path").style("stroke",function(e,n){return t.hoverfill(e,n)}),this.fill_g.selectAll("path").classed("selected",!1).style("fill",function(e,n){return t.fill_g_colorfill(e,n)})},change_stroke_color:function(){this.stroke_g.selectAll("path").style("stroke",this.model.get("stroke_color"))},change_map_color:function(){var t=this;this.is_object_empty(this.model.get("color"))&&this.fill_g.selectAll("path").style("fill",function(e,n){return t.fill_g_colorfill(e,n)})},update_style:function(){var t=this.model.get("color"),e=this;this.is_object_empty(t)||this.fill_g.selectAll("path").style("fill",function(t,n){return e.fill_g_colorfill(t,n)})},is_object_empty:function(t){var e=!0;for(var n in t){e=!1;break}return e},hoverfill:function(t,e){var n=this.model.get("selected");return(n||[]).indexOf(t.id)>-1&&this.validate_color(this.model.get("selected_styles").selected_stroke)?this.model.get("selected_styles").selected_stroke:this.model.get("stroke_color")},fill_g_colorfill:function(t,e){var n=this.scales.color,i=this.model.get("selected"),r=i||[],s=this.model.get("color"),a=this.model.get("colors");return r.indexOf(t.id)>-1?this.model.get("selected_styles").selected_fill:this.is_object_empty(s)?a[t.id]||a.default_color:void 0===s[t.id]||null===s[t.id]||"nan"===s[t.id]||void 0===n?a.default_color:n.scale(s[t.id])}});t.exports={Map:l}},function(t,e,n){var i=n(2),r=n(0),s=n(3),a=n(1),o=i.DOMWidgetView.extend({initialize:function(){this.d3el=r.select(this.el),o.__super__.initialize.apply(this,arguments)},render:function(){this.parent=this.options.parent,this.update_formats(),this.create_listeners(),this.create_table()},create_listeners:function(){this.listenTo(this.parent,"update_tooltip",this.update_tooltip),this.model.on_some_change(["fields","show_labels","labels"],this.create_table,this),this.listenTo(this.model,"change:formats",this.update_formats)},update_formats:function(){var t=this.model.get("fields"),e=this.model.get("formats");this.tooltip_formats=t.map(function(t,n){var i=e[n];return void 0===i||""===i?function(t){return t}:s.is_valid_time_format(i)?r.time.format(i):r.format(i)})},update_tooltip:function(t){var e=this;this.d3el.select("table").selectAll("tr").select(".datavalue").text(function(n,i){return e.tooltip_formats[i](t[n])})},create_table:function(){for(var t=this.model.get("fields"),e=a.clone(this.model.get("labels")),n=e.length;n<t.length;n++)e[n]=t[n];this.d3el.select("table").remove();var i=this.d3el.append("table").selectAll("tr").data(t);i.exit().remove();var r=i.enter().append("tr").attr("class","datarow");this.model.get("show_labels")&&r.append("td").text(function(t,n){return e[n]}).attr("class","tooltiptext datafield"),r.append("td").attr("class","tooltiptext datavalue"),this.update_formats()}});t.exports={Tooltip:o}},function(t,e,n){var i=n(2),r=n(1),s="^"+n(6).version,a=i.DOMWidgetModel.extend({defaults:function(){return r.extend(i.DOMWidgetModel.prototype.defaults(),{_model_name:"TooltipModel",_view_name:"Tooltip",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:s,_view_module_version:s,fields:[],formats:[],show_labels:!0,labels:[]})}});t.exports={TooltipModel:a}},function(t,e,n){var i=n(0),r=n(1),s=n(25),a=s.Lines.extend({render:function(){var t=this;return s.Lines.__super__.render.apply(this).then(function(){t.scales.x,t.scales.y;t.create_listeners(),t.draw()})},set_ranges:function(){a.__super__.set_ranges.apply(this);var t=this.scales.width;t&&t.set_range([.5,this.model.get("stroke_width")])},create_listeners:function(){a.__super__.create_listeners.apply(this),this.listenTo(this.model,"change:colors",this.update_colors,this),this.listenTo(this.model,"change:labels_visibility",this.update_legend_labels,this),this.listenTo(this.model,"change:color change:width",this.update_and_draw,this)},draw_legend:function(t,e,n,s,a){var o=t.selectAll(".legend"+this.uuid).data(this.model.mark_data,function(t,e){return t.name}),l=this,c=.8*a;o.enter().append("g").attr("class","legend"+this.uuid).attr("transform",function(t,e){return"translate(0, "+(e*a+n)+")"}).on("mouseover",r.bind(this.make_axis_bold,this)).on("mouseout",r.bind(this.make_axis_non_bold,this)).append("line").style("stroke",function(t,e){return l.get_colors(e)}).attr({x1:0,x2:c,y1:c/2,y2:c/2}),o.append("text").attr("class","legendtext").attr("x",1.2*c).attr("y",c/2).attr("dy","0.35em").text(function(t,e){return l.model.get("labels")[e]}).style("fill",function(t,e){return l.get_colors(e)});var h=i.max(this.model.get("labels"),function(t){return t.length});return o.exit().remove(),[this.model.mark_data.length,h]},set_positional_scales:function(){var t=this.scales.x,e=this.scales.y;this.listenTo(t,"domain_changed",function(){this.model.dirty||this.draw()}),this.listenTo(e,"domain_changed",function(){this.model.dirty||this.draw()})},initialize_additional_scales:function(){var t=this.scales.color;t&&(this.listenTo(t,"domain_changed",function(){this.draw()}),t.on("color_scale_range_changed",this.draw,this))},draw:function(){this.set_ranges();var t=this.d3el.selectAll(".curve").data(this.model.mark_data,function(t,e){return t.name});t.enter().append("g").attr("class","curve"),t.exit().transition("draw").duration(this.parent.model.get("animation_duration")).remove();var e=this.scales.x,n=this.scales.y,r=this;t[0].forEach(function(t,s){var a=i.select(t).selectAll("line").data(r.model.mark_data[s].values);a.enter().append("line"),a.attr("class","line-elem").attr({x1:function(t){return e.scale(t.x1)},x2:function(t){return e.scale(t.x2)},y1:function(t){return n.scale(t.y1)},y2:function(t){return n.scale(t.y2)}}).attr("stroke",function(t){return r.get_element_color(t)}).attr("stroke-width",function(t){return r.get_element_width(t)})})},get_element_color:function(t){var e=this.scales.color;return void 0!==e&&void 0!==t.color?e.scale(t.color):this.model.get("colors")[0]},get_element_width:function(t){var e=this.scales.width;return void 0!==e&&void 0!==t.size?e.scale(t.size):this.model.get("stroke_width")},relayout:function(){s.Lines.__super__.relayout.apply(this),this.set_ranges();var t=this.scales.x,e=this.scales.y;this.d3el.selectAll(".curve").selectAll(".line-elem").transition("relayout").duration(this.parent.model.get("animation_duration")).attr({x1:function(e){return t.scale(e.x1)},x2:function(e){return t.scale(e.x2)},y1:function(t){return e.scale(t.y1)},y2:function(t){return e.scale(t.y2)}})},create_labels:function(){}});t.exports={FlexLine:a}},function(t,e,n){var i=n(1),r=n(5),s=n(78),a=r.MarkModel.extend({defaults:function(){return i.extend(r.MarkModel.prototype.defaults(),{_model_name:"MapModel",_view_name:"Map",color:{},hover_highlight:!0,hovered_styles:{hovered_fill:"Orange",hovered_stroke:null,hovered_stroke_width:2},stroke_color:null,default_color:null,scales_metadata:{color:{dimension:"color"},projection:{dimension:"geo"}},selected:[],selected_styles:{selected_fill:"Red",selected_stroke:null,selected_stroke_width:2},map_data:void 0})},initialize:function(){a.__super__.initialize.apply(this,arguments),this.on("change:map_data",this.update_data,this),this.on("change:color",this.color_data_updated,this),this.update_data(),this.update_domains()},update_data:function(){this.dirty=!0;var t=this.get("map_data");"Topology"==t.type?this.geodata=s.feature(t,t.objects.subunits).features:this.geodata=t.features,this.color_data_updated(),this.dirty=!1,this.trigger("data_updated")},update_properties:function(t){t.properties?t.properties.color=this.color_data[t.id]:t.properties={color:this.color_data[t.id]}},color_data_updated:function(){var t=this;this.update_domains(),this.geodata.map(function(e){return t.update_properties(e)})},update_domains:function(){var t=this,e=this.get("scales").color;this.color_data=this.get("color"),null!==e&&void 0!==e&&(this.get("preserve_domain").color?e.del_domain([],this.model_id+"_color"):e.compute_and_set_domain(Object.keys(this.color_data).map(function(e){return t.color_data[e]}),this.model_id+"_color"))},get_data_dict:function(t,e){return i.extend(t.properties,{id:t.id})}});t.exports={MapModel:a}},function(t,e,n){!function(t){"use strict";function e(){}function n(t){if(!t)return e;var n,i,r=t.scale[0],s=t.scale[1],a=t.translate[0],o=t.translate[1];return function(t,e){e||(n=i=0),t[0]=(n+=t[0])*r+a,t[1]=(i+=t[1])*s+o}}function i(t,e){for(var n=0,i=t.length;n<i;){var r=n+i>>>1;t[r]<e?n=r+1:i=r}return n}function r(t,e){var n={type:"Feature",id:e.id,properties:e.properties||{},geometry:s(t,e)};return null==e.id&&delete n.id,n}function s(t,e){var i=n(t.transform),r=t.arcs;function s(t,e){e.length&&e.pop();for(var n,s=r[t<0?~t:t],a=0,o=s.length;a<o;++a)e.push(n=s[a].slice()),i(n,a);t<0&&function(t,e){for(var n,i=t.length,r=i-e;r<--i;)n=t[r],t[r++]=t[i],t[i]=n}(e,o)}function a(t){return t=t.slice(),i(t,0),t}function o(t){for(var e=[],n=0,i=t.length;n<i;++n)s(t[n],e);return e.length<2&&e.push(e[0].slice()),e}function l(t){for(var e=o(t);e.length<4;)e.push(e[0].slice());return e}function c(t){return t.map(l)}var h={Point:function(t){return a(t.coordinates)},MultiPoint:function(t){return t.coordinates.map(a)},LineString:function(t){return o(t.arcs)},MultiLineString:function(t){return t.arcs.map(o)},Polygon:function(t){return c(t.arcs)},MultiPolygon:function(t){return t.arcs.map(c)}};return function t(e){var n=e.type;return"GeometryCollection"===n?{type:n,geometries:e.geometries.map(t)}:n in h?{type:n,coordinates:h[n](e)}:null}(e)}function a(t,e){var n={},i={},r={},s=[],a=-1;function o(t,e){for(var i in t){var r=t[i];delete e[r.start],delete r.start,delete r.end,r.forEach(function(t){n[t<0?~t:t]=1}),s.push(r)}}return e.forEach(function(n,i){var r,s=t.arcs[n<0?~n:n];s.length<3&&!s[1][0]&&!s[1][1]&&(r=e[++a],e[a]=n,e[i]=r)}),e.forEach(function(e){var n,s,a=function(e){var n,i=t.arcs[e<0?~e:e],r=i[0];return t.transform?(n=[0,0],i.forEach(function(t){n[0]+=t[0],n[1]+=t[1]})):n=i[i.length-1],e<0?[n,r]:[r,n]}(e),o=a[0],l=a[1];if(n=r[o])if(delete r[n.end],n.push(e),n.end=l,s=i[l]){delete i[s.start];var c=s===n?n:n.concat(s);i[c.start=n.start]=r[c.end=s.end]=c}else i[n.start]=r[n.end]=n;else if(n=i[l])if(delete i[n.start],n.unshift(e),n.start=o,s=r[o]){delete r[s.end];var h=s===n?n:s.concat(n);i[h.start=s.start]=r[h.end=n.end]=h}else i[n.start]=r[n.end]=n;else i[(n=[e]).start=o]=r[n.end=l]=n}),o(r,i),o(i,r),e.forEach(function(t){n[t<0?~t:t]||s.push([t])}),s}function o(t,e,n){var i=[];function r(t){var e=t<0?~t:t;(c[e]||(c[e]=[])).push({i:t,g:l})}function s(t){t.forEach(r)}function o(t){t.forEach(s)}if(arguments.length>1){var l,c=[],h={LineString:s,MultiLineString:o,Polygon:o,MultiPolygon:function(t){t.forEach(o)}};!function t(e){"GeometryCollection"===e.type?e.geometries.forEach(t):e.type in h&&(l=e,h[e.type](e.arcs))}(e),c.forEach(arguments.length<3?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)})}else for(var u=0,d=t.arcs.length;u<d;++u)i.push(u);return{type:"MultiLineString",arcs:a(t,i)}}function l(t){var e=t[0],n=t[1],i=t[2];return Math.abs((e[0]-i[0])*(n[1]-e[1])-(e[0]-n[0])*(i[1]-e[1]))}function c(t,e){var n={},i=[],r=[];function o(t){t.forEach(function(e){e.forEach(function(e){(n[e=e<0?~e:e]||(n[e]=[])).push(t)})}),i.push(t)}function l(e){return Math.abs(function(t){for(var e,n=-1,i=t.length,r=t[i-1],s=0;++n<i;)e=r,r=t[n],s+=e[0]*r[1]-e[1]*r[0];return s/2}(s(t,{type:"Polygon",arcs:[e]}).coordinates[0]))}return e.forEach(function(t){"Polygon"===t.type?o(t.arcs):"MultiPolygon"===t.type&&t.arcs.forEach(o)}),i.forEach(function(t){if(!t._){var e=[],i=[t];for(t._=1,r.push(e);t=i.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){n[t<0?~t:t].forEach(function(t){t._||(t._=1,i.push(t))})})})}}),i.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:r.map(function(e){var i,r=[];if(e.forEach(function(t){t.forEach(function(t){t.forEach(function(t){n[t<0?~t:t].length<2&&r.push(t)})})}),r=a(t,r),(i=r.length)>1)for(var s,o,c=1,h=l(r[0]);c<i;++c)(s=l(r[c]))>h&&(o=r[0],r[0]=r[c],r[c]=o,h=s);return r})}}function h(t,e){return t[1][2]-e[1][2]}t.version="1.6.27",t.mesh=function(t){return s(t,o.apply(this,arguments))},t.meshArcs=o,t.merge=function(t){return s(t,c.apply(this,arguments))},t.mergeArcs=c,t.feature=function(t,e){return"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map(function(e){return r(t,e)})}:r(t,e)},t.neighbors=function(t){var e={},n=t.map(function(){return[]});function r(t,n){t.forEach(function(t){t<0&&(t=~t);var i=e[t];i?i.push(n):e[t]=[n]})}function s(t,e){t.forEach(function(t){r(t,e)})}var a={LineString:r,MultiLineString:s,Polygon:s,MultiPolygon:function(t,e){t.forEach(function(t){s(t,e)})}};for(var o in t.forEach(function t(e,n){"GeometryCollection"===e.type?e.geometries.forEach(function(e){t(e,n)}):e.type in a&&a[e.type](e.arcs,n)}),e)for(var l=e[o],c=l.length,h=0;h<c;++h)for(var u=h+1;u<c;++u){var d,_=l[h],f=l[u];(d=n[_])[o=i(d,f)]!==f&&d.splice(o,0,f),(d=n[f])[o=i(d,_)]!==_&&d.splice(o,0,_)}return n},t.presimplify=function(t,i){var r=n(t.transform),s=function(t){if(!t)return e;var n,i,r=t.scale[0],s=t.scale[1],a=t.translate[0],o=t.translate[1];return function(t,e){e||(n=i=0);var l=Math.round((t[0]-a)/r),c=Math.round((t[1]-o)/s);t[0]=l-n,t[1]=c-i,n=l,i=c}}(t.transform),a=function(){var t={},e=[],n=0;function i(t,n){for(;n>0;){var i=(n+1>>1)-1,r=e[i];if(h(t,r)>=0)break;e[r._=n]=r,e[t._=n=i]=t}}function r(t,i){for(;;){var r=i+1<<1,s=r-1,a=i,o=e[a];if(s<n&&h(e[s],o)<0&&(o=e[a=s]),r<n&&h(e[r],o)<0&&(o=e[a=r]),a===i)break;e[o._=i]=o,e[t._=i=a]=t}}return t.push=function(t){return i(e[t._=n]=t,n++),n},t.pop=function(){if(!(n<=0)){var t,i=e[0];return--n>0&&(t=e[n],r(e[t._=0]=t,0)),i}},t.remove=function(t){var s,a=t._;if(e[a]===t)return a!==--n&&(h(s=e[n],t)<0?i:r)(e[s._=a]=s,a),a},t}();function o(t){a.remove(t),t[1][2]=i(t),a.push(t)}return i||(i=l),t.arcs.forEach(function(t){var e,n,l,c,h=[],u=0;for(n=0,l=t.length;n<l;++n)c=t[n],r(t[n]=[c[0],c[1],1/0],n);for(n=1,l=t.length-1;n<l;++n)(e=t.slice(n-1,n+2))[1][2]=i(e),h.push(e),a.push(e);for(n=0,l=h.length;n<l;++n)(e=h[n]).previous=h[n-1],e.next=h[n+1];for(;e=a.pop();){var d=e.previous,_=e.next;e[1][2]<u?e[1][2]=u:u=e[1][2],d&&(d.next=_,d[2]=e[2],o(d)),_&&(_.previous=d,_[0]=e[0],o(_))}t.forEach(s)}),t},Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){var i=n(0),r=n(2).WidgetView.extend({render:function(){this.set_projection(),this.listenTo(this.model,"attribute_changed",this.reset_scale)},set_projection:function(){this.path=i.geo.path().projection(this.model.projection),this.scale=this.model.projection},reset_scale:function(){this.set_projection(),this.trigger("domain_changed",null)}}),s=r.extend({}),a=r.extend({}),o=r.extend({}),l=r.extend({}),c=r.extend({}),h=r.extend({}),u=r.extend({});t.exports={GeoScale:r,Mercator:s,Albers:a,AlbersUSA:o,EquiRectangular:l,Orthographic:c,Gnomonic:h,Stereographic:u}},function(t,e,n){var i=n(0),r=n(1),s=n(11),a=s.ScaleModel.extend({defaults:function(){return r.extend(s.ScaleModel.prototype.defaults(),{_model_name:"GeoScaleModel",_view_name:"GeoScale"})}}),o=a.extend({defaults:function(){return r.extend(a.prototype.defaults(),{_model_name:"MercatorModel",_view_name:"Mercator",scale_factor:190,center:[0,60],rotate:[0,0]})},initialize:function(){o.__super__.initialize.apply(this,arguments),this.on_some_change(["scale_factor","center","rotate"],this.create_projection,this),this.create_projection()},create_projection:function(){this.projection=i.geo.mercator().center(this.get("center")).scale(this.get("scale_factor")).rotate(this.get("rotate")),this.attribute_changed()},attribute_changed:function(){this.trigger("attribute_changed")}}),l=a.extend({defaults:function(){return r.extend(a.prototype.defaults(),{_model_name:"AlbersModel",_view_name:"Albers",scale_factor:250,center:[0,60],parallels:[29.5,45.5],precision:.1})},initialize:function(){l.__super__.initialize.apply(this,arguments),this.on_some_change(["rotate","center","parallels","scale_factor","precision"],this.create_projection,this),this.create_projection()},create_projection:function(){this.projection=i.geo.albers().rotate(this.get("rotate")).center(this.get("center")).parallels(this.get("parallels")).scale(this.get("scale_factor")).precision(this.get("precision")),this.attribute_changed()},attribute_changed:function(){this.trigger("attribute_changed")}}),c=a.extend({defaults:function(){return r.extend(a.prototype.defaults(),{_model_name:"AlbersUSAModel",_view_name:"AlbersUSA",scale_factor:1200,translate:[600,490]})},initialize:function(){c.__super__.initialize.apply(this,arguments),this.on_some_change(["scale_factor","translate"],this.create_projection,this),this.create_projection()},create_projection:function(){this.projection=i.geo.albersUsa().scale(this.get("scale_factor")).translate(this.get("translate")),this.attribute_changed()},attribute_changed:function(){this.trigger("attribute_changed")}}),h=a.extend({defaults:function(){return r.extend(a.prototype.defaults(),{_model_name:"EquiRectangularModel",_view_name:"EquiRectangular",scale_factor:145})},initialize:function(){h.__super__.initialize.apply(this,arguments),this.on_some_change(["scale_factor","center"],this.create_projection,this),this.create_projection()},create_projection:function(){this.projection=i.geo.equirectangular().center(this.get("center")).scale(this.get("scale_factor")),this.attribute_changed()},attribute_changed:function(){this.trigger("attribute_changed")}}),u=a.extend({defaults:function(){return r.extend(a.prototype.defaults(),{_model_name:"OrthographicModel",_view_name:"Orthographic",scale_factor:145,center:[0,60],rotate:[0,0],clip_angle:90,precision:.1})},initialize:function(){u.__super__.initialize.apply(this,arguments),this.on_some_change(["scale_factor","center","clip_angle","rotate","precision"],this.create_projection,this),this.create_projection()},create_projection:function(){this.projection=i.geo.orthographic().center(this.get("center")).scale(this.get("scale_factor")).clipAngle(this.get("clip_angle")).rotate(this.get("rotate")).precision(this.get("precision")),this.attribute_changed()},attribute_changed:function(){this.trigger("attribute_changed")}}),d=a.extend({defaults:function(){return r.extend(a.prototype.defaults(),{_model_name:"GnomonicModel",_view_name:"Gnomonic",scale_factor:145,center:[0,60],precision:.1,clip_angle:89.999})},initialize:function(){d.__super__.initialize.apply(this,arguments),this.on_some_change(["scale_factor","precision","clip_angle"],this.create_projection,this),this.create_projection()},create_projection:function(){this.projection=i.geo.gnomonic().clipAngle(this.get("clip_angle")).scale(this.get("scale_factor")).precision(this.get("precision")),this.attribute_changed()},attribute_changed:function(){this.trigger("attribute_changed")}}),_=a.extend({defaults:function(){return r.extend(a.prototype.defaults(),{_model_name:"StereographicModel",_view_name:"StereographicModel",scale_factor:245,center:[0,60],precision:.1,rotate:[96,0],clip_angle:179.9999})},initialize:function(){_.__super__.initialize.apply(this,arguments),this.on_some_change(["scale_factor","center","clip_angle","rotate","precision"],this.create_projection,this),this.create_projection()},create_projection:function(){this.projection=i.geo.stereographic().scale(this.get("scale_factor")).rotate(this.get("rotate")).clipAngle(this.get("clip_angle")).center(this.get("center")).precision(this.get("precision")),this.attribute_changed()},attribute_changed:function(){this.trigger("attribute_changed")}});t.exports={GeoScaleModel:a,MercatorModel:o,AlbersModel:l,AlbersUSAModel:c,EquiRectangularModel:h,OrthographicModel:u,GnomonicModel:d,StereographicModel:_}},function(t,e,n){var i=n(2),r=n(1),s=n(0),a=n(26),o=n(27),l=n(28);l.__esModule&&(l=l.default);var c=a.Figure.extend({render:function(t){this.id=i.uuid();var e=String(this.model.get("layout").get("min_width")),n=String(this.model.get("layout").get("min_height")),r=this._get_height_width(n.slice(0,-2),e.slice(0,-2));this.width=r.width,this.height=r.height,this.scales={},this.set_top_el_style();var a=this;this.margin=this.model.get("map_margin"),this.num_rows=this.model.get("rows"),this.num_cols=this.model.get("cols"),this.row_groups=this.model.get("row_groups"),this.enable_select=this.model.get("enable_select"),this.update_data(),this.set_area_dimensions(this.data.length),this.model.get("theme")&&this.svg.classed(this.model.get("theme"),!0),this.fig=this.svg.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.fig_map=this.fig.append("g"),this.fig_axes=this.fig.append("g"),this.fig_click=this.fig.append("g"),this.fig_hover=this.fig.append("g"),this.fig_names=this.fig.append("g").style("display",this.model.get("show_groups")?"inline":"none"),this.fig_map.classed("g-map",!0),this.fig_axes.classed("g-axes",!0),this.fig_click.classed("g-click",!0),this.fig_hover.classed("g-hover",!0),this.fig_names.classed("g-names",!0),this.axis=[],this.tooltip_div=s.select(document.createElement("div")).attr("class","mark_tooltip").style("opacity",0).style("pointer-events","none");var c=this.model.get("freeze_tooltip_location");this.popper_reference=c?new o.ElementReference(this.svg.node()):new o.PositionReference({x:0,y:0,width:20,height:20}),this.popper=new l(this.popper_reference,this.tooltip_div.node(),{placement:"auto"}),this.update_default_tooltip(),this.selected_stroke=this.model.get("selected_stroke"),this.hovered_stroke=this.model.get("hovered_stroke"),this.update_plotarea_dimensions(),this.title=this.fig.append("text").attr("class","mainheading").attr({x:.5*this.plotarea_width,y:-this.margin.top/2,dy:"1em"}).text(this.model.get("title")).style(this.model.get("title_style")),this.create_scale_views().then(function(){a.create_listeners(),a.axis_views=new i.ViewList(a.add_axis,null,a),a.axis_views.update(a.model.get("axes")),a.model.on("change:axes",function(t,e,n){a.axis_views.update(e)})}),this.displayed.then(function(){document.body.appendChild(a.tooltip_div.node()),a.relayout(),a.draw_group_names(),a.create_tooltip_widget()})},set_top_el_style:function(){this.el.style["user-select"]="none",this.el.style["ms-user-select"]="none",this.el.style["moz-user-select"]="none",this.el.style["khtml-user-select"]="none",this.el.style["webkit-user-select"]="none"},update_plotarea_dimensions:function(){this.plotarea_width=this.width-this.margin.left-this.margin.right,this.plotarea_height=this.height-this.margin.top-this.margin.bottom,this.column_width=parseFloat((this.plotarea_width/this.num_cols).toFixed(2)),this.row_height=parseFloat((this.plotarea_height/this.num_rows).toFixed(2))},reset_drawing_controls:function(){this.prev_x=0,this.prev_y=-1,this.y_direction=1,this.x_direction=1,this.group_iter=1},create_listeners:function(){this.listenTo(this.model,"change:scales",this.create_scale_views,this),this.listenTo(this.model,"change:color",this.recolor_chart,this),this.listenTo(this.model,"change:colors",this.colors_updated,this),this.listenTo(this.model,"change:show_groups",this.show_groups,this),this.listenTo(this.model,"change:selected_stroke",this.update_selected_stroke,this),this.listenTo(this.model,"change:hovered_stroke",this.update_hovered_stroke,this),this.listenTo(this.model,"change:font_style",this.update_font_style,this),this.model.on_some_change(["title","title_style"],this.update_title,this),this.listenTo(this.model,"change:selected",function(){this.clear_selected(),this.apply_selected()},this),this.model.on_some_change(["names","groups","ref_data"],function(){this.update_data(),this.compute_dimensions_and_draw()},this),this.listenTo(this.model,"change:rows",function(t,e){this.num_rows=e,this.compute_dimensions_and_draw()},this),this.listenTo(this.model,"change:cols",function(t,e){this.num_cols=e,this.compute_dimensions_and_draw()},this),this.listenTo(this.model,"change:row_groups",function(t,e){this.row_groups=e,this.compute_dimensions_and_draw()},this),this.listenTo(this.model,"change:tooltip_widget",this.create_tooltip_widget,this),this.listenTo(this.model,"change:tooltip_fields",this.update_default_tooltip,this),this.listenTo(this.model,"change:tooltip_formats",this.update_default_tooltip,this)},update_title:function(t,e){this.title.text(this.model.get("title")).style(this.model.get("title_style"))},relayout:function(){var t=this,e=this._get_height_width(this.el.clientHeight,this.el.clientWidth);this.width=e.width,this.height=e.height,window.requestAnimationFrame(function(){t.margin=t.model.get("map_margin"),t.update_plotarea_dimensions(),t.fig.attr("transform","translate("+t.margin.left+","+t.margin.top+")"),t.title.attr({x:.5*t.plotarea_width,y:-t.margin.top/2,dy:"1em"}),t.draw_map(),t.clear_selected(),t.apply_selected(),t.fig_hover.selectAll("rect").remove(),t.hide_tooltip(),t.trigger("margin_updated")})},update_data:function(){var t=this;this.data=this.model.get_typed_field("names"),this.ref_data=this.model.get("ref_data"),this.group_data=this.model.get_typed_field("groups"),this.groups=r.uniq(this.group_data,!0);var e=this.model.get_typed_field("display_text");e=void 0===e||0===e.length?this.data:e,this.colors=this.model.get("colors");var n=this.colors.length;this.colors_map=function(e){return t.get_color(e,n)};var i=this.model.get_typed_field("color"),s=this.data.map(function(n,r){return{display:e[r],name:n,color:i[r],group:t.group_data[r],ref_data:null===t.ref_data||void 0===t.ref_data?null:t.ref_data[r]}});this.update_domains(),this.grouped_data=r.groupBy(s,function(e,n){return t.group_data[n]}),this.groups=[],this.running_sums=[],this.running_sums[0]=0;var a=0;for(var o in this.grouped_data)this.groups.push(o),a+=this.grouped_data[o].length,this.running_sums.push(a);this.running_sums.pop()},update_domains:function(){var t=this.model.get("scales").color,e=this.model.get_typed_field("color");t&&e.length>0&&t.compute_and_set_domain(e,this.model.model_id)},set_area_dimensions:function(t){this.num_rows=this.model.get("rows"),this.num_cols=this.model.get("cols"),this.row_groups=this.model.get("row_groups"),void 0!==this.num_cols&&null!==this.num_cols&&0!==this.num_cols?(this.row_groups>1&&this.num_cols%2==0&&this.num_cols++,this.num_rows=Math.floor(t/this.num_cols),this.num_rows=t%this.num_cols==0?this.num_rows:this.num_rows+1):void 0!==this.num_rows&&null!==this.num_rows&&0!==this.num_rows?(this.num_cols=Math.floor(t/this.num_rows),this.num_cols=t%this.num_rows==0?this.num_cols:this.num_cols+1,this.row_groups>1&&this.num_cols%2==0&&this.num_cols++):(this.num_cols=Math.floor(Math.sqrt(t)),this.row_groups>1&&this.num_cols%2==0&&this.num_cols++,this.num_rows=Math.floor(t/this.num_cols),this.num_rows=t%this.num_cols==0?this.num_rows:this.num_rows+1),this.row_groups=Math.min(this.row_groups,this.num_rows),1==this.row_groups&&(this.num_cols=Math.floor(t/this.num_rows),this.num_cols=t%this.num_rows==0?this.num_cols:this.num_cols+1),this.set_row_limits()},compute_dimensions_and_draw:function(){this.set_area_dimensions(this.data.length),this.update_plotarea_dimensions(),this.draw_map(),this.clear_selected(),this.apply_selected(),this.fig_hover.selectAll("rect").remove(),this.hide_tooltip()},update_default_tooltip:function(){this.tooltip_fields=this.model.get("tooltip_fields");var t=this.model.get("tooltip_formats");this.tooltip_formats=this.tooltip_fields.map(function(e,n){var i=t[n];return void 0===i||""===i?function(t){return t}:s.format(i)})},create_scale_views:function(){for(var t in this.scales)this.stopListening(this.scales[t]);var e=this.model.get("scales"),n=this,s={};return r.each(e,function(t,e){s[e]=n.create_child_view(t)}),i.resolvePromisesDict(s).then(function(t){n.scales=t,n.set_scales()})},set_scales:function(){var t=this,e=this.scales.color;e&&(e.set_range(),e.on("color_scale_range_changed",t.update_map_colors,t),this.update_domains(),this.listenTo(e,"domain_changed",function(){t.update_map_colors()}),this.update_map_colors())},show_groups:function(t,e){this.fig_names.style("display",e?"inline":"none"),this.fig_map.selectAll(".market_map_text").style("opacity",e?.2:1),this.fig_map.selectAll(".market_map_rect").style("stroke-opacity",e?.2:1)},draw_map:function(){this.reset_drawing_controls(),this.fig_map.selectAll(".element_group").remove(),this.fig_names.selectAll(".names_object").remove(),this.rect_groups=this.fig_map.selectAll(".element_group").data(this.groups);var t=this.scales.color,e=this;this.rect_groups.enter().append("g").attr("class","element_group").attr("transform",function(t,n){return e.get_group_transform(n)}),this.rect_groups.exit().remove(),this.end_points=[],this.rect_groups[0].forEach(function(n,i){var r=e.grouped_data[e.groups[i]],a=(e.colors_map(i),e.get_new_cords()),o=e.get_end_points(a[2],r.length,a[0],a[1],a[3],a[4]);o.forEach(function(t){e.end_points.push(t)});var l=e.running_sums[i],c=s.select(n).selectAll(".rect_element").data(r),h=c.enter().append("g").classed("rect_element",!0);h.append("rect").attr("x",0).attr("y",0).classed("market_map_rect",!0),h.append("text").classed("market_map_text",!0).style({"text-anchor":"middle",fill:"black","pointer-events":"none","dominant-baseline":"central"}).style(e.model.get("font_style")),c.attr("transform",function(t,n){return e.get_cell_transform(n)}).on("click",function(t,n){e.cell_click_handler(t,l+n,this)}).on("mouseover",function(t,n){e.mouseover_handler(t,l+n,this)}).on("mousemove",function(t){e.mousemove_handler(t)}).on("mouseout",function(t,n){e.mouseout_handler(t,l+n,this)}).attr("class",function(t,e){return s.select(this).attr("class")+" rect_"+(l+e)}),c.selectAll(".market_map_rect").attr("width",e.column_width).attr("height",e.row_height).style("stroke-opacity",e.model.get("show_groups")?.2:1).style({stroke:e.model.get("stroke"),fill:function(n,r){return t&&void 0!==n.color&&null!==n.color?t.scale(n.color):e.colors_map(i)}}),c.selectAll(".market_map_text").attr("x",e.column_width/2).attr("y",e.row_height/2).text(function(t,e){return t.display}).style("opacity",e.model.get("show_groups")?.2:1),c.exit().remove();e.create_bounding_path(n,o);var u=s.min(o,function(t){return t.x}),d=s.min(o,function(t){return t.y});e.fig_names.append("foreignObject").attr("class","names_object").attr("x",u).attr("y",d).append("xhtml:div").attr("class","names_div").style({display:"flex","flex-direction":"row","align-content":"center","align-items":"center",width:"100%",height:"100%","justify-content":"center","word-wrap":"break-word",font:"24px sans-serif",color:"black"}).text(e.groups[i])}),this.draw_group_names()},draw_group_names:function(){var t=this.svg.selectAll(".bounding_path")[0].map(function(t){return t.getBoundingClientRect()});this.fig_names.selectAll(".names_object").data(t).attr("width",function(t){return t.width}).attr("height",function(t){return t.height})},recolor_chart:function(){var t=this;this.update_data(),this.rect_groups=this.fig.selectAll(".element_group").data(this.groups);var e=this.scales.color;this.rect_groups[0].forEach(function(n,i){var r=t.grouped_data[t.groups[i]];t.colors_map(i),s.select(n).selectAll(".rect_element").data(r).select("rect").style({stroke:t.model.get("stroke"),fill:function(n,r){return e&&void 0!==n.color&&null!==n.color?e.scale(n.color):t.colors_map(i)}})})},update_font_style:function(t,e){this.svg.selectAll(".market_map_text").style(e)},update_map_colors:function(){var t=this,e=this.scales.color;void 0!==this.rect_groups&&null!==this.rect_groups&&this.rect_groups[0].forEach(function(n,i){var r=t.grouped_data[t.groups[i]];t.colors_map(i),s.select(n).selectAll(".rect_element").data(r).select("rect").style({stroke:t.model.get("stroke"),fill:function(n,r){return e&&void 0!==n.color&&null!==n.color?e.scale(n.color):t.colors_map(i)}})})},cell_click_handler:function(t,e,n){if(this.model.get("enable_select")){var i=this.model.get("selected").slice(),r=i.indexOf(t.name);-1==r?i.push(t.name):i.splice(r,1),this.model.set("selected",i),this.touch()}},apply_selected:function(){var t=this.model.get("selected"),e=this;void 0===t||null===t||0===t.length?this.clear_selected():t.forEach(function(t){var n=e.fig_map.selectAll(".rect_element").filter(function(e,n){return e.name===t});e.fig_click.append("rect").data(n.data()).attr("transform",n.attr("transform")).attr("x",0).attr("y",0).attr("width",e.column_width).attr("height",e.row_height).style({stroke:e.selected_stroke,"stroke-width":"3px",fill:"none"})})},clear_selected:function(){this.fig_click.selectAll("rect").remove()},mouseover_handler:function(t,e,n){var i=s.select(n).attr("transform");this.model.get("enable_hover")&&(this.fig_hover.append("rect").attr("class","hover_"+e).attr("transform",i).attr("x",0).attr("y",0).attr("width",this.column_width).attr("height",this.row_height).style({stroke:this.hovered_stroke,"stroke-width":"3px",fill:"none","pointer-events":"none"}),this.show_tooltip(s.event,t),this.send({event:"hover",data:t.name,ref_data:t.ref_data}))},update_selected_stroke:function(t,e){this.selected_stroke=e,this.fig_click.selectAll("rect").style({stroke:e})},update_hovered_stroke:function(t,e){this.hovered_stroke=e},mouseout_handler:function(t,e,n){this.fig_hover.select(".hover_"+e).remove(),this.hide_tooltip()},show_tooltip:function(t,e){s.mouse(this.el);var n=this;if(this.tooltip_view||this.tooltip_fields&&0!=this.tooltip_fields.length){var i=this.tooltip_div;i.transition().style("opacity",.9).style("display",null),this.move_tooltip(),i.select("table").remove();var r=e.ref_data;if(!this.tooltip_view){var a=i.append("table").selectAll("tr").data(this.tooltip_fields);a.exit().remove();var o=a.enter().append("tr");o.append("td").attr("class","tooltiptext").text(function(t){return t}),o.append("td").attr("class","tooltiptext").text(function(t,e){return null===r||void 0===r?null:n.tooltip_formats[e](r[t])})}this.popper.enableEventListeners(),this.move_tooltip()}},mousemove_handler:function(t){this.move_tooltip(t)},move_tooltip:function(t){this.popper_reference.x=s.event.clientX,this.popper_reference.y=s.event.clientY,this.popper.scheduleUpdate()},hide_tooltip:function(){this.tooltip_div.style("pointer-events","none"),this.tooltip_div.transition().style("opacity",0).style("display","none"),this.popper.disableEventListeners()},create_tooltip_widget:function(){var t=this.model.get("tooltip_widget");null!==this.tooltip_view&&void 0!==this.tooltip_view&&(this.tooltip_view.remove(),this.tooltip_view=null);var e=this;t&&this.create_child_view(t).then(function(t){e.tooltip_view=t,e.tooltip_div.node().appendChild(t.el),t.trigger("displayed",{add_to_dom_only:!0})})},get_group_transform:function(t){return"translate(0, 0)"},get_cell_transform:function(t){return this.past_border_y()?this.prev_y+=this.y_direction:this.past_border_x()?(this.y_direction=-1*this.y_direction,this.prev_x+=this.x_direction):(this.x_direction=-1*this.x_direction,this.prev_y+=this.y_direction,this.group_iter+=1),"translate("+this.prev_x*this.column_width+", "+this.prev_y*this.row_height+")"},get_new_cords:function(){var t=this.prev_x,e=this.prev_y,n=this.y_direction,i=this.x_direction,r=this.group_iter;return this.past_border_y()?e+=this.y_direction:this.past_border_x()?(n=-1*this.y_direction,t+=this.x_direction):(i=-1*this.x_direction,e+=this.y_direction,r+=1),[t,e,r,i,n,t*this.column_width,e*this.row_height]},past_border_y:function(){return 1==this.y_direction?this.prev_y+1<this.row_limits[this.group_iter]:this.prev_y-1>this.row_limits[this.group_iter-1]-1},past_border_x:function(){return 1==this.x_direction?this.prev_x+1<this.num_cols:this.prev_x-1>-1},colors_updated:function(){this.colors=this.model.get("colors"),this.recolor_chart()},get_color:function(t,e){return this.colors[t%e]},set_row_limits:function(){var t=Math.floor(this.num_rows/this.row_groups);this.row_limits=[];for(var e=this.row_groups-1;e>-1;e--)this.row_limits.unshift(e*t);this.row_limits[this.row_groups]=this.num_rows},get_end_points:function(t,e,n,i,r,s){var a,o=this.row_limits[t-1],l=this.row_limits[t],c=!1,h=r,u=s,d=[],_=1==u?l-i:i-o+1,f=1==h?this.num_cols-1-n:n,g=e,p=l-o;if(0!==g){this.calc_end_point_source(n,i,h,u).forEach(function(t){d.push(t)});var m=Math.min(_,g);if(m===g)return this.calc_end_point_source(n,i,-1*h,u).forEach(function(t){d.push(t)}),a=i+(g-1)*u,this.calc_end_point_dest(n,a,-1*h,u).forEach(function(t){d.push(t)}),this.calc_end_point_dest(n,a,h,u).forEach(function(t){d.push(t)}),d;if(g-=m,0===f?this.calc_end_point_source(n,i,-1*h,u).forEach(function(t){d.push(t)}):_!==l-o?(this.calc_end_point_source(n,i,-1*h,u).forEach(function(t){d.push(t)}),g>p&&this.calc_end_point_dest(n+h,1==u?o:l-1,-1*h,-1*u).forEach(function(t){d.push(t)})):g<p&&this.calc_end_point_source(n,i,-1*h,u).forEach(function(t){d.push(t)}),i+=u*(m-1),this.calc_end_point_dest(n,i,-1*h,u).forEach(function(t){d.push(t)}),0===g)return this.calc_end_point_dest(n,i,h,u).forEach(function(t){d.push(t)}),d;0!==f&&g>p&&(n+=h)}for(;g>p;){var v;if(p*f<g){var b=g-(v=f)*p;v+=Math.floor(b/(this.row_limits[t+1]-this.row_limits[t]))}else v=Math.floor(g/p);v>f?(n=1===h?this.num_cols-1:0,0!==f&&this.calc_end_point_dest(n,o,h,-1).forEach(function(t){d.push(t)}),v=f,f=this.num_cols,t+=1,o=l,l=this.row_limits[t],i=o,h*=-1,u=Math.pow(-1,v)*u*-1,this.calc_end_point_dest(n,l-1,-1*h,1).forEach(function(t){d.push(t)})):v===f?(n=1===h?this.num_cols-1:0,0!==f&&this.calc_end_point_dest(n,o,h,-1).forEach(function(t){d.push(t)}),v=f,f=this.num_cols,(t+=1)<this.row_limits.length?(o=l,l=this.row_limits[t],i=o,h*=-1,u=Math.pow(-1,v)*u*-1,c=!0):(u=1,h=1)):(i=1===(u=Math.pow(-1,v)*u)?o:l-1,n+=h*(v-1),this.calc_end_point_source(n,i,-1*h,u).forEach(function(t){d.push(t)})),g-=v*p,p=l-o}return 0===g?(i=1===u?l-1:o,h=c?-1*h:h,this.calc_end_point_dest(n,i,h,u).forEach(function(t){d.push(t)})):(i=1===(u*=-1)?o:l-1,n=c?n:n+h,this.calc_end_point_source(n,i,-1*h,u).forEach(function(t){d.push(t)}),a=i+(g-1)*u,this.calc_end_point_dest(n,a,h,u).forEach(function(t){d.push(t)}),this.calc_end_point_dest(n,a,-1*h,u).forEach(function(t){d.push(t)})),d},create_bounding_path:function(t,e){e[0].x,e[0].y;var n=[],i=e.slice();n.push(e[0]),i.splice(0,1);for(var r=["x","y"],a=0,o=r[a%2],l=r[(a+1)%2],c=n[0],h=c[o],u=c[l],d=2*i.length,_=0;i.length>1&&d>0;){var f=i.filter(function(t){return t[o]==h});if(f.length>0){a++;var g=s.min(f,function(t){return t[l]}),p=s.max(f,function(t){return t[l]});if(g<u&&p>u)if("y"==o)_=1==this.x_direction?p:g;else{var m=f.filter(function(t){return t[l]<u}),v=f.filter(function(t){return t[l]>u});_=1==m.length?g:1==v.length?p:s.max(m,function(t){return t[l]})}else _=g>u?g:p;i.filter(function(t){return t[o]==h&&t[l]==_}).forEach(function(t){i.splice(i.indexOf(t),1)});var b={};b[o]=h,b[l]=_,n.push(b)}else _=u;var y=o;o=l,l=y,u=h,h=_,d--}i.length>0&&n.push(i[0]),n.push(e[0]);var x=s.svg.line().interpolate("linear").x(function(t){return t.x}).y(function(t){return t.y});return s.select(t).append("path").attr("class","bounding_path").attr("d",function(){return x(n)}).attr("fill","none").style("stroke",this.model.get("group_stroke")).style("stroke-width",3)},calc_end_point_source:function(t,e,n,i){return e=1==i?e:e+1,[{x:(t=1==n?t:t+1)*this.column_width,y:e*this.row_height}]},calc_end_point_dest:function(t,e,n,i){return e=-1==i?e:e+1,[{x:(t=-1==n?t:t+1)*this.column_width,y:e*this.row_height}]}});t.exports={MarketMap:c}},function(t,e,n){var i=n(0),r=n(1),s=n(3),a=n(4).Mark.extend({render:function(){var t=a.__super__.render.apply(this),e=this;return this.displayed.then(function(){e.parent.tooltip_div.node().appendChild(e.tooltip_div.node()),e.create_tooltip()}),this.selected_indices=this.model.get("selected"),this.selected_style=this.model.get("selected_style"),this.unselected_style=this.model.get("unselected_style"),this.anchor_style=this.model.get("anchor_style"),this.display_el_classes=["heatmapcell"],t.then(function(){e.event_listeners={},e.process_interactions(),e.create_listeners(),e.compute_view_padding(),e.draw()})},initialize_additional_scales:function(){var t=this.scales.color;t&&(this.listenTo(t,"domain_changed",function(){this.apply_styles()}),t.on("color_scale_range_changed",this.apply_styles,this))},set_ranges:function(){var t=this.scales.row;if(t){var e=this.parent.padded_range("y",t.model);t.set_range(e)}var n=this.scales.column;n&&n.set_range(this.parent.padded_range("x",n.model))},set_positional_scales:function(){var t=this.scales.column,e=this.scales.row;this.listenTo(t,"domain_changed",function(){this.model.dirty||this.draw()}),this.listenTo(e,"domain_changed",function(){this.model.dirty||this.draw()})},expand_scale_domain:function(t,e,n,r){var s,a;if("expand_one"===n){var o=(s=e.map(function(e){return t.scale(e)})).slice(1).map(function(t,e){return t-s[e]});a=0,o[0]<0?(r=!r,a=i.max(o)):a=i.min(o);var l=0;return r?(l=s[s.length-1]+a,[e[0],t.invert(l)]):(l=s[0]-a,[t.invert(l),e[s.length-1]])}if("expand_two"===n){s=e.map(function(e){return t.scale(e)}),a=i.min(s.slice(1).map(function(t,e){return t-s[e]}));var c=s[s.length-1]+a,h=s[0]-a;return[t.invert(h),t.invert(c)]}},create_listeners:function(){a.__super__.create_listeners.apply(this),this.listenTo(this.model,"change:stroke",this.update_stroke,this),this.listenTo(this.model,"change:opacity",this.update_opacity,this),this.d3el.on("mouseover",r.bind(function(){this.event_dispatcher("mouse_over")},this)).on("mousemove",r.bind(function(){this.event_dispatcher("mouse_move")},this)).on("mouseout",r.bind(function(){this.event_dispatcher("mouse_out")},this)),this.listenTo(this.model,"data_updated",this.draw,this),this.listenTo(this.model,"change:tooltip",this.create_tooltip,this),this.listenTo(this.parent,"bg_clicked",function(){this.event_dispatcher("parent_clicked")}),this.model.on_some_change(["display_format","font_style"],this.update_labels,this),this.listenTo(this.model,"change:selected",this.update_selected),this.listenTo(this.model,"change:interactions",this.process_interactions)},click_handler:function(t){t.data;var e=this.model.colors[0].length,n=t.row_num*e+t.column_num,a=t.row_num,o=t.column_num,l=this,c=this.model.get("selected")?s.deepCopy(this.model.get("selected")):[],h=s.deepCopy(this._cell_nums_from_indices(c)),u=h.indexOf(n),d=i.event.ctrlKey||i.event.metaKey;if(u>-1&&d)c.splice(u,1);else if(d||(h=[],c=[]),c.push([a,o]),h.push(l._cell_nums_from_indices([[a,o]])[0]),i.event.shiftKey){if(u>-1)return;var _=0!==h.length?l.anchor_cell_index[0]:a,f=0!==h.length?l.anchor_cell_index[1]:o;r.range(Math.min(a,_),Math.max(a,_)+1).forEach(function(t){r.range(Math.min(o,f),Math.max(o,f)+1).forEach(function(e){var n=l._cell_nums_from_indices([[t,e]])[0];-1===h.indexOf(n)&&(h.push(n),c.push([t,e]))})})}else this.anchor_cell_index=[a,o];this.model.set("selected",0===c.length?null:c,{updated_view:this}),this.touch(),i.event||(i.event=window.event);var g=i.event;void 0!==g.cancelBubble&&(g.cancelBubble=!0),g.stopPropagation&&g.stopPropagation(),g.preventDefault(),this.selected_indices=c,this.apply_styles()},update_selected:function(t,e){this.selected_indices=e,this.apply_styles()},set_style_on_elements:function(t,e,n){e&&(0!==e.length||n&&0!==n.length)&&0!==Object.keys(t).length&&(n=n&&0!==n.length?n:this._filter_cells_by_index(e)).style(t)},set_default_style:function(t,e){if(t&&(0!==t.length||e&&0!==e.length)){e=e&&0!==e.length?e:this._filter_cells_by_index(t);var n=this.model.get("stroke"),i=this.model.get("opacity"),r=this;e.style("fill",function(t){return r.get_element_fill(t)}).style("opacity",i).style("stroke",n)}},clear_style:function(t,e,n){if(0!==Object.keys(t).length){n&&0!==n.length||(n=e?this._filter_cells_by_index(e):this.display_cells);var i={};for(var r in t)i[r]=null;n.style(i)}},_filter_cells_by_cell_num:function(t){return null===t||void 0===t?[]:this.display_cells.filter(function(e){return-1!==t.indexOf(e._cell_num)})},selected_style_updated:function(t,e){this.selected_style=e,this.clear_style(t.previous("selected_style"),this.selected_indices,this.selected_elements),this.style_updated(e,this.selected_indices,this.selected_elements)},unselected_style_updated:function(t,e){this.unselected_style=e,this.clear_style(t.previous("unselected_style"),[],this.unselected_elements),this.style_updated(e,[],this.unselected_elements)},apply_styles:function(){var t=this.model.colors.length,e=this.model.colors[0].length;this.clear_style(this.selected_style),this.clear_style(this.unselected_style),this.clear_style(this.anchor_style),this.set_default_style([],this.display_cells);var n=this._cell_nums_from_indices(this.selected_indices),i=null===n||0===n.length?[]:r.difference(r.range(t*e),n);if(this.selected_elements=this._filter_cells_by_cell_num(n),this.set_style_on_elements(this.selected_style,this.selected_indices,this.selected_elements),this.unselected_elements=this._filter_cells_by_cell_num(i),this.set_style_on_elements(this.unselected_style,[],this.unselected_elements),null!==this.anchor_cell_index&&void 0!==this.anchor_cell_index){var s=this._cell_nums_from_indices([this.anchor_cell_index]);this.anchor_element=this._filter_cells_by_cell_num(s),this.set_style_on_elements(this.anchor_style,[],this.anchor_element)}},style_updated:function(t,e,n){this.set_default_style(e,n),this.set_style_on_elements(t,e,n)},reset_selection:function(){this.model.set("selected",null),this.touch(),this.selected_indices=null,this.clear_style(this.selected_style),this.clear_style(this.unselected_style),this.clear_style(this.anchor_style),this.set_default_style([],this.display_cells)},relayout:function(){this.set_ranges(),this.compute_view_padding(),this.draw()},_cell_nums_from_indices:function(t){if(null===t||void 0===t)return null;var e=this.model.colors[0].length;return t.map(function(t){return t[0]*e+t[1]})},invert_point:function(t){},selector_changed:function(t,e){if(void 0===t)return this.model.set("selected",null),this.touch(),[];var n=r.range(this.model.colors[0].length),i=r.range(this.model.colors.length),s=this,a=r.filter(n,function(t){return e([s.column_pixels[t],[]])}),o=r.filter(i,function(t){return e([[],s.row_pixels[t]])}),l=a.map(function(t){return o.map(function(e){return[e,t]})});l=r.flatten(l,!0),this.model.set("selected",l),this.touch()},draw:function(){this.set_ranges();var t,e=this,n=this.model.colors.length,s=this.model.colors[0].length,a=this.scales.row,o=this.scales.column,l="start"===this.model.get("row_align"),c="start"===this.model.get("column_align");"middle"!==this.model.modes.row&&"boundaries"!==this.model.modes.row&&(t=this.expand_scale_domain(a,this.model.rows,this.model.modes.row,l),(i.min(t)<i.min(a.model.domain)||i.max(t)>i.max(a.model.domain))&&a.model.compute_and_set_domain(t,a.model.model_id)),"middle"!==this.model.modes.column&&"boundaries"!==this.model.modes.column&&(t=this.expand_scale_domain(o,this.model.columns,this.model.modes.column,c),(i.min(t)<i.min(o.model.domain)||i.max(t)>i.max(o.model.domain))&&o.model.compute_and_set_domain(t,o.model.model_id));var h=this.get_tile_plotting_data(a,this.model.rows,this.model.modes.row,l),u=this.get_tile_plotting_data(o,this.model.columns,this.model.modes.column,c);this.row_pixels=h.start.map(function(t,e){return[t,t+h.widths[e]]}),this.column_pixels=u.start.map(function(t,e){return[t,t+u.widths[e]]}),this.display_rows=this.d3el.selectAll(".heatmaprow").data(r.range(n)),this.display_rows.enter().append("g").attr("class","heatmaprow"),this.display_rows.attr("transform",function(t){return"translate(0, "+h.start[t]+")"});var d=r.range(s),_=r.range(n).map(function(t){return d.map(function(n){return e.model.mark_data[t*s+n]})});this.display_cell_groups=this.display_rows.selectAll(".heatmapcell").data(function(t,e){return _[e]}).enter().append("g").attr("class","heatmapcell").attr("transform",function(t,e){return"translate("+u.start[e]+", 0)"}),this.display_cells=this.display_cell_groups.append("rect").attr("class","cell_rect").on("click",r.bind(function(){this.event_dispatcher("element_clicked")},this)),this.display_cell_groups.append("text").attr("class","cell_text").style({"text-anchor":"middle",fill:"black","pointer-events":"none","dominant-baseline":"central"}),this.display_cell_groups.selectAll(".cell_rect").attr("x",0).attr("y",0).attr("width",function(t,e){return u.widths[e]}).attr("height",function(t){return h.widths[t.row_num]}),this.display_cell_groups.selectAll(".cell_text").attr("x",function(t,e){return u.widths[e]/2}).attr("y",function(t){return h.widths[t.row_num]/2}),this.apply_styles(),this.update_labels(),this.display_cells.on("click",function(t,n){return e.event_dispatcher("element_clicked",{data:t.color,index:n,row_num:t.row_num,column_num:t.column_num})})},update_stroke:function(t,e){this.display_cells.style("stroke",e)},update_opacity:function(t,e){this.display_cells.style("opacity",e)},update_labels:function(){var t=this.model.get("display_format"),e=i.format(t);i.selectAll(".cell_text").text(function(n,i){return t?e(n.color):null}).style(this.model.get("font_style"))},get_tile_plotting_data:function(t,e,n,r){var s,a=[],o=[];if("middle"===n)return a=e.map(function(e){return t.scale(e)}),o=e.map(function(e){return t.scale.rangeBand()}),{start:a,widths:o};if("boundaries"===n){var l=e.map(function(e){return t.scale(e)});o=[];for(var c=1;c<l.length;++c)o[c-1]=Math.abs(l[c]-l[c-1]);return{start:a=l[1]>l[0]?l.slice(0,-1):l.slice(1),widths:o}}if("expand_one"===n)return r?(o=(a=e.map(function(e){return t.scale(e)})).slice(1).map(function(t,e){return Math.abs(t-a[e])}),s=i.max(t.scale.range()),o=a[0]<a[1]?Array.prototype.concat(o,[Math.abs(s-i.max(a))]):Array.prototype.concat([Math.abs(s-i.max(a))],o)):(o=(a=e.map(function(e){return t.scale(e)})).slice(1).map(function(t,e){return Math.abs(t-a[e])}),s=i.min(t.scale.range()),s=i.min(t.scale.range()),a[1]>a[0]?(a.splice(0,0,Math.abs(0,0,s)),o.splice(0,0,a[1]-a[0]),a.splice(-1,1)):(o=Array.prototype.concat(o,[Math.abs(s-a.slice(-1)[0])]),(a=Array.prototype.concat(a,s)).splice(0,1))),{widths:o,start:a};if("expand_two"===n){var h=(a=e.map(function(e){return t.scale(e)}))[1]-a[0]>0,u=h?i.min(t.scale.range()):i.max(t.scale.range());return a.splice(0,0,u),o=a.slice(1).map(function(t,e){return Math.abs(t-a[e])}),u=h?i.max(t.scale.range()):i.min(t.scale.range()),o[o.length]=Math.abs(u-a.slice(-1)[0]),{start:a,widths:o}}},get_element_fill:function(t){return null===t.color?this.model.get("null_color"):this.scales.color.scale(t.color)},process_interactions:function(){var t=this.model.get("interactions");r.isEmpty(t)?this.reset_interactions():(void 0!==t.click&&null!==t.click?"tooltip"===t.click?(this.event_listeners.element_clicked=function(){return this.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip):"select"==t.click&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.click_handler):this.reset_click(),void 0!==t.hover&&null!==t.hover?"tooltip"===t.hover&&(this.event_listeners.mouse_over=this.refresh_tooltip,this.event_listeners.mouse_move=this.move_tooltip,this.event_listeners.mouse_out=this.hide_tooltip):this.reset_hover())}});t.exports={GridHeatMap:a}},function(t,e,n){var i=n(2),r=n(1),s=n(0),a=n(7),o="^"+n(6).version,l=a.BaseModel.extend({defaults:function(){return r.extend(a.BaseModel.prototype.defaults(),{_model_name:"MarketMapModel",_view_name:"MarketMap",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:o,_view_module_version:o,map_width:1080,map_height:800,names:[],groups:[],display_text:[],ref_data:void 0,title:"",tooltip_fields:[],tooltip_formats:[],show_groups:!1,cols:0,rows:0,row_groups:1,colors:s.scale.category20().range(),scales:{},axes:[],color:[],map_margin:{top:50,right:50,left:50,bottom:50},preserve_aspect:!1,stroke:"white",group_stroke:"black",selected_stroke:"dodgerblue",hovered_stroke:"orangered",font_style:{},title_style:{},selected:[],enable_hover:!0,enable_select:!0,tooltip_widget:null})}},{serializers:r.extend({scales:{deserialize:i.unpack_models},axes:{deserialize:i.unpack_models},tooltip_widget:{deserialize:i.unpack_models},style:{deserialize:i.unpack_models},layout:{deserialize:i.unpack_models}},a.BaseModel.serializers)});t.exports={MarketMapModel:l}},function(t,e,n){var i=n(0),r=n(1),s=(n(3),n(4).Mark.extend({render:function(){var t=s.__super__.render.apply(this),e=this;return this.displayed.then(function(){e.parent.tooltip_div.node().appendChild(e.tooltip_div.node()),e.create_tooltip()}),this.image=i.select(this.el).append("image").classed("heatmap",!0).attr("width",this.parent.width).attr("height",this.parent.height),this.canvas=document.createElement("canvas"),t.then(function(){e.event_listeners={},e.process_interactions(),e.create_listeners(),e.compute_view_padding(),e.draw()})},set_ranges:function(){var t=this.scales.x;if(t){var e=this.parent.padded_range("x",t.model);t.set_range(e)}var n=this.scales.y;n&&n.set_range(this.parent.padded_range("y",n.model))},set_positional_scales:function(){var t=this.scales.x,e=this.scales.y;this.listenTo(t,"domain_changed",function(){this.model.dirty||this.draw()}),this.listenTo(e,"domain_changed",function(){this.model.dirty||this.draw()})},initialize_additional_scales:function(){var t=this.scales.color;t&&(this.listenTo(t,"domain_changed",function(){this.draw()}),t.on("color_scale_range_changed",this.draw,this))},create_listeners:function(){s.__super__.create_listeners.apply(this),this.d3el.on("mouseover",r.bind(function(){this.event_dispatcher("mouse_over")},this)).on("mousemove",r.bind(function(){this.event_dispatcher("mouse_move")},this)).on("mouseout",r.bind(function(){this.event_dispatcher("mouse_out")},this)),this.listenTo(this.model,"data_updated",this.draw,this),this.listenTo(this.model,"change:tooltip",this.create_tooltip,this),this.listenTo(this.parent,"bg_clicked",function(){this.event_dispatcher("parent_clicked")}),this.listenTo(this.model,"change:interactions",this.process_interactions)},click_handler:function(t){},process_interactions:function(t){},relayout:function(){this.set_ranges(),this.compute_view_padding(),this.draw()},draw_canvas:function(){this.image.attr("href",this.canvas.toDataURL("image/png"))},draw:function(){this.set_ranges();var t=this,e=this.get_x_plotting_data(this.model.mark_data.x),n=this.get_y_plotting_data(this.model.mark_data.y);this.canvas.setAttribute("width",e.total_width),this.canvas.setAttribute("height",n.total_height);var i=this.canvas.getContext("2d");this.model.mark_data.color.forEach(function(r,s){var a=n.heights[s],o=n.start[s];r.forEach(function(n,r){var s=e.widths[r],l=e.start[r];i.fillStyle=t.get_element_fill(n),i.fillRect(l,o,s+.5,a+.5)})}),this.image.attr("width",e.total_width).attr("height",n.total_height).attr("x",e.x0).attr("y",n.y0),this.draw_canvas()},get_x_plotting_data:function(t){var e=t.map(this.scales.x.scale),n=this.get_x_padding(e),i=t.length,r=e.map(function(t,r){return 0==r?.5*(e[1]-t)+n.left:r==i-1?.5*(t-e[r-1])+n.right:.5*(e[r+1]-e[r-1])}),s=e[0]-n.left,a=e.map(function(t,n){return 0==n?0:.5*(t+e[n-1])-s});return{widths:r,total_width:e[i-1]-e[0]+n.left+n.right,start:a,x0:s}},get_x_padding:function(t){var e=t.length;return{left:.5*(t[1]-t[0]),right:.5*(t[e-1]-t[e-2])}},get_y_plotting_data:function(t){var e=t.map(this.scales.y.scale),n=this.get_y_padding(e),i=t.length,r=e.map(function(t,r){return 0==r?.5*-(e[1]-t)+n.bottom:r==i-1?.5*-(t-e[r-1])+n.top:.5*-(e[r+1]-e[r-1])}),s=e[i-1]-n.top,a=e.map(function(t,n){return n==i-1?0:.5*(t+e[n+1])-s});return{heights:r,total_height:e[0]-e[i-1]+n.top+n.bottom,start:a,y0:s}},get_y_padding:function(t){var e=t.length;return{bottom:.5*-(t[1]-t[0]),top:.5*-(t[e-1]-t[e-2])}},get_element_fill:function(t){return null===t?this.model.get("null_color"):this.scales.color.scale(t)}}));t.exports={HeatMap:s}},function(t,e,n){n(0);var i=n(1),r=n(5),s=r.MarkModel.extend({defaults:i.extend({},r.MarkModel.prototype.defaults,{_model_name:"HeatMapModel",_view_name:"HeatMap",x:[],y:[],color:null,scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"},color:{dimension:"color"}},null_color:"black"}),initialize:function(){s.__super__.initialize.apply(this,arguments),this.on_some_change(["x","y","color"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data(),this.update_domains()},update_data:function(){this.dirty=!0,this.mark_data={x:this.get_typed_field("x"),y:this.get_typed_field("y"),color:this.get_typed_field("color")},this.update_domains(),this.dirty=!1,this.trigger("data_updated")},update_domains:function(){if(this.mark_data){var t=this.get("scales"),e=t.x,n=t.y,i=t.color,r=[].concat.apply([],this.mark_data.color);this.get("preserve_domain").x?e.del_domain([],this.model_id+"_x"):e.compute_and_set_domain(this.mark_data.x,this.model_id+"_x"),this.get("preserve_domain").y?n.del_domain([],this.model_id+"_y"):n.compute_and_set_domain(this.mark_data.y,this.model_id+"_y"),null!==i&&void 0!==i&&(this.get("preserve_domain").color?i.del_domain([],this.model_id+"_color"):i.compute_and_set_domain(r,this.model_id+"_color"))}},get_data_dict:function(t,e){return t}});t.exports={HeatMapModel:s}},function(t,e,n){var i=n(2),r=n(1),s="^"+n(6).version,a=i.DOMWidgetModel.extend({defaults:function(){return r.extend(i.DOMWidgetModel.prototype.defaults(),{_model_name:"ToolbarModel",_view_name:"Toolbar",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:s,_view_module_version:s,figure:void 0,_panning:!1,_panzoom:null})},panzoom:function(){var t=this.get("figure");if(this.get("_panning"))t&&(t.set("interaction",this.cached_interaction),t.save_changes()),this.set("_panning",!1),this.save_changes();else{if(t){this.cached_interaction=t.get("interaction");var e=this,n=this.get("_panzoom");n?(t.set("interaction",n),t.save_changes()):this._create_panzoom_model(t).then(function(n){e.set("_panzoom",n),e.save_changes(),t.set("interaction",n),t.save_changes()})}this.set("_panning",!0),this.save_changes()}},reset:function(){var t=this.get("figure");this.get("_panning");if(t){t.set("interaction",this.cached_interaction),t.save_changes();var e=this.get("_panzoom");e.reset_scales(),e.close(),this.set("_panzoom",null),this.set("_panning",!1),this.save_changes()}},save_png:function(){var t=this.get("figure");t&&t.save_png()},_create_panzoom_model:function(t){return this.widget_manager.new_widget({model_name:"PanZoomModel",model_module:"bqplot",model_module_version:t.get("_model_module_version"),view_name:"PanZoom",view_module:"bqplot",view_module_version:t.get("_view_module_version")}).then(function(e){return Promise.all(t.get("marks")).then(function(t){for(var n=[],i=[],s=0;s<t.length;++s){var a=t[s].get("preserve_domain"),o=t[s].get("scales");r.each(o,function(e,r){var l=t[s].get("scales_metadata")[r].dimension;"x"!==l||a[r]||n.push(o[r]),"y"!==l||a[r]||i.push(o[r])})}return e.set("scales",{x:n,y:i}),e.save_changes(),e})})}},{serializers:r.extend({figure:{deserialize:i.unpack_models},_panzoom:{deserialize:i.unpack_models}},i.DOMWidgetModel.serializers)}),o=i.DOMWidgetView.extend({render:function(){var t=this;this.el.classList.add("jupyter-widget"),this.el.classList.add("widget-hbox");var e=document.createElement("button");e.classList.add("jupyter-widgets"),e.classList.add("jupyter-button"),e.classList.add("widget-toggle-button"),e.setAttribute("data-toggle","tooltip"),e.setAttribute("title","PanZoom"),e.onclick=function(e){e.preventDefault(),t.model.panzoom()};var n=document.createElement("i");n.className="fa fa-arrows",e.appendChild(n);var i=document.createElement("button");i.classList.add("jupyter-widgets"),i.classList.add("jupyter-button"),i.classList.add("widget-button"),i.setAttribute("data-toggle","tooltip"),i.setAttribute("title","Reset"),i.onclick=function(e){e.preventDefault(),t.model.reset()};var r=document.createElement("i");r.className="fa fa-refresh",i.appendChild(r);var s=document.createElement("button");s.classList.add("jupyter-widgets"),s.classList.add("jupyter-button"),s.classList.add("widget-button"),s.setAttribute("data-toggle","tooltip"),s.setAttribute("title","Save"),s.onclick=function(e){e.preventDefault(),t.model.save_png()};var a=document.createElement("i");a.className="fa fa-save",s.appendChild(a),this.el.appendChild(e),this.el.appendChild(i),this.el.appendChild(s),this._panzoom=e,this.update()},update:function(){this.model.get("_panning")?this._panzoom.classList.add("mod-active"):this._panzoom.classList.remove("mod-active")}});t.exports={Toolbar:o,ToolbarModel:a}},function(t,e,n){n(0);var i=n(1),r=n(5),s=r.MarkModel.extend({defaults:function(){return i.extend({},r.MarkModel.prototype.defaults,{_model_name:"GraphModel",_view_name:"Graph",x:[],y:[],color:null,hovered_point:null,scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"},color:{dimension:"color"}},colors:[]})},initialize:function(){s.__super__.initialize.apply(this,arguments),this.on_some_change(["x","y","color","link_color","node_data","link_data","link_color"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data()},update_node_data:function(){var t=this.get("node_data"),e=this.get_typed_field("x"),n=this.get_typed_field("y"),i=this.get_typed_field("color"),r=this.get("scales"),s=(r.x,r.y,r.color);t.length>0&&"string"==typeof t[0]&&(t=t.map(function(t){return{label:t}})),this.mark_data=[];var a=this;t.forEach(function(t,e){t.label=t.label||"N"+e,t.label_display=t.label_display||"center",t.shape=t.shape||"circle",t.shape_attrs=function(t,e){var n={};switch(t){case"circle":n.r=e.r||15;break;case"rect":n.width=e.width||25,n.height=e.height||.8*n.width,n.rx=e.rx||0,n.ry=e.ry||0;break;case"ellipse":n.rx=e.rx||20,n.ry=e.ry||.6*n.rx;break;default:console.log("Invalid shape passed - ",t)}return n}(t.shape,t.shape_attrs||{}),t.value=t.value||null,a.mark_data.push(t)}),0!==e.length&&0!==n.length&&(s&&(this.get("preserve_domain").color?s.del_domain([],this.model_id+"_color"):s.compute_and_set_domain(i,this.model_id+"_color")),this.mark_data.forEach(function(t,r){t.xval=e[r],t.yval=n[r],t.color=i[r]}))},update_link_data:function(){var t=this.get("scales").link_color;this.link_data=this.get("link_data");var e=this.get_typed_field("link_matrix"),n=this.get_typed_field("link_color"),i=this;void 0!==t&&n.length>0&&(e=n),0===this.link_data.length&&e.length>0&&e.forEach(function(t,e){t.forEach(function(t,n){null!==t&&i.link_data.push({source:e,target:n,value:t})})})},update_data:function(){this.dirty=!0,this.update_node_data(),this.update_link_data(),this.update_unique_ids(),this.update_domains(),this.dirty=!1,this.trigger("data_updated")},update_unique_ids:function(){},get_data_dict:function(t,e){return t},update_domains:function(){var t={x:"xval",y:"yval"};if(this.mark_data){var e=this.get("scales");for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];this.get("preserve_domain")[n]?i.del_domain([],this.model_id+n):i.compute_and_set_domain(this.mark_data.map(function(e){return e[n]||e[t[n]]}),this.model_id+n)}}}});t.exports={GraphModel:s}},function(t,e,n){var i=n(0),r=n(1),s=n(3),a=n(4).Mark.extend({render:function(){var t=a.__super__.render.apply(this),e=this;return this.selected_style=this.model.get("selected_style"),this.unselected_style=this.model.get("unselected_style"),this.selected_indices=this.model.get("selected"),this.hovered_style=this.model.get("hovered_style"),this.unhovered_style=this.model.get("unhovered_style"),this.hovered_index=this.model.get("hovered_point")?[this.model.get("hovered_point")]:null,this.display_el_classes=["element"],this.event_metadata={mouse_over:{msg_name:"hover",lookup_data:!1,hit_test:!0},element_clicked:{msg_name:"element_click",lookup_data:!1,hit_test:!0},parent_clicked:{msg_name:"background_click",hit_test:!1}},this.displayed.then(function(){e.parent.tooltip_div.node().appendChild(e.tooltip_div.node()),e.create_tooltip()}),this.d3el.attr("class","network"),this.arrow=this.parent.svg.append("defs").append("marker").attr("id","arrow").attr("refX",0).attr("refY",3).attr("markerWidth",10).attr("markerHeight",10).attr("orient","auto").append("path").attr("class","linkarrow").attr("d","M0,0 L0,6 L9,3 z"),t.then(function(){e.event_listeners={},e.process_interactions(),e.create_listeners(),e.compute_view_padding(),e.draw()})},set_ranges:function(){var t=this.scales.x,e=this.scales.y;t&&t.set_range(this.parent.padded_range("x",t.model)),e&&e.set_range(this.parent.padded_range("y",e.model))},set_positional_scales:function(){this.x_scale=this.scales.x,this.y_scale=this.scales.y,this.x_scale||(this.x_scale=this.parent.scale_x),this.y_scale||(this.y_scale=this.parent.scale_y),this.listenTo(this.x_scale,"domain_changed",function(){this.model.dirty||this.update_position()}),this.listenTo(this.y_scale,"domain_changed",function(){this.model.dirty||this.update_position()})},relayout:function(){this.set_ranges(),this.update_position()},update_position:function(){var t=this.scales.x,e=this.scales.y;this.set_ranges();t&&e&&(this.model.mark_data.forEach(function(n){n.x=t.scale(n.xval)+t.offset,n.y=e.scale(n.yval)+e.offset}),this.force_layout&&(this.force_layout.nodes(this.model.mark_data).links(this.model.link_data).start(),this.links&&this.links.data(this.force_layout.links()),this.nodes&&this.nodes.data(this.force_layout.nodes()),this.nodes&&this.links&&this.tick()))},initialize_additional_scales:function(){var t=this.scales.color;t&&(this.listenTo(t,"domain_changed",function(){this.color_scale_updated()}),t.on("color_scale_range_changed",this.color_scale_updated,this));var e=this.scales.link_color;e&&this.listenTo(e,"domain_changed",function(){this.link_color_scale_updated()})},create_listeners:function(){a.__super__.create_listeners.apply(this),this.d3el.on("mouseover",r.bind(function(){this.event_dispatcher("mouse_over")},this)).on("mousemove",r.bind(function(){this.event_dispatcher("mouse_move")},this)).on("mouseout",r.bind(function(){this.event_dispatcher("mouse_out")},this)),this.listenTo(this.model,"change:charge",this.update_charge),this.listenTo(this.model,"change:link_distance",this.update_link_distance),this.listenTo(this.model,"data_updated",this.data_updated,this),this.listenTo(this.model,"change:tooltip",this.create_tooltip,this),this.listenTo(this.model,"change:enable_hover",function(){this.hide_tooltip()},this),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.model,"change:selected",this.update_selected),this.listenTo(this.model,"change:hovered_point",this.update_hovered),this.listenTo(this.model,"change:hovered_style",this.hovered_style_updated,this),this.listenTo(this.model,"change:unhovered_style",this.unhovered_style_updated,this),this.listenTo(this.parent,"bg_clicked",function(){this.event_dispatcher("parent_clicked")})},data_updated:function(){this.draw(),this.relayout()},get_node_color:function(t,e){var n=this.scales.color,i=this.model.get("colors"),r=i.length;return n&&void 0!==t.color?n.scale(t.color):i[e%r]},draw:function(){this.set_ranges();var t=this.scales.x,e=this.scales.y,n=(this.scales.color,this.scales.link_color);this.d3el.selectAll(".node").remove(),this.d3el.selectAll(".link").remove(),this.force_layout=i.layout.force().size([this.parent.width,this.parent.height]).linkDistance(this.model.get("link_distance")),t&&e&&this.model.mark_data.forEach(function(n){n.x=t.scale(n.xval)+t.offset,n.y=e.scale(n.yval)+e.offset}),this.force_layout.nodes(this.model.mark_data).links(this.model.link_data),t||e||this.force_layout.charge(this.model.get("charge")).on("tick",r.bind(this.tick,this)).start();var s=this.model.get("directed");this.links=this.d3el.selectAll(".link").data(this.force_layout.links()).enter().append("path").attr("class","link").style("stroke",function(t){return n?n.scale(t.value):null}).style("stroke-width",function(t){return t.link_width}).attr("marker-mid",s?"url(#arrow)":null);var a=this;this.nodes=this.d3el.selectAll(".node").data(this.force_layout.nodes()).enter().append("g").attr("class","node").call(this.force_layout.drag),this.nodes.append(function(t){return document.createElementNS(i.ns.prefix.svg,t.shape)}).attr("class","element").each(function(t){var e=i.select(this);for(var n in t.shape_attrs)e.attr(n,t.shape_attrs[n])}).style("fill",function(t,e){return a.get_node_color(t,e)}),this.nodes.append("text").attr("class","label").attr("text-anchor",function(t){return"center"===t.label_display?"middle":"start"}).attr("x",function(t){var e=0;if("outside"===t.label_display)switch(t.shape){case"rect":e=t.shape_attrs.width/2+5;break;case"circle":e=t.shape_attrs.r+5;break;case"ellipse":e=t.shape_attrs.rx+5;break;default:e=0}return e}).attr("y",".31em").text(function(t){return t.label}).style("display",function(t){return"none"===t.label_display?"none":"inline"}),this.nodes.on("click",r.bind(function(t,e){this.event_dispatcher("element_clicked",{data:t,index:e})},this)),this.nodes.on("mouseover",r.bind(function(t,e){this.hover_handler({data:t,index:e})},this)),this.nodes.on("mouseout",r.bind(function(){this.reset_hover()},this))},color_scale_updated:function(){var t=this;this.nodes.selectAll(".element").style("fill",function(e,n){return t.get_node_color(e,n)})},link_color_scale_updated:function(){var t=this.scales.link_color;this.links.style("stroke",function(e){return t?t.scale(e.value):null})},process_interactions:function(){var t=this.model.get("interactions");r.isEmpty(t)?this.reset_interactions():(void 0!==t.click&&null!==t.click?"tooltip"===t.click?(this.event_listeners.element_clicked=function(){return this.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip):"select"==t.click&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.click_handler):this.reset_click(),void 0!==t.hover&&null!==t.hover?"tooltip"===t.hover&&(this.event_listeners.mouse_over=this.refresh_tooltip,this.event_listeners.mouse_move=this.move_tooltip,this.event_listeners.mouse_out=this.hide_tooltip):this.reset_hover())},reset_hover:function(){this.links.style("opacity",1),this.model.set("hovered_point",null),this.hovered_index=null,this.touch()},hover_handler:function(t){var e=t.data,n=t.index;this.model.get("highlight_links")?this.links.style("opacity",function(t){return t.source.label===e.label||t.target.label===e.label?1:.1}):this.links.style("opacity",1),this.model.set("hovered_point",n,{updated_view:this}),this.touch()},reset_selection:function(){this.model.set("selected",null),this.selected_indices=null,this.touch()},click_handler:function(t){t.data;var e=t.index,n=this.model.get("selected"),r=n?s.deepCopy(n):[],a=r.indexOf(e),o=i.event.ctrlKey||i.event.metaKey;a>-1&&o?r.splice(a,1):o?r.push(e):(r=[]).push(e),this.model.set("selected",0===r.length?null:r,{updated_view:this}),this.touch(),i.event||(i.event=window.event);var l=i.event;void 0!==l.cancelBubble&&(l.cancelBubble=!0),l.stopPropagation&&l.stopPropagation(),l.preventDefault()},hovered_style_updated:function(t,e){this.hovered_style=e,this.clear_style(t.previous("hovered_style"),this.hovered_index),this.style_updated(e,this.hovered_index)},unhovered_style_updated:function(t,e){this.unhovered_style=e;var n=this.hovered_index,i=n?r.range(this.model.mark_data.length).filter(function(t){return-1===n.indexOf(t)}):[];this.clear_style(t.previous("unhovered_style"),i),this.style_updated(e,i)},update_selected:function(t,e){this.selected_indices=e,this.apply_styles()},update_hovered:function(t,e){this.hovered_index=null===e?e:[e],this.apply_styles()},apply_styles:function(t){void 0!==t&&null!==t||(t=[this.selected_style,this.unselected_style,this.hovered_style,this.unhovered_style]),a.__super__.apply_styles.apply(this,[t]);var e=r.range(this.model.mark_data.length);this.set_style_on_elements(this.hovered_style,this.hovered_index);var n=this.hovered_index?r.difference(e,this.hovered_index):[];this.set_style_on_elements(this.unhovered_style,n)},clear_style:function(t,e){var n=this.d3el.selectAll(".element");e&&(n=n.filter(function(t,n){return-1!==e.indexOf(n)}));var i={};for(var r in t)i[r]=null;n.style(i)},set_style_on_elements:function(t,e){if(e&&0!==e.length&&(void 0===t||0!==Object.keys(t).length)){var n=this.d3el.selectAll(".element");(n=n.filter(function(t,n){return-1!==e.indexOf(n)})).style(t)}},compute_view_padding:function(){var t=i.max(this.model.mark_data.map(function(t){return(t.shape_attrs.r||t.shape_attrs.width/2||t.shape_attrs.rx)+1})),e=i.max(this.model.mark_data.map(function(t){return(t.shape_attrs.r||t.shape_attrs.height/2||t.shape_attrs.ry)+1}));t===this.x_padding&&e===this.y_padding||(this.x_padding=t,this.y_padding=t,this.trigger("mark_padding_updated"))},selected_deleter:function(){i.event.stopPropagation()},update_link_distance:function(){var t=this.scales.x,e=this.scales.y,n=this.model.get("link_distance");t||e||this.force_layout.linkDistance(n).start()},update_charge:function(){var t=this.scales.x,e=this.scales.y,n=this.model.get("charge");t||e||this.force_layout.charge(n).start()},link_arc:function(t){var e=t.target.x-t.source.x,n=t.target.y-t.source.y,i=Math.sqrt(e*e+n*n);return"M"+t.source.x+","+t.source.y+"A"+i+","+i+" 0 0,1 "+t.target.x+","+t.target.y},link_line:function(t){var e=(t.source.x+t.target.x)/2,n=(t.source.y+t.target.y)/2;return"M"+t.source.x+","+t.source.y+"L"+e+","+n+"L"+t.target.x+","+t.target.y},link_slant_line:function(t){var e=(t.source.x+t.target.x)/2;return"M"+t.source.x+","+t.source.y+"L"+e+","+t.target.y+"L"+t.target.x+","+t.target.y},tick:function(){var t=this.model.get("link_type");this.nodes.attr("transform",function(t){return"translate("+t.x+","+t.y+")"}),this.nodes.select("rect").attr("transform",function(t){return"translate("+-t.shape_attrs.width/2+","+-t.shape_attrs.height/2+")"});var e=this.link_arc;switch(t){case"arc":e=this.link_arc;break;case"line":e=this.link_line;break;case"slant_line":e=this.link_slant_line;break;default:e=this.link_arc}this.links.attr("d",function(t){return e(t)})}});t.exports={Graph:a}},function(t,e,n){n(0);var i=n(4),r=(n(3),n(1),i.Mark.extend({render:function(){var t=r.__super__.render.apply(this),e=this.d3el||this.el;window.last_el=e,window.last_image=this,this.im=e.append("image").attr("x",0).attr("y",0).attr("width",1).attr("height",1).attr("preserveAspectRatio","none"),this.update_image();var n=this;return t.then(function(){n.create_listeners(),n.listenTo(n.parent,"margin_updated",function(){n.draw()})})},set_positional_scales:function(){var t=this.scales.x,e=this.scales.y;this.listenTo(t,"domain_changed",function(){this.model.dirty||this.draw()}),this.listenTo(e,"domain_changed",function(){this.model.dirty||this.draw()})},set_ranges:function(){var t=this.scales.x,e=this.scales.y;t&&t.set_range(this.parent.padded_range("x",t.model)),e&&e.set_range(this.parent.padded_range("y",e.model))},create_listeners:function(){r.__super__.create_listeners.apply(this),this.listenTo(this.model,"change:image",this.update_image,this),this.listenTo(this.model,"data_updated",function(){this.draw(!0)},this)},update_image:function(){this.im.attr("href")&&URL.revokeObjectURL(this.im.attr("href"));var t=this.model.get("image"),e=new Blob([t.get("value")],{type:"image/"+t.get("format")}),n=URL.createObjectURL(e);this.im.attr("href",n)},remove:function(){URL.revokeObjectURL(this.im.attr("href")),r.__super__.remove.apply(this)},relayout:function(){this.draw(!0)},draw:function(t){this.set_ranges();var e=this.scales.x?this.scales.x:this.parent.scale_x,n=this.scales.y?this.scales.y:this.parent.scale_y,i=t?this.parent.model.get("animation_duration"):0,r=this.d3el||this.el,s=this.model.mark_data.x.map(e.scale),a=this.model.mark_data.y.map(n.scale);r.selectAll("image").transition().duration(i).attr("transform",function(t){return"translate("+(s[0]+e.offset)+","+(a[1]+n.offset)+") scale("+(s[1]-s[0])+", "+(a[0]-a[1])+")"})}}));t.exports={Image:r}},function(t,e,n){var i=n(2),r=(n(0),n(1)),s=n(5),a=s.MarkModel.extend({defaults:function(){return r.extend(s.MarkModel.prototype.defaults(),{_model_name:"ImageModel",_view_name:"Image",x:1,y:1,scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"}}})},initialize:function(){a.__super__.initialize.apply(this,arguments),this.on_some_change(["x","y"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data()},update_data:function(){this.mark_data={x:this.get_typed_field("x"),y:this.get_typed_field("y")},this.update_domains(),this.trigger("data_updated")},update_domains:function(){if(this.mark_data){var t=this.get("scales"),e=t.x,n=t.y;e&&(this.get("preserve_domain").x?e.del_domain([],this.model_id+"_x"):e.compute_and_set_domain(this.mark_data.x,this.model_id+"_x")),n&&(this.get("preserve_domain").y?n.del_domain([],this.model_id+"_y"):n.compute_and_set_domain(this.mark_data.y,this.model_id+"_y"))}}},{serializers:r.extend({image:{deserialize:i.unpack_models}},s.MarkModel.serializers)});t.exports={ImageModel:a}}])});
//# sourceMappingURL=index.js.map